Using device: cuda
Selected target_properties: ['rot_A']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 4199, Training: 3360, Validation: 839
Actual heads number: 1
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)
冻结层 6: interaction_blocks.3 (SimpleInteractionBlock)
冻结层 7: lins.0 (Linear)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Frozen
interaction_blocks.3.conv1.lin_rel.bias: Frozen
interaction_blocks.3.conv1.lin_root.weight: Frozen
interaction_blocks.3.conv2.lin_rel.weight: Frozen
interaction_blocks.3.conv2.lin_rel.bias: Frozen
interaction_blocks.3.conv2.lin_root.weight: Frozen
interaction_blocks.3.lin1.weight: Frozen
interaction_blocks.3.lin1.bias: Frozen
interaction_blocks.3.lin2.weight: Frozen
interaction_blocks.3.lin2.bias: Frozen
interaction_blocks.3.lin_cat.weight: Frozen
interaction_blocks.3.lin_cat.bias: Frozen
interaction_blocks.3.norm.weight: Frozen
interaction_blocks.3.norm.bias: Frozen
interaction_blocks.3.norm.mean_scale: Frozen
interaction_blocks.3.lin_feature1.lin1.weight: Frozen
interaction_blocks.3.lin_feature1.lin2.weight: Frozen
interaction_blocks.3.lin_feature2.lin1.weight: Frozen
interaction_blocks.3.lin_feature2.lin2.weight: Frozen
interaction_blocks.3.lin.weight: Frozen
interaction_blocks.3.lin.bias: Frozen
interaction_blocks.3.lins.0.weight: Frozen
interaction_blocks.3.lins.0.bias: Frozen
interaction_blocks.3.lins.1.weight: Frozen
interaction_blocks.3.lins.1.bias: Frozen
interaction_blocks.3.lins.2.weight: Frozen
interaction_blocks.3.lins.2.bias: Frozen
interaction_blocks.3.lins.3.weight: Frozen
interaction_blocks.3.lins.3.bias: Frozen
interaction_blocks.3.final.weight: Frozen
interaction_blocks.3.final.bias: Frozen
lins.0.weight: Frozen
lins.0.bias: Frozen
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 1025539

Epoch 1/1000
Training Loss: 1.48010815, Training R2: -1.056070
Validation Loss: 1.24907489, Validation R2: -0.004057
Saved best model with validation loss 1.24907489 to best_model_1e-3.pth

Epoch 2/1000
Training Loss: 1.19186099, Training R2: -0.004220
Validation Loss: 1.26373875, Validation R2: -0.027818

Epoch 3/1000
Training Loss: 1.21139441, Training R2: -0.037980
Validation Loss: 1.26775479, Validation R2: -0.034152

Epoch 4/1000
Training Loss: 1.20491588, Training R2: -0.027092
Validation Loss: 1.24903838, Validation R2: -0.003998
Saved best model with validation loss 1.24903838 to best_model_1e-3.pth

Epoch 5/1000
Training Loss: 1.20210694, Training R2: -0.021949
Validation Loss: 1.32062080, Validation R2: -0.122466

Epoch 6/1000
Training Loss: 1.23446796, Training R2: -0.078377
Validation Loss: 1.24687922, Validation R2: -0.000508
Saved best model with validation loss 1.24687922 to best_model_1e-3.pth

Epoch 7/1000
Training Loss: 1.19364999, Training R2: -0.007376
Validation Loss: 1.25390455, Validation R2: -0.011859

Epoch 8/1000
Training Loss: 1.19204886, Training R2: -0.006113
Validation Loss: 1.24722809, Validation R2: -0.001033

Epoch 9/1000
Training Loss: 1.19437162, Training R2: -0.009001
Validation Loss: 1.26786635, Validation R2: -0.034334

Epoch 10/1000
Training Loss: 1.21694443, Training R2: -0.046421
Validation Loss: 1.24675678, Validation R2: -0.000308
Saved best model with validation loss 1.24675678 to best_model_1e-3.pth

Epoch 11/1000
Training Loss: 1.19820615, Training R2: -0.013653
Validation Loss: 1.30505212, Validation R2: -0.096155

Epoch 12/1000
Training Loss: 1.21658521, Training R2: -0.047188
Validation Loss: 1.24655324, Validation R2: 0.000032
Saved best model with validation loss 1.24655324 to best_model_1e-3.pth

Epoch 13/1000
Training Loss: 1.20400984, Training R2: -0.024210
Validation Loss: 1.25213448, Validation R2: -0.008998

Epoch 14/1000
Training Loss: 1.20163347, Training R2: -0.021492
Validation Loss: 1.25870993, Validation R2: -0.019644

Epoch 15/1000
Training Loss: 1.19754429, Training R2: -0.014513
Validation Loss: 1.29571117, Validation R2: -0.080200

Epoch 16/1000
Training Loss: 1.21785570, Training R2: -0.048307
Validation Loss: 1.26106785, Validation R2: -0.023473

Epoch 17/1000
Training Loss: 1.19290949, Training R2: -0.005823
Validation Loss: 1.25665300, Validation R2: -0.016308

Epoch 18/1000
Training Loss: 1.19360609, Training R2: -0.006982
Validation Loss: 1.25146745, Validation R2: -0.007814

Epoch 19/1000
Training Loss: 1.19425198, Training R2: -0.007282
Validation Loss: 1.24845705, Validation R2: -0.003059

Epoch 20/1000
Training Loss: 1.19261580, Training R2: -0.005439
Validation Loss: 1.24819655, Validation R2: -0.002639

Epoch 21/1000
Training Loss: 1.20193384, Training R2: -0.022069
Validation Loss: 1.25850505, Validation R2: -0.019311

Epoch 22/1000
Training Loss: 1.19165347, Training R2: -0.003691
Validation Loss: 1.24691101, Validation R2: -0.000559

Epoch 23/1000
Training Loss: 1.19178201, Training R2: -0.004061
Validation Loss: 1.24985351, Validation R2: -0.005226

Epoch 24/1000
Training Loss: 1.19239831, Training R2: -0.006029
Validation Loss: 1.24919705, Validation R2: -0.004176

Epoch 25/1000
Training Loss: 1.19790474, Training R2: -0.017044
Validation Loss: 1.24655513, Validation R2: 0.000022

Epoch 26/1000
Training Loss: 1.20814263, Training R2: -0.032449
Validation Loss: 1.25295506, Validation R2: -0.010324

Epoch 27/1000
Training Loss: 1.19385978, Training R2: -0.007366
Validation Loss: 1.24763677, Validation R2: -0.001734

Epoch 28/1000
Training Loss: 1.18953035, Training R2: -0.000451
Validation Loss: 1.25153181, Validation R2: -0.008024

Epoch 29/1000
Training Loss: 1.19159702, Training R2: -0.003855
Validation Loss: 1.25068239, Validation R2: -0.006652

Epoch 30/1000
Training Loss: 1.19046345, Training R2: -0.002867
Validation Loss: 1.25019629, Validation R2: -0.005775

Epoch 31/1000
Training Loss: 1.19610760, Training R2: -0.011741
Validation Loss: 1.26293003, Validation R2: -0.026501

Epoch 32/1000
Training Loss: 1.19438356, Training R2: -0.008505
Validation Loss: 1.24725347, Validation R2: -0.001115

Epoch 33/1000
Training Loss: 1.19256669, Training R2: -0.005092
Validation Loss: 1.24682588, Validation R2: -0.000392

Epoch 34/1000
Training Loss: 1.19442392, Training R2: -0.007529
Validation Loss: 1.26440499, Validation R2: -0.028901

Epoch 35/1000
Training Loss: 1.19672685, Training R2: -0.011895
Validation Loss: 1.24630555, Validation R2: 0.000429
Saved best model with validation loss 1.24630555 to best_model_1e-3.pth

Epoch 36/1000
Epoch 00036: reducing learning rate of group 0 to 5.0000e-04.
Training Loss: 1.18916807, Training R2: -0.000341
Validation Loss: 1.25379091, Validation R2: -0.011533

Epoch 37/1000
学习率已减少 1 次
Training Loss: 1.19420163, Training R2: -0.008132
Validation Loss: 1.24308622, Validation R2: 0.005622
Saved best model with validation loss 1.24308622 to best_model_1e-3.pth

Epoch 38/1000
Training Loss: 1.18749818, Training R2: 0.002648
Validation Loss: 1.24400620, Validation R2: 0.004151

Epoch 39/1000
Training Loss: 1.19037690, Training R2: -0.000873
Validation Loss: 1.24903657, Validation R2: -0.003803

Epoch 40/1000
Training Loss: 1.18523491, Training R2: 0.007155
Validation Loss: 1.26318355, Validation R2: -0.026795

Epoch 41/1000
Training Loss: 1.19493169, Training R2: -0.009662
Validation Loss: 1.24425645, Validation R2: 0.003723

Epoch 42/1000
Training Loss: 1.19107906, Training R2: -0.002351
Validation Loss: 1.23774321, Validation R2: 0.014262
Saved best model with validation loss 1.23774321 to best_model_1e-3.pth

Epoch 43/1000
Training Loss: 1.16887057, Training R2: 0.034287
Validation Loss: 1.21802429, Validation R2: 0.045501
Saved best model with validation loss 1.21802429 to best_model_1e-3.pth

Epoch 44/1000
Training Loss: 1.15762868, Training R2: 0.053334
Validation Loss: 1.27611084, Validation R2: -0.047861

Epoch 45/1000
Training Loss: 1.16257885, Training R2: 0.044820
Validation Loss: 1.20184906, Validation R2: 0.070474
Saved best model with validation loss 1.20184906 to best_model_1e-3.pth

Epoch 46/1000
Training Loss: 1.14647948, Training R2: 0.070478
Validation Loss: 1.21875564, Validation R2: 0.044084

Epoch 47/1000
Training Loss: 1.14137005, Training R2: 0.079045
Validation Loss: 1.22482623, Validation R2: 0.034550

Epoch 48/1000
Training Loss: 1.14115477, Training R2: 0.079646
Validation Loss: 1.21858363, Validation R2: 0.043902

Epoch 49/1000
Training Loss: 1.15120710, Training R2: 0.063337
Validation Loss: 1.17495766, Validation R2: 0.110857
Saved best model with validation loss 1.17495766 to best_model_1e-3.pth

Epoch 50/1000
Training Loss: 1.12512293, Training R2: 0.104345
Validation Loss: 1.18256757, Validation R2: 0.099994

Epoch 51/1000
Training Loss: 1.16184888, Training R2: 0.045156
Validation Loss: 1.20170102, Validation R2: 0.070725

Epoch 52/1000
Training Loss: 1.12187780, Training R2: 0.110031
Validation Loss: 1.16820918, Validation R2: 0.121617
Saved best model with validation loss 1.16820918 to best_model_1e-3.pth

Epoch 53/1000
Training Loss: 1.10051373, Training R2: 0.144142
Validation Loss: 1.15722532, Validation R2: 0.137762
Saved best model with validation loss 1.15722532 to best_model_1e-3.pth

Epoch 54/1000
Training Loss: 1.10252058, Training R2: 0.140048
Validation Loss: 1.15130774, Validation R2: 0.146755
Saved best model with validation loss 1.15130774 to best_model_1e-3.pth

Epoch 55/1000
Training Loss: 1.08067250, Training R2: 0.173072
Validation Loss: 1.23429243, Validation R2: 0.019599

Epoch 56/1000
Training Loss: 1.10937161, Training R2: 0.129518
Validation Loss: 1.16206976, Validation R2: 0.130652

Epoch 57/1000
Training Loss: 1.08523694, Training R2: 0.166985
Validation Loss: 1.22713317, Validation R2: 0.031028

Epoch 58/1000
Training Loss: 1.11524149, Training R2: 0.119837
Validation Loss: 1.15161677, Validation R2: 0.145638

Epoch 59/1000
Training Loss: 1.08342207, Training R2: 0.170148
Validation Loss: 1.18032692, Validation R2: 0.099884

Epoch 60/1000
Training Loss: 1.09739483, Training R2: 0.148630
Validation Loss: 1.16249807, Validation R2: 0.129842

Epoch 61/1000
Training Loss: 1.11062759, Training R2: 0.127909
Validation Loss: 1.18953735, Validation R2: 0.089211

Epoch 62/1000
Training Loss: 1.11005340, Training R2: 0.129094
Validation Loss: 1.20243214, Validation R2: 0.069716

Epoch 63/1000
Training Loss: 1.10697291, Training R2: 0.133390
Validation Loss: 1.14244394, Validation R2: 0.159559
Saved best model with validation loss 1.14244394 to best_model_1e-3.pth

Epoch 64/1000
Training Loss: 1.07168268, Training R2: 0.186931
Validation Loss: 1.17897275, Validation R2: 0.105402

Epoch 65/1000
Training Loss: 1.08483956, Training R2: 0.167599
Validation Loss: 1.23327279, Validation R2: 0.021186

Epoch 66/1000
Training Loss: 1.09981285, Training R2: 0.144437
Validation Loss: 1.14525510, Validation R2: 0.155723

Epoch 67/1000
Epoch 00067: reducing learning rate of group 0 to 2.5000e-04.
Training Loss: 1.07025097, Training R2: 0.190538
Validation Loss: 1.21582225, Validation R2: 0.047923

Epoch 68/1000
学习率已减少 2 次
Training Loss: 1.10732823, Training R2: 0.133464
Validation Loss: 1.13769844, Validation R2: 0.166487
Saved best model with validation loss 1.13769844 to best_model_1e-3.pth

Epoch 69/1000
Training Loss: 1.06823600, Training R2: 0.192872
Validation Loss: 1.14436130, Validation R2: 0.156857

Epoch 70/1000
Training Loss: 1.06799037, Training R2: 0.193238
Validation Loss: 1.12430116, Validation R2: 0.185814
Saved best model with validation loss 1.12430116 to best_model_1e-3.pth

Epoch 71/1000
Training Loss: 1.06005710, Training R2: 0.205822
Validation Loss: 1.12958846, Validation R2: 0.178281

Epoch 72/1000
Training Loss: 1.05828318, Training R2: 0.208351
Validation Loss: 1.15029655, Validation R2: 0.146912

Epoch 73/1000
Training Loss: 1.09369476, Training R2: 0.153032
Validation Loss: 1.13332025, Validation R2: 0.172784

Epoch 74/1000
Training Loss: 1.06433268, Training R2: 0.199722
Validation Loss: 1.13981448, Validation R2: 0.163849

Epoch 75/1000
Training Loss: 1.05918541, Training R2: 0.207047
Validation Loss: 1.12577417, Validation R2: 0.182886

Epoch 76/1000
Training Loss: 1.05122829, Training R2: 0.218176
Validation Loss: 1.11301355, Validation R2: 0.202145
Saved best model with validation loss 1.11301355 to best_model_1e-3.pth

Epoch 77/1000
Training Loss: 1.05306356, Training R2: 0.216457
Validation Loss: 1.14772799, Validation R2: 0.152005

Epoch 78/1000
Training Loss: 1.05098372, Training R2: 0.219791
Validation Loss: 1.12704015, Validation R2: 0.181700

Epoch 79/1000
Training Loss: 1.05694999, Training R2: 0.209019
Validation Loss: 1.13079013, Validation R2: 0.176997

Epoch 80/1000
Training Loss: 1.04987477, Training R2: 0.220348
Validation Loss: 1.10076803, Validation R2: 0.219395
Saved best model with validation loss 1.10076803 to best_model_1e-3.pth

Epoch 81/1000
Training Loss: 1.04550696, Training R2: 0.227727
Validation Loss: 1.11209627, Validation R2: 0.202987

Epoch 82/1000
Training Loss: 1.04117603, Training R2: 0.233792
Validation Loss: 1.11942844, Validation R2: 0.191935

Epoch 83/1000
Training Loss: 1.04546919, Training R2: 0.227134
Validation Loss: 1.10781341, Validation R2: 0.209435

Epoch 84/1000
Training Loss: 1.04171184, Training R2: 0.233243
Validation Loss: 1.10217137, Validation R2: 0.217406

Epoch 85/1000
Training Loss: 1.04008283, Training R2: 0.235064
Validation Loss: 1.10318569, Validation R2: 0.215830

Epoch 86/1000
Training Loss: 1.03635232, Training R2: 0.240949
Validation Loss: 1.09220384, Validation R2: 0.230253
Saved best model with validation loss 1.09220384 to best_model_1e-3.pth

Epoch 87/1000
Training Loss: 1.03278777, Training R2: 0.246243
Validation Loss: 1.11509940, Validation R2: 0.199042

Epoch 88/1000
Training Loss: 1.03750225, Training R2: 0.239221
Validation Loss: 1.09812565, Validation R2: 0.223110

Epoch 89/1000
Training Loss: 1.04098387, Training R2: 0.233869
Validation Loss: 1.10382619, Validation R2: 0.214459

Epoch 90/1000
Training Loss: 1.04308482, Training R2: 0.228908
Validation Loss: 1.08940613, Validation R2: 0.235316
Saved best model with validation loss 1.08940613 to best_model_1e-3.pth

Epoch 91/1000
Training Loss: 1.02755728, Training R2: 0.253430
Validation Loss: 1.09778872, Validation R2: 0.223131

Epoch 92/1000
Training Loss: 1.03682434, Training R2: 0.239925
Validation Loss: 1.14987809, Validation R2: 0.148890

Epoch 93/1000
Training Loss: 1.05396285, Training R2: 0.213639
Validation Loss: 1.10026758, Validation R2: 0.220388

Epoch 94/1000
Training Loss: 1.04091338, Training R2: 0.234125
Validation Loss: 1.09525480, Validation R2: 0.227446

Epoch 95/1000
Training Loss: 1.03564645, Training R2: 0.241347
Validation Loss: 1.09190487, Validation R2: 0.230296

Epoch 96/1000
Training Loss: 1.03365516, Training R2: 0.244776
Validation Loss: 1.08841444, Validation R2: 0.235845
Saved best model with validation loss 1.08841444 to best_model_1e-3.pth

Epoch 97/1000
Training Loss: 1.02688042, Training R2: 0.254489
Validation Loss: 1.08596969, Validation R2: 0.239739
Saved best model with validation loss 1.08596969 to best_model_1e-3.pth

Epoch 98/1000
Epoch 00098: reducing learning rate of group 0 to 1.2500e-04.
Training Loss: 1.02320640, Training R2: 0.260146
Validation Loss: 1.08389622, Validation R2: 0.242532
Saved best model with validation loss 1.08389622 to best_model_1e-3.pth

Epoch 99/1000
学习率已减少 3 次
Training Loss: 1.01807933, Training R2: 0.266842
Validation Loss: 1.08727319, Validation R2: 0.237392

Epoch 100/1000
Training Loss: 1.01797921, Training R2: 0.267164
Validation Loss: 1.08149565, Validation R2: 0.245397
Saved best model with validation loss 1.08149565 to best_model_1e-3.pth

Epoch 101/1000
Training Loss: 1.02582048, Training R2: 0.255543
Validation Loss: 1.08058404, Validation R2: 0.247436
Saved best model with validation loss 1.08058404 to best_model_1e-3.pth

Epoch 102/1000
Training Loss: 1.02203645, Training R2: 0.261659
Validation Loss: 1.08070121, Validation R2: 0.246842

Epoch 103/1000
Training Loss: 1.01600312, Training R2: 0.270493
Validation Loss: 1.08545866, Validation R2: 0.240208

Epoch 104/1000
Training Loss: 1.00905161, Training R2: 0.280398
Validation Loss: 1.08843804, Validation R2: 0.236593

Epoch 105/1000
Training Loss: 1.01158917, Training R2: 0.275872
Validation Loss: 1.08349305, Validation R2: 0.242852

Epoch 106/1000
Training Loss: 1.01445343, Training R2: 0.272637
Validation Loss: 1.09647686, Validation R2: 0.225286

Epoch 107/1000
Training Loss: 1.00670829, Training R2: 0.283499
Validation Loss: 1.06695518, Validation R2: 0.265737
Saved best model with validation loss 1.06695518 to best_model_1e-3.pth

Epoch 108/1000
Training Loss: 1.00296376, Training R2: 0.288608
Validation Loss: 1.07610537, Validation R2: 0.253605

Epoch 109/1000
Training Loss: 1.00403716, Training R2: 0.288078
Validation Loss: 1.06711662, Validation R2: 0.265639

Epoch 110/1000
Training Loss: 0.99779694, Training R2: 0.296729
Validation Loss: 1.06364445, Validation R2: 0.269823
Saved best model with validation loss 1.06364445 to best_model_1e-3.pth

Epoch 111/1000
Training Loss: 1.00018087, Training R2: 0.292458
Validation Loss: 1.07669980, Validation R2: 0.252507

Epoch 112/1000
Training Loss: 1.00626089, Training R2: 0.284208
Validation Loss: 1.08812306, Validation R2: 0.237122

Epoch 113/1000
Training Loss: 1.01157282, Training R2: 0.277500
Validation Loss: 1.06782376, Validation R2: 0.264312

Epoch 114/1000
Training Loss: 0.99875086, Training R2: 0.294620
Validation Loss: 1.06600190, Validation R2: 0.266668

Epoch 115/1000
Training Loss: 0.99857839, Training R2: 0.295038
Validation Loss: 1.07395019, Validation R2: 0.256552

Epoch 116/1000
Training Loss: 0.99733159, Training R2: 0.296467
Validation Loss: 1.06038697, Validation R2: 0.274144
Saved best model with validation loss 1.06038697 to best_model_1e-3.pth

Epoch 117/1000
Training Loss: 0.98770220, Training R2: 0.309553
Validation Loss: 1.06479954, Validation R2: 0.267948

Epoch 118/1000
Training Loss: 0.99062545, Training R2: 0.305890
Validation Loss: 1.06960329, Validation R2: 0.261629

Epoch 119/1000
Training Loss: 0.98454324, Training R2: 0.314634
Validation Loss: 1.06947706, Validation R2: 0.260388

Epoch 120/1000
Training Loss: 0.98124934, Training R2: 0.319927
Validation Loss: 1.06413657, Validation R2: 0.268965

Epoch 121/1000
Training Loss: 0.97675771, Training R2: 0.325707
Validation Loss: 1.05784913, Validation R2: 0.277786
Saved best model with validation loss 1.05784913 to best_model_1e-3.pth

Epoch 122/1000
Training Loss: 0.97646896, Training R2: 0.326327
Validation Loss: 1.06164745, Validation R2: 0.272455

Epoch 123/1000
Training Loss: 0.97679184, Training R2: 0.325610
Validation Loss: 1.05377858, Validation R2: 0.282372
Saved best model with validation loss 1.05377858 to best_model_1e-3.pth

Epoch 124/1000
Training Loss: 0.98160666, Training R2: 0.318305
Validation Loss: 1.06915482, Validation R2: 0.261821

Epoch 125/1000
Training Loss: 0.98245362, Training R2: 0.318057
Validation Loss: 1.05209664, Validation R2: 0.285329
Saved best model with validation loss 1.05209664 to best_model_1e-3.pth

Epoch 126/1000
Training Loss: 0.97724287, Training R2: 0.324818
Validation Loss: 1.06414055, Validation R2: 0.269529

Epoch 127/1000
Training Loss: 0.97145554, Training R2: 0.331141
Validation Loss: 1.05669827, Validation R2: 0.279646

Epoch 128/1000
Training Loss: 0.96906265, Training R2: 0.335152
Validation Loss: 1.07670287, Validation R2: 0.251898

Epoch 129/1000
Epoch 00129: reducing learning rate of group 0 to 6.2500e-05.
Training Loss: 0.97501408, Training R2: 0.327462
Validation Loss: 1.05635112, Validation R2: 0.278973

Epoch 130/1000
学习率已减少 4 次
Training Loss: 0.95953382, Training R2: 0.348459
Validation Loss: 1.06037064, Validation R2: 0.274296

Epoch 131/1000
Training Loss: 0.96039192, Training R2: 0.347801
Validation Loss: 1.05258543, Validation R2: 0.284800

Epoch 132/1000
Training Loss: 0.96322622, Training R2: 0.343873
Validation Loss: 1.08149928, Validation R2: 0.246113

Epoch 133/1000
Training Loss: 0.96061050, Training R2: 0.347576
Validation Loss: 1.05239116, Validation R2: 0.284517

Epoch 134/1000
Training Loss: 0.96062285, Training R2: 0.347537
Validation Loss: 1.05338998, Validation R2: 0.284340

Epoch 135/1000
Training Loss: 0.96230073, Training R2: 0.345674
Validation Loss: 1.06054617, Validation R2: 0.273671

Epoch 136/1000
Training Loss: 0.95594631, Training R2: 0.353846
Validation Loss: 1.05212638, Validation R2: 0.285283

Epoch 137/1000
Training Loss: 0.95162001, Training R2: 0.359791
Validation Loss: 1.04741262, Validation R2: 0.291715
Saved best model with validation loss 1.04741262 to best_model_1e-3.pth

Epoch 138/1000
Training Loss: 0.96616461, Training R2: 0.339083
Validation Loss: 1.04956642, Validation R2: 0.288090

Epoch 139/1000
Training Loss: 0.95460810, Training R2: 0.353848
Validation Loss: 1.05061474, Validation R2: 0.287394

Epoch 140/1000
Training Loss: 0.94303924, Training R2: 0.370550
Validation Loss: 1.04789592, Validation R2: 0.290442

Epoch 141/1000
Training Loss: 0.94397665, Training R2: 0.369177
Validation Loss: 1.04911630, Validation R2: 0.289079

Epoch 142/1000
Training Loss: 0.94117001, Training R2: 0.373274
Validation Loss: 1.04914708, Validation R2: 0.289189

Epoch 143/1000
Training Loss: 0.94400249, Training R2: 0.369099
Validation Loss: 1.05444340, Validation R2: 0.282409

Epoch 144/1000
Training Loss: 0.93551559, Training R2: 0.381187
Validation Loss: 1.04581739, Validation R2: 0.293715
Saved best model with validation loss 1.04581739 to best_model_1e-3.pth

Epoch 145/1000
Training Loss: 0.93656158, Training R2: 0.380178
Validation Loss: 1.05639974, Validation R2: 0.279796

Epoch 146/1000
Training Loss: 0.95061245, Training R2: 0.360815
Validation Loss: 1.05206329, Validation R2: 0.285884

Epoch 147/1000
Training Loss: 0.93999453, Training R2: 0.375612
Validation Loss: 1.04824973, Validation R2: 0.291228

Epoch 148/1000
Training Loss: 0.93131878, Training R2: 0.386427
Validation Loss: 1.04287487, Validation R2: 0.297644
Saved best model with validation loss 1.04287487 to best_model_1e-3.pth

Epoch 149/1000
Training Loss: 0.92973557, Training R2: 0.388682
Validation Loss: 1.05025084, Validation R2: 0.288844

Epoch 150/1000
Training Loss: 0.93418317, Training R2: 0.382726
Validation Loss: 1.04849026, Validation R2: 0.290544

Epoch 151/1000
Training Loss: 0.93818512, Training R2: 0.377858
Validation Loss: 1.04560401, Validation R2: 0.293284

Epoch 152/1000
Training Loss: 0.93179898, Training R2: 0.386519
Validation Loss: 1.06399490, Validation R2: 0.270839

Epoch 153/1000
Training Loss: 0.93250068, Training R2: 0.385181
Validation Loss: 1.06670632, Validation R2: 0.267022

Epoch 154/1000
Training Loss: 0.92741648, Training R2: 0.392010
Validation Loss: 1.04496697, Validation R2: 0.295846

Epoch 155/1000
Training Loss: 0.93425623, Training R2: 0.382761
Validation Loss: 1.04201578, Validation R2: 0.299978
Saved best model with validation loss 1.04201578 to best_model_1e-3.pth

Epoch 156/1000
Training Loss: 0.92811898, Training R2: 0.391148
Validation Loss: 1.03570668, Validation R2: 0.307851
Saved best model with validation loss 1.03570668 to best_model_1e-3.pth

Epoch 157/1000
Training Loss: 0.91713360, Training R2: 0.405084
Validation Loss: 1.03001291, Validation R2: 0.315520
Saved best model with validation loss 1.03001291 to best_model_1e-3.pth

Epoch 158/1000
Training Loss: 0.91523822, Training R2: 0.407431
Validation Loss: 1.03438906, Validation R2: 0.310078

Epoch 159/1000
Training Loss: 0.91393617, Training R2: 0.409641
Validation Loss: 1.09029703, Validation R2: 0.234218

Epoch 160/1000
Epoch 00160: reducing learning rate of group 0 to 3.1250e-05.
Training Loss: 0.95170906, Training R2: 0.358754
Validation Loss: 1.05447045, Validation R2: 0.282514

Epoch 161/1000
学习率已减少 5 次
Training Loss: 0.91769875, Training R2: 0.404830
Validation Loss: 1.04867383, Validation R2: 0.290174

Epoch 162/1000
Training Loss: 0.91056408, Training R2: 0.413567
Validation Loss: 1.04017451, Validation R2: 0.301640

Epoch 163/1000
Training Loss: 0.90263556, Training R2: 0.424378
Validation Loss: 1.03744028, Validation R2: 0.305911

Epoch 164/1000
Training Loss: 0.90051428, Training R2: 0.427242
Validation Loss: 1.04058889, Validation R2: 0.301519

Epoch 165/1000
Training Loss: 0.90421006, Training R2: 0.421092
Validation Loss: 1.03712216, Validation R2: 0.306590

Epoch 166/1000
Training Loss: 0.90655584, Training R2: 0.418863
Validation Loss: 1.03856607, Validation R2: 0.304152

Epoch 167/1000
Training Loss: 0.90373762, Training R2: 0.422922
Validation Loss: 1.04629801, Validation R2: 0.293367

Epoch 168/1000
Training Loss: 0.90214269, Training R2: 0.424706
Validation Loss: 1.04024411, Validation R2: 0.301907

Epoch 169/1000
Training Loss: 0.89544506, Training R2: 0.433222
Validation Loss: 1.03916395, Validation R2: 0.303663

Epoch 170/1000
Training Loss: 0.89230649, Training R2: 0.437335
Validation Loss: 1.04759913, Validation R2: 0.292265

Epoch 171/1000
Training Loss: 0.89144942, Training R2: 0.438382
Validation Loss: 1.03890308, Validation R2: 0.304473

Epoch 172/1000
Training Loss: 0.89016847, Training R2: 0.439626
Validation Loss: 1.05137131, Validation R2: 0.288098

Epoch 173/1000
Training Loss: 0.88832255, Training R2: 0.442351
Validation Loss: 1.04065971, Validation R2: 0.302059

Epoch 174/1000
Training Loss: 0.88631140, Training R2: 0.445104
Validation Loss: 1.04593418, Validation R2: 0.295176

Epoch 175/1000
Training Loss: 0.88734068, Training R2: 0.442833
Validation Loss: 1.05401573, Validation R2: 0.284516

Epoch 176/1000
Training Loss: 0.89028405, Training R2: 0.439624
Validation Loss: 1.04391639, Validation R2: 0.297017

Epoch 177/1000
Training Loss: 0.88254741, Training R2: 0.449464
Validation Loss: 1.04502856, Validation R2: 0.295750

Epoch 178/1000
Training Loss: 0.88094632, Training R2: 0.451786
Validation Loss: 1.04961091, Validation R2: 0.290345

Epoch 179/1000
Training Loss: 0.87959101, Training R2: 0.451828
Validation Loss: 1.04625074, Validation R2: 0.293733

Epoch 180/1000
Training Loss: 0.88190442, Training R2: 0.449781
Validation Loss: 1.04290289, Validation R2: 0.298854

Epoch 181/1000
Training Loss: 0.87610329, Training R2: 0.457561
Validation Loss: 1.04071119, Validation R2: 0.302078

Epoch 182/1000
Training Loss: 0.87614514, Training R2: 0.455098
Validation Loss: 1.04762079, Validation R2: 0.292612

Epoch 183/1000
Training Loss: 0.88614120, Training R2: 0.444514
Validation Loss: 1.04437178, Validation R2: 0.297109

Epoch 184/1000
Training Loss: 0.88740976, Training R2: 0.442158
Validation Loss: 1.04940255, Validation R2: 0.290787

Epoch 185/1000
Training Loss: 0.87398695, Training R2: 0.460514
Validation Loss: 1.04384117, Validation R2: 0.297497

Epoch 186/1000
Training Loss: 0.87400555, Training R2: 0.460125
Validation Loss: 1.04475109, Validation R2: 0.296785

Epoch 187/1000
Training Loss: 0.87407310, Training R2: 0.459476
Validation Loss: 1.05106376, Validation R2: 0.288325

Epoch 188/1000
Training Loss: 0.87264795, Training R2: 0.460324
Validation Loss: 1.04939939, Validation R2: 0.289573

Epoch 189/1000
Training Loss: 0.87663502, Training R2: 0.456783
Validation Loss: 1.04385088, Validation R2: 0.297828

Epoch 190/1000
Training Loss: 0.87620025, Training R2: 0.457116
Validation Loss: 1.05279467, Validation R2: 0.286443

Epoch 191/1000
Epoch 00191: reducing learning rate of group 0 to 1.5625e-05.
Training Loss: 0.86953617, Training R2: 0.465805
Validation Loss: 1.04479930, Validation R2: 0.295776

Epoch 192/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/benchmark/data/Lipo/loss_curve_rot_A.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/benchmark/data/Lipo/r2_curve_rot_A.png
