Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3258499

Epoch 1/1000
Training Loss: 1.98778536, Training R2: -1.805080
Validation Loss: 1.22335374, Validation R2: -0.154364
Saved best model with validation R2 -0.154364 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.20983805, Training R2: -0.046276
Validation Loss: 1.10859597, Validation R2: -0.170578

Epoch 3/1000
Training Loss: 1.10999353, Training R2: -0.002264
Validation Loss: 1.06108224, Validation R2: 0.089009
Saved best model with validation R2 0.089009 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 1.13704854, Training R2: 0.065729
Validation Loss: 1.02555752, Validation R2: 0.091497
Saved best model with validation R2 0.091497 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.06194629, Training R2: 0.088110
Validation Loss: 1.03036273, Validation R2: 0.015688

Epoch 6/1000
Training Loss: 1.02242362, Training R2: 0.114229
Validation Loss: 0.99973011, Validation R2: 0.163230
Saved best model with validation R2 0.163230 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 1.03120777, Training R2: 0.188713
Validation Loss: 0.99333006, Validation R2: 0.123537

Epoch 8/1000
Training Loss: 0.98458153, Training R2: 0.189541
Validation Loss: 0.94383109, Validation R2: 0.242711
Saved best model with validation R2 0.242711 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.92993880, Training R2: 0.265213
Validation Loss: 1.00973010, Validation R2: 0.067966

Epoch 10/1000
Training Loss: 0.90871246, Training R2: 0.256271
Validation Loss: 0.88327497, Validation R2: 0.304672
Saved best model with validation R2 0.304672 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.81489327, Training R2: 0.367830
Validation Loss: 0.84105372, Validation R2: 0.336640
Saved best model with validation R2 0.336640 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.78803981, Training R2: 0.414680
Validation Loss: 0.89007521, Validation R2: 0.251037

Epoch 13/1000
Training Loss: 0.73565316, Training R2: 0.456402
Validation Loss: 0.83131421, Validation R2: 0.345458
Saved best model with validation R2 0.345458 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.67938820, Training R2: 0.514860
Validation Loss: 0.85103667, Validation R2: 0.341444

Epoch 15/1000
Training Loss: 0.65658605, Training R2: 0.535575
Validation Loss: 0.89558548, Validation R2: 0.252783

Epoch 16/1000
Training Loss: 0.67729663, Training R2: 0.516000
Validation Loss: 0.81683666, Validation R2: 0.392844
Saved best model with validation R2 0.392844 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.61376392, Training R2: 0.579829
Validation Loss: 0.83182204, Validation R2: 0.368557

Epoch 18/1000
Training Loss: 0.63768279, Training R2: 0.565282
Validation Loss: 0.81221372, Validation R2: 0.360983

Epoch 19/1000
Training Loss: 0.58130428, Training R2: 0.608772
Validation Loss: 0.80454922, Validation R2: 0.381023

Epoch 20/1000
Training Loss: 0.56960804, Training R2: 0.609275
Validation Loss: 0.82060742, Validation R2: 0.387138

Epoch 21/1000
Training Loss: 0.55686868, Training R2: 0.625308
Validation Loss: 0.81129986, Validation R2: 0.383022

Epoch 22/1000
Training Loss: 0.50742275, Training R2: 0.661194
Validation Loss: 0.81671280, Validation R2: 0.351710

Epoch 23/1000
Training Loss: 0.47978045, Training R2: 0.689067
Validation Loss: 0.82329327, Validation R2: 0.333550

Epoch 24/1000
Training Loss: 0.45838057, Training R2: 0.698944
Validation Loss: 0.83618009, Validation R2: 0.343431

Epoch 25/1000
Training Loss: 0.42278043, Training R2: 0.721955
Validation Loss: 0.83374494, Validation R2: 0.362267

Epoch 26/1000
Training Loss: 0.41726160, Training R2: 0.732274
Validation Loss: 0.80710983, Validation R2: 0.369030

Epoch 27/1000
Training Loss: 0.38002272, Training R2: 0.752689
Validation Loss: 0.80755079, Validation R2: 0.368985

Epoch 28/1000
Training Loss: 0.39676036, Training R2: 0.752196
Validation Loss: 0.83879334, Validation R2: 0.368151

Epoch 29/1000
Training Loss: 0.43274281, Training R2: 0.740279
Validation Loss: 0.86558533, Validation R2: 0.349588

Epoch 30/1000
Training Loss: 0.49217971, Training R2: 0.713168
Validation Loss: 0.81649506, Validation R2: 0.375102

Epoch 31/1000
Training Loss: 0.44708313, Training R2: 0.736422
Validation Loss: 0.89290708, Validation R2: 0.252643

Epoch 32/1000
Training Loss: 0.46048831, Training R2: 0.734075
Validation Loss: 0.78010148, Validation R2: 0.394174
Saved best model with validation R2 0.394174 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.39678465, Training R2: 0.757462
Validation Loss: 0.81893784, Validation R2: 0.363921

Epoch 34/1000
Training Loss: 0.40257092, Training R2: 0.768204
Validation Loss: 0.82636511, Validation R2: 0.339096

Epoch 35/1000
Training Loss: 0.35324770, Training R2: 0.788024
Validation Loss: 0.82376617, Validation R2: 0.346497

Epoch 36/1000
Training Loss: 0.35543793, Training R2: 0.782125
Validation Loss: 0.81603110, Validation R2: 0.385490

Epoch 37/1000
Training Loss: 0.34817750, Training R2: 0.791732
Validation Loss: 0.81411386, Validation R2: 0.367410

Epoch 38/1000
Training Loss: 0.34698155, Training R2: 0.796613
Validation Loss: 0.81967914, Validation R2: 0.345831

Epoch 39/1000
Training Loss: 0.33180191, Training R2: 0.805551
Validation Loss: 0.79776150, Validation R2: 0.384907

Epoch 40/1000
Training Loss: 0.30035454, Training R2: 0.825068
Validation Loss: 0.79654568, Validation R2: 0.419528
Saved best model with validation R2 0.419528 to best_finetuned_model.pth

Epoch 41/1000
Training Loss: 0.32062224, Training R2: 0.812756
Validation Loss: 0.79867971, Validation R2: 0.405122

Epoch 42/1000
Training Loss: 0.31561013, Training R2: 0.824481
Validation Loss: 0.80573684, Validation R2: 0.402708

Epoch 43/1000
Training Loss: 0.29510289, Training R2: 0.824870
Validation Loss: 0.80932617, Validation R2: 0.394480

Epoch 44/1000
Training Loss: 0.27553151, Training R2: 0.835421
Validation Loss: 0.81055677, Validation R2: 0.391563

Epoch 45/1000
Training Loss: 0.27300651, Training R2: 0.841866
Validation Loss: 0.80442119, Validation R2: 0.416487

Epoch 46/1000
Training Loss: 0.27803818, Training R2: 0.835955
Validation Loss: 0.80653393, Validation R2: 0.392572

Epoch 47/1000
Training Loss: 0.27482343, Training R2: 0.847466
Validation Loss: 0.81741691, Validation R2: 0.394830

Epoch 48/1000
Training Loss: 0.31121155, Training R2: 0.836550
Validation Loss: 0.81001586, Validation R2: 0.432355
Saved best model with validation R2 0.432355 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.35107437, Training R2: 0.821016
Validation Loss: 0.79382294, Validation R2: 0.420769

Epoch 50/1000
Training Loss: 0.26909409, Training R2: 0.854670
Validation Loss: 0.79729396, Validation R2: 0.422276

Epoch 51/1000
Training Loss: 0.26702815, Training R2: 0.853426
Validation Loss: 0.79470432, Validation R2: 0.420624

Epoch 52/1000
Training Loss: 0.29058105, Training R2: 0.861078
Validation Loss: 0.80860490, Validation R2: 0.396150

Epoch 53/1000
Training Loss: 0.29306183, Training R2: 0.854076
Validation Loss: 0.79208481, Validation R2: 0.444588
Saved best model with validation R2 0.444588 to best_finetuned_model.pth

Epoch 54/1000
Training Loss: 0.27952807, Training R2: 0.854362
Validation Loss: 0.81388688, Validation R2: 0.405948

Epoch 55/1000
Training Loss: 0.29709349, Training R2: 0.842226
Validation Loss: 0.78726965, Validation R2: 0.432778

Epoch 56/1000
Training Loss: 0.26462620, Training R2: 0.860909
Validation Loss: 0.77421033, Validation R2: 0.450279
Saved best model with validation R2 0.450279 to best_finetuned_model.pth

Epoch 57/1000
Training Loss: 0.24855974, Training R2: 0.868687
Validation Loss: 0.79244477, Validation R2: 0.407154

Epoch 58/1000
Training Loss: 0.27987955, Training R2: 0.859976
Validation Loss: 0.79734010, Validation R2: 0.400551

Epoch 59/1000
Training Loss: 0.25007224, Training R2: 0.864084
Validation Loss: 0.81649244, Validation R2: 0.380553

Epoch 60/1000
Training Loss: 0.28349475, Training R2: 0.867196
Validation Loss: 0.79539961, Validation R2: 0.414968

Epoch 61/1000
Training Loss: 0.24059292, Training R2: 0.868145
Validation Loss: 0.78583068, Validation R2: 0.429074

Epoch 62/1000
Training Loss: 0.22086551, Training R2: 0.878980
Validation Loss: 0.77276409, Validation R2: 0.446750

Epoch 63/1000
Training Loss: 0.19788727, Training R2: 0.887684
Validation Loss: 0.77424389, Validation R2: 0.448512

Epoch 64/1000
Training Loss: 0.21057524, Training R2: 0.886084
Validation Loss: 0.78625327, Validation R2: 0.421619

Epoch 65/1000
Training Loss: 0.19195619, Training R2: 0.887379
Validation Loss: 0.79573148, Validation R2: 0.431538

Epoch 66/1000
Training Loss: 0.19738814, Training R2: 0.889710
Validation Loss: 0.77731735, Validation R2: 0.441719

Epoch 67/1000
Training Loss: 0.19902978, Training R2: 0.894276
Validation Loss: 0.78037518, Validation R2: 0.428751

Epoch 68/1000
Training Loss: 0.19322121, Training R2: 0.888994
Validation Loss: 0.82324779, Validation R2: 0.365568

Epoch 69/1000
Training Loss: 0.24086304, Training R2: 0.876041
Validation Loss: 0.81383312, Validation R2: 0.376203

Epoch 70/1000
Training Loss: 0.23427057, Training R2: 0.878864
Validation Loss: 0.77781105, Validation R2: 0.424698

Epoch 71/1000
Training Loss: 0.22065704, Training R2: 0.874462
Validation Loss: 0.77870452, Validation R2: 0.429444

Epoch 72/1000
Training Loss: 0.19089268, Training R2: 0.894078
Validation Loss: 0.79943109, Validation R2: 0.419193

Epoch 73/1000
Training Loss: 0.19185064, Training R2: 0.900296
Validation Loss: 0.79405266, Validation R2: 0.402004

Epoch 74/1000
Training Loss: 0.18793072, Training R2: 0.897731
Validation Loss: 0.78286290, Validation R2: 0.426444

Epoch 75/1000
Training Loss: 0.19601200, Training R2: 0.900358
Validation Loss: 0.78625029, Validation R2: 0.420329

Epoch 76/1000
Training Loss: 0.21771998, Training R2: 0.882139
Validation Loss: 0.80388677, Validation R2: 0.401496

Epoch 77/1000
Epoch 00077: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.20905013, Training R2: 0.893887
Validation Loss: 0.80399519, Validation R2: 0.392062

Epoch 78/1000
学习率已减少 1 次
Training Loss: 0.19619007, Training R2: 0.893880
Validation Loss: 0.79137617, Validation R2: 0.412369

Epoch 79/1000
Training Loss: 0.16118793, Training R2: 0.901786
Validation Loss: 0.79496831, Validation R2: 0.418588

Epoch 80/1000
Training Loss: 0.15101894, Training R2: 0.909317
Validation Loss: 0.79493111, Validation R2: 0.408938

Epoch 81/1000
Training Loss: 0.14316859, Training R2: 0.912573
Validation Loss: 0.79114276, Validation R2: 0.412199

Epoch 82/1000
Training Loss: 0.13220465, Training R2: 0.914460
Validation Loss: 0.79749340, Validation R2: 0.405175

Epoch 83/1000
Training Loss: 0.12418117, Training R2: 0.916662
Validation Loss: 0.79623181, Validation R2: 0.400922

Epoch 84/1000
Training Loss: 0.13530779, Training R2: 0.918334
Validation Loss: 0.78800887, Validation R2: 0.411398

Epoch 85/1000
Training Loss: 0.12965760, Training R2: 0.917515
Validation Loss: 0.78494000, Validation R2: 0.421829

Epoch 86/1000
Training Loss: 0.11221128, Training R2: 0.919344
Validation Loss: 0.78110516, Validation R2: 0.423343

Epoch 87/1000
Training Loss: 0.11744148, Training R2: 0.917981
Validation Loss: 0.77745962, Validation R2: 0.430193

Epoch 88/1000
Training Loss: 0.11113871, Training R2: 0.919496
Validation Loss: 0.77682316, Validation R2: 0.426271

Epoch 89/1000
Training Loss: 0.11498043, Training R2: 0.920850
Validation Loss: 0.78450042, Validation R2: 0.419659

Epoch 90/1000
Training Loss: 0.11687891, Training R2: 0.916059
Validation Loss: 0.78694183, Validation R2: 0.416411

Epoch 91/1000
Training Loss: 0.12113102, Training R2: 0.917880
Validation Loss: 0.79192823, Validation R2: 0.413530

Epoch 92/1000
Training Loss: 0.11866753, Training R2: 0.918556
Validation Loss: 0.77527267, Validation R2: 0.436813

Epoch 93/1000
Training Loss: 0.14286267, Training R2: 0.917583
Validation Loss: 0.76607102, Validation R2: 0.449945

Epoch 94/1000
Training Loss: 0.13359849, Training R2: 0.916331
Validation Loss: 0.78236967, Validation R2: 0.426630

Epoch 95/1000
Training Loss: 0.11424472, Training R2: 0.923731
Validation Loss: 0.79378265, Validation R2: 0.408897

Epoch 96/1000
Training Loss: 0.11879900, Training R2: 0.924940
Validation Loss: 0.79271436, Validation R2: 0.411358

Epoch 97/1000
Training Loss: 0.12436165, Training R2: 0.924391
Validation Loss: 0.77920085, Validation R2: 0.431234

Epoch 98/1000
Epoch 00098: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.11619895, Training R2: 0.922799
Validation Loss: 0.77480340, Validation R2: 0.434234

Epoch 99/1000
学习率已减少 2 次
Training Loss: 0.10844910, Training R2: 0.924989
Validation Loss: 0.77551448, Validation R2: 0.435976

Epoch 100/1000
Training Loss: 0.09378668, Training R2: 0.928720
Validation Loss: 0.77370793, Validation R2: 0.433405

Epoch 101/1000
Training Loss: 0.08978859, Training R2: 0.929270
Validation Loss: 0.77991039, Validation R2: 0.422272

Epoch 102/1000
Training Loss: 0.08665172, Training R2: 0.929066
Validation Loss: 0.78123689, Validation R2: 0.424821

Epoch 103/1000
Training Loss: 0.08376957, Training R2: 0.929108
Validation Loss: 0.77447575, Validation R2: 0.436233

Epoch 104/1000
Training Loss: 0.08130400, Training R2: 0.929800
Validation Loss: 0.77542716, Validation R2: 0.438227

Epoch 105/1000
Training Loss: 0.07170699, Training R2: 0.930660
Validation Loss: 0.78047901, Validation R2: 0.427733

Epoch 106/1000
Training Loss: 0.07201067, Training R2: 0.930444
Validation Loss: 0.77897543, Validation R2: 0.429408

Epoch 107/1000
Training Loss: 0.07154580, Training R2: 0.927740
Validation Loss: 0.77911592, Validation R2: 0.425892

Epoch 108/1000
Training Loss: 0.06977445, Training R2: 0.931310
Validation Loss: 0.77547008, Validation R2: 0.432492

Epoch 109/1000
Training Loss: 0.06577329, Training R2: 0.931743
Validation Loss: 0.77521420, Validation R2: 0.436079

Epoch 110/1000
Training Loss: 0.07700649, Training R2: 0.929739
Validation Loss: 0.77542967, Validation R2: 0.439040

Epoch 111/1000
Training Loss: 0.07323705, Training R2: 0.930243
Validation Loss: 0.77984399, Validation R2: 0.426910

Epoch 112/1000
Training Loss: 0.08157399, Training R2: 0.931437
Validation Loss: 0.77695096, Validation R2: 0.427200

Epoch 113/1000
Training Loss: 0.07341179, Training R2: 0.931214
Validation Loss: 0.77800405, Validation R2: 0.425428

Epoch 114/1000
Training Loss: 0.08517895, Training R2: 0.931517
Validation Loss: 0.77602690, Validation R2: 0.426269

Epoch 115/1000
Training Loss: 0.09544824, Training R2: 0.931472
Validation Loss: 0.77212560, Validation R2: 0.438792

Epoch 116/1000
Training Loss: 0.08942416, Training R2: 0.931823
Validation Loss: 0.77534759, Validation R2: 0.433267

Epoch 117/1000
Training Loss: 0.09092402, Training R2: 0.932052
Validation Loss: 0.77996367, Validation R2: 0.428344

Epoch 118/1000
Training Loss: 0.07343059, Training R2: 0.933029
Validation Loss: 0.78308213, Validation R2: 0.426999

Epoch 119/1000
Epoch 00119: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.07164321, Training R2: 0.933821
Validation Loss: 0.77681518, Validation R2: 0.433324

Epoch 120/1000
学习率已减少 3 次
Training Loss: 0.07384048, Training R2: 0.933078
Validation Loss: 0.77765644, Validation R2: 0.429199

Epoch 121/1000
Training Loss: 0.06945465, Training R2: 0.930865
Validation Loss: 0.77929550, Validation R2: 0.425601

Epoch 122/1000
Training Loss: 0.06747897, Training R2: 0.931729
Validation Loss: 0.77846432, Validation R2: 0.428405

Epoch 123/1000
Training Loss: 0.06143209, Training R2: 0.933989
Validation Loss: 0.77981412, Validation R2: 0.426334

Epoch 124/1000
Training Loss: 0.06062614, Training R2: 0.933920
Validation Loss: 0.77711803, Validation R2: 0.429695

Epoch 125/1000
Training Loss: 0.06287201, Training R2: 0.931951
Validation Loss: 0.77742177, Validation R2: 0.427086

Epoch 126/1000
Training Loss: 0.05460648, Training R2: 0.934777
Validation Loss: 0.77672386, Validation R2: 0.427494

Epoch 127/1000
Training Loss: 0.05266415, Training R2: 0.935581
Validation Loss: 0.77693599, Validation R2: 0.428169

Epoch 128/1000
Training Loss: 0.05209449, Training R2: 0.935261
Validation Loss: 0.77744454, Validation R2: 0.428058

Epoch 129/1000
Training Loss: 0.05073915, Training R2: 0.935226
Validation Loss: 0.77644515, Validation R2: 0.429230

Epoch 130/1000
Training Loss: 0.05045930, Training R2: 0.935210
Validation Loss: 0.77565473, Validation R2: 0.431560

Epoch 131/1000
Training Loss: 0.05046387, Training R2: 0.935133
Validation Loss: 0.77401131, Validation R2: 0.434166

Epoch 132/1000
Training Loss: 0.04836800, Training R2: 0.935567
Validation Loss: 0.77549607, Validation R2: 0.429992

Epoch 133/1000
Training Loss: 0.04977685, Training R2: 0.935817
Validation Loss: 0.77778715, Validation R2: 0.426195

Epoch 134/1000
Training Loss: 0.04958777, Training R2: 0.936430
Validation Loss: 0.77526271, Validation R2: 0.428893

Epoch 135/1000
Training Loss: 0.05455275, Training R2: 0.935957
Validation Loss: 0.77368981, Validation R2: 0.430498

Epoch 136/1000
Training Loss: 0.05118030, Training R2: 0.936635
Validation Loss: 0.77802700, Validation R2: 0.424772

Epoch 137/1000
Training Loss: 0.04946171, Training R2: 0.936787
Validation Loss: 0.77353698, Validation R2: 0.431834

Epoch 138/1000
Training Loss: 0.05102935, Training R2: 0.936364
Validation Loss: 0.77849531, Validation R2: 0.425002

Epoch 139/1000
Training Loss: 0.05397311, Training R2: 0.935364
Validation Loss: 0.77970874, Validation R2: 0.424119

Epoch 140/1000
Epoch 00140: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.05315365, Training R2: 0.935842
Validation Loss: 0.78162360, Validation R2: 0.422917

Epoch 141/1000
学习率已减少 4 次
Training Loss: 0.04863203, Training R2: 0.936391
Validation Loss: 0.77512193, Validation R2: 0.429825

Epoch 142/1000
Training Loss: 0.04692624, Training R2: 0.936530
Validation Loss: 0.77654648, Validation R2: 0.428077

Epoch 143/1000
Training Loss: 0.04593733, Training R2: 0.937078
Validation Loss: 0.77334845, Validation R2: 0.430125

Epoch 144/1000
Training Loss: 0.04601206, Training R2: 0.936674
Validation Loss: 0.77315646, Validation R2: 0.429802

Epoch 145/1000
Training Loss: 0.04411659, Training R2: 0.936499
Validation Loss: 0.77358627, Validation R2: 0.430475

Epoch 146/1000
Training Loss: 0.04353457, Training R2: 0.937004
Validation Loss: 0.77298015, Validation R2: 0.431660

Epoch 147/1000
Training Loss: 0.04219498, Training R2: 0.936936
Validation Loss: 0.77581143, Validation R2: 0.429966

Epoch 148/1000
Training Loss: 0.04345847, Training R2: 0.937064
Validation Loss: 0.77517456, Validation R2: 0.431951

Epoch 149/1000
Training Loss: 0.04160209, Training R2: 0.937113
Validation Loss: 0.77230465, Validation R2: 0.433595

Epoch 150/1000
Training Loss: 0.04266930, Training R2: 0.937261
Validation Loss: 0.77245069, Validation R2: 0.432852

Epoch 151/1000
Training Loss: 0.04100660, Training R2: 0.937528
Validation Loss: 0.77303356, Validation R2: 0.432935

Epoch 152/1000
Training Loss: 0.04093959, Training R2: 0.937744
Validation Loss: 0.77501982, Validation R2: 0.430466

Epoch 153/1000
Training Loss: 0.04399904, Training R2: 0.937624
Validation Loss: 0.77191854, Validation R2: 0.434574

Epoch 154/1000
Training Loss: 0.04537187, Training R2: 0.937766
Validation Loss: 0.77707028, Validation R2: 0.425720

Epoch 155/1000
Training Loss: 0.04484914, Training R2: 0.937956
Validation Loss: 0.77785343, Validation R2: 0.423786

Epoch 156/1000
Training Loss: 0.04470972, Training R2: 0.938021
Validation Loss: 0.77654570, Validation R2: 0.427836

Epoch 157/1000
Training Loss: 0.04355833, Training R2: 0.938244
Validation Loss: 0.77332973, Validation R2: 0.431690

Epoch 158/1000
Training Loss: 0.04466472, Training R2: 0.937979
Validation Loss: 0.77726018, Validation R2: 0.428650

Epoch 159/1000
Training Loss: 0.04360396, Training R2: 0.938289
Validation Loss: 0.77536309, Validation R2: 0.430453

Epoch 160/1000
Training Loss: 0.04117268, Training R2: 0.938116
Validation Loss: 0.77654082, Validation R2: 0.428513

Epoch 161/1000
Epoch 00161: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.04087440, Training R2: 0.937923
Validation Loss: 0.77781266, Validation R2: 0.426367

Epoch 162/1000
学习率已减少 5 次
Training Loss: 0.03898455, Training R2: 0.938184
Validation Loss: 0.77919036, Validation R2: 0.425093

Epoch 163/1000
Training Loss: 0.04018140, Training R2: 0.938111
Validation Loss: 0.77584928, Validation R2: 0.429389

Epoch 164/1000
Training Loss: 0.03991253, Training R2: 0.938355
Validation Loss: 0.77472854, Validation R2: 0.429607

Epoch 165/1000
Training Loss: 0.04028444, Training R2: 0.938346
Validation Loss: 0.77884734, Validation R2: 0.425053

Epoch 166/1000
Training Loss: 0.03903207, Training R2: 0.938352
Validation Loss: 0.77444130, Validation R2: 0.430727

Epoch 167/1000
Training Loss: 0.03950458, Training R2: 0.938365
Validation Loss: 0.77715546, Validation R2: 0.428261

Epoch 168/1000
Training Loss: 0.03890759, Training R2: 0.938456
Validation Loss: 0.77750385, Validation R2: 0.426392

Epoch 169/1000
Training Loss: 0.03733291, Training R2: 0.938427
Validation Loss: 0.77679551, Validation R2: 0.427254

Epoch 170/1000
Training Loss: 0.03668118, Training R2: 0.938589
Validation Loss: 0.77607697, Validation R2: 0.428959

Epoch 171/1000
Training Loss: 0.03844167, Training R2: 0.938666
Validation Loss: 0.77464646, Validation R2: 0.428659

Epoch 172/1000
Training Loss: 0.03833222, Training R2: 0.938465
Validation Loss: 0.77921093, Validation R2: 0.424733

Epoch 173/1000
Training Loss: 0.03807275, Training R2: 0.938653
Validation Loss: 0.77703285, Validation R2: 0.429012

Epoch 174/1000
Training Loss: 0.03688984, Training R2: 0.938578
Validation Loss: 0.77817631, Validation R2: 0.426984

Epoch 175/1000
Training Loss: 0.03581269, Training R2: 0.938679
Validation Loss: 0.77625751, Validation R2: 0.427808

Epoch 176/1000
Training Loss: 0.03578316, Training R2: 0.938613
Validation Loss: 0.77718139, Validation R2: 0.426679

Epoch 177/1000
Training Loss: 0.03745374, Training R2: 0.937011
Validation Loss: 0.77633834, Validation R2: 0.427461

Epoch 178/1000
Training Loss: 0.03492603, Training R2: 0.938746
Validation Loss: 0.77781415, Validation R2: 0.427635

Epoch 179/1000
Training Loss: 0.03539884, Training R2: 0.938536
Validation Loss: 0.77575451, Validation R2: 0.428488

Epoch 180/1000
Training Loss: 0.03501703, Training R2: 0.938655
Validation Loss: 0.77608258, Validation R2: 0.428026

Epoch 181/1000
Training Loss: 0.03677499, Training R2: 0.938670
Validation Loss: 0.77417618, Validation R2: 0.429083

Epoch 182/1000
Epoch 00182: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.03589403, Training R2: 0.938664
Validation Loss: 0.77661031, Validation R2: 0.426959

Epoch 183/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
