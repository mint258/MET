Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 100000, Training: 80000, Validation: 20000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3258499

Epoch 1/1000
Training Loss: 0.75840297, Training R2: 0.478057
Validation Loss: 0.52437742, Validation R2: 0.725371
Saved best model with validation R2 0.725371 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.44493999, Training R2: 0.793308
Validation Loss: 0.38350438, Validation R2: 0.835701
Saved best model with validation R2 0.835701 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.34456413, Training R2: 0.875558
Validation Loss: 0.34933282, Validation R2: 0.891467
Saved best model with validation R2 0.891467 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.28847338, Training R2: 0.914300
Validation Loss: 0.28152769, Validation R2: 0.918858
Saved best model with validation R2 0.918858 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.25126915, Training R2: 0.932534
Validation Loss: 0.26603035, Validation R2: 0.929708
Saved best model with validation R2 0.929708 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.22972583, Training R2: 0.942803
Validation Loss: 0.23860296, Validation R2: 0.940602
Saved best model with validation R2 0.940602 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.21054868, Training R2: 0.951335
Validation Loss: 0.22460083, Validation R2: 0.947162
Saved best model with validation R2 0.947162 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.19402981, Training R2: 0.957390
Validation Loss: 0.21898081, Validation R2: 0.949806
Saved best model with validation R2 0.949806 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.17959733, Training R2: 0.963142
Validation Loss: 0.20969308, Validation R2: 0.951915
Saved best model with validation R2 0.951915 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.17173576, Training R2: 0.966944
Validation Loss: 0.20999710, Validation R2: 0.951884

Epoch 11/1000
Training Loss: 0.16382527, Training R2: 0.969252
Validation Loss: 0.19938981, Validation R2: 0.957250
Saved best model with validation R2 0.957250 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.15517366, Training R2: 0.972830
Validation Loss: 0.19623703, Validation R2: 0.959278
Saved best model with validation R2 0.959278 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.14720502, Training R2: 0.975831
Validation Loss: 0.18348373, Validation R2: 0.963047
Saved best model with validation R2 0.963047 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.14206070, Training R2: 0.977694
Validation Loss: 0.17960750, Validation R2: 0.963661
Saved best model with validation R2 0.963661 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.13299559, Training R2: 0.979887
Validation Loss: 0.17651341, Validation R2: 0.964189
Saved best model with validation R2 0.964189 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.13658055, Training R2: 0.980111
Validation Loss: 0.18223383, Validation R2: 0.963473

Epoch 17/1000
Training Loss: 0.12727751, Training R2: 0.982320
Validation Loss: 0.17574994, Validation R2: 0.965713
Saved best model with validation R2 0.965713 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.11785867, Training R2: 0.984392
Validation Loss: 0.16573005, Validation R2: 0.969097
Saved best model with validation R2 0.969097 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.12062475, Training R2: 0.984240
Validation Loss: 0.17407319, Validation R2: 0.966750

Epoch 20/1000
Training Loss: 0.11722329, Training R2: 0.985203
Validation Loss: 0.17474141, Validation R2: 0.966769

Epoch 21/1000
Training Loss: 0.10739852, Training R2: 0.987233
Validation Loss: 0.16470160, Validation R2: 0.968797

Epoch 22/1000
Training Loss: 0.10409921, Training R2: 0.987812
Validation Loss: 0.16252746, Validation R2: 0.970268
Saved best model with validation R2 0.970268 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.10192181, Training R2: 0.988455
Validation Loss: 0.16037760, Validation R2: 0.970628
Saved best model with validation R2 0.970628 to best_finetuned_model.pth

Epoch 24/1000
Training Loss: 0.10155786, Training R2: 0.988714
Validation Loss: 0.16370856, Validation R2: 0.970702
Saved best model with validation R2 0.970702 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.09685506, Training R2: 0.989511
Validation Loss: 0.15800623, Validation R2: 0.971161
Saved best model with validation R2 0.971161 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.09460383, Training R2: 0.990181
Validation Loss: 0.15718885, Validation R2: 0.971843
Saved best model with validation R2 0.971843 to best_finetuned_model.pth

Epoch 27/1000
Training Loss: 0.09269082, Training R2: 0.990346
Validation Loss: 0.15384776, Validation R2: 0.972283
Saved best model with validation R2 0.972283 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.09317224, Training R2: 0.990414
Validation Loss: 0.16745331, Validation R2: 0.970173

Epoch 29/1000
Training Loss: 0.09287412, Training R2: 0.990546
Validation Loss: 0.15479197, Validation R2: 0.972569
Saved best model with validation R2 0.972569 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.09267693, Training R2: 0.990852
Validation Loss: 0.15731253, Validation R2: 0.972656
Saved best model with validation R2 0.972656 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.08252140, Training R2: 0.992180
Validation Loss: 0.16332308, Validation R2: 0.972110

Epoch 32/1000
Training Loss: 0.08738370, Training R2: 0.991663
Validation Loss: 0.17406182, Validation R2: 0.970484

Epoch 33/1000
Training Loss: 0.08680182, Training R2: 0.991696
Validation Loss: 0.16044488, Validation R2: 0.972449

Epoch 34/1000
Training Loss: 0.07892505, Training R2: 0.992956
Validation Loss: 0.16478198, Validation R2: 0.971831

Epoch 35/1000
Training Loss: 0.07854633, Training R2: 0.992918
Validation Loss: 0.14929801, Validation R2: 0.973845
Saved best model with validation R2 0.973845 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.07590323, Training R2: 0.993277
Validation Loss: 0.14615281, Validation R2: 0.975375
Saved best model with validation R2 0.975375 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.07758964, Training R2: 0.993035
Validation Loss: 0.14796362, Validation R2: 0.975400
Saved best model with validation R2 0.975400 to best_finetuned_model.pth

Epoch 38/1000
Training Loss: 0.07982394, Training R2: 0.992869
Validation Loss: 0.14768838, Validation R2: 0.975537
Saved best model with validation R2 0.975537 to best_finetuned_model.pth

Epoch 39/1000
Training Loss: 0.07581063, Training R2: 0.993387
Validation Loss: 0.15093135, Validation R2: 0.974519

Epoch 40/1000
Training Loss: 0.07548297, Training R2: 0.993591
Validation Loss: 0.14737459, Validation R2: 0.975478

Epoch 41/1000
Training Loss: 0.07583016, Training R2: 0.993515
Validation Loss: 0.16155759, Validation R2: 0.972846

Epoch 42/1000
Training Loss: 0.08129478, Training R2: 0.992949
Validation Loss: 0.14119856, Validation R2: 0.975915
Saved best model with validation R2 0.975915 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.06891309, Training R2: 0.994313
Validation Loss: 0.14279759, Validation R2: 0.975282

Epoch 44/1000
Training Loss: 0.07357933, Training R2: 0.993897
Validation Loss: 0.14017324, Validation R2: 0.976358
Saved best model with validation R2 0.976358 to best_finetuned_model.pth

Epoch 45/1000
Training Loss: 0.06962603, Training R2: 0.994321
Validation Loss: 0.14407800, Validation R2: 0.976336

Epoch 46/1000
Training Loss: 0.06650859, Training R2: 0.994380
Validation Loss: 0.13868203, Validation R2: 0.977173
Saved best model with validation R2 0.977173 to best_finetuned_model.pth

Epoch 47/1000
Training Loss: 0.06848890, Training R2: 0.994445
Validation Loss: 0.15664210, Validation R2: 0.973598

Epoch 48/1000
Training Loss: 0.06886619, Training R2: 0.994557
Validation Loss: 0.14386050, Validation R2: 0.976124

Epoch 49/1000
Training Loss: 0.06892465, Training R2: 0.994649
Validation Loss: 0.14060727, Validation R2: 0.976924

Epoch 50/1000
Training Loss: 0.06238787, Training R2: 0.995284
Validation Loss: 0.13736059, Validation R2: 0.976682

Epoch 51/1000
Training Loss: 0.06274713, Training R2: 0.995281
Validation Loss: 0.14804444, Validation R2: 0.975078

Epoch 52/1000
Training Loss: 0.06457520, Training R2: 0.995112
Validation Loss: 0.15006424, Validation R2: 0.975549

Epoch 53/1000
Training Loss: 0.06352005, Training R2: 0.995098
Validation Loss: 0.14093044, Validation R2: 0.976585

Epoch 54/1000
Training Loss: 0.06208999, Training R2: 0.995316
Validation Loss: 0.13792343, Validation R2: 0.977505
Saved best model with validation R2 0.977505 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.06568593, Training R2: 0.994977
Validation Loss: 0.14679710, Validation R2: 0.975464

Epoch 56/1000
Training Loss: 0.05991288, Training R2: 0.995551
Validation Loss: 0.13623590, Validation R2: 0.978104
Saved best model with validation R2 0.978104 to best_finetuned_model.pth

Epoch 57/1000
Training Loss: 0.06395103, Training R2: 0.995270
Validation Loss: 0.13818765, Validation R2: 0.977262

Epoch 58/1000
Training Loss: 0.06045433, Training R2: 0.995585
Validation Loss: 0.13532579, Validation R2: 0.978155
Saved best model with validation R2 0.978155 to best_finetuned_model.pth

Epoch 59/1000
Training Loss: 0.05883315, Training R2: 0.995791
Validation Loss: 0.13468268, Validation R2: 0.978148

Epoch 60/1000
Training Loss: 0.06022409, Training R2: 0.995591
Validation Loss: 0.13367671, Validation R2: 0.978277
Saved best model with validation R2 0.978277 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.05861633, Training R2: 0.995833
Validation Loss: 0.13247760, Validation R2: 0.979144
Saved best model with validation R2 0.979144 to best_finetuned_model.pth

Epoch 62/1000
Training Loss: 0.06113460, Training R2: 0.995491
Validation Loss: 0.13395025, Validation R2: 0.978093

Epoch 63/1000
Training Loss: 0.06178315, Training R2: 0.995643
Validation Loss: 0.13452297, Validation R2: 0.978757

Epoch 64/1000
Training Loss: 0.05564104, Training R2: 0.996174
Validation Loss: 0.13265896, Validation R2: 0.979025

Epoch 65/1000
Training Loss: 0.06157659, Training R2: 0.995651
Validation Loss: 0.13701403, Validation R2: 0.977799

Epoch 66/1000
Training Loss: 0.05921941, Training R2: 0.995926
Validation Loss: 0.13529494, Validation R2: 0.978358

Epoch 67/1000
Training Loss: 0.05810724, Training R2: 0.995898
Validation Loss: 0.13577819, Validation R2: 0.977224

Epoch 68/1000
Training Loss: 0.05504873, Training R2: 0.996186
Validation Loss: 0.13231781, Validation R2: 0.978766

Epoch 69/1000
Training Loss: 0.05464828, Training R2: 0.996267
Validation Loss: 0.13386862, Validation R2: 0.978602

Epoch 70/1000
Training Loss: 0.05609478, Training R2: 0.996241
Validation Loss: 0.13160320, Validation R2: 0.978768

Epoch 71/1000
Training Loss: 0.05425897, Training R2: 0.996344
Validation Loss: 0.13759583, Validation R2: 0.978224

Epoch 72/1000
Training Loss: 0.05635629, Training R2: 0.996145
Validation Loss: 0.12887937, Validation R2: 0.980134
Saved best model with validation R2 0.980134 to best_finetuned_model.pth

Epoch 73/1000
Training Loss: 0.05495644, Training R2: 0.996319
Validation Loss: 0.13191781, Validation R2: 0.978710

Epoch 74/1000
Training Loss: 0.05722161, Training R2: 0.996155
Validation Loss: 0.13842813, Validation R2: 0.977962

Epoch 75/1000
Training Loss: 0.05674103, Training R2: 0.996229
Validation Loss: 0.13838404, Validation R2: 0.977952

Epoch 76/1000
Training Loss: 0.05118830, Training R2: 0.996694
Validation Loss: 0.12957376, Validation R2: 0.979806

Epoch 77/1000
Training Loss: 0.05699137, Training R2: 0.996157
Validation Loss: 0.13017602, Validation R2: 0.979346

Epoch 78/1000
Training Loss: 0.05518864, Training R2: 0.996369
Validation Loss: 0.12994895, Validation R2: 0.979903

Epoch 79/1000
