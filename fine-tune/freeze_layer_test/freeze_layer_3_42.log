Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4564611

Epoch 1/1000
Training Loss: 1.26768356, Training R2: -0.246242
Validation Loss: 1.16045177, Validation R2: -0.076977
Saved best model with validation R2 -0.076977 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.18542667, Training R2: -0.188215
Validation Loss: 1.13375044, Validation R2: -0.003733
Saved best model with validation R2 -0.003733 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.10562537, Training R2: 0.039171
Validation Loss: 1.13062036, Validation R2: -0.028913

Epoch 4/1000
Training Loss: 1.07991661, Training R2: 0.000134
Validation Loss: 1.06572247, Validation R2: 0.138154
Saved best model with validation R2 0.138154 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.04069477, Training R2: 0.163079
Validation Loss: 1.18851888, Validation R2: -0.104369

Epoch 6/1000
Training Loss: 0.99513946, Training R2: 0.154052
Validation Loss: 0.95733976, Validation R2: 0.246295
Saved best model with validation R2 0.246295 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.87987687, Training R2: 0.332561
Validation Loss: 0.99611253, Validation R2: 0.201502

Epoch 8/1000
Training Loss: 0.83352556, Training R2: 0.381750
Validation Loss: 0.86229664, Validation R2: 0.334303
Saved best model with validation R2 0.334303 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.73409466, Training R2: 0.485761
Validation Loss: 0.82357413, Validation R2: 0.373277
Saved best model with validation R2 0.373277 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.63994475, Training R2: 0.552808
Validation Loss: 0.80616415, Validation R2: 0.369290

Epoch 11/1000
Training Loss: 0.68465990, Training R2: 0.522713
Validation Loss: 0.80305493, Validation R2: 0.372771

Epoch 12/1000
Training Loss: 0.63196342, Training R2: 0.567250
Validation Loss: 0.80126160, Validation R2: 0.348389

Epoch 13/1000
Training Loss: 0.55987825, Training R2: 0.625950
Validation Loss: 0.86297238, Validation R2: 0.325179

Epoch 14/1000
Training Loss: 0.64175782, Training R2: 0.554939
Validation Loss: 0.78308195, Validation R2: 0.438319
Saved best model with validation R2 0.438319 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.54804862, Training R2: 0.655852
Validation Loss: 0.73423880, Validation R2: 0.451346
Saved best model with validation R2 0.451346 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.53562355, Training R2: 0.686673
Validation Loss: 0.76015675, Validation R2: 0.417091

Epoch 17/1000
Training Loss: 0.49613732, Training R2: 0.696408
Validation Loss: 0.79295897, Validation R2: 0.419770

Epoch 18/1000
Training Loss: 0.48649964, Training R2: 0.717384
Validation Loss: 0.73576242, Validation R2: 0.451049

Epoch 19/1000
Training Loss: 0.45264852, Training R2: 0.741758
Validation Loss: 0.66692787, Validation R2: 0.531757
Saved best model with validation R2 0.531757 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.41007928, Training R2: 0.759723
Validation Loss: 0.68035156, Validation R2: 0.539230
Saved best model with validation R2 0.539230 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.41858593, Training R2: 0.763772
Validation Loss: 0.74804723, Validation R2: 0.475058

Epoch 22/1000
Training Loss: 0.41721644, Training R2: 0.766979
Validation Loss: 0.67735410, Validation R2: 0.505536

Epoch 23/1000
Training Loss: 0.40921319, Training R2: 0.773985
Validation Loss: 0.66468930, Validation R2: 0.504174

Epoch 24/1000
Training Loss: 0.37593086, Training R2: 0.806676
Validation Loss: 0.67757100, Validation R2: 0.537324

Epoch 25/1000
Training Loss: 0.36273560, Training R2: 0.810640
Validation Loss: 0.76802105, Validation R2: 0.471481

Epoch 26/1000
Training Loss: 0.42440766, Training R2: 0.788474
Validation Loss: 0.67941612, Validation R2: 0.476278

Epoch 27/1000
Training Loss: 0.38271848, Training R2: 0.804475
Validation Loss: 0.69641888, Validation R2: 0.436326

Epoch 28/1000
Training Loss: 0.35238686, Training R2: 0.819540
Validation Loss: 0.66284454, Validation R2: 0.503639

Epoch 29/1000
Training Loss: 0.30576111, Training R2: 0.838336
Validation Loss: 0.65890133, Validation R2: 0.553444
Saved best model with validation R2 0.553444 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.30874554, Training R2: 0.836542
Validation Loss: 0.65219253, Validation R2: 0.541479

Epoch 31/1000
Training Loss: 0.30178615, Training R2: 0.852477
Validation Loss: 0.71729696, Validation R2: 0.440899

Epoch 32/1000
Training Loss: 0.36609560, Training R2: 0.822085
Validation Loss: 0.64092433, Validation R2: 0.561735
Saved best model with validation R2 0.561735 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.36780244, Training R2: 0.824730
Validation Loss: 0.69550854, Validation R2: 0.550218

Epoch 34/1000
Training Loss: 0.35545291, Training R2: 0.831012
Validation Loss: 0.66992319, Validation R2: 0.518233

Epoch 35/1000
Training Loss: 0.33945609, Training R2: 0.836396
Validation Loss: 0.64867723, Validation R2: 0.579068
Saved best model with validation R2 0.579068 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.30888785, Training R2: 0.852048
Validation Loss: 0.70562917, Validation R2: 0.509509

Epoch 37/1000
Training Loss: 0.31043822, Training R2: 0.841854
Validation Loss: 0.63401353, Validation R2: 0.554918

Epoch 38/1000
Training Loss: 0.29278056, Training R2: 0.861813
Validation Loss: 0.62294304, Validation R2: 0.577897

Epoch 39/1000
Training Loss: 0.24662252, Training R2: 0.877438
Validation Loss: 0.65633404, Validation R2: 0.504257

Epoch 40/1000
Training Loss: 0.24951257, Training R2: 0.877110
Validation Loss: 0.64555335, Validation R2: 0.567823

Epoch 41/1000
Training Loss: 0.28029613, Training R2: 0.856297
Validation Loss: 0.63061988, Validation R2: 0.561182

Epoch 42/1000
Training Loss: 0.23295179, Training R2: 0.885300
Validation Loss: 0.64352614, Validation R2: 0.536151

Epoch 43/1000
Training Loss: 0.21484510, Training R2: 0.886328
Validation Loss: 0.61798638, Validation R2: 0.552667

Epoch 44/1000
Training Loss: 0.19168964, Training R2: 0.899407
Validation Loss: 0.65403336, Validation R2: 0.553173

Epoch 45/1000
Training Loss: 0.23113833, Training R2: 0.884490
Validation Loss: 0.64138335, Validation R2: 0.543582

Epoch 46/1000
Training Loss: 0.21744134, Training R2: 0.894000
Validation Loss: 0.63022745, Validation R2: 0.567069

Epoch 47/1000
Training Loss: 0.19444095, Training R2: 0.897512
Validation Loss: 0.64678437, Validation R2: 0.544150

Epoch 48/1000
Training Loss: 0.20305253, Training R2: 0.890313
Validation Loss: 0.64225745, Validation R2: 0.546724

Epoch 49/1000
Training Loss: 0.19409086, Training R2: 0.895237
Validation Loss: 0.64275914, Validation R2: 0.560954

Epoch 50/1000
Training Loss: 0.19753359, Training R2: 0.896209
Validation Loss: 0.63006943, Validation R2: 0.549101

Epoch 51/1000
Training Loss: 0.18565324, Training R2: 0.903357
Validation Loss: 0.61371374, Validation R2: 0.558820

Epoch 52/1000
Training Loss: 0.18899768, Training R2: 0.907221
Validation Loss: 0.63502002, Validation R2: 0.532045

Epoch 53/1000
Training Loss: 0.19751232, Training R2: 0.909278
Validation Loss: 0.63264376, Validation R2: 0.554484

Epoch 54/1000
Training Loss: 0.18340115, Training R2: 0.906681
Validation Loss: 0.65019667, Validation R2: 0.518157

Epoch 55/1000
Training Loss: 0.16680474, Training R2: 0.911073
Validation Loss: 0.65802723, Validation R2: 0.504383

Epoch 56/1000
Epoch 00056: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.19119240, Training R2: 0.909352
Validation Loss: 0.62724543, Validation R2: 0.567454

Epoch 57/1000
学习率已减少 1 次
Training Loss: 0.16967270, Training R2: 0.911427
Validation Loss: 0.64310360, Validation R2: 0.580750
Saved best model with validation R2 0.580750 to best_finetuned_model.pth

Epoch 58/1000
Training Loss: 0.18449074, Training R2: 0.914082
Validation Loss: 0.62456137, Validation R2: 0.555907

Epoch 59/1000
Training Loss: 0.16896847, Training R2: 0.914988
Validation Loss: 0.62780321, Validation R2: 0.567702

Epoch 60/1000
Training Loss: 0.14669332, Training R2: 0.917481
Validation Loss: 0.62706995, Validation R2: 0.574719

Epoch 61/1000
Training Loss: 0.13704244, Training R2: 0.920074
Validation Loss: 0.62411839, Validation R2: 0.587805
Saved best model with validation R2 0.587805 to best_finetuned_model.pth

Epoch 62/1000
Training Loss: 0.14110720, Training R2: 0.918874
Validation Loss: 0.61348093, Validation R2: 0.572219

Epoch 63/1000
Training Loss: 0.13538834, Training R2: 0.923547
Validation Loss: 0.61153698, Validation R2: 0.573801

Epoch 64/1000
Training Loss: 0.12829888, Training R2: 0.924913
Validation Loss: 0.60712087, Validation R2: 0.576428

Epoch 65/1000
Training Loss: 0.12467643, Training R2: 0.925777
Validation Loss: 0.62396002, Validation R2: 0.582224

Epoch 66/1000
Training Loss: 0.13199961, Training R2: 0.919762
Validation Loss: 0.61837959, Validation R2: 0.573922

Epoch 67/1000
Training Loss: 0.11928997, Training R2: 0.927668
Validation Loss: 0.60134780, Validation R2: 0.585466

Epoch 68/1000
Training Loss: 0.12435171, Training R2: 0.923606
Validation Loss: 0.61937332, Validation R2: 0.561306

Epoch 69/1000
Training Loss: 0.13920739, Training R2: 0.924762
Validation Loss: 0.60497880, Validation R2: 0.578503

Epoch 70/1000
Training Loss: 0.12034813, Training R2: 0.928390
Validation Loss: 0.62945622, Validation R2: 0.571426

Epoch 71/1000
Training Loss: 0.12330284, Training R2: 0.927899
Validation Loss: 0.61381680, Validation R2: 0.586412

Epoch 72/1000
Training Loss: 0.11287492, Training R2: 0.929327
Validation Loss: 0.61214632, Validation R2: 0.569130

Epoch 73/1000
Training Loss: 0.11366741, Training R2: 0.928448
Validation Loss: 0.61157346, Validation R2: 0.576758

Epoch 74/1000
Training Loss: 0.11459306, Training R2: 0.925106
Validation Loss: 0.61022335, Validation R2: 0.571400

Epoch 75/1000
Training Loss: 0.09652659, Training R2: 0.930348
Validation Loss: 0.61289352, Validation R2: 0.560966

Epoch 76/1000
Training Loss: 0.09728761, Training R2: 0.928756
Validation Loss: 0.61215347, Validation R2: 0.561443

Epoch 77/1000
Training Loss: 0.09585513, Training R2: 0.931348
Validation Loss: 0.62100983, Validation R2: 0.567692

Epoch 78/1000
Training Loss: 0.10203658, Training R2: 0.929065
Validation Loss: 0.61520600, Validation R2: 0.559412

Epoch 79/1000
Training Loss: 0.09035815, Training R2: 0.933038
Validation Loss: 0.61824441, Validation R2: 0.558256

Epoch 80/1000
Training Loss: 0.09085785, Training R2: 0.931720
Validation Loss: 0.61340505, Validation R2: 0.547683

Epoch 81/1000
Training Loss: 0.08788612, Training R2: 0.932822
Validation Loss: 0.61969852, Validation R2: 0.558608

Epoch 82/1000
Epoch 00082: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.09259892, Training R2: 0.933380
Validation Loss: 0.61899030, Validation R2: 0.545682

Epoch 83/1000
学习率已减少 2 次
Training Loss: 0.08705962, Training R2: 0.933408
Validation Loss: 0.62225610, Validation R2: 0.542093

Epoch 84/1000
Training Loss: 0.08136034, Training R2: 0.934501
Validation Loss: 0.62033898, Validation R2: 0.550681

Epoch 85/1000
Training Loss: 0.07626001, Training R2: 0.934700
Validation Loss: 0.61595243, Validation R2: 0.546614

Epoch 86/1000
Training Loss: 0.07445072, Training R2: 0.935620
Validation Loss: 0.62130606, Validation R2: 0.540257

Epoch 87/1000
Training Loss: 0.07110914, Training R2: 0.936719
Validation Loss: 0.62189627, Validation R2: 0.538532

Epoch 88/1000
Training Loss: 0.06661061, Training R2: 0.937405
Validation Loss: 0.61939049, Validation R2: 0.546877

Epoch 89/1000
Training Loss: 0.06931848, Training R2: 0.936282
Validation Loss: 0.62529290, Validation R2: 0.543429

Epoch 90/1000
Training Loss: 0.07216912, Training R2: 0.936670
Validation Loss: 0.62890929, Validation R2: 0.542072

Epoch 91/1000
Training Loss: 0.07879917, Training R2: 0.936753
Validation Loss: 0.61894697, Validation R2: 0.543690

Epoch 92/1000
Training Loss: 0.06760876, Training R2: 0.937409
Validation Loss: 0.61989892, Validation R2: 0.538237

Epoch 93/1000
Training Loss: 0.07404868, Training R2: 0.937564
Validation Loss: 0.61808634, Validation R2: 0.543677

Epoch 94/1000
Training Loss: 0.08040884, Training R2: 0.937135
Validation Loss: 0.62472218, Validation R2: 0.535621

Epoch 95/1000
Training Loss: 0.07888513, Training R2: 0.935855
Validation Loss: 0.63154536, Validation R2: 0.547808

Epoch 96/1000
Training Loss: 0.07889978, Training R2: 0.937522
Validation Loss: 0.62395591, Validation R2: 0.551404

Epoch 97/1000
Training Loss: 0.07641811, Training R2: 0.937343
Validation Loss: 0.61936134, Validation R2: 0.541615

Epoch 98/1000
Training Loss: 0.07393615, Training R2: 0.939375
Validation Loss: 0.62002742, Validation R2: 0.539455

Epoch 99/1000
Training Loss: 0.06984878, Training R2: 0.937583
Validation Loss: 0.62029618, Validation R2: 0.537032

Epoch 100/1000
Training Loss: 0.07344772, Training R2: 0.939374
Validation Loss: 0.62081075, Validation R2: 0.543156

Epoch 101/1000
Training Loss: 0.06596207, Training R2: 0.939508
Validation Loss: 0.62063360, Validation R2: 0.551682

Epoch 102/1000
Training Loss: 0.06696463, Training R2: 0.940170
Validation Loss: 0.61737502, Validation R2: 0.552989

Epoch 103/1000
Epoch 00103: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.06108224, Training R2: 0.940416
Validation Loss: 0.61537886, Validation R2: 0.548628

Epoch 104/1000
学习率已减少 3 次
Training Loss: 0.05441674, Training R2: 0.941246
Validation Loss: 0.61575842, Validation R2: 0.547348

Epoch 105/1000
Training Loss: 0.05428794, Training R2: 0.941531
Validation Loss: 0.61676621, Validation R2: 0.548209

Epoch 106/1000
Training Loss: 0.05326565, Training R2: 0.940811
Validation Loss: 0.61542898, Validation R2: 0.544819

Epoch 107/1000
Training Loss: 0.05316025, Training R2: 0.941401
Validation Loss: 0.61631680, Validation R2: 0.543487

Epoch 108/1000
Training Loss: 0.05426267, Training R2: 0.941122
Validation Loss: 0.61546493, Validation R2: 0.545548

Epoch 109/1000
Training Loss: 0.05285054, Training R2: 0.941803
Validation Loss: 0.61855084, Validation R2: 0.546070

Epoch 110/1000
Training Loss: 0.05358346, Training R2: 0.941315
Validation Loss: 0.61855102, Validation R2: 0.544728

Epoch 111/1000
Training Loss: 0.05192735, Training R2: 0.942279
Validation Loss: 0.61701459, Validation R2: 0.543539

Epoch 112/1000
Training Loss: 0.05526265, Training R2: 0.942475
Validation Loss: 0.61935711, Validation R2: 0.547719

Epoch 113/1000
Training Loss: 0.04903296, Training R2: 0.942362
Validation Loss: 0.61962545, Validation R2: 0.550527

Epoch 114/1000
Training Loss: 0.05250625, Training R2: 0.943447
Validation Loss: 0.62049919, Validation R2: 0.545610

Epoch 115/1000
Training Loss: 0.05033485, Training R2: 0.942486
Validation Loss: 0.62085384, Validation R2: 0.543762

Epoch 116/1000
Training Loss: 0.05252710, Training R2: 0.942690
Validation Loss: 0.62160492, Validation R2: 0.535771

Epoch 117/1000
Training Loss: 0.05258328, Training R2: 0.942550
Validation Loss: 0.62198031, Validation R2: 0.542599

Epoch 118/1000
Training Loss: 0.04991298, Training R2: 0.942929
Validation Loss: 0.62071151, Validation R2: 0.544745

Epoch 119/1000
Training Loss: 0.04974557, Training R2: 0.944645
Validation Loss: 0.62158060, Validation R2: 0.542005

Epoch 120/1000
Training Loss: 0.04935955, Training R2: 0.943827
Validation Loss: 0.61880100, Validation R2: 0.538790

Epoch 121/1000
Training Loss: 0.05272870, Training R2: 0.944382
Validation Loss: 0.61973315, Validation R2: 0.535210

Epoch 122/1000
Training Loss: 0.04772235, Training R2: 0.944123
Validation Loss: 0.62372237, Validation R2: 0.533039

Epoch 123/1000
Training Loss: 0.04477748, Training R2: 0.944769
Validation Loss: 0.62157989, Validation R2: 0.536222

Epoch 124/1000
Epoch 00124: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.04510389, Training R2: 0.945417
Validation Loss: 0.62144142, Validation R2: 0.538090

Epoch 125/1000
学习率已减少 4 次
Training Loss: 0.04119279, Training R2: 0.945140
Validation Loss: 0.62117058, Validation R2: 0.535447

Epoch 126/1000
Training Loss: 0.04133423, Training R2: 0.945566
Validation Loss: 0.62070775, Validation R2: 0.537232

Epoch 127/1000
Training Loss: 0.03949598, Training R2: 0.945226
Validation Loss: 0.62207586, Validation R2: 0.537260

Epoch 128/1000
Training Loss: 0.03809045, Training R2: 0.945580
Validation Loss: 0.62088984, Validation R2: 0.535598

Epoch 129/1000
Training Loss: 0.03717674, Training R2: 0.945832
Validation Loss: 0.62194067, Validation R2: 0.534155

Epoch 130/1000
Training Loss: 0.03674486, Training R2: 0.945685
Validation Loss: 0.62059850, Validation R2: 0.535387

Epoch 131/1000
Training Loss: 0.03614663, Training R2: 0.945828
Validation Loss: 0.62059224, Validation R2: 0.538796

Epoch 132/1000
Training Loss: 0.03531506, Training R2: 0.945642
Validation Loss: 0.62142545, Validation R2: 0.537354

Epoch 133/1000
Training Loss: 0.03520332, Training R2: 0.946087
Validation Loss: 0.62191468, Validation R2: 0.538273

Epoch 134/1000
Training Loss: 0.03460831, Training R2: 0.945998
Validation Loss: 0.62080544, Validation R2: 0.539250

Epoch 135/1000
Training Loss: 0.03386166, Training R2: 0.945963
Validation Loss: 0.61971754, Validation R2: 0.539712

Epoch 136/1000
Training Loss: 0.03360197, Training R2: 0.946197
Validation Loss: 0.61792958, Validation R2: 0.543374

Epoch 137/1000
Training Loss: 0.03352037, Training R2: 0.946342
Validation Loss: 0.61819339, Validation R2: 0.543805

Epoch 138/1000
Training Loss: 0.03299228, Training R2: 0.946122
Validation Loss: 0.61958963, Validation R2: 0.539805

Epoch 139/1000
Training Loss: 0.03322269, Training R2: 0.946128
Validation Loss: 0.61974108, Validation R2: 0.539681

Epoch 140/1000
Training Loss: 0.03365971, Training R2: 0.946319
Validation Loss: 0.62058282, Validation R2: 0.540353

Epoch 141/1000
Training Loss: 0.03223708, Training R2: 0.946413
Validation Loss: 0.62018257, Validation R2: 0.540698

Epoch 142/1000
Training Loss: 0.03230175, Training R2: 0.946410
Validation Loss: 0.61963898, Validation R2: 0.539685

Epoch 143/1000
Training Loss: 0.03176027, Training R2: 0.946742
Validation Loss: 0.61915511, Validation R2: 0.540341

Epoch 144/1000
Training Loss: 0.03247131, Training R2: 0.946720
Validation Loss: 0.61896992, Validation R2: 0.541040

Epoch 145/1000
Epoch 00145: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.03315673, Training R2: 0.946718
Validation Loss: 0.61995995, Validation R2: 0.540510

Epoch 146/1000
学习率已减少 5 次
Training Loss: 0.03246127, Training R2: 0.946919
Validation Loss: 0.62038773, Validation R2: 0.537703

Epoch 147/1000
Training Loss: 0.03145228, Training R2: 0.947015
Validation Loss: 0.61970371, Validation R2: 0.540959

Epoch 148/1000
Training Loss: 0.03204139, Training R2: 0.946994
Validation Loss: 0.61958259, Validation R2: 0.539481

Epoch 149/1000
Training Loss: 0.03148014, Training R2: 0.947187
Validation Loss: 0.62099814, Validation R2: 0.536764

Epoch 150/1000
Training Loss: 0.03115931, Training R2: 0.947097
Validation Loss: 0.61973035, Validation R2: 0.539554

Epoch 151/1000
Training Loss: 0.03074703, Training R2: 0.947225
Validation Loss: 0.62062585, Validation R2: 0.538419

Epoch 152/1000
Training Loss: 0.03054705, Training R2: 0.947210
Validation Loss: 0.61999702, Validation R2: 0.539914

Epoch 153/1000
Training Loss: 0.02991519, Training R2: 0.947181
Validation Loss: 0.62022573, Validation R2: 0.540512

Epoch 154/1000
Training Loss: 0.02985178, Training R2: 0.947131
Validation Loss: 0.61919701, Validation R2: 0.541042

Epoch 155/1000
Training Loss: 0.02964256, Training R2: 0.947328
Validation Loss: 0.62052983, Validation R2: 0.538741

Epoch 156/1000
Training Loss: 0.02917093, Training R2: 0.947348
Validation Loss: 0.61960828, Validation R2: 0.539395

Epoch 157/1000
Training Loss: 0.02878724, Training R2: 0.947413
Validation Loss: 0.61996299, Validation R2: 0.540047

Epoch 158/1000
Training Loss: 0.02830056, Training R2: 0.947336
Validation Loss: 0.62013566, Validation R2: 0.538815

Epoch 159/1000
Training Loss: 0.02892918, Training R2: 0.947408
Validation Loss: 0.62057394, Validation R2: 0.537763

Epoch 160/1000
Training Loss: 0.02995412, Training R2: 0.947389
Validation Loss: 0.61994535, Validation R2: 0.539264

Epoch 161/1000
Training Loss: 0.02840889, Training R2: 0.947602
Validation Loss: 0.62095803, Validation R2: 0.537410

Epoch 162/1000
Training Loss: 0.02837630, Training R2: 0.947511
Validation Loss: 0.61997926, Validation R2: 0.538598

Epoch 163/1000
Training Loss: 0.02925034, Training R2: 0.947565
Validation Loss: 0.62028402, Validation R2: 0.538434

Epoch 164/1000
Training Loss: 0.02866911, Training R2: 0.947732
Validation Loss: 0.62131041, Validation R2: 0.537536

Epoch 165/1000
Training Loss: 0.02907873, Training R2: 0.947673
Validation Loss: 0.62043655, Validation R2: 0.539806

Epoch 166/1000
Epoch 00166: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.03029871, Training R2: 0.947747
Validation Loss: 0.62059665, Validation R2: 0.539599

Epoch 167/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_dipole.png
