Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3451011

Epoch 1/1000
Training Loss: 2.23718632, Training R2: -3.007801
Validation Loss: 1.53024042, Validation R2: -0.271266
Saved best model with validation R2 -0.271266 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.30156977, Training R2: -0.248758
Validation Loss: 1.20792472, Validation R2: -0.024622
Saved best model with validation R2 -0.024622 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.12459819, Training R2: -0.119808
Validation Loss: 1.26776457, Validation R2: -0.173924

Epoch 4/1000
Training Loss: 1.11300944, Training R2: -0.094964
Validation Loss: 1.21836782, Validation R2: 0.036256
Saved best model with validation R2 0.036256 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.08545097, Training R2: 0.086430
Validation Loss: 1.16186869, Validation R2: 0.100845
Saved best model with validation R2 0.100845 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 1.01103114, Training R2: 0.123402
Validation Loss: 1.13629568, Validation R2: 0.066130

Epoch 7/1000
Training Loss: 0.98841870, Training R2: 0.120487
Validation Loss: 1.10812104, Validation R2: 0.150365
Saved best model with validation R2 0.150365 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.94008334, Training R2: 0.242051
Validation Loss: 1.08411431, Validation R2: 0.168270
Saved best model with validation R2 0.168270 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.87355950, Training R2: 0.316726
Validation Loss: 1.08184969, Validation R2: 0.166845

Epoch 10/1000
Training Loss: 0.86218534, Training R2: 0.339210
Validation Loss: 1.06667590, Validation R2: 0.175706
Saved best model with validation R2 0.175706 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.82231374, Training R2: 0.374997
Validation Loss: 1.05155075, Validation R2: 0.184349
Saved best model with validation R2 0.184349 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.80211021, Training R2: 0.405086
Validation Loss: 1.01258039, Validation R2: 0.218964
Saved best model with validation R2 0.218964 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.75878219, Training R2: 0.446357
Validation Loss: 0.98446536, Validation R2: 0.241999
Saved best model with validation R2 0.241999 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.72087241, Training R2: 0.486221
Validation Loss: 0.97040731, Validation R2: 0.259521
Saved best model with validation R2 0.259521 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.71542648, Training R2: 0.492567
Validation Loss: 0.99650466, Validation R2: 0.226508

Epoch 16/1000
Training Loss: 0.69519911, Training R2: 0.507168
Validation Loss: 0.96989101, Validation R2: 0.236567

Epoch 17/1000
Training Loss: 0.66638946, Training R2: 0.537201
Validation Loss: 0.95147091, Validation R2: 0.270134
Saved best model with validation R2 0.270134 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.63151432, Training R2: 0.561602
Validation Loss: 0.93666381, Validation R2: 0.280506
Saved best model with validation R2 0.280506 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.61077406, Training R2: 0.590931
Validation Loss: 0.92445171, Validation R2: 0.292614
Saved best model with validation R2 0.292614 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.57910566, Training R2: 0.613699
Validation Loss: 0.90916502, Validation R2: 0.309761
Saved best model with validation R2 0.309761 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.57230788, Training R2: 0.618738
Validation Loss: 0.96251738, Validation R2: 0.260545

Epoch 22/1000
Training Loss: 0.59496519, Training R2: 0.630989
Validation Loss: 0.90693158, Validation R2: 0.280004

Epoch 23/1000
Training Loss: 0.56329540, Training R2: 0.627772
Validation Loss: 0.97366697, Validation R2: 0.288488

Epoch 24/1000
Training Loss: 0.56048098, Training R2: 0.676363
Validation Loss: 0.89676738, Validation R2: 0.327058
Saved best model with validation R2 0.327058 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.53171645, Training R2: 0.699595
Validation Loss: 0.89056104, Validation R2: 0.309332

Epoch 26/1000
Training Loss: 0.50453055, Training R2: 0.705378
Validation Loss: 0.86591953, Validation R2: 0.362385
Saved best model with validation R2 0.362385 to best_finetuned_model.pth

Epoch 27/1000
Training Loss: 0.46332334, Training R2: 0.748207
Validation Loss: 0.88690031, Validation R2: 0.338790

Epoch 28/1000
Training Loss: 0.45012947, Training R2: 0.758647
Validation Loss: 0.92958152, Validation R2: 0.268530

Epoch 29/1000
Training Loss: 0.47115438, Training R2: 0.743905
Validation Loss: 0.91285664, Validation R2: 0.305776

Epoch 30/1000
Training Loss: 0.45768794, Training R2: 0.758039
Validation Loss: 0.90886426, Validation R2: 0.320233

Epoch 31/1000
Training Loss: 0.41016644, Training R2: 0.789838
Validation Loss: 0.85751867, Validation R2: 0.355669

Epoch 32/1000
Training Loss: 0.38822300, Training R2: 0.812394
Validation Loss: 0.86724091, Validation R2: 0.333314

Epoch 33/1000
Training Loss: 0.39888182, Training R2: 0.798540
Validation Loss: 0.81843436, Validation R2: 0.364798
Saved best model with validation R2 0.364798 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.38818286, Training R2: 0.806421
Validation Loss: 0.85728770, Validation R2: 0.347529

Epoch 35/1000
Training Loss: 0.42664050, Training R2: 0.809355
Validation Loss: 0.85316616, Validation R2: 0.340876

Epoch 36/1000
Training Loss: 0.40066950, Training R2: 0.825130
Validation Loss: 0.85232204, Validation R2: 0.330391

Epoch 37/1000
Training Loss: 0.33832721, Training R2: 0.854514
Validation Loss: 0.85042596, Validation R2: 0.340081

Epoch 38/1000
Training Loss: 0.32558118, Training R2: 0.853438
Validation Loss: 0.85865116, Validation R2: 0.353802

Epoch 39/1000
Training Loss: 0.35825221, Training R2: 0.846404
Validation Loss: 0.83972698, Validation R2: 0.359652

Epoch 40/1000
Training Loss: 0.36144591, Training R2: 0.842527
Validation Loss: 0.83816338, Validation R2: 0.342421

Epoch 41/1000
Training Loss: 0.33653436, Training R2: 0.858857
Validation Loss: 0.81696033, Validation R2: 0.348707

Epoch 42/1000
Training Loss: 0.30174284, Training R2: 0.873025
Validation Loss: 0.82878554, Validation R2: 0.359276

Epoch 43/1000
Training Loss: 0.30191626, Training R2: 0.875817
Validation Loss: 0.79804927, Validation R2: 0.395679
Saved best model with validation R2 0.395679 to best_finetuned_model.pth

Epoch 44/1000
Training Loss: 0.27838535, Training R2: 0.885314
Validation Loss: 0.80820042, Validation R2: 0.365128

Epoch 45/1000
Training Loss: 0.27695478, Training R2: 0.890745
Validation Loss: 0.80422252, Validation R2: 0.387090

Epoch 46/1000
Training Loss: 0.26232304, Training R2: 0.899665
Validation Loss: 0.79562867, Validation R2: 0.370436

Epoch 47/1000
Training Loss: 0.26700235, Training R2: 0.903857
Validation Loss: 0.79466826, Validation R2: 0.369021

Epoch 48/1000
Training Loss: 0.23694145, Training R2: 0.915812
Validation Loss: 0.78502768, Validation R2: 0.387147

Epoch 49/1000
Training Loss: 0.22391487, Training R2: 0.919799
Validation Loss: 0.79531109, Validation R2: 0.388793

Epoch 50/1000
Training Loss: 0.22096013, Training R2: 0.924520
Validation Loss: 0.78730541, Validation R2: 0.388106

Epoch 51/1000
Training Loss: 0.21789343, Training R2: 0.926561
Validation Loss: 0.76834387, Validation R2: 0.394348

Epoch 52/1000
Training Loss: 0.19335148, Training R2: 0.933281
Validation Loss: 0.77697539, Validation R2: 0.395557

Epoch 53/1000
Training Loss: 0.23001804, Training R2: 0.924404
Validation Loss: 0.76932800, Validation R2: 0.397592
Saved best model with validation R2 0.397592 to best_finetuned_model.pth

Epoch 54/1000
Training Loss: 0.20673411, Training R2: 0.932217
Validation Loss: 0.79077703, Validation R2: 0.365430

Epoch 55/1000
Training Loss: 0.19122460, Training R2: 0.936767
Validation Loss: 0.81560302, Validation R2: 0.339562

Epoch 56/1000
Training Loss: 0.20933927, Training R2: 0.932608
Validation Loss: 0.81911606, Validation R2: 0.342607

Epoch 57/1000
Training Loss: 0.25452844, Training R2: 0.921590
Validation Loss: 0.80146468, Validation R2: 0.362076

Epoch 58/1000
Training Loss: 0.26083810, Training R2: 0.918108
Validation Loss: 0.78062916, Validation R2: 0.390821

Epoch 59/1000
Training Loss: 0.20995986, Training R2: 0.936065
Validation Loss: 0.77959442, Validation R2: 0.400791
Saved best model with validation R2 0.400791 to best_finetuned_model.pth

Epoch 60/1000
Training Loss: 0.19887770, Training R2: 0.937684
Validation Loss: 0.78805381, Validation R2: 0.401951
Saved best model with validation R2 0.401951 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.20895912, Training R2: 0.934641
Validation Loss: 0.77877319, Validation R2: 0.402699
Saved best model with validation R2 0.402699 to best_finetuned_model.pth

Epoch 62/1000
Training Loss: 0.17606581, Training R2: 0.940988
Validation Loss: 0.77464569, Validation R2: 0.404007
Saved best model with validation R2 0.404007 to best_finetuned_model.pth

Epoch 63/1000
Training Loss: 0.18869456, Training R2: 0.938316
Validation Loss: 0.77560711, Validation R2: 0.389580

Epoch 64/1000
Training Loss: 0.17381252, Training R2: 0.942496
Validation Loss: 0.78268677, Validation R2: 0.377990

Epoch 65/1000
Training Loss: 0.18631422, Training R2: 0.942195
Validation Loss: 0.78431493, Validation R2: 0.375658

Epoch 66/1000
Training Loss: 0.19738692, Training R2: 0.938028
Validation Loss: 0.76827353, Validation R2: 0.406462
Saved best model with validation R2 0.406462 to best_finetuned_model.pth

Epoch 67/1000
Training Loss: 0.17085375, Training R2: 0.945112
Validation Loss: 0.76189464, Validation R2: 0.408812
Saved best model with validation R2 0.408812 to best_finetuned_model.pth

Epoch 68/1000
Training Loss: 0.16049646, Training R2: 0.950359
Validation Loss: 0.77678651, Validation R2: 0.405261

Epoch 69/1000
Training Loss: 0.15753271, Training R2: 0.950339
Validation Loss: 0.79345810, Validation R2: 0.374466

Epoch 70/1000
Training Loss: 0.17682445, Training R2: 0.948316
Validation Loss: 0.79420060, Validation R2: 0.379594

Epoch 71/1000
Training Loss: 0.18753423, Training R2: 0.945836
Validation Loss: 0.76652706, Validation R2: 0.391396

Epoch 72/1000
Training Loss: 0.18031777, Training R2: 0.950420
Validation Loss: 0.80814010, Validation R2: 0.358652

Epoch 73/1000
Training Loss: 0.22088159, Training R2: 0.940087
Validation Loss: 0.76503980, Validation R2: 0.394675

Epoch 74/1000
Training Loss: 0.17525032, Training R2: 0.949907
Validation Loss: 0.78291935, Validation R2: 0.382539

Epoch 75/1000
Training Loss: 0.16534150, Training R2: 0.954564
Validation Loss: 0.78911668, Validation R2: 0.391081

Epoch 76/1000
Training Loss: 0.16067008, Training R2: 0.955125
Validation Loss: 0.78160751, Validation R2: 0.394260

Epoch 77/1000
Training Loss: 0.15493672, Training R2: 0.958921
Validation Loss: 0.77936071, Validation R2: 0.395729

Epoch 78/1000
Training Loss: 0.14582887, Training R2: 0.961477
Validation Loss: 0.77744019, Validation R2: 0.385158

Epoch 79/1000
Training Loss: 0.17145728, Training R2: 0.955767
Validation Loss: 0.76650733, Validation R2: 0.394129

Epoch 80/1000
Training Loss: 0.17993424, Training R2: 0.955908
Validation Loss: 0.78032070, Validation R2: 0.398058

Epoch 81/1000
Training Loss: 0.15783961, Training R2: 0.957941
Validation Loss: 0.79451108, Validation R2: 0.390810

Epoch 82/1000
Training Loss: 0.15392750, Training R2: 0.962305
Validation Loss: 0.77672970, Validation R2: 0.427610
Saved best model with validation R2 0.427610 to best_finetuned_model.pth

Epoch 83/1000
Training Loss: 0.18822144, Training R2: 0.953179
Validation Loss: 0.76951778, Validation R2: 0.432847
Saved best model with validation R2 0.432847 to best_finetuned_model.pth

Epoch 84/1000
Training Loss: 0.19298508, Training R2: 0.954674
Validation Loss: 0.76952440, Validation R2: 0.432187

Epoch 85/1000
Training Loss: 0.21814281, Training R2: 0.941712
Validation Loss: 0.74518478, Validation R2: 0.420823

Epoch 86/1000
Training Loss: 0.19480065, Training R2: 0.953651
Validation Loss: 0.76504958, Validation R2: 0.395418

Epoch 87/1000
Training Loss: 0.17129201, Training R2: 0.957184
Validation Loss: 0.79252869, Validation R2: 0.390281

Epoch 88/1000
Training Loss: 0.18694058, Training R2: 0.955078
Validation Loss: 0.76868629, Validation R2: 0.402348

Epoch 89/1000
Training Loss: 0.13630570, Training R2: 0.966880
Validation Loss: 0.79236007, Validation R2: 0.371753

Epoch 90/1000
Training Loss: 0.16234928, Training R2: 0.962472
Validation Loss: 0.78781676, Validation R2: 0.363804

Epoch 91/1000
Training Loss: 0.17290930, Training R2: 0.959209
Validation Loss: 0.77538800, Validation R2: 0.378545

Epoch 92/1000
Training Loss: 0.14932769, Training R2: 0.966311
Validation Loss: 0.78425461, Validation R2: 0.374271

Epoch 93/1000
Training Loss: 0.15461989, Training R2: 0.963638
Validation Loss: 0.77814949, Validation R2: 0.393295

Epoch 94/1000
Training Loss: 0.13186249, Training R2: 0.966149
Validation Loss: 0.75887203, Validation R2: 0.412331

Epoch 95/1000
Training Loss: 0.12368744, Training R2: 0.969030
Validation Loss: 0.76726806, Validation R2: 0.406697

Epoch 96/1000
Training Loss: 0.12506597, Training R2: 0.967615
Validation Loss: 0.75506061, Validation R2: 0.410272

Epoch 97/1000
Training Loss: 0.13323114, Training R2: 0.965781
Validation Loss: 0.75045776, Validation R2: 0.413714

Epoch 98/1000
Training Loss: 0.12025514, Training R2: 0.968945
Validation Loss: 0.75407499, Validation R2: 0.415034

Epoch 99/1000
Training Loss: 0.12023536, Training R2: 0.971108
Validation Loss: 0.77660394, Validation R2: 0.400474

Epoch 100/1000
Training Loss: 0.12844351, Training R2: 0.970168
Validation Loss: 0.78730160, Validation R2: 0.397593

Epoch 101/1000
Training Loss: 0.12537689, Training R2: 0.971346
Validation Loss: 0.77681959, Validation R2: 0.381938

Epoch 102/1000
Training Loss: 0.12841316, Training R2: 0.973344
Validation Loss: 0.76763594, Validation R2: 0.394127

Epoch 103/1000
Training Loss: 0.12865961, Training R2: 0.973510
Validation Loss: 0.77033138, Validation R2: 0.383411

Epoch 104/1000
Epoch 00104: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.14346185, Training R2: 0.971089
Validation Loss: 0.76968199, Validation R2: 0.404847

Epoch 105/1000
学习率已减少 1 次
Training Loss: 0.13581437, Training R2: 0.971821
Validation Loss: 0.76772916, Validation R2: 0.402345

Epoch 106/1000
Training Loss: 0.10617222, Training R2: 0.977230
Validation Loss: 0.77222425, Validation R2: 0.404904

Epoch 107/1000
Training Loss: 0.10954401, Training R2: 0.976337
Validation Loss: 0.76110035, Validation R2: 0.406641

Epoch 108/1000
Training Loss: 0.09633127, Training R2: 0.979461
Validation Loss: 0.76369435, Validation R2: 0.406798

Epoch 109/1000
Training Loss: 0.08881251, Training R2: 0.979749
Validation Loss: 0.76227432, Validation R2: 0.408965

Epoch 110/1000
Training Loss: 0.08230575, Training R2: 0.981356
Validation Loss: 0.75943452, Validation R2: 0.415907

Epoch 111/1000
Training Loss: 0.08512857, Training R2: 0.980278
Validation Loss: 0.75736767, Validation R2: 0.411972

Epoch 112/1000
Training Loss: 0.08093375, Training R2: 0.981600
Validation Loss: 0.76168311, Validation R2: 0.415918

Epoch 113/1000
Training Loss: 0.09761659, Training R2: 0.978580
Validation Loss: 0.75373703, Validation R2: 0.425690

Epoch 114/1000
Training Loss: 0.08672608, Training R2: 0.981083
Validation Loss: 0.75865227, Validation R2: 0.428474

Epoch 115/1000
Training Loss: 0.11077657, Training R2: 0.978082
Validation Loss: 0.76557523, Validation R2: 0.425366

Epoch 116/1000
Training Loss: 0.11535985, Training R2: 0.977471
Validation Loss: 0.75667858, Validation R2: 0.419729

Epoch 117/1000
Training Loss: 0.10851429, Training R2: 0.978545
Validation Loss: 0.74767137, Validation R2: 0.421363

Epoch 118/1000
Training Loss: 0.09788142, Training R2: 0.979840
Validation Loss: 0.74275768, Validation R2: 0.423539

Epoch 119/1000
Training Loss: 0.07862686, Training R2: 0.982579
Validation Loss: 0.74976957, Validation R2: 0.418837

Epoch 120/1000
Training Loss: 0.07025303, Training R2: 0.983103
Validation Loss: 0.75055188, Validation R2: 0.423332

Epoch 121/1000
Training Loss: 0.06817653, Training R2: 0.983857
Validation Loss: 0.75853562, Validation R2: 0.420559

Epoch 122/1000
Training Loss: 0.06634138, Training R2: 0.984250
Validation Loss: 0.76225060, Validation R2: 0.417265

Epoch 123/1000
Training Loss: 0.06352524, Training R2: 0.984168
Validation Loss: 0.74949455, Validation R2: 0.416863

Epoch 124/1000
Training Loss: 0.06151997, Training R2: 0.984825
Validation Loss: 0.74538928, Validation R2: 0.426975

Epoch 125/1000
Epoch 00125: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.05991465, Training R2: 0.984786
Validation Loss: 0.75209123, Validation R2: 0.425797

Epoch 126/1000
学习率已减少 2 次
Training Loss: 0.05712878, Training R2: 0.985260
Validation Loss: 0.75359493, Validation R2: 0.427253

Epoch 127/1000
Training Loss: 0.05335463, Training R2: 0.985879
Validation Loss: 0.75106138, Validation R2: 0.429628

Epoch 128/1000
Training Loss: 0.05349074, Training R2: 0.985894
Validation Loss: 0.75447434, Validation R2: 0.426956

Epoch 129/1000
Training Loss: 0.04893893, Training R2: 0.986357
Validation Loss: 0.75544643, Validation R2: 0.424007

Epoch 130/1000
Training Loss: 0.04574584, Training R2: 0.986781
Validation Loss: 0.75269055, Validation R2: 0.429731

Epoch 131/1000
Training Loss: 0.04294631, Training R2: 0.987005
Validation Loss: 0.75134397, Validation R2: 0.427526

Epoch 132/1000
Training Loss: 0.04163211, Training R2: 0.987196
Validation Loss: 0.75001460, Validation R2: 0.426165

Epoch 133/1000
Training Loss: 0.04324267, Training R2: 0.987381
Validation Loss: 0.74986446, Validation R2: 0.426916

Epoch 134/1000
Training Loss: 0.04255908, Training R2: 0.987377
Validation Loss: 0.75275028, Validation R2: 0.421408

Epoch 135/1000
Training Loss: 0.04490012, Training R2: 0.987164
Validation Loss: 0.75557739, Validation R2: 0.425616

Epoch 136/1000
Training Loss: 0.04433922, Training R2: 0.987629
Validation Loss: 0.75513488, Validation R2: 0.424845

Epoch 137/1000
Training Loss: 0.04549709, Training R2: 0.987645
Validation Loss: 0.75795156, Validation R2: 0.422642

Epoch 138/1000
Training Loss: 0.05378397, Training R2: 0.987309
Validation Loss: 0.75588745, Validation R2: 0.421674

Epoch 139/1000
Training Loss: 0.06236889, Training R2: 0.987038
Validation Loss: 0.75535017, Validation R2: 0.422579

Epoch 140/1000
Training Loss: 0.05076385, Training R2: 0.987589
Validation Loss: 0.75499624, Validation R2: 0.420547

Epoch 141/1000
Training Loss: 0.04520181, Training R2: 0.987888
Validation Loss: 0.75346082, Validation R2: 0.419633

Epoch 142/1000
Training Loss: 0.04758059, Training R2: 0.987948
Validation Loss: 0.75160515, Validation R2: 0.423415

Epoch 143/1000
Training Loss: 0.04258151, Training R2: 0.988470
Validation Loss: 0.74825364, Validation R2: 0.427396

Epoch 144/1000
Training Loss: 0.04054702, Training R2: 0.988644
Validation Loss: 0.74561477, Validation R2: 0.430993

Epoch 145/1000
Training Loss: 0.04349178, Training R2: 0.988671
Validation Loss: 0.74583602, Validation R2: 0.430051

Epoch 146/1000
Epoch 00146: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.04251385, Training R2: 0.989036
Validation Loss: 0.75016648, Validation R2: 0.425696

Epoch 147/1000
学习率已减少 3 次
Training Loss: 0.03862181, Training R2: 0.989234
Validation Loss: 0.74934047, Validation R2: 0.426360

Epoch 148/1000
Training Loss: 0.03696984, Training R2: 0.989172
Validation Loss: 0.74656296, Validation R2: 0.429053

Epoch 149/1000
Training Loss: 0.03535232, Training R2: 0.989275
Validation Loss: 0.74873912, Validation R2: 0.429030

Epoch 150/1000
Training Loss: 0.03339233, Training R2: 0.989302
Validation Loss: 0.74925911, Validation R2: 0.429083

Epoch 151/1000
Training Loss: 0.03367763, Training R2: 0.989572
Validation Loss: 0.74867010, Validation R2: 0.429970

Epoch 152/1000
Training Loss: 0.03503937, Training R2: 0.989566
Validation Loss: 0.74947768, Validation R2: 0.428269

Epoch 153/1000
Training Loss: 0.03277609, Training R2: 0.989541
Validation Loss: 0.74959725, Validation R2: 0.426462

Epoch 154/1000
Training Loss: 0.03406260, Training R2: 0.989719
Validation Loss: 0.75198835, Validation R2: 0.424685

Epoch 155/1000
Training Loss: 0.03988290, Training R2: 0.989203
Validation Loss: 0.75093490, Validation R2: 0.428067

Epoch 156/1000
Training Loss: 0.03396532, Training R2: 0.989697
Validation Loss: 0.75064808, Validation R2: 0.428824

Epoch 157/1000
Training Loss: 0.03179151, Training R2: 0.989664
Validation Loss: 0.74960738, Validation R2: 0.427835

Epoch 158/1000
Training Loss: 0.02923616, Training R2: 0.989964
Validation Loss: 0.74755806, Validation R2: 0.430643

Epoch 159/1000
Training Loss: 0.03049370, Training R2: 0.989774
Validation Loss: 0.74713987, Validation R2: 0.429401

Epoch 160/1000
Training Loss: 0.02891677, Training R2: 0.990005
Validation Loss: 0.74950802, Validation R2: 0.427234

Epoch 161/1000
Training Loss: 0.02775790, Training R2: 0.989898
Validation Loss: 0.74831188, Validation R2: 0.428227

Epoch 162/1000
Training Loss: 0.02712164, Training R2: 0.990075
Validation Loss: 0.75152075, Validation R2: 0.426570

Epoch 163/1000
Training Loss: 0.02622300, Training R2: 0.990052
Validation Loss: 0.75066972, Validation R2: 0.426517

Epoch 164/1000
Training Loss: 0.03121277, Training R2: 0.990203
Validation Loss: 0.75231522, Validation R2: 0.427330

Epoch 165/1000
Training Loss: 0.03249670, Training R2: 0.989790
Validation Loss: 0.75026578, Validation R2: 0.428070

Epoch 166/1000
Training Loss: 0.03169745, Training R2: 0.990085
Validation Loss: 0.74835038, Validation R2: 0.431715

Epoch 167/1000
Epoch 00167: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.03090952, Training R2: 0.990023
Validation Loss: 0.74878162, Validation R2: 0.428427

Epoch 168/1000
学习率已减少 4 次
Training Loss: 0.02658867, Training R2: 0.990285
Validation Loss: 0.74963415, Validation R2: 0.427949

Epoch 169/1000
Training Loss: 0.02450209, Training R2: 0.990343
Validation Loss: 0.75074393, Validation R2: 0.427879

Epoch 170/1000
Training Loss: 0.02365890, Training R2: 0.990337
Validation Loss: 0.75104535, Validation R2: 0.426437

Epoch 171/1000
Training Loss: 0.02399172, Training R2: 0.990405
Validation Loss: 0.75152785, Validation R2: 0.426777

Epoch 172/1000
Training Loss: 0.02299862, Training R2: 0.990364
Validation Loss: 0.75006443, Validation R2: 0.429150

Epoch 173/1000
Training Loss: 0.02345228, Training R2: 0.990288
Validation Loss: 0.74830884, Validation R2: 0.429595

Epoch 174/1000
Training Loss: 0.02294548, Training R2: 0.990353
Validation Loss: 0.74875242, Validation R2: 0.428042

Epoch 175/1000
Training Loss: 0.02207318, Training R2: 0.990356
Validation Loss: 0.74967194, Validation R2: 0.427390

Epoch 176/1000
Training Loss: 0.02061942, Training R2: 0.990404
Validation Loss: 0.74908888, Validation R2: 0.428663

Epoch 177/1000
Training Loss: 0.02038574, Training R2: 0.990422
Validation Loss: 0.74907482, Validation R2: 0.428928

Epoch 178/1000
Training Loss: 0.01988295, Training R2: 0.990475
Validation Loss: 0.74946028, Validation R2: 0.428321

Epoch 179/1000
Training Loss: 0.01997446, Training R2: 0.990502
Validation Loss: 0.74903989, Validation R2: 0.427995

Epoch 180/1000
Training Loss: 0.02166742, Training R2: 0.990511
Validation Loss: 0.74946773, Validation R2: 0.426826

Epoch 181/1000
Training Loss: 0.02253449, Training R2: 0.990538
Validation Loss: 0.74859315, Validation R2: 0.428120

Epoch 182/1000
Training Loss: 0.02334066, Training R2: 0.990495
Validation Loss: 0.74891555, Validation R2: 0.428889

Epoch 183/1000
Training Loss: 0.02267820, Training R2: 0.990584
Validation Loss: 0.74940914, Validation R2: 0.428864

Epoch 184/1000
Training Loss: 0.02130815, Training R2: 0.990663
Validation Loss: 0.74985337, Validation R2: 0.428298

Epoch 185/1000
Training Loss: 0.01950926, Training R2: 0.990740
Validation Loss: 0.74958640, Validation R2: 0.427805

Epoch 186/1000
Training Loss: 0.01873140, Training R2: 0.990792
Validation Loss: 0.74883538, Validation R2: 0.429005

Epoch 187/1000
Training Loss: 0.01913608, Training R2: 0.990805
Validation Loss: 0.74932480, Validation R2: 0.428471

Epoch 188/1000
Epoch 00188: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.01862968, Training R2: 0.990852
Validation Loss: 0.74944699, Validation R2: 0.428789

Epoch 189/1000
学习率已减少 5 次
Training Loss: 0.01814032, Training R2: 0.990848
Validation Loss: 0.74854642, Validation R2: 0.429473

Epoch 190/1000
Training Loss: 0.01757664, Training R2: 0.990863
Validation Loss: 0.74892241, Validation R2: 0.428689

Epoch 191/1000
Training Loss: 0.01758377, Training R2: 0.990841
Validation Loss: 0.74789363, Validation R2: 0.429264

Epoch 192/1000
Training Loss: 0.01712199, Training R2: 0.990900
Validation Loss: 0.74804384, Validation R2: 0.429102

Epoch 193/1000
Training Loss: 0.01661186, Training R2: 0.990871
Validation Loss: 0.74869370, Validation R2: 0.428634

Epoch 194/1000
Training Loss: 0.01645929, Training R2: 0.990915
Validation Loss: 0.74908596, Validation R2: 0.428584

Epoch 195/1000
Training Loss: 0.01599363, Training R2: 0.990904
Validation Loss: 0.74902940, Validation R2: 0.428705

Epoch 196/1000
Training Loss: 0.01581578, Training R2: 0.990905
Validation Loss: 0.74886864, Validation R2: 0.428757

Epoch 197/1000
Training Loss: 0.01561347, Training R2: 0.990935
Validation Loss: 0.74901289, Validation R2: 0.428135

Epoch 198/1000
Training Loss: 0.01605158, Training R2: 0.990920
Validation Loss: 0.74820578, Validation R2: 0.428694

Epoch 199/1000
Training Loss: 0.01565571, Training R2: 0.990969
Validation Loss: 0.74848771, Validation R2: 0.428351

Epoch 200/1000
Training Loss: 0.01547850, Training R2: 0.990972
Validation Loss: 0.74884564, Validation R2: 0.428911

Epoch 201/1000
Training Loss: 0.01582302, Training R2: 0.991021
Validation Loss: 0.74954224, Validation R2: 0.427893

Epoch 202/1000
Training Loss: 0.01547210, Training R2: 0.991101
Validation Loss: 0.74930137, Validation R2: 0.428124

Epoch 203/1000
Training Loss: 0.01619864, Training R2: 0.991127
Validation Loss: 0.74960339, Validation R2: 0.427681

Epoch 204/1000
Training Loss: 0.01716759, Training R2: 0.991142
Validation Loss: 0.74939299, Validation R2: 0.428243

Epoch 205/1000
Training Loss: 0.01689538, Training R2: 0.991144
Validation Loss: 0.74944901, Validation R2: 0.428321

Epoch 206/1000
Training Loss: 0.01559238, Training R2: 0.991161
Validation Loss: 0.74951237, Validation R2: 0.428646

Epoch 207/1000
Training Loss: 0.01609669, Training R2: 0.991115
Validation Loss: 0.74943388, Validation R2: 0.427806

Epoch 208/1000
Training Loss: 0.01599817, Training R2: 0.991166
Validation Loss: 0.74904722, Validation R2: 0.428450

Epoch 209/1000
Epoch 00209: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.01617616, Training R2: 0.991119
Validation Loss: 0.74885219, Validation R2: 0.428623

Epoch 210/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_dipole.png
