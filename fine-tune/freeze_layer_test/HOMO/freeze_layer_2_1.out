Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5678211

Epoch 1/1000
Training Loss: 0.77824537, Training R2: -762.624455
Validation Loss: 0.32472327, Validation R2: -86.031903
Saved best model with validation R2 -86.031903 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.25074797, Training R2: -78.417110
Validation Loss: 0.18020569, Validation R2: -26.513146
Saved best model with validation R2 -26.513146 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.16216211, Training R2: -27.204730
Validation Loss: 0.03756079, Validation R2: -0.782629
Saved best model with validation R2 -0.782629 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.10240457, Training R2: -12.189505
Validation Loss: 0.14712043, Validation R2: -17.007652

Epoch 5/1000
Training Loss: 0.14393452, Training R2: -20.599317
Validation Loss: 0.09659386, Validation R2: -7.304806

Epoch 6/1000
Training Loss: 0.06781749, Training R2: -4.869834
Validation Loss: 0.03927391, Validation R2: -0.808531

Epoch 7/1000
Training Loss: 0.04974382, Training R2: -2.245772
Validation Loss: 0.05163344, Validation R2: -1.772470

Epoch 8/1000
Training Loss: 0.04228700, Training R2: -1.391765
Validation Loss: 0.03600989, Validation R2: -0.601585
Saved best model with validation R2 -0.601585 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.03230534, Training R2: -0.510598
Validation Loss: 0.02701518, Validation R2: -0.068364
Saved best model with validation R2 -0.068364 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.02736480, Training R2: -0.153268
Validation Loss: 0.03273560, Validation R2: -0.387814

Epoch 11/1000
Training Loss: 0.02600510, Training R2: -0.084181
Validation Loss: 0.02334496, Validation R2: 0.134142
Saved best model with validation R2 0.134142 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.02493156, Training R2: 0.006425
Validation Loss: 0.02345016, Validation R2: 0.173838
Saved best model with validation R2 0.173838 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.02128675, Training R2: 0.220174
Validation Loss: 0.03359896, Validation R2: -0.361129

Epoch 14/1000
Training Loss: 0.02549086, Training R2: 0.041656
Validation Loss: 0.02452140, Validation R2: 0.194909
Saved best model with validation R2 0.194909 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.02313372, Training R2: 0.189551
Validation Loss: 0.02159010, Validation R2: 0.305385
Saved best model with validation R2 0.305385 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.01968679, Training R2: 0.354261
Validation Loss: 0.02548692, Validation R2: 0.150325

Epoch 17/1000
Training Loss: 0.02079001, Training R2: 0.329638
Validation Loss: 0.03048367, Validation R2: -0.097505

Epoch 18/1000
Training Loss: 0.02142248, Training R2: 0.278094
Validation Loss: 0.02139045, Validation R2: 0.368766
Saved best model with validation R2 0.368766 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.02318652, Training R2: 0.158374
Validation Loss: 0.03942924, Validation R2: -0.611648

Epoch 20/1000
Training Loss: 0.02369759, Training R2: 0.143193
Validation Loss: 0.01904587, Validation R2: 0.476948
Saved best model with validation R2 0.476948 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.02542525, Training R2: 0.098776
Validation Loss: 0.04122934, Validation R2: -0.739292

Epoch 22/1000
Training Loss: 0.02968235, Training R2: -0.174553
Validation Loss: 0.01910687, Validation R2: 0.475496

Epoch 23/1000
Training Loss: 0.02390427, Training R2: 0.128329
Validation Loss: 0.02135007, Validation R2: 0.367820

Epoch 24/1000
Training Loss: 0.02061747, Training R2: 0.393511
Validation Loss: 0.01752201, Validation R2: 0.526935
Saved best model with validation R2 0.526935 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.02359165, Training R2: 0.208836
Validation Loss: 0.01691966, Validation R2: 0.550273
Saved best model with validation R2 0.550273 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.01846296, Training R2: 0.455901
Validation Loss: 0.02418894, Validation R2: 0.257105

Epoch 27/1000
Training Loss: 0.01824206, Training R2: 0.461751
Validation Loss: 0.01864783, Validation R2: 0.499694

Epoch 28/1000
Training Loss: 0.03894697, Training R2: -1.109667
Validation Loss: 0.09842561, Validation R2: -7.023552

Epoch 29/1000
Training Loss: 0.08085883, Training R2: -7.215787
Validation Loss: 0.08129628, Validation R2: -4.702112

Epoch 30/1000
Training Loss: 0.08360298, Training R2: -6.206175
Validation Loss: 0.06839667, Validation R2: -3.213800

Epoch 31/1000
Training Loss: 0.07105252, Training R2: -4.622324
Validation Loss: 0.12798074, Validation R2: -12.396055

Epoch 32/1000
Training Loss: 0.08450604, Training R2: -6.993449
Validation Loss: 0.03156978, Validation R2: -0.214981

Epoch 33/1000
Training Loss: 0.07201377, Training R2: -5.197570
Validation Loss: 0.07687028, Validation R2: -4.205297

Epoch 34/1000
Training Loss: 0.08423014, Training R2: -6.461735
Validation Loss: 0.08845903, Validation R2: -5.652854

Epoch 35/1000
Training Loss: 0.06450603, Training R2: -3.660359
Validation Loss: 0.02800648, Validation R2: 0.004581

Epoch 36/1000
Training Loss: 0.06853868, Training R2: -4.673765
Validation Loss: 0.06492913, Validation R2: -2.834703

Epoch 37/1000
Training Loss: 0.07164592, Training R2: -4.631678
Validation Loss: 0.08000942, Validation R2: -4.480745

Epoch 38/1000
Training Loss: 0.06043658, Training R2: -3.192535
Validation Loss: 0.02947741, Validation R2: -0.085896

Epoch 39/1000
Training Loss: 0.06541920, Training R2: -4.157511
Validation Loss: 0.04897314, Validation R2: -1.431967

Epoch 40/1000
Training Loss: 0.05164824, Training R2: -2.247563
Validation Loss: 0.07762633, Validation R2: -4.219395

Epoch 41/1000
Training Loss: 0.05870005, Training R2: -3.031932
Validation Loss: 0.04577557, Validation R2: -1.184417

Epoch 42/1000
Training Loss: 0.06434605, Training R2: -3.637095
Validation Loss: 0.03580756, Validation R2: -0.490859

Epoch 43/1000
Training Loss: 0.03999390, Training R2: -1.151073
Validation Loss: 0.06814434, Validation R2: -3.123710

Epoch 44/1000
Training Loss: 0.05303186, Training R2: -2.486729
Validation Loss: 0.02732609, Validation R2: 0.030518

Epoch 45/1000
Training Loss: 0.05989459, Training R2: -3.395518
Validation Loss: 0.04453181, Validation R2: -1.083885

Epoch 46/1000
Epoch 00046: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.04657383, Training R2: -1.677816
Validation Loss: 0.07430868, Validation R2: -3.742280

Epoch 47/1000
学习率已减少 1 次
Training Loss: 0.04724292, Training R2: -1.888405
Validation Loss: 0.06044540, Validation R2: -2.373632

Epoch 48/1000
Training Loss: 0.04043416, Training R2: -1.152381
Validation Loss: 0.05156209, Validation R2: -1.470048

Epoch 49/1000
Training Loss: 0.03470670, Training R2: -0.571183
Validation Loss: 0.03609005, Validation R2: -0.428741

Epoch 50/1000
Training Loss: 0.02739498, Training R2: -0.031781
Validation Loss: 0.01800001, Validation R2: 0.507253

Epoch 51/1000
Training Loss: 0.02442396, Training R2: 0.160066
Validation Loss: 0.02355983, Validation R2: 0.290794

Epoch 52/1000
Training Loss: 0.02039514, Training R2: 0.408540
Validation Loss: 0.01801522, Validation R2: 0.514148

Epoch 53/1000
Training Loss: 0.01679592, Training R2: 0.569132
Validation Loss: 0.02446947, Validation R2: 0.261887

Epoch 54/1000
Training Loss: 0.01934920, Training R2: 0.433486
Validation Loss: 0.01516857, Validation R2: 0.613416
Saved best model with validation R2 0.613416 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.01590769, Training R2: 0.582295
Validation Loss: 0.01765710, Validation R2: 0.518293

Epoch 56/1000
Training Loss: 0.01533402, Training R2: 0.617419
Validation Loss: 0.01891142, Validation R2: 0.483214

Epoch 57/1000
Training Loss: 0.01511298, Training R2: 0.629905
Validation Loss: 0.02360289, Validation R2: 0.316483

Epoch 58/1000
Training Loss: 0.01941598, Training R2: 0.477675
Validation Loss: 0.01614976, Validation R2: 0.574365

Epoch 59/1000
Training Loss: 0.01636546, Training R2: 0.609930
Validation Loss: 0.02013693, Validation R2: 0.462642

Epoch 60/1000
Training Loss: 0.01879552, Training R2: 0.517960
Validation Loss: 0.01624108, Validation R2: 0.583961

Epoch 61/1000
Training Loss: 0.01245244, Training R2: 0.737580
Validation Loss: 0.01476432, Validation R2: 0.614387
Saved best model with validation R2 0.614387 to best_finetuned_model.pth

Epoch 62/1000
Training Loss: 0.01145830, Training R2: 0.780958
Validation Loss: 0.01419349, Validation R2: 0.623666
Saved best model with validation R2 0.623666 to best_finetuned_model.pth

Epoch 63/1000
Training Loss: 0.01043348, Training R2: 0.807127
Validation Loss: 0.01570534, Validation R2: 0.609492

Epoch 64/1000
Training Loss: 0.01168413, Training R2: 0.783227
Validation Loss: 0.01304345, Validation R2: 0.677914
Saved best model with validation R2 0.677914 to best_finetuned_model.pth

Epoch 65/1000
Training Loss: 0.01077378, Training R2: 0.814422
Validation Loss: 0.01579636, Validation R2: 0.603049

Epoch 66/1000
Training Loss: 0.01066058, Training R2: 0.818069
Validation Loss: 0.01268650, Validation R2: 0.686141
Saved best model with validation R2 0.686141 to best_finetuned_model.pth

Epoch 67/1000
Training Loss: 0.00972369, Training R2: 0.839476
Validation Loss: 0.01558072, Validation R2: 0.610093

Epoch 68/1000
Training Loss: 0.00971802, Training R2: 0.843441
Validation Loss: 0.01752575, Validation R2: 0.551166

Epoch 69/1000
Training Loss: 0.01073383, Training R2: 0.822551
Validation Loss: 0.01267936, Validation R2: 0.683791

Epoch 70/1000
Training Loss: 0.00990847, Training R2: 0.842538
Validation Loss: 0.01471412, Validation R2: 0.618123

Epoch 71/1000
Training Loss: 0.01093556, Training R2: 0.814708
Validation Loss: 0.01392643, Validation R2: 0.650792

Epoch 72/1000
Training Loss: 0.00985723, Training R2: 0.839278
Validation Loss: 0.01260255, Validation R2: 0.676240

Epoch 73/1000
Training Loss: 0.00754590, Training R2: 0.895583
Validation Loss: 0.01258516, Validation R2: 0.680243

Epoch 74/1000
Training Loss: 0.00727085, Training R2: 0.900118
Validation Loss: 0.01706122, Validation R2: 0.562775

Epoch 75/1000
Training Loss: 0.00996325, Training R2: 0.840187
Validation Loss: 0.01399306, Validation R2: 0.642827

Epoch 76/1000
Training Loss: 0.00795188, Training R2: 0.891638
Validation Loss: 0.01577011, Validation R2: 0.583111

Epoch 77/1000
Training Loss: 0.00931589, Training R2: 0.867153
Validation Loss: 0.01455343, Validation R2: 0.623746

Epoch 78/1000
Training Loss: 0.00866898, Training R2: 0.877875
Validation Loss: 0.01307415, Validation R2: 0.671143

Epoch 79/1000
Training Loss: 0.00999935, Training R2: 0.856568
Validation Loss: 0.01373481, Validation R2: 0.639770

Epoch 80/1000
Training Loss: 0.00782208, Training R2: 0.900359
Validation Loss: 0.01330492, Validation R2: 0.657108

Epoch 81/1000
Training Loss: 0.00832295, Training R2: 0.895882
Validation Loss: 0.01221799, Validation R2: 0.684042

Epoch 82/1000
Training Loss: 0.00829778, Training R2: 0.894578
Validation Loss: 0.01527492, Validation R2: 0.596368

Epoch 83/1000
Training Loss: 0.01122260, Training R2: 0.820063
Validation Loss: 0.01267196, Validation R2: 0.676521

Epoch 84/1000
Training Loss: 0.01129739, Training R2: 0.804644
Validation Loss: 0.01404641, Validation R2: 0.645977

Epoch 85/1000
Training Loss: 0.01618322, Training R2: 0.654500
Validation Loss: 0.03022499, Validation R2: 0.027586

Epoch 86/1000
Training Loss: 0.01743776, Training R2: 0.609689
Validation Loss: 0.01963872, Validation R2: 0.444779

Epoch 87/1000
Epoch 00087: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01401808, Training R2: 0.749285
Validation Loss: 0.02330028, Validation R2: 0.344828

Epoch 88/1000
学习率已减少 2 次
Training Loss: 0.01595379, Training R2: 0.678672
Validation Loss: 0.01283687, Validation R2: 0.676799

Epoch 89/1000
Training Loss: 0.01400022, Training R2: 0.734193
Validation Loss: 0.01707152, Validation R2: 0.562109

Epoch 90/1000
Training Loss: 0.01120466, Training R2: 0.832060
Validation Loss: 0.01241528, Validation R2: 0.680222

Epoch 91/1000
Training Loss: 0.00784006, Training R2: 0.901979
Validation Loss: 0.01296632, Validation R2: 0.665370

Epoch 92/1000
Training Loss: 0.00825611, Training R2: 0.898838
Validation Loss: 0.01439805, Validation R2: 0.629172

Epoch 93/1000
Training Loss: 0.00858482, Training R2: 0.893779
Validation Loss: 0.01275331, Validation R2: 0.670249

Epoch 94/1000
Training Loss: 0.00650155, Training R2: 0.931771
Validation Loss: 0.01234478, Validation R2: 0.681140

Epoch 95/1000
Training Loss: 0.00582023, Training R2: 0.942781
Validation Loss: 0.01227899, Validation R2: 0.687056
Saved best model with validation R2 0.687056 to best_finetuned_model.pth

Epoch 96/1000
Training Loss: 0.00678935, Training R2: 0.927333
Validation Loss: 0.01232685, Validation R2: 0.687324
Saved best model with validation R2 0.687324 to best_finetuned_model.pth

Epoch 97/1000
Training Loss: 0.00703828, Training R2: 0.923265
Validation Loss: 0.01300561, Validation R2: 0.670350

Epoch 98/1000
Training Loss: 0.00965675, Training R2: 0.879392
Validation Loss: 0.01515561, Validation R2: 0.615390

Epoch 99/1000
Training Loss: 0.00922579, Training R2: 0.890053
Validation Loss: 0.01363566, Validation R2: 0.647770

Epoch 100/1000
Training Loss: 0.00708868, Training R2: 0.922597
Validation Loss: 0.01295015, Validation R2: 0.670131

Epoch 101/1000
Training Loss: 0.00728075, Training R2: 0.919392
Validation Loss: 0.01220670, Validation R2: 0.695679
Saved best model with validation R2 0.695679 to best_finetuned_model.pth

Epoch 102/1000
Training Loss: 0.00739797, Training R2: 0.918170
Validation Loss: 0.01326500, Validation R2: 0.668893

Epoch 103/1000
Training Loss: 0.00945946, Training R2: 0.886193
Validation Loss: 0.01459301, Validation R2: 0.635645

Epoch 104/1000
Training Loss: 0.00819094, Training R2: 0.908542
Validation Loss: 0.01367932, Validation R2: 0.663600

Epoch 105/1000
Training Loss: 0.00685843, Training R2: 0.926770
Validation Loss: 0.01204878, Validation R2: 0.698256
Saved best model with validation R2 0.698256 to best_finetuned_model.pth

Epoch 106/1000
Training Loss: 0.00689901, Training R2: 0.929527
Validation Loss: 0.01372029, Validation R2: 0.657418

Epoch 107/1000
Training Loss: 0.00861581, Training R2: 0.899504
Validation Loss: 0.01332014, Validation R2: 0.659559

Epoch 108/1000
Training Loss: 0.00803813, Training R2: 0.909477
Validation Loss: 0.01447566, Validation R2: 0.641439

Epoch 109/1000
Training Loss: 0.00882803, Training R2: 0.899638
Validation Loss: 0.01352987, Validation R2: 0.670885

Epoch 110/1000
Training Loss: 0.00751014, Training R2: 0.919752
Validation Loss: 0.01304011, Validation R2: 0.681776

Epoch 111/1000
Training Loss: 0.00753085, Training R2: 0.918221
Validation Loss: 0.01226595, Validation R2: 0.698824
Saved best model with validation R2 0.698824 to best_finetuned_model.pth

Epoch 112/1000
Training Loss: 0.00807081, Training R2: 0.908526
Validation Loss: 0.01369371, Validation R2: 0.671404

Epoch 113/1000
Training Loss: 0.00849129, Training R2: 0.899895
Validation Loss: 0.01233724, Validation R2: 0.702140
Saved best model with validation R2 0.702140 to best_finetuned_model.pth

Epoch 114/1000
Training Loss: 0.00681542, Training R2: 0.928004
Validation Loss: 0.01155937, Validation R2: 0.714886
Saved best model with validation R2 0.714886 to best_finetuned_model.pth

Epoch 115/1000
Training Loss: 0.00593201, Training R2: 0.943744
Validation Loss: 0.01193500, Validation R2: 0.703458

Epoch 116/1000
Training Loss: 0.00507816, Training R2: 0.955400
Validation Loss: 0.01180424, Validation R2: 0.707055

Epoch 117/1000
Training Loss: 0.00480732, Training R2: 0.958737
Validation Loss: 0.01244977, Validation R2: 0.697183

Epoch 118/1000
Training Loss: 0.00522069, Training R2: 0.952878
Validation Loss: 0.01170070, Validation R2: 0.712215

Epoch 119/1000
Training Loss: 0.00489270, Training R2: 0.958584
Validation Loss: 0.01243289, Validation R2: 0.691543

Epoch 120/1000
Training Loss: 0.00516125, Training R2: 0.954118
Validation Loss: 0.01288440, Validation R2: 0.682462

Epoch 121/1000
Training Loss: 0.00576552, Training R2: 0.946686
Validation Loss: 0.01203644, Validation R2: 0.702095

Epoch 122/1000
Training Loss: 0.00566047, Training R2: 0.947587
Validation Loss: 0.01308970, Validation R2: 0.681099

Epoch 123/1000
Training Loss: 0.00612904, Training R2: 0.943772
Validation Loss: 0.01221559, Validation R2: 0.701853

Epoch 124/1000
Training Loss: 0.00538005, Training R2: 0.953234
Validation Loss: 0.01376431, Validation R2: 0.660611

Epoch 125/1000
Training Loss: 0.00636731, Training R2: 0.937370
Validation Loss: 0.01208217, Validation R2: 0.703535

Epoch 126/1000
Training Loss: 0.00554673, Training R2: 0.952438
Validation Loss: 0.01242904, Validation R2: 0.697509

Epoch 127/1000
Training Loss: 0.00493185, Training R2: 0.957613
Validation Loss: 0.01205138, Validation R2: 0.698974

Epoch 128/1000
Training Loss: 0.00490928, Training R2: 0.958914
Validation Loss: 0.01233374, Validation R2: 0.697992

Epoch 129/1000
Training Loss: 0.00476646, Training R2: 0.960845
Validation Loss: 0.01287952, Validation R2: 0.680696

Epoch 130/1000
Training Loss: 0.00536250, Training R2: 0.953415
Validation Loss: 0.01206353, Validation R2: 0.699852

Epoch 131/1000
Training Loss: 0.00466369, Training R2: 0.961270
Validation Loss: 0.01277957, Validation R2: 0.679566

Epoch 132/1000
Training Loss: 0.00493984, Training R2: 0.959182
Validation Loss: 0.01212420, Validation R2: 0.702786

Epoch 133/1000
Training Loss: 0.00421317, Training R2: 0.966718
Validation Loss: 0.01250469, Validation R2: 0.681524

Epoch 134/1000
Training Loss: 0.00474688, Training R2: 0.961251
Validation Loss: 0.01325695, Validation R2: 0.672536

Epoch 135/1000
Epoch 00135: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00585995, Training R2: 0.947282
Validation Loss: 0.01194693, Validation R2: 0.706540

Epoch 136/1000
学习率已减少 3 次
Training Loss: 0.00534750, Training R2: 0.954883
Validation Loss: 0.01168611, Validation R2: 0.712665

Epoch 137/1000
Training Loss: 0.00388157, Training R2: 0.969987
Validation Loss: 0.01181330, Validation R2: 0.708874

Epoch 138/1000
Training Loss: 0.00378843, Training R2: 0.972164
Validation Loss: 0.01196792, Validation R2: 0.701196

Epoch 139/1000
Training Loss: 0.00367429, Training R2: 0.973192
Validation Loss: 0.01202746, Validation R2: 0.697797

Epoch 140/1000
Training Loss: 0.00378652, Training R2: 0.972219
Validation Loss: 0.01214704, Validation R2: 0.694825

Epoch 141/1000
Training Loss: 0.00396530, Training R2: 0.971127
Validation Loss: 0.01317598, Validation R2: 0.672751

Epoch 142/1000
Training Loss: 0.00562772, Training R2: 0.951908
Validation Loss: 0.01232988, Validation R2: 0.693436

Epoch 143/1000
Training Loss: 0.00481181, Training R2: 0.960812
Validation Loss: 0.01183603, Validation R2: 0.704019

Epoch 144/1000
Training Loss: 0.00374091, Training R2: 0.972740
Validation Loss: 0.01201056, Validation R2: 0.699740

Epoch 145/1000
Training Loss: 0.00399375, Training R2: 0.969794
Validation Loss: 0.01177833, Validation R2: 0.704732

Epoch 146/1000
Training Loss: 0.00331829, Training R2: 0.976183
Validation Loss: 0.01176833, Validation R2: 0.707803

Epoch 147/1000
Training Loss: 0.00336737, Training R2: 0.975869
Validation Loss: 0.01175348, Validation R2: 0.709175

Epoch 148/1000
Training Loss: 0.00304000, Training R2: 0.978236
Validation Loss: 0.01162298, Validation R2: 0.711690

Epoch 149/1000
Training Loss: 0.00301355, Training R2: 0.977743
Validation Loss: 0.01174591, Validation R2: 0.709841

Epoch 150/1000
Training Loss: 0.00333443, Training R2: 0.975704
Validation Loss: 0.01150100, Validation R2: 0.715516
Saved best model with validation R2 0.715516 to best_finetuned_model.pth

Epoch 151/1000
Training Loss: 0.00314395, Training R2: 0.977280
Validation Loss: 0.01169401, Validation R2: 0.711526

Epoch 152/1000
Training Loss: 0.00295258, Training R2: 0.979029
Validation Loss: 0.01167762, Validation R2: 0.708985

Epoch 153/1000
Training Loss: 0.00296639, Training R2: 0.979010
Validation Loss: 0.01156976, Validation R2: 0.715396

Epoch 154/1000
Training Loss: 0.00270502, Training R2: 0.980593
Validation Loss: 0.01168528, Validation R2: 0.709685

Epoch 155/1000
Training Loss: 0.00333159, Training R2: 0.976149
Validation Loss: 0.01188384, Validation R2: 0.708718

Epoch 156/1000
Training Loss: 0.00334620, Training R2: 0.977293
Validation Loss: 0.01186420, Validation R2: 0.704242

Epoch 157/1000
Training Loss: 0.00301483, Training R2: 0.978927
Validation Loss: 0.01166640, Validation R2: 0.711366

Epoch 158/1000
Training Loss: 0.00272370, Training R2: 0.980496
Validation Loss: 0.01181362, Validation R2: 0.708215

Epoch 159/1000
Training Loss: 0.00318905, Training R2: 0.977137
Validation Loss: 0.01179988, Validation R2: 0.709254

Epoch 160/1000
Training Loss: 0.00312702, Training R2: 0.978220
Validation Loss: 0.01164751, Validation R2: 0.714040

Epoch 161/1000
Training Loss: 0.00356978, Training R2: 0.975727
Validation Loss: 0.01149502, Validation R2: 0.716440
Saved best model with validation R2 0.716440 to best_finetuned_model.pth

Epoch 162/1000
Training Loss: 0.00366514, Training R2: 0.974216
Validation Loss: 0.01161404, Validation R2: 0.712399

Epoch 163/1000
Training Loss: 0.00293947, Training R2: 0.979594
Validation Loss: 0.01159273, Validation R2: 0.711866

Epoch 164/1000
Training Loss: 0.00298422, Training R2: 0.979462
Validation Loss: 0.01168771, Validation R2: 0.711447

Epoch 165/1000
Training Loss: 0.00297169, Training R2: 0.979136
Validation Loss: 0.01168398, Validation R2: 0.711625

Epoch 166/1000
Training Loss: 0.00303512, Training R2: 0.979027
Validation Loss: 0.01179196, Validation R2: 0.705750

Epoch 167/1000
Training Loss: 0.00335619, Training R2: 0.977559
Validation Loss: 0.01170075, Validation R2: 0.710590

Epoch 168/1000
Training Loss: 0.00319211, Training R2: 0.977823
Validation Loss: 0.01175566, Validation R2: 0.706642

Epoch 169/1000
Training Loss: 0.00315180, Training R2: 0.978043
Validation Loss: 0.01176944, Validation R2: 0.705860

Epoch 170/1000
Training Loss: 0.00295363, Training R2: 0.980421
Validation Loss: 0.01165682, Validation R2: 0.710951

Epoch 171/1000
Training Loss: 0.00278220, Training R2: 0.980931
Validation Loss: 0.01155550, Validation R2: 0.714334

Epoch 172/1000
Training Loss: 0.00315612, Training R2: 0.979373
Validation Loss: 0.01174627, Validation R2: 0.708993

Epoch 173/1000
Training Loss: 0.00326480, Training R2: 0.979064
Validation Loss: 0.01166681, Validation R2: 0.714468

Epoch 174/1000
Training Loss: 0.00307866, Training R2: 0.979940
Validation Loss: 0.01163370, Validation R2: 0.712710

Epoch 175/1000
Training Loss: 0.00377288, Training R2: 0.971431
Validation Loss: 0.01169898, Validation R2: 0.712152

Epoch 176/1000
Training Loss: 0.00680300, Training R2: 0.936886
Validation Loss: 0.01214184, Validation R2: 0.702852

Epoch 177/1000
Training Loss: 0.00430640, Training R2: 0.969163
Validation Loss: 0.01146958, Validation R2: 0.719171
Saved best model with validation R2 0.719171 to best_finetuned_model.pth

Epoch 178/1000
Training Loss: 0.00478222, Training R2: 0.965959
Validation Loss: 0.01328185, Validation R2: 0.676199

Epoch 179/1000
Training Loss: 0.00615395, Training R2: 0.944411
Validation Loss: 0.01382580, Validation R2: 0.662509

Epoch 180/1000
Training Loss: 0.00788749, Training R2: 0.919503
Validation Loss: 0.01852600, Validation R2: 0.540777

Epoch 181/1000
Training Loss: 0.01064441, Training R2: 0.869879
Validation Loss: 0.01420426, Validation R2: 0.651173

Epoch 182/1000
Training Loss: 0.00788971, Training R2: 0.924013
Validation Loss: 0.01502143, Validation R2: 0.628883

Epoch 183/1000
Training Loss: 0.01112790, Training R2: 0.864050
Validation Loss: 0.01735527, Validation R2: 0.571179

Epoch 184/1000
Training Loss: 0.00946505, Training R2: 0.895296
Validation Loss: 0.01276730, Validation R2: 0.690130

Epoch 185/1000
Training Loss: 0.00881166, Training R2: 0.908148
Validation Loss: 0.01348436, Validation R2: 0.672726

Epoch 186/1000
Training Loss: 0.00774624, Training R2: 0.922714
Validation Loss: 0.01755711, Validation R2: 0.570886

Epoch 187/1000
Training Loss: 0.00984976, Training R2: 0.881623
Validation Loss: 0.01393025, Validation R2: 0.663052

Epoch 188/1000
Training Loss: 0.00859384, Training R2: 0.909734
Validation Loss: 0.01297088, Validation R2: 0.686851

Epoch 189/1000
Training Loss: 0.00734282, Training R2: 0.928412
Validation Loss: 0.01503230, Validation R2: 0.640947

Epoch 190/1000
Training Loss: 0.00787504, Training R2: 0.917226
Validation Loss: 0.01174486, Validation R2: 0.707479

Epoch 191/1000
Training Loss: 0.00523358, Training R2: 0.956963
Validation Loss: 0.01296966, Validation R2: 0.684413

Epoch 192/1000
Training Loss: 0.00516961, Training R2: 0.962125
Validation Loss: 0.01184257, Validation R2: 0.713811

Epoch 193/1000
Training Loss: 0.00397938, Training R2: 0.973547
Validation Loss: 0.01159402, Validation R2: 0.718488

Epoch 194/1000
Training Loss: 0.00470296, Training R2: 0.965736
Validation Loss: 0.01298284, Validation R2: 0.684344

Epoch 195/1000
Training Loss: 0.00525084, Training R2: 0.959576
Validation Loss: 0.01203779, Validation R2: 0.703185

Epoch 196/1000
Training Loss: 0.00429069, Training R2: 0.970594
Validation Loss: 0.01203444, Validation R2: 0.703094

Epoch 197/1000
Training Loss: 0.00363539, Training R2: 0.976676
Validation Loss: 0.01167432, Validation R2: 0.710760

Epoch 198/1000
Epoch 00198: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00321830, Training R2: 0.978960
Validation Loss: 0.01231989, Validation R2: 0.695332

Epoch 199/1000
学习率已减少 4 次
Training Loss: 0.00382083, Training R2: 0.975123
Validation Loss: 0.01187947, Validation R2: 0.706422

Epoch 200/1000
Training Loss: 0.00346865, Training R2: 0.977271
Validation Loss: 0.01210152, Validation R2: 0.702510

Epoch 201/1000
Training Loss: 0.00353526, Training R2: 0.978038
Validation Loss: 0.01177102, Validation R2: 0.711428

Epoch 202/1000
Training Loss: 0.00326435, Training R2: 0.980037
Validation Loss: 0.01196250, Validation R2: 0.705567

Epoch 203/1000
Training Loss: 0.00346429, Training R2: 0.979164
Validation Loss: 0.01204696, Validation R2: 0.703405

Epoch 204/1000
Training Loss: 0.00340238, Training R2: 0.978854
Validation Loss: 0.01173288, Validation R2: 0.710367

Epoch 205/1000
Training Loss: 0.00292261, Training R2: 0.981894
Validation Loss: 0.01164549, Validation R2: 0.714597

Epoch 206/1000
Training Loss: 0.00269257, Training R2: 0.983400
Validation Loss: 0.01163155, Validation R2: 0.716813

Epoch 207/1000
Training Loss: 0.00290001, Training R2: 0.982364
Validation Loss: 0.01175465, Validation R2: 0.714327

Epoch 208/1000
Training Loss: 0.00302752, Training R2: 0.981812
Validation Loss: 0.01161323, Validation R2: 0.716602

Epoch 209/1000
Training Loss: 0.00245567, Training R2: 0.985119
Validation Loss: 0.01166399, Validation R2: 0.716055

Epoch 210/1000
Training Loss: 0.00258748, Training R2: 0.984481
Validation Loss: 0.01159141, Validation R2: 0.716315

Epoch 211/1000
Training Loss: 0.00231577, Training R2: 0.986132
Validation Loss: 0.01176187, Validation R2: 0.712864

Epoch 212/1000
Training Loss: 0.00290641, Training R2: 0.983225
Validation Loss: 0.01174774, Validation R2: 0.712716

Epoch 213/1000
Training Loss: 0.00289293, Training R2: 0.983937
Validation Loss: 0.01173417, Validation R2: 0.710959

Epoch 214/1000
Training Loss: 0.00250290, Training R2: 0.985738
Validation Loss: 0.01178277, Validation R2: 0.710829

Epoch 215/1000
Training Loss: 0.00272111, Training R2: 0.983890
Validation Loss: 0.01176620, Validation R2: 0.711684

Epoch 216/1000
Training Loss: 0.00267436, Training R2: 0.983904
Validation Loss: 0.01178310, Validation R2: 0.709978

Epoch 217/1000
Training Loss: 0.00247949, Training R2: 0.985561
Validation Loss: 0.01184718, Validation R2: 0.709209

Epoch 218/1000
Training Loss: 0.00257113, Training R2: 0.984871
Validation Loss: 0.01182656, Validation R2: 0.710155

Epoch 219/1000
Epoch 00219: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00223151, Training R2: 0.986704
Validation Loss: 0.01177619, Validation R2: 0.710966

Epoch 220/1000
学习率已减少 5 次
Training Loss: 0.00206769, Training R2: 0.987294
Validation Loss: 0.01172970, Validation R2: 0.712428

Epoch 221/1000
Training Loss: 0.00197047, Training R2: 0.987397
Validation Loss: 0.01173026, Validation R2: 0.711650

Epoch 222/1000
Training Loss: 0.00200030, Training R2: 0.987539
Validation Loss: 0.01167982, Validation R2: 0.714127

Epoch 223/1000
Training Loss: 0.00192513, Training R2: 0.987798
Validation Loss: 0.01168825, Validation R2: 0.713489

Epoch 224/1000
Training Loss: 0.00185778, Training R2: 0.988014
Validation Loss: 0.01174354, Validation R2: 0.711575

Epoch 225/1000
Training Loss: 0.00185054, Training R2: 0.987984
Validation Loss: 0.01175013, Validation R2: 0.710951

Epoch 226/1000
Training Loss: 0.00183857, Training R2: 0.988121
Validation Loss: 0.01177275, Validation R2: 0.709645

Epoch 227/1000
Training Loss: 0.00191313, Training R2: 0.987902
Validation Loss: 0.01173376, Validation R2: 0.710550

Epoch 228/1000
Training Loss: 0.00175245, Training R2: 0.988395
Validation Loss: 0.01178615, Validation R2: 0.708821

Epoch 229/1000
Training Loss: 0.00197549, Training R2: 0.987718
Validation Loss: 0.01178382, Validation R2: 0.708597

Epoch 230/1000
Training Loss: 0.00186405, Training R2: 0.988020
Validation Loss: 0.01173487, Validation R2: 0.710249

Epoch 231/1000
Training Loss: 0.00172784, Training R2: 0.988509
Validation Loss: 0.01168925, Validation R2: 0.712052

Epoch 232/1000
Training Loss: 0.00163891, Training R2: 0.988688
Validation Loss: 0.01172682, Validation R2: 0.710427

Epoch 233/1000
Training Loss: 0.00162230, Training R2: 0.988804
Validation Loss: 0.01170337, Validation R2: 0.711382

Epoch 234/1000
Training Loss: 0.00166040, Training R2: 0.988746
Validation Loss: 0.01173444, Validation R2: 0.711354

Epoch 235/1000
Training Loss: 0.00216560, Training R2: 0.987347
Validation Loss: 0.01163847, Validation R2: 0.713549

Epoch 236/1000
Training Loss: 0.00187202, Training R2: 0.987891
Validation Loss: 0.01163413, Validation R2: 0.713366

Epoch 237/1000
Training Loss: 0.00171435, Training R2: 0.988539
Validation Loss: 0.01159315, Validation R2: 0.714636

Epoch 238/1000
Training Loss: 0.00163905, Training R2: 0.988705
Validation Loss: 0.01161868, Validation R2: 0.713674

Epoch 239/1000
Training Loss: 0.00173249, Training R2: 0.988575
Validation Loss: 0.01163612, Validation R2: 0.712848

Epoch 240/1000
Epoch 00240: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00166455, Training R2: 0.988953
Validation Loss: 0.01162778, Validation R2: 0.713550

Epoch 241/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_HOMO_energy.png
