Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3451011

Epoch 1/1000
Training Loss: 0.47069869, Training R2: -467.901209
Validation Loss: 0.03329137, Validation R2: -0.490265
Saved best model with validation R2 -0.490265 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.03160500, Training R2: -0.554712
Validation Loss: 0.03978775, Validation R2: -1.138148

Epoch 3/1000
Training Loss: 0.03129031, Training R2: -0.616327
Validation Loss: 0.07120531, Validation R2: -4.293149

Epoch 4/1000
Training Loss: 0.06295619, Training R2: -3.992916
Validation Loss: 0.08481700, Validation R2: -5.970714

Epoch 5/1000
Training Loss: 0.06640080, Training R2: -4.311283
Validation Loss: 0.02229118, Validation R2: 0.143368
Saved best model with validation R2 0.143368 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.03190658, Training R2: -0.551240
Validation Loss: 0.02332316, Validation R2: 0.109742

Epoch 7/1000
Training Loss: 0.02729017, Training R2: -0.065183
Validation Loss: 0.04677485, Validation R2: -1.585602

Epoch 8/1000
Training Loss: 0.03720858, Training R2: -0.913270
Validation Loss: 0.03077035, Validation R2: -0.360735

Epoch 9/1000
Training Loss: 0.02691161, Training R2: -0.058032
Validation Loss: 0.02276065, Validation R2: 0.261426
Saved best model with validation R2 0.261426 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.02467049, Training R2: 0.106207
Validation Loss: 0.05381786, Validation R2: -1.929176

Epoch 11/1000
Training Loss: 0.04948720, Training R2: -2.019434
Validation Loss: 0.06388523, Validation R2: -2.957740

Epoch 12/1000
Training Loss: 0.05215114, Training R2: -2.407355
Validation Loss: 0.02873170, Validation R2: -0.196579

Epoch 13/1000
Training Loss: 0.06204304, Training R2: -3.579702
Validation Loss: 0.07340953, Validation R2: -4.168924

Epoch 14/1000
Training Loss: 0.06035818, Training R2: -2.914659
Validation Loss: 0.01991180, Validation R2: 0.320239
Saved best model with validation R2 0.320239 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.02763084, Training R2: -0.138019
Validation Loss: 0.02200681, Validation R2: 0.193749

Epoch 16/1000
Training Loss: 0.02594152, Training R2: 0.025684
Validation Loss: 0.03324861, Validation R2: -0.448752

Epoch 17/1000
Training Loss: 0.02375437, Training R2: 0.118884
Validation Loss: 0.01941550, Validation R2: 0.425753
Saved best model with validation R2 0.425753 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.02265817, Training R2: 0.248567
Validation Loss: 0.02602436, Validation R2: 0.167051

Epoch 19/1000
Training Loss: 0.02655508, Training R2: -0.001167
Validation Loss: 0.01743019, Validation R2: 0.482457
Saved best model with validation R2 0.482457 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.03102606, Training R2: -0.460105
Validation Loss: 0.07049266, Validation R2: -3.576099

Epoch 21/1000
Training Loss: 0.04011673, Training R2: -1.164244
Validation Loss: 0.02351224, Validation R2: 0.282252

Epoch 22/1000
Training Loss: 0.03812584, Training R2: -0.797208
Validation Loss: 0.07713094, Validation R2: -4.440611

Epoch 23/1000
Training Loss: 0.06224560, Training R2: -3.763434
Validation Loss: 0.02392670, Validation R2: 0.101051

Epoch 24/1000
Training Loss: 0.09401169, Training R2: -9.673790
Validation Loss: 0.01967102, Validation R2: 0.300028

Epoch 25/1000
Training Loss: 0.04702884, Training R2: -1.799395
Validation Loss: 0.06629329, Validation R2: -3.100723

Epoch 26/1000
Training Loss: 0.05458332, Training R2: -2.608302
Validation Loss: 0.01705821, Validation R2: 0.426609

Epoch 27/1000
Training Loss: 0.05008400, Training R2: -2.244463
Validation Loss: 0.07654238, Validation R2: -4.464172

Epoch 28/1000
Training Loss: 0.05417930, Training R2: -2.632880
Validation Loss: 0.03081436, Validation R2: -0.030549

Epoch 29/1000
Training Loss: 0.04743658, Training R2: -1.532473
Validation Loss: 0.04616634, Validation R2: -1.100527

Epoch 30/1000
Training Loss: 0.04129936, Training R2: -1.120792
Validation Loss: 0.02977060, Validation R2: 0.029162

Epoch 31/1000
Training Loss: 0.02913127, Training R2: -0.098071
Validation Loss: 0.01952768, Validation R2: 0.467875

Epoch 32/1000
Training Loss: 0.02169513, Training R2: 0.341306
Validation Loss: 0.01916340, Validation R2: 0.480580

Epoch 33/1000
Training Loss: 0.01936950, Training R2: 0.461309
Validation Loss: 0.01771751, Validation R2: 0.404412

Epoch 34/1000
Training Loss: 0.01683996, Training R2: 0.559792
Validation Loss: 0.02549696, Validation R2: 0.244398

Epoch 35/1000
Training Loss: 0.01722499, Training R2: 0.565140
Validation Loss: 0.02666905, Validation R2: 0.193945

Epoch 36/1000
Training Loss: 0.02095831, Training R2: 0.389399
Validation Loss: 0.02797364, Validation R2: -0.013247

Epoch 37/1000
Training Loss: 0.01891003, Training R2: 0.498128
Validation Loss: 0.01786538, Validation R2: 0.542951
Saved best model with validation R2 0.542951 to best_finetuned_model.pth

Epoch 38/1000
Training Loss: 0.01892282, Training R2: 0.497118
Validation Loss: 0.01797019, Validation R2: 0.515161

Epoch 39/1000
Training Loss: 0.02371948, Training R2: 0.184262
Validation Loss: 0.03446206, Validation R2: -0.229300

Epoch 40/1000
Training Loss: 0.04491132, Training R2: -1.120825
Validation Loss: 0.02952353, Validation R2: 0.062797

Epoch 41/1000
Training Loss: 0.02335452, Training R2: 0.289927
Validation Loss: 0.02423156, Validation R2: 0.314713

Epoch 42/1000
Training Loss: 0.03909202, Training R2: -0.737827
Validation Loss: 0.03613111, Validation R2: -0.316095

Epoch 43/1000
Training Loss: 0.02958584, Training R2: -0.039666
Validation Loss: 0.04702184, Validation R2: -1.143061

Epoch 44/1000
Training Loss: 0.03174596, Training R2: -0.247014
Validation Loss: 0.02086055, Validation R2: 0.438161

Epoch 45/1000
Training Loss: 0.02823529, Training R2: -0.038478
Validation Loss: 0.04920199, Validation R2: -1.307523

Epoch 46/1000
Training Loss: 0.03223669, Training R2: -0.285495
Validation Loss: 0.04309901, Validation R2: -0.812875

Epoch 47/1000
Training Loss: 0.02651819, Training R2: 0.056315
Validation Loss: 0.01891633, Validation R2: 0.519850

Epoch 48/1000
Training Loss: 0.03386383, Training R2: -0.325180
Validation Loss: 0.04682504, Validation R2: -1.070711

Epoch 49/1000
Training Loss: 0.02909579, Training R2: -0.076022
Validation Loss: 0.03173959, Validation R2: -0.064980

Epoch 50/1000
Training Loss: 0.03223570, Training R2: -0.149729
Validation Loss: 0.04781611, Validation R2: -1.194978

Epoch 51/1000
Training Loss: 0.03209182, Training R2: -0.334465
Validation Loss: 0.02410754, Validation R2: 0.316577

Epoch 52/1000
Training Loss: 0.01953332, Training R2: 0.472871
Validation Loss: 0.02856408, Validation R2: -0.082376

Epoch 53/1000
Training Loss: 0.02345158, Training R2: 0.269008
Validation Loss: 0.04654555, Validation R2: -1.259708

Epoch 54/1000
Training Loss: 0.04296679, Training R2: -1.081876
Validation Loss: 0.01303090, Validation R2: 0.602485
Saved best model with validation R2 0.602485 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.03445997, Training R2: -0.515179
Validation Loss: 0.05453177, Validation R2: -1.777498

Epoch 56/1000
Training Loss: 0.03778055, Training R2: -0.825904
Validation Loss: 0.05835985, Validation R2: -2.208120

Epoch 57/1000
Training Loss: 0.05112899, Training R2: -2.039924
Validation Loss: 0.10144312, Validation R2: -8.196320

Epoch 58/1000
Training Loss: 0.06738984, Training R2: -3.915420
Validation Loss: 0.04500191, Validation R2: -1.016993

Epoch 59/1000
Training Loss: 0.04906263, Training R2: -1.627451
Validation Loss: 0.05377262, Validation R2: -1.791689

Epoch 60/1000
Training Loss: 0.04158346, Training R2: -1.125648
Validation Loss: 0.03506135, Validation R2: -0.475443

Epoch 61/1000
Training Loss: 0.04125529, Training R2: -0.906428
Validation Loss: 0.07192709, Validation R2: -3.808336

Epoch 62/1000
Training Loss: 0.05555333, Training R2: -2.659997
Validation Loss: 0.09326949, Validation R2: -6.735014

Epoch 63/1000
Training Loss: 0.06295302, Training R2: -3.282114
Validation Loss: 0.03894893, Validation R2: -0.715110

Epoch 64/1000
Training Loss: 0.05440731, Training R2: -2.227110
Validation Loss: 0.05280311, Validation R2: -1.815630

Epoch 65/1000
Training Loss: 0.05544505, Training R2: -2.311364
Validation Loss: 0.06835172, Validation R2: -3.381424

Epoch 66/1000
Training Loss: 0.05172488, Training R2: -1.999693
Validation Loss: 0.02549685, Validation R2: 0.080136

Epoch 67/1000
Training Loss: 0.05313106, Training R2: -2.337454
Validation Loss: 0.05245574, Validation R2: -1.775743

Epoch 68/1000
Training Loss: 0.05778729, Training R2: -2.533360
Validation Loss: 0.05998892, Validation R2: -2.364407

Epoch 69/1000
Training Loss: 0.04783678, Training R2: -1.563915
Validation Loss: 0.03142163, Validation R2: -0.278175

Epoch 70/1000
Training Loss: 0.05720794, Training R2: -2.647365
Validation Loss: 0.03227822, Validation R2: -0.328259

Epoch 71/1000
Training Loss: 0.03735373, Training R2: -0.702309
Validation Loss: 0.07145919, Validation R2: -3.653823

Epoch 72/1000
Training Loss: 0.04992073, Training R2: -1.710134
Validation Loss: 0.02677121, Validation R2: -0.005161

Epoch 73/1000
Training Loss: 0.05119466, Training R2: -1.988730
Validation Loss: 0.04336170, Validation R2: -1.021806

Epoch 74/1000
Training Loss: 0.04762015, Training R2: -1.521510
Validation Loss: 0.06485242, Validation R2: -2.889639

Epoch 75/1000
Epoch 00075: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.04493563, Training R2: -1.254011
Validation Loss: 0.02048931, Validation R2: 0.282094

Epoch 76/1000
学习率已减少 1 次
Training Loss: 0.02414145, Training R2: 0.229397
Validation Loss: 0.01487186, Validation R2: 0.561803

Epoch 77/1000
Training Loss: 0.02083228, Training R2: 0.381326
Validation Loss: 0.02327452, Validation R2: 0.342018

Epoch 78/1000
Training Loss: 0.01773199, Training R2: 0.569335
Validation Loss: 0.01419438, Validation R2: 0.601164

Epoch 79/1000
Training Loss: 0.01338059, Training R2: 0.732180
Validation Loss: 0.01371400, Validation R2: 0.585606

Epoch 80/1000
Training Loss: 0.01206125, Training R2: 0.777421
Validation Loss: 0.01424585, Validation R2: 0.619869
Saved best model with validation R2 0.619869 to best_finetuned_model.pth

Epoch 81/1000
Training Loss: 0.01157131, Training R2: 0.789031
Validation Loss: 0.01957692, Validation R2: 0.480854

Epoch 82/1000
Training Loss: 0.01515658, Training R2: 0.678580
Validation Loss: 0.01964855, Validation R2: 0.477353

Epoch 83/1000
Training Loss: 0.01615156, Training R2: 0.649981
Validation Loss: 0.01575372, Validation R2: 0.522553

Epoch 84/1000
Training Loss: 0.01542023, Training R2: 0.680412
Validation Loss: 0.02191451, Validation R2: 0.299972

Epoch 85/1000
Training Loss: 0.01661144, Training R2: 0.626579
Validation Loss: 0.01480896, Validation R2: 0.563907

Epoch 86/1000
Training Loss: 0.01282560, Training R2: 0.760527
Validation Loss: 0.01205879, Validation R2: 0.667506
Saved best model with validation R2 0.667506 to best_finetuned_model.pth

Epoch 87/1000
Training Loss: 0.01201077, Training R2: 0.788253
Validation Loss: 0.01552069, Validation R2: 0.604135

Epoch 88/1000
Training Loss: 0.01218560, Training R2: 0.788146
Validation Loss: 0.01260908, Validation R2: 0.652929

Epoch 89/1000
Training Loss: 0.01013437, Training R2: 0.839487
Validation Loss: 0.01252449, Validation R2: 0.664749

Epoch 90/1000
Training Loss: 0.00962382, Training R2: 0.856931
Validation Loss: 0.01180951, Validation R2: 0.660152

Epoch 91/1000
Training Loss: 0.00976767, Training R2: 0.858027
Validation Loss: 0.01221399, Validation R2: 0.648891

Epoch 92/1000
Training Loss: 0.00886293, Training R2: 0.876977
Validation Loss: 0.01127950, Validation R2: 0.692317
Saved best model with validation R2 0.692317 to best_finetuned_model.pth

Epoch 93/1000
Training Loss: 0.00778262, Training R2: 0.902201
Validation Loss: 0.01121948, Validation R2: 0.676603

Epoch 94/1000
Training Loss: 0.00760071, Training R2: 0.907643
Validation Loss: 0.01358690, Validation R2: 0.605515

Epoch 95/1000
Training Loss: 0.00876644, Training R2: 0.884269
Validation Loss: 0.01325280, Validation R2: 0.654945

Epoch 96/1000
Training Loss: 0.00970662, Training R2: 0.865192
Validation Loss: 0.01465502, Validation R2: 0.623144

Epoch 97/1000
Training Loss: 0.00980488, Training R2: 0.865344
Validation Loss: 0.01097210, Validation R2: 0.699296
Saved best model with validation R2 0.699296 to best_finetuned_model.pth

Epoch 98/1000
Training Loss: 0.00914348, Training R2: 0.869709
Validation Loss: 0.01058719, Validation R2: 0.697772

Epoch 99/1000
Training Loss: 0.00821656, Training R2: 0.897093
Validation Loss: 0.01017231, Validation R2: 0.715252
Saved best model with validation R2 0.715252 to best_finetuned_model.pth

Epoch 100/1000
Training Loss: 0.00645446, Training R2: 0.928851
Validation Loss: 0.01019432, Validation R2: 0.709066

Epoch 101/1000
Training Loss: 0.00649686, Training R2: 0.929823
Validation Loss: 0.01024812, Validation R2: 0.706278

Epoch 102/1000
Training Loss: 0.00724165, Training R2: 0.919100
Validation Loss: 0.01130032, Validation R2: 0.677357

Epoch 103/1000
Training Loss: 0.00654945, Training R2: 0.927077
Validation Loss: 0.01176663, Validation R2: 0.697398

Epoch 104/1000
Training Loss: 0.00769151, Training R2: 0.910406
Validation Loss: 0.01102630, Validation R2: 0.699741

Epoch 105/1000
Training Loss: 0.00676444, Training R2: 0.927649
Validation Loss: 0.01052205, Validation R2: 0.669822

Epoch 106/1000
Training Loss: 0.00637038, Training R2: 0.935072
Validation Loss: 0.01062257, Validation R2: 0.694950

Epoch 107/1000
Training Loss: 0.00998023, Training R2: 0.848191
Validation Loss: 0.01481256, Validation R2: 0.637431

Epoch 108/1000
Training Loss: 0.02030246, Training R2: 0.539646
Validation Loss: 0.02615052, Validation R2: 0.238092

Epoch 109/1000
Training Loss: 0.02181798, Training R2: 0.488013
Validation Loss: 0.01028031, Validation R2: 0.714812

Epoch 110/1000
Training Loss: 0.02277177, Training R2: 0.342889
Validation Loss: 0.03877525, Validation R2: -0.555844

Epoch 111/1000
Training Loss: 0.03094357, Training R2: -0.034889
Validation Loss: 0.05285741, Validation R2: -1.516873

Epoch 112/1000
Training Loss: 0.03279325, Training R2: -0.370275
Validation Loss: 0.04187074, Validation R2: -0.819462

Epoch 113/1000
Training Loss: 0.03041065, Training R2: -0.083562
Validation Loss: 0.03684640, Validation R2: -0.332611

Epoch 114/1000
Training Loss: 0.02576951, Training R2: 0.185683
Validation Loss: 0.01212227, Validation R2: 0.681662

Epoch 115/1000
Training Loss: 0.01342798, Training R2: 0.750881
Validation Loss: 0.02351748, Validation R2: 0.249178

Epoch 116/1000
Training Loss: 0.01454480, Training R2: 0.739482
Validation Loss: 0.02006130, Validation R2: 0.402645

Epoch 117/1000
Training Loss: 0.01228560, Training R2: 0.804604
Validation Loss: 0.01756905, Validation R2: 0.477137

Epoch 118/1000
Training Loss: 0.01142265, Training R2: 0.829971
Validation Loss: 0.01523173, Validation R2: 0.536567

Epoch 119/1000
Training Loss: 0.01578952, Training R2: 0.714343
Validation Loss: 0.01858448, Validation R2: 0.420756

Epoch 120/1000
Epoch 00120: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01235207, Training R2: 0.802979
Validation Loss: 0.01068723, Validation R2: 0.684456

Epoch 121/1000
学习率已减少 2 次
Training Loss: 0.00708035, Training R2: 0.922976
Validation Loss: 0.00994312, Validation R2: 0.720408
Saved best model with validation R2 0.720408 to best_finetuned_model.pth

Epoch 122/1000
Training Loss: 0.00643363, Training R2: 0.934217
Validation Loss: 0.00973747, Validation R2: 0.728561
Saved best model with validation R2 0.728561 to best_finetuned_model.pth

Epoch 123/1000
Training Loss: 0.00601345, Training R2: 0.941407
Validation Loss: 0.00973842, Validation R2: 0.734149
Saved best model with validation R2 0.734149 to best_finetuned_model.pth

Epoch 124/1000
Training Loss: 0.00572856, Training R2: 0.945135
Validation Loss: 0.00979398, Validation R2: 0.740215
Saved best model with validation R2 0.740215 to best_finetuned_model.pth

Epoch 125/1000
Training Loss: 0.00565841, Training R2: 0.946904
Validation Loss: 0.01011327, Validation R2: 0.742428
Saved best model with validation R2 0.742428 to best_finetuned_model.pth

Epoch 126/1000
Training Loss: 0.00578505, Training R2: 0.944559
Validation Loss: 0.01005687, Validation R2: 0.744824
Saved best model with validation R2 0.744824 to best_finetuned_model.pth

Epoch 127/1000
Training Loss: 0.00588053, Training R2: 0.944397
Validation Loss: 0.01141419, Validation R2: 0.725152

Epoch 128/1000
Training Loss: 0.00693662, Training R2: 0.932286
Validation Loss: 0.01407871, Validation R2: 0.669364

Epoch 129/1000
Training Loss: 0.00951623, Training R2: 0.884570
Validation Loss: 0.00982162, Validation R2: 0.731235

Epoch 130/1000
Training Loss: 0.00638372, Training R2: 0.938199
Validation Loss: 0.01144897, Validation R2: 0.677184

Epoch 131/1000
Training Loss: 0.00746075, Training R2: 0.926359
Validation Loss: 0.01111138, Validation R2: 0.687696

Epoch 132/1000
Training Loss: 0.00662012, Training R2: 0.938397
Validation Loss: 0.01092128, Validation R2: 0.693443

Epoch 133/1000
Training Loss: 0.00603986, Training R2: 0.946105
Validation Loss: 0.01132016, Validation R2: 0.681337

Epoch 134/1000
Training Loss: 0.00727897, Training R2: 0.929993
Validation Loss: 0.01053894, Validation R2: 0.701796

Epoch 135/1000
Training Loss: 0.00611451, Training R2: 0.944157
Validation Loss: 0.01086280, Validation R2: 0.691987

Epoch 136/1000
Training Loss: 0.00659570, Training R2: 0.937460
Validation Loss: 0.01031925, Validation R2: 0.708194

Epoch 137/1000
Training Loss: 0.00637180, Training R2: 0.940313
Validation Loss: 0.01059688, Validation R2: 0.700295

Epoch 138/1000
Training Loss: 0.00739803, Training R2: 0.928306
Validation Loss: 0.01155704, Validation R2: 0.676684

Epoch 139/1000
Training Loss: 0.00746142, Training R2: 0.926321
Validation Loss: 0.01303119, Validation R2: 0.638793

Epoch 140/1000
Training Loss: 0.00735862, Training R2: 0.924893
Validation Loss: 0.01035639, Validation R2: 0.707717

Epoch 141/1000
Training Loss: 0.00493434, Training R2: 0.961643
Validation Loss: 0.00941382, Validation R2: 0.736221

Epoch 142/1000
Training Loss: 0.00423070, Training R2: 0.969419
Validation Loss: 0.00988841, Validation R2: 0.736749

Epoch 143/1000
Training Loss: 0.00460513, Training R2: 0.965997
Validation Loss: 0.00952990, Validation R2: 0.738679

Epoch 144/1000
Training Loss: 0.00524923, Training R2: 0.956977
Validation Loss: 0.00969071, Validation R2: 0.735415

Epoch 145/1000
Training Loss: 0.00617697, Training R2: 0.945963
Validation Loss: 0.01119780, Validation R2: 0.713721

Epoch 146/1000
Training Loss: 0.00858929, Training R2: 0.911948
Validation Loss: 0.01047372, Validation R2: 0.724120

Epoch 147/1000
Epoch 00147: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00706437, Training R2: 0.935611
Validation Loss: 0.01093845, Validation R2: 0.718051

Epoch 148/1000
学习率已减少 3 次
Training Loss: 0.00625799, Training R2: 0.947404
Validation Loss: 0.00958309, Validation R2: 0.734166

Epoch 149/1000
Training Loss: 0.00513554, Training R2: 0.960214
Validation Loss: 0.01034850, Validation R2: 0.705313

Epoch 150/1000
Training Loss: 0.00451294, Training R2: 0.967710
Validation Loss: 0.01014034, Validation R2: 0.711389

Epoch 151/1000
Training Loss: 0.00417389, Training R2: 0.972085
Validation Loss: 0.00972021, Validation R2: 0.724149

Epoch 152/1000
Training Loss: 0.00386201, Training R2: 0.975156
Validation Loss: 0.00947742, Validation R2: 0.733012

Epoch 153/1000
Training Loss: 0.00390578, Training R2: 0.974633
Validation Loss: 0.00947882, Validation R2: 0.736814

Epoch 154/1000
Training Loss: 0.00358112, Training R2: 0.976962
Validation Loss: 0.00947813, Validation R2: 0.732254

Epoch 155/1000
Training Loss: 0.00335601, Training R2: 0.979321
Validation Loss: 0.00960359, Validation R2: 0.728362

Epoch 156/1000
Training Loss: 0.00332327, Training R2: 0.979395
Validation Loss: 0.00976065, Validation R2: 0.722379

Epoch 157/1000
Training Loss: 0.00326577, Training R2: 0.979633
Validation Loss: 0.00990030, Validation R2: 0.718623

Epoch 158/1000
Training Loss: 0.00334018, Training R2: 0.979282
Validation Loss: 0.00959130, Validation R2: 0.732171

Epoch 159/1000
Training Loss: 0.00323388, Training R2: 0.979888
Validation Loss: 0.00952027, Validation R2: 0.732331

Epoch 160/1000
Training Loss: 0.00313451, Training R2: 0.981115
Validation Loss: 0.00947589, Validation R2: 0.732220

Epoch 161/1000
Training Loss: 0.00304351, Training R2: 0.981930
Validation Loss: 0.00949148, Validation R2: 0.733794

Epoch 162/1000
Training Loss: 0.00337732, Training R2: 0.979826
Validation Loss: 0.00963020, Validation R2: 0.732980

Epoch 163/1000
Training Loss: 0.00405010, Training R2: 0.974905
Validation Loss: 0.01001023, Validation R2: 0.728881

Epoch 164/1000
Training Loss: 0.00400487, Training R2: 0.974582
Validation Loss: 0.00977784, Validation R2: 0.730442

Epoch 165/1000
Training Loss: 0.00348549, Training R2: 0.979017
Validation Loss: 0.00947774, Validation R2: 0.733674

Epoch 166/1000
Training Loss: 0.00315708, Training R2: 0.981557
Validation Loss: 0.00953272, Validation R2: 0.730177

Epoch 167/1000
Training Loss: 0.00325507, Training R2: 0.981014
Validation Loss: 0.00975380, Validation R2: 0.724313

Epoch 168/1000
Epoch 00168: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00292819, Training R2: 0.982989
Validation Loss: 0.00949686, Validation R2: 0.731104

Epoch 169/1000
学习率已减少 4 次
Training Loss: 0.00273254, Training R2: 0.984602
Validation Loss: 0.00957731, Validation R2: 0.728380

Epoch 170/1000
Training Loss: 0.00282618, Training R2: 0.983924
Validation Loss: 0.00937162, Validation R2: 0.737862

Epoch 171/1000
Training Loss: 0.00274623, Training R2: 0.984293
Validation Loss: 0.00937213, Validation R2: 0.736262

Epoch 172/1000
Training Loss: 0.00277399, Training R2: 0.983858
Validation Loss: 0.00945040, Validation R2: 0.731956

Epoch 173/1000
Training Loss: 0.00266155, Training R2: 0.984545
Validation Loss: 0.00962314, Validation R2: 0.726155

Epoch 174/1000
Training Loss: 0.00265727, Training R2: 0.984684
Validation Loss: 0.00946486, Validation R2: 0.730713

Epoch 175/1000
Training Loss: 0.00255088, Training R2: 0.985245
Validation Loss: 0.00942076, Validation R2: 0.734639

Epoch 176/1000
Training Loss: 0.00273558, Training R2: 0.984924
Validation Loss: 0.00947733, Validation R2: 0.731663

Epoch 177/1000
Training Loss: 0.00276469, Training R2: 0.984024
Validation Loss: 0.00945117, Validation R2: 0.731990

Epoch 178/1000
Training Loss: 0.00286661, Training R2: 0.984194
Validation Loss: 0.00971022, Validation R2: 0.720852

Epoch 179/1000
Training Loss: 0.00289021, Training R2: 0.983914
Validation Loss: 0.00964016, Validation R2: 0.722165

Epoch 180/1000
Training Loss: 0.00246666, Training R2: 0.986143
Validation Loss: 0.00957529, Validation R2: 0.723300

Epoch 181/1000
Training Loss: 0.00245937, Training R2: 0.986205
Validation Loss: 0.00958660, Validation R2: 0.722716

Epoch 182/1000
Training Loss: 0.00234603, Training R2: 0.986698
Validation Loss: 0.00949475, Validation R2: 0.728409

Epoch 183/1000
Training Loss: 0.00250049, Training R2: 0.986247
Validation Loss: 0.00948318, Validation R2: 0.727742

Epoch 184/1000
Training Loss: 0.00239203, Training R2: 0.986360
Validation Loss: 0.00963596, Validation R2: 0.721790

Epoch 185/1000
Training Loss: 0.00244843, Training R2: 0.986639
Validation Loss: 0.00967076, Validation R2: 0.721115

Epoch 186/1000
Training Loss: 0.00244224, Training R2: 0.986400
Validation Loss: 0.00974920, Validation R2: 0.719758

Epoch 187/1000
Training Loss: 0.00249178, Training R2: 0.986443
Validation Loss: 0.00959481, Validation R2: 0.724614

Epoch 188/1000
Training Loss: 0.00235894, Training R2: 0.987055
Validation Loss: 0.00943508, Validation R2: 0.730308

Epoch 189/1000
Epoch 00189: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00222503, Training R2: 0.987698
Validation Loss: 0.00947125, Validation R2: 0.727750

Epoch 190/1000
学习率已减少 5 次
Training Loss: 0.00216674, Training R2: 0.987792
Validation Loss: 0.00963651, Validation R2: 0.720125

Epoch 191/1000
Training Loss: 0.00223319, Training R2: 0.987561
Validation Loss: 0.00956090, Validation R2: 0.722301

Epoch 192/1000
Training Loss: 0.00220630, Training R2: 0.987862
Validation Loss: 0.00951697, Validation R2: 0.725925

Epoch 193/1000
Training Loss: 0.00227746, Training R2: 0.987519
Validation Loss: 0.00959672, Validation R2: 0.720084

Epoch 194/1000
Training Loss: 0.00226226, Training R2: 0.987533
Validation Loss: 0.00961143, Validation R2: 0.719040

Epoch 195/1000
Training Loss: 0.00208377, Training R2: 0.988153
Validation Loss: 0.00957371, Validation R2: 0.720576

Epoch 196/1000
Training Loss: 0.00211901, Training R2: 0.988130
Validation Loss: 0.00950459, Validation R2: 0.723764

Epoch 197/1000
Training Loss: 0.00219067, Training R2: 0.987891
Validation Loss: 0.00950545, Validation R2: 0.725685

Epoch 198/1000
Training Loss: 0.00225329, Training R2: 0.987471
Validation Loss: 0.00957819, Validation R2: 0.719835

Epoch 199/1000
Training Loss: 0.00209829, Training R2: 0.988232
Validation Loss: 0.00969065, Validation R2: 0.715111

Epoch 200/1000
Training Loss: 0.00216114, Training R2: 0.988317
Validation Loss: 0.00955130, Validation R2: 0.720829

Epoch 201/1000
Training Loss: 0.00204900, Training R2: 0.988466
Validation Loss: 0.00954567, Validation R2: 0.722029

Epoch 202/1000
Training Loss: 0.00216061, Training R2: 0.987792
Validation Loss: 0.00960953, Validation R2: 0.718049

Epoch 203/1000
Training Loss: 0.00203391, Training R2: 0.988353
Validation Loss: 0.00954049, Validation R2: 0.721693

Epoch 204/1000
Training Loss: 0.00200183, Training R2: 0.988558
Validation Loss: 0.00958601, Validation R2: 0.718927

Epoch 205/1000
Training Loss: 0.00198379, Training R2: 0.988583
Validation Loss: 0.00957865, Validation R2: 0.718934

Epoch 206/1000
Training Loss: 0.00195875, Training R2: 0.988699
Validation Loss: 0.00956597, Validation R2: 0.719600

Epoch 207/1000
Training Loss: 0.00195317, Training R2: 0.988745
Validation Loss: 0.00960608, Validation R2: 0.717296

Epoch 208/1000
Training Loss: 0.00190730, Training R2: 0.988870
Validation Loss: 0.00961628, Validation R2: 0.716680

Epoch 209/1000
Training Loss: 0.00190822, Training R2: 0.988802
Validation Loss: 0.00959177, Validation R2: 0.718029

Epoch 210/1000
Epoch 00210: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00191120, Training R2: 0.988703
Validation Loss: 0.00974265, Validation R2: 0.712888

Epoch 211/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_HOMO_energy.png
