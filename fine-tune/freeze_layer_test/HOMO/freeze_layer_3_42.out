Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4564611

Epoch 1/1000
Training Loss: 0.47132214, Training R2: -468.026378
Validation Loss: 0.03537706, Validation R2: -0.619317
Saved best model with validation R2 -0.619317 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.03066467, Training R2: -0.454135
Validation Loss: 0.06556580, Validation R2: -3.716229

Epoch 3/1000
Training Loss: 0.06217354, Training R2: -3.967816
Validation Loss: 0.11529668, Validation R2: -11.264366

Epoch 4/1000
Training Loss: 0.08529444, Training R2: -8.162013
Validation Loss: 0.08669794, Validation R2: -6.177233

Epoch 5/1000
Training Loss: 0.06136578, Training R2: -3.643117
Validation Loss: 0.06270548, Validation R2: -2.954900

Epoch 6/1000
Training Loss: 0.05668580, Training R2: -2.759383
Validation Loss: 0.03261555, Validation R2: -0.296970
Saved best model with validation R2 -0.296970 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.03396258, Training R2: -0.549814
Validation Loss: 0.02740142, Validation R2: -0.016067
Saved best model with validation R2 -0.016067 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.02320422, Training R2: 0.167668
Validation Loss: 0.03235447, Validation R2: -0.224133

Epoch 9/1000
Training Loss: 0.02672470, Training R2: -0.045545
Validation Loss: 0.02247405, Validation R2: 0.186504
Saved best model with validation R2 0.186504 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.02424766, Training R2: 0.124422
Validation Loss: 0.02416289, Validation R2: 0.262575
Saved best model with validation R2 0.262575 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.02188106, Training R2: 0.266186
Validation Loss: 0.01899891, Validation R2: 0.367409
Saved best model with validation R2 0.367409 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.02108917, Training R2: 0.301346
Validation Loss: 0.01965283, Validation R2: 0.266546

Epoch 13/1000
Training Loss: 0.01790657, Training R2: 0.436089
Validation Loss: 0.01770104, Validation R2: 0.397679
Saved best model with validation R2 0.397679 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.02139576, Training R2: 0.301700
Validation Loss: 0.01687159, Validation R2: 0.477141
Saved best model with validation R2 0.477141 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.02269978, Training R2: 0.211292
Validation Loss: 0.02915207, Validation R2: -0.149579

Epoch 16/1000
Training Loss: 0.02890649, Training R2: -0.130831
Validation Loss: 0.02546517, Validation R2: 0.058513

Epoch 17/1000
Training Loss: 0.06224850, Training R2: -3.616102
Validation Loss: 0.04954553, Validation R2: -1.565361

Epoch 18/1000
Training Loss: 0.03143059, Training R2: -0.294855
Validation Loss: 0.01937480, Validation R2: 0.467155

Epoch 19/1000
Training Loss: 0.01748168, Training R2: 0.510624
Validation Loss: 0.01826866, Validation R2: 0.397011

Epoch 20/1000
Training Loss: 0.01849479, Training R2: 0.477243
Validation Loss: 0.02007265, Validation R2: 0.474960

Epoch 21/1000
Training Loss: 0.01482696, Training R2: 0.639318
Validation Loss: 0.02341420, Validation R2: 0.335667

Epoch 22/1000
Training Loss: 0.02288403, Training R2: 0.326228
Validation Loss: 0.02012230, Validation R2: 0.484907
Saved best model with validation R2 0.484907 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.02377691, Training R2: 0.273123
Validation Loss: 0.02683567, Validation R2: 0.006704

Epoch 24/1000
Training Loss: 0.02900731, Training R2: -0.131076
Validation Loss: 0.05171008, Validation R2: -1.704669

Epoch 25/1000
Training Loss: 0.05666672, Training R2: -2.292887
Validation Loss: 0.05309421, Validation R2: -1.853004

Epoch 26/1000
Training Loss: 0.03357693, Training R2: -0.462577
Validation Loss: 0.01533663, Validation R2: 0.553922
Saved best model with validation R2 0.553922 to best_finetuned_model.pth

Epoch 27/1000
Training Loss: 0.01286584, Training R2: 0.723311
Validation Loss: 0.04484867, Validation R2: -0.964176

Epoch 28/1000
Training Loss: 0.04555997, Training R2: -1.635781
Validation Loss: 0.03623613, Validation R2: -0.348535

Epoch 29/1000
Training Loss: 0.03833378, Training R2: -0.526510
Validation Loss: 0.07328708, Validation R2: -3.843957

Epoch 30/1000
Training Loss: 0.05482514, Training R2: -2.715242
Validation Loss: 0.02973433, Validation R2: -0.128142

Epoch 31/1000
Training Loss: 0.06786666, Training R2: -4.231486
Validation Loss: 0.10359407, Validation R2: -8.578330

Epoch 32/1000
Training Loss: 0.10780817, Training R2: -10.406166
Validation Loss: 0.06364647, Validation R2: -2.763490

Epoch 33/1000
Training Loss: 0.05458353, Training R2: -2.570128
Validation Loss: 0.01857623, Validation R2: 0.339808

Epoch 34/1000
Training Loss: 0.07027116, Training R2: -5.196742
Validation Loss: 0.08195136, Validation R2: -5.247725

Epoch 35/1000
Training Loss: 0.09172374, Training R2: -7.448950
Validation Loss: 0.07496917, Validation R2: -4.222830

Epoch 36/1000
Training Loss: 0.05404248, Training R2: -2.259505
Validation Loss: 0.02117671, Validation R2: 0.365554

Epoch 37/1000
Training Loss: 0.02343543, Training R2: 0.199782
Validation Loss: 0.02342419, Validation R2: 0.292306

Epoch 38/1000
Training Loss: 0.01929137, Training R2: 0.456534
Validation Loss: 0.02242437, Validation R2: 0.369327

Epoch 39/1000
Training Loss: 0.02257466, Training R2: 0.272334
Validation Loss: 0.01953085, Validation R2: 0.476240

Epoch 40/1000
Training Loss: 0.04270667, Training R2: -1.214730
Validation Loss: 0.03424779, Validation R2: -0.241490

Epoch 41/1000
Training Loss: 0.02960364, Training R2: -0.027188
Validation Loss: 0.03254216, Validation R2: -0.136400

Epoch 42/1000
Training Loss: 0.04227320, Training R2: -0.926373
Validation Loss: 0.02762817, Validation R2: 0.147169

Epoch 43/1000
Training Loss: 0.03051909, Training R2: -0.082114
Validation Loss: 0.05352237, Validation R2: -1.728312

Epoch 44/1000
Training Loss: 0.03425192, Training R2: -0.462864
Validation Loss: 0.01574489, Validation R2: 0.562635
Saved best model with validation R2 0.562635 to best_finetuned_model.pth

Epoch 45/1000
Training Loss: 0.01486428, Training R2: 0.652519
Validation Loss: 0.01580554, Validation R2: 0.605612
Saved best model with validation R2 0.605612 to best_finetuned_model.pth

Epoch 46/1000
Training Loss: 0.01201370, Training R2: 0.758008
Validation Loss: 0.02375432, Validation R2: 0.328206

Epoch 47/1000
Training Loss: 0.01571779, Training R2: 0.635116
Validation Loss: 0.01587904, Validation R2: 0.478130

Epoch 48/1000
Training Loss: 0.01736670, Training R2: 0.569282
Validation Loss: 0.01649039, Validation R2: 0.429051

Epoch 49/1000
Training Loss: 0.01697860, Training R2: 0.602296
Validation Loss: 0.01382893, Validation R2: 0.581711

Epoch 50/1000
Training Loss: 0.01770076, Training R2: 0.570046
Validation Loss: 0.02265790, Validation R2: 0.195604

Epoch 51/1000
Training Loss: 0.02033854, Training R2: 0.449857
Validation Loss: 0.01371277, Validation R2: 0.582840

Epoch 52/1000
Training Loss: 0.01751664, Training R2: 0.513953
Validation Loss: 0.03169468, Validation R2: -0.060842

Epoch 53/1000
Training Loss: 0.02842009, Training R2: -0.039860
Validation Loss: 0.06674197, Validation R2: -3.029450

Epoch 54/1000
Training Loss: 0.05698377, Training R2: -2.681949
Validation Loss: 0.11694683, Validation R2: -11.006915

Epoch 55/1000
Training Loss: 0.07335319, Training R2: -5.146813
Validation Loss: 0.02866480, Validation R2: 0.081450

Epoch 56/1000
Training Loss: 0.05994443, Training R2: -3.091724
Validation Loss: 0.06997302, Validation R2: -3.545706

Epoch 57/1000
Training Loss: 0.07872021, Training R2: -5.296758
Validation Loss: 0.08556991, Validation R2: -5.747320

Epoch 58/1000
Training Loss: 0.05916982, Training R2: -3.255507
Validation Loss: 0.08787526, Validation R2: -6.031545

Epoch 59/1000
Training Loss: 0.06680718, Training R2: -3.841623
Validation Loss: 0.07174128, Validation R2: -3.841608

Epoch 60/1000
Training Loss: 0.04989457, Training R2: -1.917907
Validation Loss: 0.04393002, Validation R2: -1.126911

Epoch 61/1000
Training Loss: 0.03581621, Training R2: -0.684477
Validation Loss: 0.02520306, Validation R2: 0.236986

Epoch 62/1000
Training Loss: 0.03778583, Training R2: -0.661639
Validation Loss: 0.03156867, Validation R2: -0.127632

Epoch 63/1000
Training Loss: 0.02239378, Training R2: 0.347606
Validation Loss: 0.01585026, Validation R2: 0.532498

Epoch 64/1000
Training Loss: 0.01592344, Training R2: 0.631603
Validation Loss: 0.01696294, Validation R2: 0.445647

Epoch 65/1000
Training Loss: 0.01472415, Training R2: 0.692377
Validation Loss: 0.01353839, Validation R2: 0.658577
Saved best model with validation R2 0.658577 to best_finetuned_model.pth

Epoch 66/1000
Training Loss: 0.01640461, Training R2: 0.625111
Validation Loss: 0.02842796, Validation R2: -0.010260

Epoch 67/1000
Training Loss: 0.01602817, Training R2: 0.629685
Validation Loss: 0.01572698, Validation R2: 0.612955

Epoch 68/1000
Training Loss: 0.01537449, Training R2: 0.695285
Validation Loss: 0.01384885, Validation R2: 0.633561

Epoch 69/1000
Training Loss: 0.00974570, Training R2: 0.850906
Validation Loss: 0.02131214, Validation R2: 0.287713

Epoch 70/1000
Training Loss: 0.01460421, Training R2: 0.714269
Validation Loss: 0.01174858, Validation R2: 0.684284
Saved best model with validation R2 0.684284 to best_finetuned_model.pth

Epoch 71/1000
Training Loss: 0.01594038, Training R2: 0.641509
Validation Loss: 0.01304919, Validation R2: 0.610960

Epoch 72/1000
Training Loss: 0.01413894, Training R2: 0.715243
Validation Loss: 0.02123170, Validation R2: 0.429362

Epoch 73/1000
Training Loss: 0.01517888, Training R2: 0.707561
Validation Loss: 0.01262661, Validation R2: 0.627312

Epoch 74/1000
Training Loss: 0.01537377, Training R2: 0.681084
Validation Loss: 0.02289239, Validation R2: 0.359019

Epoch 75/1000
Training Loss: 0.01703861, Training R2: 0.635104
Validation Loss: 0.01826729, Validation R2: 0.446413

Epoch 76/1000
Training Loss: 0.01058213, Training R2: 0.844278
Validation Loss: 0.02765717, Validation R2: 0.036926

Epoch 77/1000
Training Loss: 0.01575092, Training R2: 0.653192
Validation Loss: 0.01253013, Validation R2: 0.670792

Epoch 78/1000
Training Loss: 0.01526833, Training R2: 0.667620
Validation Loss: 0.03799928, Validation R2: -0.435936

Epoch 79/1000
Training Loss: 0.03220724, Training R2: -0.260870
Validation Loss: 0.03332866, Validation R2: -0.159863

Epoch 80/1000
Training Loss: 0.02929020, Training R2: 0.076221
Validation Loss: 0.03899006, Validation R2: -0.493992

Epoch 81/1000
Training Loss: 0.03610926, Training R2: -0.342883
Validation Loss: 0.02014519, Validation R2: 0.461101

Epoch 82/1000
Training Loss: 0.02021132, Training R2: 0.501798
Validation Loss: 0.02693615, Validation R2: 0.182010

Epoch 83/1000
Training Loss: 0.01608663, Training R2: 0.646551
Validation Loss: 0.01181200, Validation R2: 0.673052

Epoch 84/1000
Training Loss: 0.01503096, Training R2: 0.659910
Validation Loss: 0.03607167, Validation R2: -0.428782

Epoch 85/1000
Training Loss: 0.03607976, Training R2: -0.456848
Validation Loss: 0.01214885, Validation R2: 0.667961

Epoch 86/1000
Training Loss: 0.04117960, Training R2: -1.166860
Validation Loss: 0.03356789, Validation R2: -0.141878

Epoch 87/1000
Training Loss: 0.02478092, Training R2: 0.234107
Validation Loss: 0.04393014, Validation R2: -0.838640

Epoch 88/1000
Training Loss: 0.03587644, Training R2: -0.304032
Validation Loss: 0.02428461, Validation R2: 0.313323

Epoch 89/1000
Training Loss: 0.02689694, Training R2: 0.186239
Validation Loss: 0.03083856, Validation R2: 0.014029

Epoch 90/1000
Training Loss: 0.02703219, Training R2: 0.235940
Validation Loss: 0.03342934, Validation R2: -0.133695

Epoch 91/1000
Epoch 00091: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.03142159, Training R2: -0.015654
Validation Loss: 0.02275449, Validation R2: 0.368089

Epoch 92/1000
学习率已减少 1 次
Training Loss: 0.01685535, Training R2: 0.643063
Validation Loss: 0.01310582, Validation R2: 0.659476

Epoch 93/1000
Training Loss: 0.01228128, Training R2: 0.787643
Validation Loss: 0.02133058, Validation R2: 0.320605

Epoch 94/1000
Training Loss: 0.01480246, Training R2: 0.714046
Validation Loss: 0.02409190, Validation R2: 0.211078

Epoch 95/1000
Training Loss: 0.01842499, Training R2: 0.613296
Validation Loss: 0.01216678, Validation R2: 0.652106

Epoch 96/1000
Training Loss: 0.01040315, Training R2: 0.849682
Validation Loss: 0.01332705, Validation R2: 0.617714

Epoch 97/1000
Training Loss: 0.00928045, Training R2: 0.879507
Validation Loss: 0.01440620, Validation R2: 0.585921

Epoch 98/1000
Training Loss: 0.00914642, Training R2: 0.883059
Validation Loss: 0.01118251, Validation R2: 0.694907
Saved best model with validation R2 0.694907 to best_finetuned_model.pth

Epoch 99/1000
Training Loss: 0.00758494, Training R2: 0.916339
Validation Loss: 0.01472289, Validation R2: 0.634129

Epoch 100/1000
Training Loss: 0.00849724, Training R2: 0.894264
Validation Loss: 0.01154897, Validation R2: 0.673505

Epoch 101/1000
Training Loss: 0.00908358, Training R2: 0.887698
Validation Loss: 0.01706431, Validation R2: 0.489993

Epoch 102/1000
Training Loss: 0.01217047, Training R2: 0.806589
Validation Loss: 0.02777197, Validation R2: 0.039324

Epoch 103/1000
Training Loss: 0.01931738, Training R2: 0.538723
Validation Loss: 0.01167685, Validation R2: 0.698947
Saved best model with validation R2 0.698947 to best_finetuned_model.pth

Epoch 104/1000
Training Loss: 0.01523538, Training R2: 0.711374
Validation Loss: 0.01925890, Validation R2: 0.508245

Epoch 105/1000
Training Loss: 0.01294654, Training R2: 0.798794
Validation Loss: 0.01280478, Validation R2: 0.687025

Epoch 106/1000
Training Loss: 0.01296641, Training R2: 0.797517
Validation Loss: 0.02040184, Validation R2: 0.477730

Epoch 107/1000
Training Loss: 0.01320928, Training R2: 0.788922
Validation Loss: 0.01198673, Validation R2: 0.709953
Saved best model with validation R2 0.709953 to best_finetuned_model.pth

Epoch 108/1000
Training Loss: 0.00960571, Training R2: 0.873655
Validation Loss: 0.01195212, Validation R2: 0.709336

Epoch 109/1000
Training Loss: 0.01590115, Training R2: 0.702884
Validation Loss: 0.01440483, Validation R2: 0.646998

Epoch 110/1000
Training Loss: 0.01284182, Training R2: 0.805822
Validation Loss: 0.01730933, Validation R2: 0.563268

Epoch 111/1000
Training Loss: 0.01418162, Training R2: 0.770021
Validation Loss: 0.01786971, Validation R2: 0.545336

Epoch 112/1000
Training Loss: 0.01175362, Training R2: 0.820824
Validation Loss: 0.01145651, Validation R2: 0.702398

Epoch 113/1000
Training Loss: 0.00859140, Training R2: 0.896595
Validation Loss: 0.01212825, Validation R2: 0.639702

Epoch 114/1000
Training Loss: 0.00827185, Training R2: 0.908094
Validation Loss: 0.01091673, Validation R2: 0.696152

Epoch 115/1000
Training Loss: 0.00540663, Training R2: 0.955317
Validation Loss: 0.01197457, Validation R2: 0.695052

Epoch 116/1000
Training Loss: 0.00728844, Training R2: 0.927864
Validation Loss: 0.01510328, Validation R2: 0.560042

Epoch 117/1000
Training Loss: 0.00821230, Training R2: 0.907587
Validation Loss: 0.01181856, Validation R2: 0.657607

Epoch 118/1000
Training Loss: 0.01396711, Training R2: 0.771971
Validation Loss: 0.02330471, Validation R2: 0.258986

Epoch 119/1000
Training Loss: 0.01267603, Training R2: 0.794939
Validation Loss: 0.01093866, Validation R2: 0.676972

Epoch 120/1000
Training Loss: 0.01255558, Training R2: 0.800663
Validation Loss: 0.02641106, Validation R2: 0.122429

Epoch 121/1000
Training Loss: 0.01587372, Training R2: 0.683015
Validation Loss: 0.02847577, Validation R2: 0.025944

Epoch 122/1000
Training Loss: 0.02206000, Training R2: 0.432977
Validation Loss: 0.04322718, Validation R2: -0.742263

Epoch 123/1000
Training Loss: 0.02978449, Training R2: 0.045542
Validation Loss: 0.01993198, Validation R2: 0.368840

Epoch 124/1000
Training Loss: 0.02562703, Training R2: 0.283962
Validation Loss: 0.02260591, Validation R2: 0.245996

Epoch 125/1000
Training Loss: 0.02040137, Training R2: 0.485814
Validation Loss: 0.03290645, Validation R2: -0.112620

Epoch 126/1000
Training Loss: 0.02623550, Training R2: 0.188638
Validation Loss: 0.02733509, Validation R2: 0.045160

Epoch 127/1000
Training Loss: 0.02609748, Training R2: 0.288203
Validation Loss: 0.02010029, Validation R2: 0.370249

Epoch 128/1000
Epoch 00128: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01555334, Training R2: 0.684155
Validation Loss: 0.01233176, Validation R2: 0.679071

Epoch 129/1000
学习率已减少 2 次
Training Loss: 0.00856890, Training R2: 0.901343
Validation Loss: 0.01254169, Validation R2: 0.674955

Epoch 130/1000
Training Loss: 0.00795132, Training R2: 0.913740
Validation Loss: 0.01011026, Validation R2: 0.716805
Saved best model with validation R2 0.716805 to best_finetuned_model.pth

Epoch 131/1000
Training Loss: 0.00599853, Training R2: 0.944612
Validation Loss: 0.01069797, Validation R2: 0.690659

Epoch 132/1000
Training Loss: 0.00642820, Training R2: 0.941969
Validation Loss: 0.00974436, Validation R2: 0.725248
Saved best model with validation R2 0.725248 to best_finetuned_model.pth

Epoch 133/1000
Training Loss: 0.00498146, Training R2: 0.963415
Validation Loss: 0.00964641, Validation R2: 0.733918
Saved best model with validation R2 0.733918 to best_finetuned_model.pth

Epoch 134/1000
Training Loss: 0.00492643, Training R2: 0.963747
Validation Loss: 0.00962588, Validation R2: 0.735335
Saved best model with validation R2 0.735335 to best_finetuned_model.pth

Epoch 135/1000
Training Loss: 0.00464402, Training R2: 0.968049
Validation Loss: 0.00962582, Validation R2: 0.734000

Epoch 136/1000
Training Loss: 0.00440631, Training R2: 0.970300
Validation Loss: 0.00988469, Validation R2: 0.738040
Saved best model with validation R2 0.738040 to best_finetuned_model.pth

Epoch 137/1000
Training Loss: 0.00435664, Training R2: 0.970712
Validation Loss: 0.00999933, Validation R2: 0.740077
Saved best model with validation R2 0.740077 to best_finetuned_model.pth

Epoch 138/1000
Training Loss: 0.00450408, Training R2: 0.970399
Validation Loss: 0.00957755, Validation R2: 0.741649
Saved best model with validation R2 0.741649 to best_finetuned_model.pth

Epoch 139/1000
Training Loss: 0.00404420, Training R2: 0.974829
Validation Loss: 0.00993754, Validation R2: 0.716932

Epoch 140/1000
Training Loss: 0.00395548, Training R2: 0.975917
Validation Loss: 0.00964382, Validation R2: 0.724545

Epoch 141/1000
Training Loss: 0.00418562, Training R2: 0.973491
Validation Loss: 0.00984778, Validation R2: 0.731655

Epoch 142/1000
Training Loss: 0.00352034, Training R2: 0.979678
Validation Loss: 0.00968615, Validation R2: 0.722862

Epoch 143/1000
Training Loss: 0.00344460, Training R2: 0.980390
Validation Loss: 0.00974395, Validation R2: 0.733425

Epoch 144/1000
Training Loss: 0.00368918, Training R2: 0.978948
Validation Loss: 0.01005771, Validation R2: 0.711566

Epoch 145/1000
Training Loss: 0.00361134, Training R2: 0.979414
Validation Loss: 0.00956302, Validation R2: 0.731606

Epoch 146/1000
Training Loss: 0.00410904, Training R2: 0.975041
Validation Loss: 0.00966733, Validation R2: 0.737075

Epoch 147/1000
Training Loss: 0.00314814, Training R2: 0.983087
Validation Loss: 0.00973269, Validation R2: 0.728419

Epoch 148/1000
Training Loss: 0.00316452, Training R2: 0.982651
Validation Loss: 0.01017032, Validation R2: 0.701007

Epoch 149/1000
Training Loss: 0.00362681, Training R2: 0.979888
Validation Loss: 0.00987998, Validation R2: 0.726231

Epoch 150/1000
Training Loss: 0.00302764, Training R2: 0.984357
Validation Loss: 0.00993472, Validation R2: 0.731319

Epoch 151/1000
Training Loss: 0.00357527, Training R2: 0.980804
Validation Loss: 0.00963356, Validation R2: 0.722024

Epoch 152/1000
Training Loss: 0.00365791, Training R2: 0.980048
Validation Loss: 0.00954499, Validation R2: 0.732702

Epoch 153/1000
Training Loss: 0.00377779, Training R2: 0.978436
Validation Loss: 0.00945776, Validation R2: 0.729231

Epoch 154/1000
Training Loss: 0.00326197, Training R2: 0.982467
Validation Loss: 0.00948833, Validation R2: 0.719055

Epoch 155/1000
Training Loss: 0.00345499, Training R2: 0.982081
Validation Loss: 0.00955308, Validation R2: 0.722593

Epoch 156/1000
Training Loss: 0.00300100, Training R2: 0.985569
Validation Loss: 0.00988930, Validation R2: 0.736764

Epoch 157/1000
Training Loss: 0.00333530, Training R2: 0.983439
Validation Loss: 0.01014021, Validation R2: 0.734073

Epoch 158/1000
Training Loss: 0.00371749, Training R2: 0.980156
Validation Loss: 0.00953275, Validation R2: 0.721720

Epoch 159/1000
Epoch 00159: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00368523, Training R2: 0.980931
Validation Loss: 0.00941480, Validation R2: 0.735625

Epoch 160/1000
学习率已减少 3 次
Training Loss: 0.00252001, Training R2: 0.989298
Validation Loss: 0.00936746, Validation R2: 0.735717

Epoch 161/1000
Training Loss: 0.00230960, Training R2: 0.990565
Validation Loss: 0.00952750, Validation R2: 0.736214

Epoch 162/1000
Training Loss: 0.00233032, Training R2: 0.990519
Validation Loss: 0.00945608, Validation R2: 0.732269

Epoch 163/1000
Training Loss: 0.00237508, Training R2: 0.990372
Validation Loss: 0.00943934, Validation R2: 0.730490

Epoch 164/1000
Training Loss: 0.00240126, Training R2: 0.989996
Validation Loss: 0.00955408, Validation R2: 0.721488

Epoch 165/1000
Training Loss: 0.00268301, Training R2: 0.989064
Validation Loss: 0.00956859, Validation R2: 0.720144

Epoch 166/1000
Training Loss: 0.00242841, Training R2: 0.990127
Validation Loss: 0.00945643, Validation R2: 0.734008

Epoch 167/1000
Training Loss: 0.00212477, Training R2: 0.991965
Validation Loss: 0.00945768, Validation R2: 0.735721

Epoch 168/1000
Training Loss: 0.00233041, Training R2: 0.990579
Validation Loss: 0.00952792, Validation R2: 0.722420

Epoch 169/1000
Training Loss: 0.00281118, Training R2: 0.988515
Validation Loss: 0.00987015, Validation R2: 0.712131

Epoch 170/1000
Training Loss: 0.00348309, Training R2: 0.983220
Validation Loss: 0.01061278, Validation R2: 0.690669

Epoch 171/1000
Training Loss: 0.00460134, Training R2: 0.975346
Validation Loss: 0.00967418, Validation R2: 0.715126

Epoch 172/1000
Training Loss: 0.00308615, Training R2: 0.987103
Validation Loss: 0.00953784, Validation R2: 0.723075

Epoch 173/1000
Training Loss: 0.00224295, Training R2: 0.991597
Validation Loss: 0.00946697, Validation R2: 0.726269

Epoch 174/1000
Training Loss: 0.00224219, Training R2: 0.991659
Validation Loss: 0.00990984, Validation R2: 0.733460

Epoch 175/1000
Training Loss: 0.00259911, Training R2: 0.989453
Validation Loss: 0.00954719, Validation R2: 0.733937

Epoch 176/1000
Training Loss: 0.00257108, Training R2: 0.989674
Validation Loss: 0.00947225, Validation R2: 0.733035

Epoch 177/1000
Training Loss: 0.00391076, Training R2: 0.980859
Validation Loss: 0.01046782, Validation R2: 0.725842

Epoch 178/1000
Training Loss: 0.00391723, Training R2: 0.981599
Validation Loss: 0.00962616, Validation R2: 0.730507

Epoch 179/1000
Training Loss: 0.00256563, Training R2: 0.989585
Validation Loss: 0.00945760, Validation R2: 0.728311

Epoch 180/1000
Epoch 00180: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00222814, Training R2: 0.991840
Validation Loss: 0.00937789, Validation R2: 0.733570

Epoch 181/1000
学习率已减少 4 次
Training Loss: 0.00174226, Training R2: 0.994226
Validation Loss: 0.00942485, Validation R2: 0.734489

Epoch 182/1000
Training Loss: 0.00172140, Training R2: 0.994353
Validation Loss: 0.00941312, Validation R2: 0.730460

Epoch 183/1000
Training Loss: 0.00163478, Training R2: 0.994656
Validation Loss: 0.00945091, Validation R2: 0.729769

Epoch 184/1000
Training Loss: 0.00159804, Training R2: 0.994777
Validation Loss: 0.00945441, Validation R2: 0.732020

Epoch 185/1000
Training Loss: 0.00155677, Training R2: 0.994820
Validation Loss: 0.00938041, Validation R2: 0.734409

Epoch 186/1000
Training Loss: 0.00148996, Training R2: 0.995041
Validation Loss: 0.00930800, Validation R2: 0.733201

Epoch 187/1000
Training Loss: 0.00144759, Training R2: 0.995246
Validation Loss: 0.00941106, Validation R2: 0.735145

Epoch 188/1000
Training Loss: 0.00153159, Training R2: 0.995009
Validation Loss: 0.00937287, Validation R2: 0.733733

Epoch 189/1000
Training Loss: 0.00150241, Training R2: 0.995215
Validation Loss: 0.00935910, Validation R2: 0.729505

Epoch 190/1000
Training Loss: 0.00154677, Training R2: 0.994980
Validation Loss: 0.00935480, Validation R2: 0.730140

Epoch 191/1000
Training Loss: 0.00154144, Training R2: 0.995204
Validation Loss: 0.00943343, Validation R2: 0.737222

Epoch 192/1000
Training Loss: 0.00154815, Training R2: 0.995017
Validation Loss: 0.00942754, Validation R2: 0.736727

Epoch 193/1000
Training Loss: 0.00144606, Training R2: 0.995482
Validation Loss: 0.00933678, Validation R2: 0.733230

Epoch 194/1000
Training Loss: 0.00145514, Training R2: 0.995431
Validation Loss: 0.00938470, Validation R2: 0.727497

Epoch 195/1000
Training Loss: 0.00150892, Training R2: 0.995331
Validation Loss: 0.00943876, Validation R2: 0.733158

Epoch 196/1000
Training Loss: 0.00140523, Training R2: 0.995636
Validation Loss: 0.00935242, Validation R2: 0.733391

Epoch 197/1000
Training Loss: 0.00131520, Training R2: 0.995862
Validation Loss: 0.00931140, Validation R2: 0.731726

Epoch 198/1000
Training Loss: 0.00136232, Training R2: 0.995790
Validation Loss: 0.00933960, Validation R2: 0.731456

Epoch 199/1000
Training Loss: 0.00137960, Training R2: 0.995798
Validation Loss: 0.00941597, Validation R2: 0.732961

Epoch 200/1000
Training Loss: 0.00134844, Training R2: 0.995877
Validation Loss: 0.00934846, Validation R2: 0.727787

Epoch 201/1000
Epoch 00201: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00131857, Training R2: 0.996036
Validation Loss: 0.00934823, Validation R2: 0.733382

Epoch 202/1000
学习率已减少 5 次
Training Loss: 0.00118660, Training R2: 0.996267
Validation Loss: 0.00930345, Validation R2: 0.732229

Epoch 203/1000
Training Loss: 0.00114823, Training R2: 0.996340
Validation Loss: 0.00932298, Validation R2: 0.731610

Epoch 204/1000
Training Loss: 0.00118587, Training R2: 0.996284
Validation Loss: 0.00932833, Validation R2: 0.731686

Epoch 205/1000
Training Loss: 0.00114003, Training R2: 0.996462
Validation Loss: 0.00937581, Validation R2: 0.734581

Epoch 206/1000
Training Loss: 0.00133577, Training R2: 0.995993
Validation Loss: 0.00937028, Validation R2: 0.735946

Epoch 207/1000
Training Loss: 0.00138659, Training R2: 0.995854
Validation Loss: 0.00931920, Validation R2: 0.735561

Epoch 208/1000
Training Loss: 0.00117827, Training R2: 0.996354
Validation Loss: 0.00937524, Validation R2: 0.736333

Epoch 209/1000
Training Loss: 0.00135454, Training R2: 0.996071
Validation Loss: 0.00937160, Validation R2: 0.735642

Epoch 210/1000
Training Loss: 0.00129864, Training R2: 0.996132
Validation Loss: 0.00931570, Validation R2: 0.734036

Epoch 211/1000
Training Loss: 0.00117429, Training R2: 0.996341
Validation Loss: 0.00931273, Validation R2: 0.734288

Epoch 212/1000
Training Loss: 0.00111309, Training R2: 0.996535
Validation Loss: 0.00929688, Validation R2: 0.734269

Epoch 213/1000
Training Loss: 0.00113080, Training R2: 0.996406
Validation Loss: 0.00927287, Validation R2: 0.733081

Epoch 214/1000
Training Loss: 0.00117120, Training R2: 0.996439
Validation Loss: 0.00928493, Validation R2: 0.731015

Epoch 215/1000
Training Loss: 0.00129736, Training R2: 0.996219
Validation Loss: 0.00932198, Validation R2: 0.728604

Epoch 216/1000
Training Loss: 0.00131607, Training R2: 0.996180
Validation Loss: 0.00928969, Validation R2: 0.731507

Epoch 217/1000
Training Loss: 0.00106674, Training R2: 0.996659
Validation Loss: 0.00928268, Validation R2: 0.732131

Epoch 218/1000
Training Loss: 0.00110500, Training R2: 0.996565
Validation Loss: 0.00926111, Validation R2: 0.733538

Epoch 219/1000
Training Loss: 0.00109056, Training R2: 0.996645
Validation Loss: 0.00928604, Validation R2: 0.731768

Epoch 220/1000
Training Loss: 0.00123921, Training R2: 0.996386
Validation Loss: 0.00930966, Validation R2: 0.730907

Epoch 221/1000
Training Loss: 0.00122949, Training R2: 0.996447
Validation Loss: 0.00933067, Validation R2: 0.729847

Epoch 222/1000
Epoch 00222: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00136094, Training R2: 0.996021
Validation Loss: 0.00931848, Validation R2: 0.729473

Epoch 223/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_HOMO_energy.png
