Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 2337411

Epoch 1/1000
Training Loss: 0.46991358, Training R2: -467.733882
Validation Loss: 0.02640211, Validation R2: -0.161786
Saved best model with validation R2 -0.161786 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.08676267, Training R2: -10.282300
Validation Loss: 0.22123940, Validation R2: -42.109193

Epoch 3/1000
Training Loss: 0.15096003, Training R2: -23.172196
Validation Loss: 0.13382939, Validation R2: -15.483942

Epoch 4/1000
Training Loss: 0.08670210, Training R2: -8.144215
Validation Loss: 0.04601153, Validation R2: -1.623147

Epoch 5/1000
Training Loss: 0.04193449, Training R2: -1.294774
Validation Loss: 0.03023035, Validation R2: -0.284352

Epoch 6/1000
Training Loss: 0.03405202, Training R2: -0.619983
Validation Loss: 0.04259854, Validation R2: -1.252127

Epoch 7/1000
Training Loss: 0.04128960, Training R2: -1.119281
Validation Loss: 0.04305254, Validation R2: -1.305816

Epoch 8/1000
Training Loss: 0.04075252, Training R2: -1.163237
Validation Loss: 0.02593223, Validation R2: 0.000913
Saved best model with validation R2 0.000913 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.02926621, Training R2: -0.194909
Validation Loss: 0.03773640, Validation R2: -0.849177

Epoch 10/1000
Training Loss: 0.03935416, Training R2: -1.011706
Validation Loss: 0.04082872, Validation R2: -1.072940

Epoch 11/1000
Training Loss: 0.03793529, Training R2: -0.881738
Validation Loss: 0.03959507, Validation R2: -0.974371

Epoch 12/1000
Training Loss: 0.03824833, Training R2: -0.825785
Validation Loss: 0.04648812, Validation R2: -1.529260

Epoch 13/1000
Training Loss: 0.04161850, Training R2: -1.148387
Validation Loss: 0.03219437, Validation R2: -0.432589

Epoch 14/1000
Training Loss: 0.03225153, Training R2: -0.407699
Validation Loss: 0.02296714, Validation R2: 0.138650
Saved best model with validation R2 0.138650 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.02125598, Training R2: 0.273225
Validation Loss: 0.02974535, Validation R2: -0.271846

Epoch 16/1000
Training Loss: 0.02469214, Training R2: 0.072995
Validation Loss: 0.01994770, Validation R2: 0.345223
Saved best model with validation R2 0.345223 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.02177869, Training R2: 0.288586
Validation Loss: 0.02436158, Validation R2: 0.262278

Epoch 18/1000
Training Loss: 0.02243349, Training R2: 0.239972
Validation Loss: 0.01906681, Validation R2: 0.387412
Saved best model with validation R2 0.387412 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.01980597, Training R2: 0.373336
Validation Loss: 0.03778527, Validation R2: -0.762297

Epoch 20/1000
Training Loss: 0.02813810, Training R2: -0.112245
Validation Loss: 0.02330976, Validation R2: 0.131316

Epoch 21/1000
Training Loss: 0.03942449, Training R2: -0.916104
Validation Loss: 0.05985403, Validation R2: -2.597563

Epoch 22/1000
Training Loss: 0.03920171, Training R2: -0.936292
Validation Loss: 0.01915447, Validation R2: 0.364302

Epoch 23/1000
Training Loss: 0.02899939, Training R2: -0.215272
Validation Loss: 0.04795150, Validation R2: -1.488710

Epoch 24/1000
Training Loss: 0.05151049, Training R2: -1.896121
Validation Loss: 0.04003549, Validation R2: -0.859596

Epoch 25/1000
Training Loss: 0.03090292, Training R2: -0.254077
Validation Loss: 0.01937258, Validation R2: 0.338961

Epoch 26/1000
Training Loss: 0.02959339, Training R2: -0.186636
Validation Loss: 0.04380974, Validation R2: -1.130900

Epoch 27/1000
Training Loss: 0.04360501, Training R2: -1.098778
Validation Loss: 0.01824505, Validation R2: 0.421207
Saved best model with validation R2 0.421207 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.02024090, Training R2: 0.365690
Validation Loss: 0.04294548, Validation R2: -0.875216

Epoch 29/1000
Training Loss: 0.03908462, Training R2: -0.829723
Validation Loss: 0.05218867, Validation R2: -1.688660

Epoch 30/1000
Training Loss: 0.04363093, Training R2: -1.386758
Validation Loss: 0.02163773, Validation R2: 0.219593

Epoch 31/1000
Training Loss: 0.05278702, Training R2: -2.428953
Validation Loss: 0.08195727, Validation R2: -5.220244

Epoch 32/1000
Training Loss: 0.05837177, Training R2: -3.225607
Validation Loss: 0.03808969, Validation R2: -0.505951

Epoch 33/1000
Training Loss: 0.04699918, Training R2: -1.479243
Validation Loss: 0.02493947, Validation R2: 0.276976

Epoch 34/1000
Training Loss: 0.02285505, Training R2: 0.241193
Validation Loss: 0.02787971, Validation R2: -0.088834

Epoch 35/1000
Training Loss: 0.02256336, Training R2: 0.271342
Validation Loss: 0.01774744, Validation R2: 0.425466
Saved best model with validation R2 0.425466 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.01806205, Training R2: 0.483170
Validation Loss: 0.03257635, Validation R2: -0.120697

Epoch 37/1000
Training Loss: 0.02370309, Training R2: 0.206279
Validation Loss: 0.01696966, Validation R2: 0.546902
Saved best model with validation R2 0.546902 to best_finetuned_model.pth

Epoch 38/1000
Training Loss: 0.01938195, Training R2: 0.448826
Validation Loss: 0.01628211, Validation R2: 0.563219
Saved best model with validation R2 0.563219 to best_finetuned_model.pth

Epoch 39/1000
Training Loss: 0.01455377, Training R2: 0.630046
Validation Loss: 0.01565354, Validation R2: 0.525344

Epoch 40/1000
Training Loss: 0.01668444, Training R2: 0.560609
Validation Loss: 0.01898470, Validation R2: 0.530438

Epoch 41/1000
Training Loss: 0.01474693, Training R2: 0.636471
Validation Loss: 0.01721600, Validation R2: 0.588623
Saved best model with validation R2 0.588623 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.02172279, Training R2: 0.342464
Validation Loss: 0.01561855, Validation R2: 0.530871

Epoch 43/1000
Training Loss: 0.01798562, Training R2: 0.517101
Validation Loss: 0.01489156, Validation R2: 0.564010

Epoch 44/1000
Training Loss: 0.01927628, Training R2: 0.458377
Validation Loss: 0.03404040, Validation R2: -0.334184

Epoch 45/1000
Training Loss: 0.02503409, Training R2: 0.179889
Validation Loss: 0.01402007, Validation R2: 0.636990
Saved best model with validation R2 0.636990 to best_finetuned_model.pth

Epoch 46/1000
Training Loss: 0.01933986, Training R2: 0.453396
Validation Loss: 0.01979377, Validation R2: 0.511957

Epoch 47/1000
Training Loss: 0.02010346, Training R2: 0.441386
Validation Loss: 0.02685370, Validation R2: 0.080950

Epoch 48/1000
Training Loss: 0.01938533, Training R2: 0.463118
Validation Loss: 0.03468315, Validation R2: -0.213858

Epoch 49/1000
Training Loss: 0.02321530, Training R2: 0.276493
Validation Loss: 0.01776236, Validation R2: 0.545887

Epoch 50/1000
Training Loss: 0.03719869, Training R2: -0.713483
Validation Loss: 0.06090134, Validation R2: -2.415290

Epoch 51/1000
Training Loss: 0.03600370, Training R2: -0.688912
Validation Loss: 0.01614943, Validation R2: 0.616797

Epoch 52/1000
Training Loss: 0.02725591, Training R2: -0.084935
Validation Loss: 0.06220713, Validation R2: -2.525844

Epoch 53/1000
Training Loss: 0.03373594, Training R2: -0.572941
Validation Loss: 0.01678114, Validation R2: 0.595392

Epoch 54/1000
Training Loss: 0.03702707, Training R2: -0.664313
Validation Loss: 0.05579625, Validation R2: -1.874572

Epoch 55/1000
Training Loss: 0.03284136, Training R2: -0.438331
Validation Loss: 0.01397470, Validation R2: 0.672170
Saved best model with validation R2 0.672170 to best_finetuned_model.pth

Epoch 56/1000
Training Loss: 0.02056990, Training R2: 0.346568
Validation Loss: 0.02082503, Validation R2: 0.319225

Epoch 57/1000
Training Loss: 0.01510642, Training R2: 0.628813
Validation Loss: 0.01671063, Validation R2: 0.433955

Epoch 58/1000
Training Loss: 0.01668614, Training R2: 0.597752
Validation Loss: 0.02051323, Validation R2: 0.299230

Epoch 59/1000
Training Loss: 0.01800551, Training R2: 0.546246
Validation Loss: 0.02402222, Validation R2: 0.170139

Epoch 60/1000
Training Loss: 0.01804093, Training R2: 0.541880
Validation Loss: 0.02750870, Validation R2: 0.143106

Epoch 61/1000
Training Loss: 0.01749886, Training R2: 0.549666
Validation Loss: 0.02438607, Validation R2: 0.158736

Epoch 62/1000
Training Loss: 0.01597049, Training R2: 0.616589
Validation Loss: 0.02075324, Validation R2: 0.438728

Epoch 63/1000
Training Loss: 0.01496383, Training R2: 0.677133
Validation Loss: 0.01878413, Validation R2: 0.511556

Epoch 64/1000
Training Loss: 0.01679701, Training R2: 0.626938
Validation Loss: 0.01944225, Validation R2: 0.487034

Epoch 65/1000
Training Loss: 0.01443773, Training R2: 0.701252
Validation Loss: 0.01238784, Validation R2: 0.679070
Saved best model with validation R2 0.679070 to best_finetuned_model.pth

Epoch 66/1000
Training Loss: 0.01300379, Training R2: 0.740315
Validation Loss: 0.01207073, Validation R2: 0.695175
Saved best model with validation R2 0.695175 to best_finetuned_model.pth

Epoch 67/1000
Training Loss: 0.01871404, Training R2: 0.530389
Validation Loss: 0.01225725, Validation R2: 0.682708

Epoch 68/1000
Training Loss: 0.01261245, Training R2: 0.752050
Validation Loss: 0.01386639, Validation R2: 0.625825

Epoch 69/1000
Training Loss: 0.01782060, Training R2: 0.524585
Validation Loss: 0.01485779, Validation R2: 0.603462

Epoch 70/1000
Training Loss: 0.01744351, Training R2: 0.605073
Validation Loss: 0.01560103, Validation R2: 0.609791

Epoch 71/1000
Training Loss: 0.01798263, Training R2: 0.592548
Validation Loss: 0.01708291, Validation R2: 0.567123

Epoch 72/1000
Training Loss: 0.01744650, Training R2: 0.608693
Validation Loss: 0.01304647, Validation R2: 0.650756

Epoch 73/1000
Training Loss: 0.01809395, Training R2: 0.556148
Validation Loss: 0.01765797, Validation R2: 0.457211

Epoch 74/1000
Training Loss: 0.01914038, Training R2: 0.511917
Validation Loss: 0.01746199, Validation R2: 0.540018

Epoch 75/1000
Training Loss: 0.01438656, Training R2: 0.712504
Validation Loss: 0.01242932, Validation R2: 0.644447

Epoch 76/1000
Training Loss: 0.02124526, Training R2: 0.372010
Validation Loss: 0.05021147, Validation R2: -1.414205

Epoch 77/1000
Training Loss: 0.04366806, Training R2: -0.890194
Validation Loss: 0.02075673, Validation R2: 0.407771

Epoch 78/1000
Training Loss: 0.02886592, Training R2: -0.043838
Validation Loss: 0.04308524, Validation R2: -0.873605

Epoch 79/1000
Training Loss: 0.03780745, Training R2: -0.509236
Validation Loss: 0.04257953, Validation R2: -0.882623

Epoch 80/1000
Training Loss: 0.03890100, Training R2: -0.589742
Validation Loss: 0.02248065, Validation R2: 0.229053

Epoch 81/1000
Training Loss: 0.02547368, Training R2: 0.157085
Validation Loss: 0.05114347, Validation R2: -1.593504

Epoch 82/1000
Training Loss: 0.03860922, Training R2: -0.677738
Validation Loss: 0.04062534, Validation R2: -0.766984

Epoch 83/1000
Training Loss: 0.03833867, Training R2: -0.520480
Validation Loss: 0.02278991, Validation R2: 0.227552

Epoch 84/1000
Training Loss: 0.02744923, Training R2: 0.097057
Validation Loss: 0.04043243, Validation R2: -0.736167

Epoch 85/1000
Training Loss: 0.03516588, Training R2: -0.287426
Validation Loss: 0.04282757, Validation R2: -0.901607

Epoch 86/1000
Training Loss: 0.03632589, Training R2: -0.373340
Validation Loss: 0.03302431, Validation R2: -0.233624

Epoch 87/1000
Epoch 00087: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.03212499, Training R2: -0.114736
Validation Loss: 0.03573893, Validation R2: -0.412006

Epoch 88/1000
学习率已减少 1 次
Training Loss: 0.02733630, Training R2: 0.066506
Validation Loss: 0.02927542, Validation R2: 0.072234

Epoch 89/1000
Training Loss: 0.02159217, Training R2: 0.395599
Validation Loss: 0.02003594, Validation R2: 0.479789

Epoch 90/1000
Training Loss: 0.01689623, Training R2: 0.605873
Validation Loss: 0.02146984, Validation R2: 0.310461

Epoch 91/1000
Training Loss: 0.01843582, Training R2: 0.568975
Validation Loss: 0.02159492, Validation R2: 0.298961

Epoch 92/1000
Training Loss: 0.01694805, Training R2: 0.619438
Validation Loss: 0.01684675, Validation R2: 0.466595

Epoch 93/1000
Training Loss: 0.01475045, Training R2: 0.712775
Validation Loss: 0.01368796, Validation R2: 0.579037

Epoch 94/1000
Training Loss: 0.01220748, Training R2: 0.789764
Validation Loss: 0.01783662, Validation R2: 0.434793

Epoch 95/1000
Training Loss: 0.01569572, Training R2: 0.688366
Validation Loss: 0.01545747, Validation R2: 0.521391

Epoch 96/1000
Training Loss: 0.01498268, Training R2: 0.713573
Validation Loss: 0.01633983, Validation R2: 0.500330

Epoch 97/1000
Training Loss: 0.01470919, Training R2: 0.724504
Validation Loss: 0.01746842, Validation R2: 0.459841

Epoch 98/1000
Training Loss: 0.01643926, Training R2: 0.662448
Validation Loss: 0.01440999, Validation R2: 0.576512

Epoch 99/1000
Training Loss: 0.01317673, Training R2: 0.767029
Validation Loss: 0.01426175, Validation R2: 0.583416

Epoch 100/1000
Training Loss: 0.01275699, Training R2: 0.779827
Validation Loss: 0.01957898, Validation R2: 0.394017

Epoch 101/1000
Training Loss: 0.01697678, Training R2: 0.655327
Validation Loss: 0.01512781, Validation R2: 0.542406

Epoch 102/1000
Training Loss: 0.01340946, Training R2: 0.765481
Validation Loss: 0.01394807, Validation R2: 0.583843

Epoch 103/1000
Training Loss: 0.01078078, Training R2: 0.835946
Validation Loss: 0.01181977, Validation R2: 0.653977

Epoch 104/1000
Training Loss: 0.00845449, Training R2: 0.893927
Validation Loss: 0.01306827, Validation R2: 0.669485

Epoch 105/1000
Training Loss: 0.00827478, Training R2: 0.892713
Validation Loss: 0.01093542, Validation R2: 0.696361
Saved best model with validation R2 0.696361 to best_finetuned_model.pth

Epoch 106/1000
Training Loss: 0.00819985, Training R2: 0.898548
Validation Loss: 0.01267593, Validation R2: 0.630933

Epoch 107/1000
Training Loss: 0.00892774, Training R2: 0.882439
Validation Loss: 0.01127065, Validation R2: 0.675713

Epoch 108/1000
Training Loss: 0.00960939, Training R2: 0.867658
Validation Loss: 0.01095043, Validation R2: 0.684063

Epoch 109/1000
Training Loss: 0.01057376, Training R2: 0.834615
Validation Loss: 0.01077299, Validation R2: 0.689840

Epoch 110/1000
Training Loss: 0.01024713, Training R2: 0.845826
Validation Loss: 0.01082774, Validation R2: 0.687070

Epoch 111/1000
Training Loss: 0.00956286, Training R2: 0.867516
Validation Loss: 0.01579724, Validation R2: 0.598363

Epoch 112/1000
Training Loss: 0.01219271, Training R2: 0.798491
Validation Loss: 0.03378752, Validation R2: -0.155774

Epoch 113/1000
Training Loss: 0.02542192, Training R2: 0.220569
Validation Loss: 0.04112615, Validation R2: -0.742456

Epoch 114/1000
Training Loss: 0.03203805, Training R2: -0.169853
Validation Loss: 0.03649219, Validation R2: -0.309818

Epoch 115/1000
Training Loss: 0.02576662, Training R2: 0.247161
Validation Loss: 0.03104565, Validation R2: -0.005881

Epoch 116/1000
Training Loss: 0.02405457, Training R2: 0.308908
Validation Loss: 0.04334299, Validation R2: -0.910791

Epoch 117/1000
Training Loss: 0.03270138, Training R2: -0.178217
Validation Loss: 0.03746869, Validation R2: -0.376162

Epoch 118/1000
Training Loss: 0.02553892, Training R2: 0.228738
Validation Loss: 0.02561493, Validation R2: 0.257547

Epoch 119/1000
Training Loss: 0.02102105, Training R2: 0.457589
Validation Loss: 0.03138046, Validation R2: -0.146498

Epoch 120/1000
Training Loss: 0.02174149, Training R2: 0.412266
Validation Loss: 0.01670675, Validation R2: 0.487316

Epoch 121/1000
Training Loss: 0.01516251, Training R2: 0.699007
Validation Loss: 0.01126579, Validation R2: 0.685544

Epoch 122/1000
Training Loss: 0.00832619, Training R2: 0.887714
Validation Loss: 0.01088991, Validation R2: 0.686910

Epoch 123/1000
Training Loss: 0.00863557, Training R2: 0.888767
Validation Loss: 0.01179439, Validation R2: 0.666348

Epoch 124/1000
Training Loss: 0.00866743, Training R2: 0.885894
Validation Loss: 0.01164183, Validation R2: 0.671968

Epoch 125/1000
Training Loss: 0.01116970, Training R2: 0.829462
Validation Loss: 0.01399508, Validation R2: 0.600891

Epoch 126/1000
Epoch 00126: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.02012491, Training R2: 0.520798
Validation Loss: 0.02198825, Validation R2: 0.300812

Epoch 127/1000
学习率已减少 2 次
Training Loss: 0.01490763, Training R2: 0.707608
Validation Loss: 0.01470877, Validation R2: 0.630517

Epoch 128/1000
Training Loss: 0.01117616, Training R2: 0.825576
Validation Loss: 0.01572543, Validation R2: 0.610235

Epoch 129/1000
Training Loss: 0.01155040, Training R2: 0.826269
Validation Loss: 0.01508612, Validation R2: 0.562809

Epoch 130/1000
Training Loss: 0.01089915, Training R2: 0.841901
Validation Loss: 0.01166481, Validation R2: 0.670187

Epoch 131/1000
Training Loss: 0.00804901, Training R2: 0.905506
Validation Loss: 0.01147567, Validation R2: 0.703055
Saved best model with validation R2 0.703055 to best_finetuned_model.pth

Epoch 132/1000
Training Loss: 0.00765619, Training R2: 0.915174
Validation Loss: 0.01303854, Validation R2: 0.673198

Epoch 133/1000
Training Loss: 0.00773149, Training R2: 0.912581
Validation Loss: 0.01256837, Validation R2: 0.683966

Epoch 134/1000
Training Loss: 0.00739394, Training R2: 0.918815
Validation Loss: 0.01046424, Validation R2: 0.718692
Saved best model with validation R2 0.718692 to best_finetuned_model.pth

Epoch 135/1000
Training Loss: 0.00662669, Training R2: 0.932920
Validation Loss: 0.01035936, Validation R2: 0.714883

Epoch 136/1000
Training Loss: 0.00635819, Training R2: 0.937763
Validation Loss: 0.01048903, Validation R2: 0.707652

Epoch 137/1000
Training Loss: 0.00660176, Training R2: 0.933151
Validation Loss: 0.01060435, Validation R2: 0.700995

Epoch 138/1000
Training Loss: 0.00650089, Training R2: 0.938140
Validation Loss: 0.01006744, Validation R2: 0.721960
Saved best model with validation R2 0.721960 to best_finetuned_model.pth

Epoch 139/1000
Training Loss: 0.00564552, Training R2: 0.948801
Validation Loss: 0.01009618, Validation R2: 0.713306

Epoch 140/1000
Training Loss: 0.00584977, Training R2: 0.945824
Validation Loss: 0.00997956, Validation R2: 0.719059

Epoch 141/1000
Training Loss: 0.00566021, Training R2: 0.948634
Validation Loss: 0.01093549, Validation R2: 0.713868

Epoch 142/1000
Training Loss: 0.00660862, Training R2: 0.934990
Validation Loss: 0.01315171, Validation R2: 0.670884

Epoch 143/1000
Training Loss: 0.00899854, Training R2: 0.893250
Validation Loss: 0.01341427, Validation R2: 0.664841

Epoch 144/1000
Training Loss: 0.00873901, Training R2: 0.895496
Validation Loss: 0.01029539, Validation R2: 0.720548

Epoch 145/1000
Training Loss: 0.00678080, Training R2: 0.929817
Validation Loss: 0.01031426, Validation R2: 0.706824

Epoch 146/1000
Training Loss: 0.00884512, Training R2: 0.894785
Validation Loss: 0.01337006, Validation R2: 0.618902

Epoch 147/1000
Training Loss: 0.00897260, Training R2: 0.889218
Validation Loss: 0.01346465, Validation R2: 0.615072

Epoch 148/1000
Training Loss: 0.00952573, Training R2: 0.880473
Validation Loss: 0.00993531, Validation R2: 0.722564
Saved best model with validation R2 0.722564 to best_finetuned_model.pth

Epoch 149/1000
Training Loss: 0.00663559, Training R2: 0.935303
Validation Loss: 0.01098788, Validation R2: 0.710567

Epoch 150/1000
Training Loss: 0.00684354, Training R2: 0.930954
Validation Loss: 0.01190530, Validation R2: 0.695609

Epoch 151/1000
Training Loss: 0.00736352, Training R2: 0.925308
Validation Loss: 0.01235929, Validation R2: 0.688731

Epoch 152/1000
Training Loss: 0.00739367, Training R2: 0.925543
Validation Loss: 0.01126223, Validation R2: 0.708239

Epoch 153/1000
Training Loss: 0.00610300, Training R2: 0.943946
Validation Loss: 0.01062276, Validation R2: 0.715449

Epoch 154/1000
Training Loss: 0.00609245, Training R2: 0.945614
Validation Loss: 0.01003238, Validation R2: 0.717261

Epoch 155/1000
Training Loss: 0.00539204, Training R2: 0.953814
Validation Loss: 0.00992843, Validation R2: 0.717687

Epoch 156/1000
Training Loss: 0.00516098, Training R2: 0.956443
Validation Loss: 0.01133774, Validation R2: 0.669336

Epoch 157/1000
Training Loss: 0.00706592, Training R2: 0.929732
Validation Loss: 0.01086184, Validation R2: 0.683412

Epoch 158/1000
Training Loss: 0.00615792, Training R2: 0.943539
Validation Loss: 0.01214118, Validation R2: 0.644145

Epoch 159/1000
Training Loss: 0.00845753, Training R2: 0.903699
Validation Loss: 0.01241604, Validation R2: 0.637148

Epoch 160/1000
Training Loss: 0.00902084, Training R2: 0.898643
Validation Loss: 0.01041796, Validation R2: 0.699862

Epoch 161/1000
Training Loss: 0.00596653, Training R2: 0.947969
Validation Loss: 0.01001465, Validation R2: 0.715413

Epoch 162/1000
Training Loss: 0.00488977, Training R2: 0.961228
Validation Loss: 0.00993948, Validation R2: 0.717740

Epoch 163/1000
Training Loss: 0.00478355, Training R2: 0.962773
Validation Loss: 0.00987575, Validation R2: 0.716215

Epoch 164/1000
Training Loss: 0.00497001, Training R2: 0.961608
Validation Loss: 0.00990341, Validation R2: 0.715440

Epoch 165/1000
Training Loss: 0.00481478, Training R2: 0.963166
Validation Loss: 0.01023930, Validation R2: 0.716167

Epoch 166/1000
Training Loss: 0.00477817, Training R2: 0.962586
Validation Loss: 0.00996458, Validation R2: 0.711255

Epoch 167/1000
Training Loss: 0.00458037, Training R2: 0.965017
Validation Loss: 0.00984522, Validation R2: 0.719573

Epoch 168/1000
Training Loss: 0.00434453, Training R2: 0.967151
Validation Loss: 0.01001960, Validation R2: 0.721849

Epoch 169/1000
Epoch 00169: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00450677, Training R2: 0.965911
Validation Loss: 0.00977787, Validation R2: 0.721955

Epoch 170/1000
学习率已减少 3 次
Training Loss: 0.00413655, Training R2: 0.969186
Validation Loss: 0.01076652, Validation R2: 0.710909

Epoch 171/1000
Training Loss: 0.00548946, Training R2: 0.955039
Validation Loss: 0.00966426, Validation R2: 0.723743
Saved best model with validation R2 0.723743 to best_finetuned_model.pth

Epoch 172/1000
Training Loss: 0.00504776, Training R2: 0.959453
Validation Loss: 0.00965374, Validation R2: 0.721453

Epoch 173/1000
Training Loss: 0.00420053, Training R2: 0.968798
Validation Loss: 0.00969391, Validation R2: 0.725822
Saved best model with validation R2 0.725822 to best_finetuned_model.pth

Epoch 174/1000
Training Loss: 0.00406447, Training R2: 0.970033
Validation Loss: 0.00974024, Validation R2: 0.724680

Epoch 175/1000
Training Loss: 0.00391699, Training R2: 0.971167
Validation Loss: 0.00973031, Validation R2: 0.720761

Epoch 176/1000
Training Loss: 0.00392857, Training R2: 0.971274
Validation Loss: 0.00977100, Validation R2: 0.714695

Epoch 177/1000
Training Loss: 0.00400670, Training R2: 0.970858
Validation Loss: 0.00967787, Validation R2: 0.721021

Epoch 178/1000
Training Loss: 0.00382125, Training R2: 0.972707
Validation Loss: 0.01017632, Validation R2: 0.720641

Epoch 179/1000
Training Loss: 0.00442841, Training R2: 0.967175
Validation Loss: 0.00967040, Validation R2: 0.724499

Epoch 180/1000
Training Loss: 0.00387351, Training R2: 0.972410
Validation Loss: 0.00973970, Validation R2: 0.722713

Epoch 181/1000
Training Loss: 0.00378922, Training R2: 0.972621
Validation Loss: 0.00986606, Validation R2: 0.710938

Epoch 182/1000
Training Loss: 0.00417453, Training R2: 0.970187
Validation Loss: 0.00970295, Validation R2: 0.717971

Epoch 183/1000
Training Loss: 0.00367069, Training R2: 0.973792
Validation Loss: 0.00969333, Validation R2: 0.715874

Epoch 184/1000
Training Loss: 0.00377316, Training R2: 0.972837
Validation Loss: 0.00976961, Validation R2: 0.720853

Epoch 185/1000
Training Loss: 0.00353481, Training R2: 0.974819
Validation Loss: 0.00962528, Validation R2: 0.721455

Epoch 186/1000
Training Loss: 0.00371718, Training R2: 0.973693
Validation Loss: 0.00984213, Validation R2: 0.723369

Epoch 187/1000
Training Loss: 0.00359514, Training R2: 0.974993
Validation Loss: 0.00999334, Validation R2: 0.722491

Epoch 188/1000
Training Loss: 0.00451876, Training R2: 0.968093
Validation Loss: 0.01039920, Validation R2: 0.717192

Epoch 189/1000
Training Loss: 0.00456863, Training R2: 0.967789
Validation Loss: 0.00985499, Validation R2: 0.721052

Epoch 190/1000
Training Loss: 0.00390715, Training R2: 0.971840
Validation Loss: 0.00980816, Validation R2: 0.719995

Epoch 191/1000
Training Loss: 0.00401928, Training R2: 0.970964
Validation Loss: 0.00974491, Validation R2: 0.721288

Epoch 192/1000
Training Loss: 0.00375271, Training R2: 0.973465
Validation Loss: 0.01007293, Validation R2: 0.720697

Epoch 193/1000
Training Loss: 0.00444995, Training R2: 0.968679
Validation Loss: 0.00998498, Validation R2: 0.722587

Epoch 194/1000
Epoch 00194: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00470552, Training R2: 0.965349
Validation Loss: 0.01017828, Validation R2: 0.721306

Epoch 195/1000
学习率已减少 4 次
Training Loss: 0.00403970, Training R2: 0.971566
Validation Loss: 0.00999698, Validation R2: 0.723183

Epoch 196/1000
Training Loss: 0.00402465, Training R2: 0.971523
Validation Loss: 0.00969960, Validation R2: 0.712292

Epoch 197/1000
Training Loss: 0.00393027, Training R2: 0.973498
Validation Loss: 0.00979321, Validation R2: 0.721630

Epoch 198/1000
Training Loss: 0.00394710, Training R2: 0.973341
Validation Loss: 0.01001481, Validation R2: 0.719860

Epoch 199/1000
Training Loss: 0.00354807, Training R2: 0.975942
Validation Loss: 0.00960769, Validation R2: 0.719959

Epoch 200/1000
Training Loss: 0.00331079, Training R2: 0.977825
Validation Loss: 0.00961571, Validation R2: 0.723618

Epoch 201/1000
Training Loss: 0.00323695, Training R2: 0.978147
Validation Loss: 0.00959411, Validation R2: 0.723487

Epoch 202/1000
Training Loss: 0.00319568, Training R2: 0.978356
Validation Loss: 0.00954183, Validation R2: 0.723034

Epoch 203/1000
Training Loss: 0.00319594, Training R2: 0.978249
Validation Loss: 0.00956556, Validation R2: 0.723842

Epoch 204/1000
Training Loss: 0.00319128, Training R2: 0.978272
Validation Loss: 0.00954397, Validation R2: 0.722755

Epoch 205/1000
Training Loss: 0.00318859, Training R2: 0.978387
Validation Loss: 0.00963292, Validation R2: 0.722762

Epoch 206/1000
Training Loss: 0.00310585, Training R2: 0.978815
Validation Loss: 0.00956418, Validation R2: 0.722056

Epoch 207/1000
Training Loss: 0.00312914, Training R2: 0.978836
Validation Loss: 0.00957910, Validation R2: 0.717403

Epoch 208/1000
Training Loss: 0.00341070, Training R2: 0.977469
Validation Loss: 0.00947340, Validation R2: 0.722398

Epoch 209/1000
Training Loss: 0.00320718, Training R2: 0.978181
Validation Loss: 0.00949991, Validation R2: 0.723264

Epoch 210/1000
Training Loss: 0.00305549, Training R2: 0.979190
Validation Loss: 0.00957785, Validation R2: 0.722637

Epoch 211/1000
Training Loss: 0.00313597, Training R2: 0.978734
Validation Loss: 0.00960756, Validation R2: 0.722775

Epoch 212/1000
Training Loss: 0.00317305, Training R2: 0.978517
Validation Loss: 0.00964551, Validation R2: 0.722981

Epoch 213/1000
Training Loss: 0.00312971, Training R2: 0.978925
Validation Loss: 0.00952640, Validation R2: 0.721932

Epoch 214/1000
Training Loss: 0.00303324, Training R2: 0.979260
Validation Loss: 0.00954381, Validation R2: 0.722348

Epoch 215/1000
Epoch 00215: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00303299, Training R2: 0.979409
Validation Loss: 0.00963491, Validation R2: 0.722958

Epoch 216/1000
学习率已减少 5 次
Training Loss: 0.00304178, Training R2: 0.979572
Validation Loss: 0.00955287, Validation R2: 0.723144

Epoch 217/1000
Training Loss: 0.00294632, Training R2: 0.979884
Validation Loss: 0.00955007, Validation R2: 0.723328

Epoch 218/1000
Training Loss: 0.00291716, Training R2: 0.979992
Validation Loss: 0.00956508, Validation R2: 0.723327

Epoch 219/1000
Training Loss: 0.00290102, Training R2: 0.980161
Validation Loss: 0.00963181, Validation R2: 0.723264

Epoch 220/1000
Training Loss: 0.00294432, Training R2: 0.980055
Validation Loss: 0.00954248, Validation R2: 0.722501

Epoch 221/1000
Training Loss: 0.00292905, Training R2: 0.980035
Validation Loss: 0.00951636, Validation R2: 0.722214

Epoch 222/1000
Training Loss: 0.00284360, Training R2: 0.980412
Validation Loss: 0.00965338, Validation R2: 0.722755

Epoch 223/1000
Training Loss: 0.00296654, Training R2: 0.980012
Validation Loss: 0.00960236, Validation R2: 0.722627

Epoch 224/1000
Training Loss: 0.00291188, Training R2: 0.980114
Validation Loss: 0.00954193, Validation R2: 0.722446

Epoch 225/1000
Training Loss: 0.00288793, Training R2: 0.980185
Validation Loss: 0.00951479, Validation R2: 0.721984

Epoch 226/1000
Training Loss: 0.00282830, Training R2: 0.980624
Validation Loss: 0.00957805, Validation R2: 0.722290

Epoch 227/1000
Training Loss: 0.00280665, Training R2: 0.980603
Validation Loss: 0.00953974, Validation R2: 0.721548

Epoch 228/1000
Training Loss: 0.00282631, Training R2: 0.980486
Validation Loss: 0.00959058, Validation R2: 0.721974

Epoch 229/1000
Training Loss: 0.00280538, Training R2: 0.980648
Validation Loss: 0.00954596, Validation R2: 0.721394

Epoch 230/1000
Training Loss: 0.00278946, Training R2: 0.980642
Validation Loss: 0.00955188, Validation R2: 0.721691

Epoch 231/1000
Training Loss: 0.00278745, Training R2: 0.980831
Validation Loss: 0.00959695, Validation R2: 0.722187

Epoch 232/1000
Training Loss: 0.00278874, Training R2: 0.980817
Validation Loss: 0.00978988, Validation R2: 0.721445

Epoch 233/1000
Training Loss: 0.00300138, Training R2: 0.980327
Validation Loss: 0.00952373, Validation R2: 0.720716

Epoch 234/1000
Training Loss: 0.00291720, Training R2: 0.980521
Validation Loss: 0.00953186, Validation R2: 0.720888

Epoch 235/1000
Training Loss: 0.00280630, Training R2: 0.980728
Validation Loss: 0.00964005, Validation R2: 0.722153

Epoch 236/1000
Epoch 00236: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00279807, Training R2: 0.980833
Validation Loss: 0.00966139, Validation R2: 0.722018

Epoch 237/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_HOMO_energy.png
