Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4564611

Epoch 1/1000
Training Loss: 1.32442057, Training R2: -0.330209
Validation Loss: 1.14414128, Validation R2: 0.111547
Saved best model with validation R2 0.111547 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.01697095, Training R2: 0.206530
Validation Loss: 0.99963764, Validation R2: 0.255904
Saved best model with validation R2 0.255904 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.88840608, Training R2: 0.356258
Validation Loss: 0.91320197, Validation R2: 0.359108
Saved best model with validation R2 0.359108 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.81582509, Training R2: 0.444167
Validation Loss: 0.85357789, Validation R2: 0.432335
Saved best model with validation R2 0.432335 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.78333325, Training R2: 0.485662
Validation Loss: 0.85382855, Validation R2: 0.442022
Saved best model with validation R2 0.442022 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.72976625, Training R2: 0.541444
Validation Loss: 0.77353791, Validation R2: 0.513477
Saved best model with validation R2 0.513477 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.65345192, Training R2: 0.608715
Validation Loss: 0.66161305, Validation R2: 0.618267
Saved best model with validation R2 0.618267 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.63332055, Training R2: 0.622656
Validation Loss: 0.66192524, Validation R2: 0.601302

Epoch 9/1000
Training Loss: 0.56493311, Training R2: 0.681497
Validation Loss: 0.62620500, Validation R2: 0.653126
Saved best model with validation R2 0.653126 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.49969687, Training R2: 0.739479
Validation Loss: 0.53905363, Validation R2: 0.720826
Saved best model with validation R2 0.720826 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.45628745, Training R2: 0.783954
Validation Loss: 0.53524125, Validation R2: 0.743899
Saved best model with validation R2 0.743899 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.43182365, Training R2: 0.808905
Validation Loss: 0.50327688, Validation R2: 0.770461
Saved best model with validation R2 0.770461 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.37472845, Training R2: 0.849769
Validation Loss: 0.48209788, Validation R2: 0.798491
Saved best model with validation R2 0.798491 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.35378546, Training R2: 0.867567
Validation Loss: 0.46239061, Validation R2: 0.815055
Saved best model with validation R2 0.815055 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.32261955, Training R2: 0.886969
Validation Loss: 0.43571688, Validation R2: 0.832334
Saved best model with validation R2 0.832334 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.33526323, Training R2: 0.884771
Validation Loss: 0.57470117, Validation R2: 0.754001

Epoch 17/1000
Training Loss: 0.34138717, Training R2: 0.881165
Validation Loss: 0.40819798, Validation R2: 0.846887
Saved best model with validation R2 0.846887 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.26435176, Training R2: 0.914007
Validation Loss: 0.38893391, Validation R2: 0.857763
Saved best model with validation R2 0.857763 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.26029598, Training R2: 0.917752
Validation Loss: 0.41134716, Validation R2: 0.850503

Epoch 20/1000
Training Loss: 0.25621615, Training R2: 0.922062
Validation Loss: 0.38660305, Validation R2: 0.862001
Saved best model with validation R2 0.862001 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.21097820, Training R2: 0.937679
Validation Loss: 0.36159188, Validation R2: 0.878322
Saved best model with validation R2 0.878322 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.20449402, Training R2: 0.941409
Validation Loss: 0.41900922, Validation R2: 0.848956

Epoch 23/1000
Training Loss: 0.23050851, Training R2: 0.934458
Validation Loss: 0.36872144, Validation R2: 0.871284

Epoch 24/1000
Training Loss: 0.21856766, Training R2: 0.941356
Validation Loss: 0.35915261, Validation R2: 0.881451
Saved best model with validation R2 0.881451 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.19454082, Training R2: 0.947413
Validation Loss: 0.34817521, Validation R2: 0.884816
Saved best model with validation R2 0.884816 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.16862098, Training R2: 0.955888
Validation Loss: 0.36505516, Validation R2: 0.878299

Epoch 27/1000
Training Loss: 0.18854772, Training R2: 0.952435
Validation Loss: 0.37083666, Validation R2: 0.873732

Epoch 28/1000
Training Loss: 0.17065704, Training R2: 0.956463
Validation Loss: 0.36251851, Validation R2: 0.877906

Epoch 29/1000
Training Loss: 0.18305025, Training R2: 0.955130
Validation Loss: 0.34337755, Validation R2: 0.890306
Saved best model with validation R2 0.890306 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.15451985, Training R2: 0.961529
Validation Loss: 0.34840504, Validation R2: 0.886479

Epoch 31/1000
Training Loss: 0.15840917, Training R2: 0.962335
Validation Loss: 0.33625896, Validation R2: 0.892711
Saved best model with validation R2 0.892711 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 0.15748645, Training R2: 0.964238
Validation Loss: 0.32961292, Validation R2: 0.897407
Saved best model with validation R2 0.897407 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.14719323, Training R2: 0.965488
Validation Loss: 0.32837906, Validation R2: 0.898798
Saved best model with validation R2 0.898798 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.14172663, Training R2: 0.966998
Validation Loss: 0.35431837, Validation R2: 0.887514

Epoch 35/1000
Training Loss: 0.16965501, Training R2: 0.961184
Validation Loss: 0.33446606, Validation R2: 0.895098

Epoch 36/1000
Training Loss: 0.12368460, Training R2: 0.971235
Validation Loss: 0.33117939, Validation R2: 0.895422

Epoch 37/1000
Training Loss: 0.12919918, Training R2: 0.971117
Validation Loss: 0.32739739, Validation R2: 0.897763

Epoch 38/1000
Training Loss: 0.12463505, Training R2: 0.971114
Validation Loss: 0.36670334, Validation R2: 0.880166

Epoch 39/1000
Training Loss: 0.19799549, Training R2: 0.956219
Validation Loss: 0.33844664, Validation R2: 0.891487

Epoch 40/1000
Training Loss: 0.13713104, Training R2: 0.969431
Validation Loss: 0.32547949, Validation R2: 0.900364
Saved best model with validation R2 0.900364 to best_finetuned_model.pth

Epoch 41/1000
Training Loss: 0.11513529, Training R2: 0.974112
Validation Loss: 0.33065831, Validation R2: 0.896070

Epoch 42/1000
Training Loss: 0.10609574, Training R2: 0.976147
Validation Loss: 0.31793914, Validation R2: 0.903894
Saved best model with validation R2 0.903894 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.11640914, Training R2: 0.973559
Validation Loss: 0.32246669, Validation R2: 0.902737

Epoch 44/1000
Training Loss: 0.12335031, Training R2: 0.974765
Validation Loss: 0.33096056, Validation R2: 0.894721

Epoch 45/1000
Training Loss: 0.12228753, Training R2: 0.972127
Validation Loss: 0.32641634, Validation R2: 0.899127

Epoch 46/1000
Training Loss: 0.11960597, Training R2: 0.975656
Validation Loss: 0.32510042, Validation R2: 0.900105

Epoch 47/1000
Training Loss: 0.13042344, Training R2: 0.973587
Validation Loss: 0.32239011, Validation R2: 0.902846

Epoch 48/1000
Training Loss: 0.13699341, Training R2: 0.971000
Validation Loss: 0.37472089, Validation R2: 0.879274

Epoch 49/1000
Training Loss: 0.17238230, Training R2: 0.966986
Validation Loss: 0.33943928, Validation R2: 0.894086

Epoch 50/1000
Training Loss: 0.12415585, Training R2: 0.974171
Validation Loss: 0.32394623, Validation R2: 0.898437

Epoch 51/1000
Training Loss: 0.10242155, Training R2: 0.977617
Validation Loss: 0.33179985, Validation R2: 0.896733

Epoch 52/1000
Training Loss: 0.10684170, Training R2: 0.976176
Validation Loss: 0.31713929, Validation R2: 0.903520

Epoch 53/1000
Training Loss: 0.09762355, Training R2: 0.980806
Validation Loss: 0.31301642, Validation R2: 0.906346
Saved best model with validation R2 0.906346 to best_finetuned_model.pth

Epoch 54/1000
Training Loss: 0.09140388, Training R2: 0.980866
Validation Loss: 0.31642416, Validation R2: 0.902936

Epoch 55/1000
Training Loss: 0.08819918, Training R2: 0.981786
Validation Loss: 0.31994014, Validation R2: 0.900414

Epoch 56/1000
Training Loss: 0.09129873, Training R2: 0.981392
Validation Loss: 0.32989525, Validation R2: 0.896569

Epoch 57/1000
Training Loss: 0.09719797, Training R2: 0.981075
Validation Loss: 0.32116537, Validation R2: 0.898660

Epoch 58/1000
Training Loss: 0.11011877, Training R2: 0.978757
Validation Loss: 0.32136270, Validation R2: 0.898546

Epoch 59/1000
Training Loss: 0.09058340, Training R2: 0.981174
Validation Loss: 0.30952869, Validation R2: 0.905535

Epoch 60/1000
Training Loss: 0.08229381, Training R2: 0.982331
Validation Loss: 0.31924129, Validation R2: 0.902561

Epoch 61/1000
Training Loss: 0.10694673, Training R2: 0.979021
Validation Loss: 0.34724319, Validation R2: 0.887148

Epoch 62/1000
Training Loss: 0.13337268, Training R2: 0.973362
Validation Loss: 0.32481098, Validation R2: 0.897559

Epoch 63/1000
Training Loss: 0.12075801, Training R2: 0.977736
Validation Loss: 0.31488044, Validation R2: 0.904043

Epoch 64/1000
Training Loss: 0.10837048, Training R2: 0.981005
Validation Loss: 0.32457776, Validation R2: 0.902477

Epoch 65/1000
Training Loss: 0.08640350, Training R2: 0.982698
Validation Loss: 0.31940052, Validation R2: 0.901562

Epoch 66/1000
Training Loss: 0.08790394, Training R2: 0.983850
Validation Loss: 0.31936033, Validation R2: 0.900286

Epoch 67/1000
Training Loss: 0.07913803, Training R2: 0.984902
Validation Loss: 0.31322691, Validation R2: 0.902641

Epoch 68/1000
Training Loss: 0.07222251, Training R2: 0.985932
Validation Loss: 0.31806464, Validation R2: 0.903987

Epoch 69/1000
Training Loss: 0.07646630, Training R2: 0.986483
Validation Loss: 0.32412114, Validation R2: 0.900022

Epoch 70/1000
Training Loss: 0.07557536, Training R2: 0.986005
Validation Loss: 0.32098322, Validation R2: 0.902232

Epoch 71/1000
Training Loss: 0.07183678, Training R2: 0.986621
Validation Loss: 0.33793097, Validation R2: 0.894281

Epoch 72/1000
Training Loss: 0.08565136, Training R2: 0.985011
Validation Loss: 0.31475303, Validation R2: 0.904437

Epoch 73/1000
Training Loss: 0.07742497, Training R2: 0.986647
Validation Loss: 0.30881973, Validation R2: 0.905771

Epoch 74/1000
Epoch 00074: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.08306216, Training R2: 0.985915
Validation Loss: 0.32250604, Validation R2: 0.899657

Epoch 75/1000
学习率已减少 1 次
Training Loss: 0.07294970, Training R2: 0.987640
Validation Loss: 0.31357482, Validation R2: 0.904933

Epoch 76/1000
Training Loss: 0.05222665, Training R2: 0.989012
Validation Loss: 0.30717538, Validation R2: 0.906800
Saved best model with validation R2 0.906800 to best_finetuned_model.pth

Epoch 77/1000
Training Loss: 0.04134392, Training R2: 0.989761
Validation Loss: 0.30823040, Validation R2: 0.905503

Epoch 78/1000
Training Loss: 0.04480698, Training R2: 0.989872
Validation Loss: 0.30854936, Validation R2: 0.906139

Epoch 79/1000
Training Loss: 0.03934041, Training R2: 0.990332
Validation Loss: 0.30398714, Validation R2: 0.908069
Saved best model with validation R2 0.908069 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.04059589, Training R2: 0.990354
Validation Loss: 0.30556363, Validation R2: 0.906334

Epoch 81/1000
Training Loss: 0.03709169, Training R2: 0.990821
Validation Loss: 0.30359222, Validation R2: 0.908258
Saved best model with validation R2 0.908258 to best_finetuned_model.pth

Epoch 82/1000
Training Loss: 0.03385710, Training R2: 0.990825
Validation Loss: 0.30525049, Validation R2: 0.906556

Epoch 83/1000
Training Loss: 0.03897477, Training R2: 0.990697
Validation Loss: 0.30814213, Validation R2: 0.905746

Epoch 84/1000
Training Loss: 0.03604045, Training R2: 0.990836
Validation Loss: 0.30415670, Validation R2: 0.907740

Epoch 85/1000
Training Loss: 0.03534009, Training R2: 0.990862
Validation Loss: 0.30538454, Validation R2: 0.907610

Epoch 86/1000
Training Loss: 0.03449580, Training R2: 0.990827
Validation Loss: 0.31279704, Validation R2: 0.904485

Epoch 87/1000
Training Loss: 0.03652785, Training R2: 0.991216
Validation Loss: 0.30683207, Validation R2: 0.904905

Epoch 88/1000
Training Loss: 0.03363858, Training R2: 0.990909
Validation Loss: 0.30548762, Validation R2: 0.906042

Epoch 89/1000
Training Loss: 0.03722039, Training R2: 0.990944
Validation Loss: 0.30375646, Validation R2: 0.907029

Epoch 90/1000
Training Loss: 0.04089142, Training R2: 0.990682
Validation Loss: 0.30496154, Validation R2: 0.907930

Epoch 91/1000
Training Loss: 0.03707194, Training R2: 0.990910
Validation Loss: 0.30271921, Validation R2: 0.909500
Saved best model with validation R2 0.909500 to best_finetuned_model.pth

Epoch 92/1000
Training Loss: 0.03629059, Training R2: 0.990973
Validation Loss: 0.31067019, Validation R2: 0.905277

Epoch 93/1000
Training Loss: 0.03417998, Training R2: 0.991114
Validation Loss: 0.30920384, Validation R2: 0.905734

Epoch 94/1000
Training Loss: 0.03820665, Training R2: 0.991086
Validation Loss: 0.31958787, Validation R2: 0.902211

Epoch 95/1000
Training Loss: 0.06416771, Training R2: 0.989308
Validation Loss: 0.30645856, Validation R2: 0.907634

Epoch 96/1000
Training Loss: 0.04541357, Training R2: 0.990652
Validation Loss: 0.30730397, Validation R2: 0.907493

Epoch 97/1000
Training Loss: 0.03997433, Training R2: 0.990886
Validation Loss: 0.31279995, Validation R2: 0.904058

Epoch 98/1000
Training Loss: 0.03761126, Training R2: 0.991191
Validation Loss: 0.30872141, Validation R2: 0.906201

Epoch 99/1000
Training Loss: 0.03897853, Training R2: 0.990887
Validation Loss: 0.30853612, Validation R2: 0.905932

Epoch 100/1000
Training Loss: 0.03663826, Training R2: 0.991024
Validation Loss: 0.30368990, Validation R2: 0.908332

Epoch 101/1000
Training Loss: 0.03648003, Training R2: 0.991161
Validation Loss: 0.30330717, Validation R2: 0.908376

Epoch 102/1000
Training Loss: 0.03678346, Training R2: 0.991132
Validation Loss: 0.30337403, Validation R2: 0.908724

Epoch 103/1000
Training Loss: 0.03335459, Training R2: 0.991437
Validation Loss: 0.30473209, Validation R2: 0.907573

Epoch 104/1000
Training Loss: 0.03516278, Training R2: 0.991224
Validation Loss: 0.30376787, Validation R2: 0.908092

Epoch 105/1000
Training Loss: 0.04679143, Training R2: 0.990743
Validation Loss: 0.31925448, Validation R2: 0.902370

Epoch 106/1000
Training Loss: 0.05681498, Training R2: 0.990368
Validation Loss: 0.31724924, Validation R2: 0.902603

Epoch 107/1000
Training Loss: 0.06112290, Training R2: 0.990128
Validation Loss: 0.31085625, Validation R2: 0.906283

Epoch 108/1000
Training Loss: 0.05849599, Training R2: 0.990434
Validation Loss: 0.31336415, Validation R2: 0.904680

Epoch 109/1000
Training Loss: 0.04296191, Training R2: 0.991294
Validation Loss: 0.30848332, Validation R2: 0.905659

Epoch 110/1000
Training Loss: 0.03309590, Training R2: 0.991711
Validation Loss: 0.30679855, Validation R2: 0.906073

Epoch 111/1000
Training Loss: 0.03216274, Training R2: 0.991945
Validation Loss: 0.30697808, Validation R2: 0.906976

Epoch 112/1000
Epoch 00112: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03211369, Training R2: 0.992125
Validation Loss: 0.30795017, Validation R2: 0.906756

Epoch 113/1000
学习率已减少 2 次
Training Loss: 0.02572870, Training R2: 0.992333
Validation Loss: 0.30490075, Validation R2: 0.907760

Epoch 114/1000
Training Loss: 0.02395435, Training R2: 0.992300
Validation Loss: 0.30580575, Validation R2: 0.906862

Epoch 115/1000
Training Loss: 0.02632510, Training R2: 0.992170
Validation Loss: 0.30597673, Validation R2: 0.908087

Epoch 116/1000
Training Loss: 0.02964830, Training R2: 0.992182
Validation Loss: 0.30696449, Validation R2: 0.906885

Epoch 117/1000
Training Loss: 0.02834712, Training R2: 0.992198
Validation Loss: 0.30647968, Validation R2: 0.907132

Epoch 118/1000
Training Loss: 0.02059852, Training R2: 0.992494
Validation Loss: 0.30482799, Validation R2: 0.907564

Epoch 119/1000
Training Loss: 0.01850388, Training R2: 0.992420
Validation Loss: 0.30534243, Validation R2: 0.907222

Epoch 120/1000
Training Loss: 0.01848621, Training R2: 0.992508
Validation Loss: 0.30541104, Validation R2: 0.907542

Epoch 121/1000
Training Loss: 0.01782125, Training R2: 0.992587
Validation Loss: 0.30705789, Validation R2: 0.906666

Epoch 122/1000
Training Loss: 0.01870405, Training R2: 0.992554
Validation Loss: 0.30617131, Validation R2: 0.907016

Epoch 123/1000
Training Loss: 0.01957725, Training R2: 0.992530
Validation Loss: 0.30782513, Validation R2: 0.906618

Epoch 124/1000
Training Loss: 0.02012398, Training R2: 0.992716
Validation Loss: 0.30862542, Validation R2: 0.906558

Epoch 125/1000
Training Loss: 0.01912675, Training R2: 0.992683
Validation Loss: 0.30545167, Validation R2: 0.907534

Epoch 126/1000
Training Loss: 0.01671032, Training R2: 0.992713
Validation Loss: 0.30470551, Validation R2: 0.907829

Epoch 127/1000
Training Loss: 0.01700018, Training R2: 0.992565
Validation Loss: 0.30649257, Validation R2: 0.906544

Epoch 128/1000
Training Loss: 0.02841848, Training R2: 0.992500
Validation Loss: 0.30704451, Validation R2: 0.906336

Epoch 129/1000
Training Loss: 0.03023838, Training R2: 0.992490
Validation Loss: 0.30525432, Validation R2: 0.907154

Epoch 130/1000
Training Loss: 0.02800067, Training R2: 0.992497
Validation Loss: 0.30790080, Validation R2: 0.905616

Epoch 131/1000
Training Loss: 0.02562904, Training R2: 0.992618
Validation Loss: 0.30466389, Validation R2: 0.908214

Epoch 132/1000
Training Loss: 0.02622639, Training R2: 0.992623
Validation Loss: 0.30724401, Validation R2: 0.906716

Epoch 133/1000
Epoch 00133: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.02087044, Training R2: 0.992752
Validation Loss: 0.30671739, Validation R2: 0.906703

Epoch 134/1000
学习率已减少 3 次
Training Loss: 0.01603845, Training R2: 0.992916
Validation Loss: 0.30588703, Validation R2: 0.907519

Epoch 135/1000
Training Loss: 0.01303084, Training R2: 0.992972
Validation Loss: 0.30585654, Validation R2: 0.907530

Epoch 136/1000
Training Loss: 0.01278633, Training R2: 0.993011
Validation Loss: 0.30589461, Validation R2: 0.907089

Epoch 137/1000
Training Loss: 0.01236277, Training R2: 0.992997
Validation Loss: 0.30700017, Validation R2: 0.906932

Epoch 138/1000
Training Loss: 0.01052206, Training R2: 0.993057
Validation Loss: 0.30559908, Validation R2: 0.907842

Epoch 139/1000
Training Loss: 0.01030826, Training R2: 0.993122
Validation Loss: 0.30675278, Validation R2: 0.906849

Epoch 140/1000
Training Loss: 0.01504791, Training R2: 0.993067
Validation Loss: 0.30560036, Validation R2: 0.907623

Epoch 141/1000
Training Loss: 0.01291364, Training R2: 0.993082
Validation Loss: 0.30502873, Validation R2: 0.907718

Epoch 142/1000
Training Loss: 0.01029329, Training R2: 0.993107
Validation Loss: 0.30534759, Validation R2: 0.907547

Epoch 143/1000
Training Loss: 0.00993914, Training R2: 0.993123
Validation Loss: 0.30559949, Validation R2: 0.907453

Epoch 144/1000
Training Loss: 0.01009339, Training R2: 0.993152
Validation Loss: 0.30634400, Validation R2: 0.907104

Epoch 145/1000
Training Loss: 0.01053672, Training R2: 0.993152
Validation Loss: 0.30566213, Validation R2: 0.907319

Epoch 146/1000
Training Loss: 0.01038381, Training R2: 0.993155
Validation Loss: 0.30658115, Validation R2: 0.907125

Epoch 147/1000
Training Loss: 0.01114335, Training R2: 0.993175
Validation Loss: 0.30620516, Validation R2: 0.907312

Epoch 148/1000
Training Loss: 0.01112237, Training R2: 0.993193
Validation Loss: 0.30561451, Validation R2: 0.907243

Epoch 149/1000
Training Loss: 0.01001283, Training R2: 0.993233
Validation Loss: 0.30655119, Validation R2: 0.906627

Epoch 150/1000
Training Loss: 0.01199754, Training R2: 0.993261
Validation Loss: 0.30642876, Validation R2: 0.906577

Epoch 151/1000
Training Loss: 0.01128950, Training R2: 0.993241
Validation Loss: 0.30576489, Validation R2: 0.907261

Epoch 152/1000
Training Loss: 0.01251273, Training R2: 0.993234
Validation Loss: 0.30622670, Validation R2: 0.906823

Epoch 153/1000
Training Loss: 0.01164329, Training R2: 0.993315
Validation Loss: 0.30443835, Validation R2: 0.908139

Epoch 154/1000
Epoch 00154: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.01201751, Training R2: 0.993318
Validation Loss: 0.30452241, Validation R2: 0.908010

Epoch 155/1000
学习率已减少 4 次
Training Loss: 0.00971151, Training R2: 0.993350
Validation Loss: 0.30658074, Validation R2: 0.906800

Epoch 156/1000
Training Loss: 0.00880778, Training R2: 0.993359
Validation Loss: 0.30560060, Validation R2: 0.907512

Epoch 157/1000
Training Loss: 0.00817736, Training R2: 0.993361
Validation Loss: 0.30549631, Validation R2: 0.907324

Epoch 158/1000
Training Loss: 0.00733111, Training R2: 0.993363
Validation Loss: 0.30552111, Validation R2: 0.907380

Epoch 159/1000
Training Loss: 0.00751094, Training R2: 0.993392
Validation Loss: 0.30596005, Validation R2: 0.906942

Epoch 160/1000
Training Loss: 0.00736620, Training R2: 0.993411
Validation Loss: 0.30533095, Validation R2: 0.907619

Epoch 161/1000
Training Loss: 0.00713385, Training R2: 0.993399
Validation Loss: 0.30576762, Validation R2: 0.907091

Epoch 162/1000
Training Loss: 0.00803898, Training R2: 0.993418
Validation Loss: 0.30580518, Validation R2: 0.907521

Epoch 163/1000
Training Loss: 0.00792772, Training R2: 0.993421
Validation Loss: 0.30588367, Validation R2: 0.907392

Epoch 164/1000
Training Loss: 0.00724957, Training R2: 0.993439
Validation Loss: 0.30500477, Validation R2: 0.907654

Epoch 165/1000
Training Loss: 0.01011150, Training R2: 0.993410
Validation Loss: 0.30568345, Validation R2: 0.907277

Epoch 166/1000
Training Loss: 0.00905669, Training R2: 0.993446
Validation Loss: 0.30517093, Validation R2: 0.907528

Epoch 167/1000
Training Loss: 0.00874142, Training R2: 0.993468
Validation Loss: 0.30568836, Validation R2: 0.907101

Epoch 168/1000
Training Loss: 0.00721863, Training R2: 0.993490
Validation Loss: 0.30584334, Validation R2: 0.906969

Epoch 169/1000
Training Loss: 0.00675169, Training R2: 0.993505
Validation Loss: 0.30543079, Validation R2: 0.907557

Epoch 170/1000
Training Loss: 0.00704126, Training R2: 0.993492
Validation Loss: 0.30605589, Validation R2: 0.907262

Epoch 171/1000
Training Loss: 0.00699382, Training R2: 0.993529
Validation Loss: 0.30603576, Validation R2: 0.907232

Epoch 172/1000
Training Loss: 0.00736872, Training R2: 0.993527
Validation Loss: 0.30598326, Validation R2: 0.907271

Epoch 173/1000
Training Loss: 0.00760219, Training R2: 0.993541
Validation Loss: 0.30621835, Validation R2: 0.907191

Epoch 174/1000
Training Loss: 0.00739672, Training R2: 0.993562
Validation Loss: 0.30589644, Validation R2: 0.907244

Epoch 175/1000
Epoch 00175: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00738799, Training R2: 0.993559
Validation Loss: 0.30611103, Validation R2: 0.907150

Epoch 176/1000
学习率已减少 5 次
Training Loss: 0.00639690, Training R2: 0.993586
Validation Loss: 0.30580214, Validation R2: 0.907330

Epoch 177/1000
Training Loss: 0.00596016, Training R2: 0.993596
Validation Loss: 0.30572470, Validation R2: 0.907229

Epoch 178/1000
Training Loss: 0.00577060, Training R2: 0.993597
Validation Loss: 0.30601792, Validation R2: 0.907298

Epoch 179/1000
Training Loss: 0.00599678, Training R2: 0.993599
Validation Loss: 0.30576622, Validation R2: 0.906995

Epoch 180/1000
Training Loss: 0.00657185, Training R2: 0.993610
Validation Loss: 0.30559895, Validation R2: 0.907270

Epoch 181/1000
Training Loss: 0.00689054, Training R2: 0.993613
Validation Loss: 0.30545373, Validation R2: 0.907342

Epoch 182/1000
Training Loss: 0.00638893, Training R2: 0.993625
Validation Loss: 0.30589862, Validation R2: 0.907265

Epoch 183/1000
Training Loss: 0.00561593, Training R2: 0.993626
Validation Loss: 0.30578908, Validation R2: 0.907292

Epoch 184/1000
Training Loss: 0.00516837, Training R2: 0.993641
Validation Loss: 0.30581815, Validation R2: 0.907362

Epoch 185/1000
Training Loss: 0.00566904, Training R2: 0.993624
Validation Loss: 0.30543937, Validation R2: 0.907424

Epoch 186/1000
Training Loss: 0.00555047, Training R2: 0.993641
Validation Loss: 0.30535790, Validation R2: 0.907451

Epoch 187/1000
Training Loss: 0.00566079, Training R2: 0.993647
Validation Loss: 0.30545083, Validation R2: 0.907426

Epoch 188/1000
Training Loss: 0.00584922, Training R2: 0.993650
Validation Loss: 0.30606555, Validation R2: 0.907264

Epoch 189/1000
Training Loss: 0.00531477, Training R2: 0.993656
Validation Loss: 0.30549536, Validation R2: 0.907380

Epoch 190/1000
Training Loss: 0.00549263, Training R2: 0.993666
Validation Loss: 0.30600329, Validation R2: 0.906970

Epoch 191/1000
Training Loss: 0.00531364, Training R2: 0.993673
Validation Loss: 0.30552420, Validation R2: 0.907417

Epoch 192/1000
Training Loss: 0.00571016, Training R2: 0.993683
Validation Loss: 0.30577243, Validation R2: 0.907301

Epoch 193/1000
Training Loss: 0.00564771, Training R2: 0.993691
Validation Loss: 0.30606002, Validation R2: 0.907309

Epoch 194/1000
Training Loss: 0.00632467, Training R2: 0.993671
Validation Loss: 0.30562173, Validation R2: 0.907336

Epoch 195/1000
Training Loss: 0.00677832, Training R2: 0.993695
Validation Loss: 0.30593844, Validation R2: 0.907208

Epoch 196/1000
Epoch 00196: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00619909, Training R2: 0.993692
Validation Loss: 0.30572422, Validation R2: 0.907310

Epoch 197/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_dipole.png
