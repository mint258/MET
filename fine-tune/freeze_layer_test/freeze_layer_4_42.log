Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3451011

Epoch 1/1000
Training Loss: 1.26825414, Training R2: -0.246961
Validation Loss: 1.15883338, Validation R2: -0.075200
Saved best model with validation R2 -0.075200 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.18630516, Training R2: -0.190973
Validation Loss: 1.13559997, Validation R2: -0.006811
Saved best model with validation R2 -0.006811 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.11215323, Training R2: 0.031383
Validation Loss: 1.12958467, Validation R2: -0.014063

Epoch 4/1000
Training Loss: 1.08770544, Training R2: -0.005361
Validation Loss: 1.07957244, Validation R2: 0.110124
Saved best model with validation R2 0.110124 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.04838323, Training R2: 0.143800
Validation Loss: 1.12005568, Validation R2: -0.008278

Epoch 6/1000
Training Loss: 0.97589991, Training R2: 0.176016
Validation Loss: 0.96496201, Validation R2: 0.234748
Saved best model with validation R2 0.234748 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.89136299, Training R2: 0.312984
Validation Loss: 0.99361324, Validation R2: 0.192849

Epoch 8/1000
Training Loss: 0.86072805, Training R2: 0.352473
Validation Loss: 0.99358577, Validation R2: 0.177990

Epoch 9/1000
Training Loss: 0.83895885, Training R2: 0.376391
Validation Loss: 0.87015957, Validation R2: 0.320522
Saved best model with validation R2 0.320522 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.73851197, Training R2: 0.480923
Validation Loss: 0.84182507, Validation R2: 0.339355
Saved best model with validation R2 0.339355 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.69713082, Training R2: 0.507894
Validation Loss: 0.81029028, Validation R2: 0.386291
Saved best model with validation R2 0.386291 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.64487601, Training R2: 0.556102
Validation Loss: 0.79183972, Validation R2: 0.404934
Saved best model with validation R2 0.404934 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.59959664, Training R2: 0.598240
Validation Loss: 0.79362684, Validation R2: 0.369807

Epoch 14/1000
Training Loss: 0.63310373, Training R2: 0.580603
Validation Loss: 0.78371114, Validation R2: 0.396172

Epoch 15/1000
Training Loss: 0.55976245, Training R2: 0.644046
Validation Loss: 0.79096389, Validation R2: 0.398748

Epoch 16/1000
Training Loss: 0.52284491, Training R2: 0.678118
Validation Loss: 0.74187875, Validation R2: 0.415802
Saved best model with validation R2 0.415802 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.49422719, Training R2: 0.694642
Validation Loss: 0.72059369, Validation R2: 0.458709
Saved best model with validation R2 0.458709 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.46935079, Training R2: 0.713238
Validation Loss: 0.71312422, Validation R2: 0.447364

Epoch 19/1000
Training Loss: 0.45347815, Training R2: 0.724439
Validation Loss: 0.72860444, Validation R2: 0.463594
Saved best model with validation R2 0.463594 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.46768032, Training R2: 0.717793
Validation Loss: 0.69810438, Validation R2: 0.479869
Saved best model with validation R2 0.479869 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.42713778, Training R2: 0.758676
Validation Loss: 0.68425274, Validation R2: 0.471114

Epoch 22/1000
Training Loss: 0.40461325, Training R2: 0.764067
Validation Loss: 0.65604150, Validation R2: 0.517858
Saved best model with validation R2 0.517858 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.38441841, Training R2: 0.775019
Validation Loss: 0.64583486, Validation R2: 0.516544

Epoch 24/1000
Training Loss: 0.36388070, Training R2: 0.804600
Validation Loss: 0.65378881, Validation R2: 0.485889

Epoch 25/1000
Training Loss: 0.33487037, Training R2: 0.824945
Validation Loss: 0.72598362, Validation R2: 0.440795

Epoch 26/1000
Training Loss: 0.40472118, Training R2: 0.799972
Validation Loss: 0.64085120, Validation R2: 0.506414

Epoch 27/1000
Training Loss: 0.34862127, Training R2: 0.827700
Validation Loss: 0.79099834, Validation R2: 0.429065

Epoch 28/1000
Training Loss: 0.50490071, Training R2: 0.751738
Validation Loss: 0.66365987, Validation R2: 0.540351
Saved best model with validation R2 0.540351 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.52510390, Training R2: 0.713916
Validation Loss: 0.74209672, Validation R2: 0.419029

Epoch 30/1000
Training Loss: 0.47709030, Training R2: 0.751838
Validation Loss: 0.65551543, Validation R2: 0.592617
Saved best model with validation R2 0.592617 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.39123008, Training R2: 0.800808
Validation Loss: 0.56074685, Validation R2: 0.622757
Saved best model with validation R2 0.622757 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 0.31507793, Training R2: 0.846313
Validation Loss: 0.59183121, Validation R2: 0.571359

Epoch 33/1000
Training Loss: 0.29693969, Training R2: 0.854130
Validation Loss: 0.58465666, Validation R2: 0.570034

Epoch 34/1000
Training Loss: 0.30078291, Training R2: 0.844768
Validation Loss: 0.58573169, Validation R2: 0.575328

Epoch 35/1000
Training Loss: 0.29033576, Training R2: 0.853155
Validation Loss: 0.58775729, Validation R2: 0.558674

Epoch 36/1000
Training Loss: 0.29478174, Training R2: 0.859877
Validation Loss: 0.59216964, Validation R2: 0.557181

Epoch 37/1000
Training Loss: 0.28493425, Training R2: 0.859525
Validation Loss: 0.56819135, Validation R2: 0.583838

Epoch 38/1000
Training Loss: 0.25212952, Training R2: 0.875339
Validation Loss: 0.55476075, Validation R2: 0.594413

Epoch 39/1000
Training Loss: 0.24489196, Training R2: 0.879551
Validation Loss: 0.55449760, Validation R2: 0.594769

Epoch 40/1000
Training Loss: 0.23298725, Training R2: 0.883342
Validation Loss: 0.56013805, Validation R2: 0.590114

Epoch 41/1000
Training Loss: 0.23398717, Training R2: 0.879606
Validation Loss: 0.56968933, Validation R2: 0.573290

Epoch 42/1000
Training Loss: 0.24958280, Training R2: 0.884792
Validation Loss: 0.57313973, Validation R2: 0.584716

Epoch 43/1000
Training Loss: 0.23969069, Training R2: 0.884667
Validation Loss: 0.58006477, Validation R2: 0.556332

Epoch 44/1000
Training Loss: 0.22536025, Training R2: 0.891857
Validation Loss: 0.54677206, Validation R2: 0.604011

Epoch 45/1000
Training Loss: 0.21903046, Training R2: 0.888365
Validation Loss: 0.55626541, Validation R2: 0.588349

Epoch 46/1000
Training Loss: 0.22142938, Training R2: 0.890613
Validation Loss: 0.56901175, Validation R2: 0.620700

Epoch 47/1000
Training Loss: 0.26509256, Training R2: 0.875016
Validation Loss: 0.56446302, Validation R2: 0.606218

Epoch 48/1000
Training Loss: 0.21008120, Training R2: 0.901357
Validation Loss: 0.54912412, Validation R2: 0.591194

Epoch 49/1000
Training Loss: 0.19235999, Training R2: 0.897277
Validation Loss: 0.54739416, Validation R2: 0.596016

Epoch 50/1000
Training Loss: 0.20406925, Training R2: 0.894241
Validation Loss: 0.52134585, Validation R2: 0.646896
Saved best model with validation R2 0.646896 to best_finetuned_model.pth

Epoch 51/1000
Training Loss: 0.19531786, Training R2: 0.898059
Validation Loss: 0.49667048, Validation R2: 0.642389

Epoch 52/1000
Training Loss: 0.20223229, Training R2: 0.900567
Validation Loss: 0.52671307, Validation R2: 0.642503

Epoch 53/1000
Training Loss: 0.17407642, Training R2: 0.904912
Validation Loss: 0.52617067, Validation R2: 0.626184

Epoch 54/1000
Training Loss: 0.16828047, Training R2: 0.909643
Validation Loss: 0.53764701, Validation R2: 0.634605

Epoch 55/1000
Training Loss: 0.17245780, Training R2: 0.909513
Validation Loss: 0.53223372, Validation R2: 0.604821

Epoch 56/1000
Training Loss: 0.16437024, Training R2: 0.914088
Validation Loss: 0.51949066, Validation R2: 0.638318

Epoch 57/1000
Training Loss: 0.16613572, Training R2: 0.915392
Validation Loss: 0.52364957, Validation R2: 0.624504

Epoch 58/1000
Training Loss: 0.18006159, Training R2: 0.907988
Validation Loss: 0.54413193, Validation R2: 0.604223

Epoch 59/1000
Training Loss: 0.19134167, Training R2: 0.910806
Validation Loss: 0.53186321, Validation R2: 0.616660

Epoch 60/1000
Training Loss: 0.17151092, Training R2: 0.913980
Validation Loss: 0.51689690, Validation R2: 0.646227

Epoch 61/1000
Training Loss: 0.15341051, Training R2: 0.918639
Validation Loss: 0.54590362, Validation R2: 0.599465

Epoch 62/1000
Training Loss: 0.16466861, Training R2: 0.915715
Validation Loss: 0.52844244, Validation R2: 0.639007

Epoch 63/1000
Training Loss: 0.16210299, Training R2: 0.918826
Validation Loss: 0.53453445, Validation R2: 0.646857

Epoch 64/1000
Training Loss: 0.23325196, Training R2: 0.902878
Validation Loss: 0.53750110, Validation R2: 0.648119
Saved best model with validation R2 0.648119 to best_finetuned_model.pth

Epoch 65/1000
Training Loss: 0.20422953, Training R2: 0.914178
Validation Loss: 0.53355652, Validation R2: 0.626534

Epoch 66/1000
Training Loss: 0.17965114, Training R2: 0.916576
Validation Loss: 0.52763981, Validation R2: 0.641474

Epoch 67/1000
Training Loss: 0.17936238, Training R2: 0.913804
Validation Loss: 0.53069991, Validation R2: 0.621121

Epoch 68/1000
Training Loss: 0.14847686, Training R2: 0.920722
Validation Loss: 0.53356832, Validation R2: 0.624368

Epoch 69/1000
Training Loss: 0.16416301, Training R2: 0.922526
Validation Loss: 0.53517675, Validation R2: 0.638618

Epoch 70/1000
Training Loss: 0.16102875, Training R2: 0.917538
Validation Loss: 0.53536886, Validation R2: 0.617229

Epoch 71/1000
Training Loss: 0.16205771, Training R2: 0.921794
Validation Loss: 0.55013013, Validation R2: 0.624318

Epoch 72/1000
Training Loss: 0.16978216, Training R2: 0.919666
Validation Loss: 0.54655844, Validation R2: 0.617284

Epoch 73/1000
Training Loss: 0.15196085, Training R2: 0.923709
Validation Loss: 0.52994317, Validation R2: 0.618195

Epoch 74/1000
Training Loss: 0.13853546, Training R2: 0.925188
Validation Loss: 0.52761918, Validation R2: 0.626542

Epoch 75/1000
Training Loss: 0.12496131, Training R2: 0.928427
Validation Loss: 0.53177452, Validation R2: 0.621029

Epoch 76/1000
Training Loss: 0.11793785, Training R2: 0.934201
Validation Loss: 0.53554177, Validation R2: 0.626229

Epoch 77/1000
Training Loss: 0.13437527, Training R2: 0.927958
Validation Loss: 0.53378016, Validation R2: 0.639827

Epoch 78/1000
Training Loss: 0.14153508, Training R2: 0.926700
Validation Loss: 0.52182114, Validation R2: 0.647178

Epoch 79/1000
Training Loss: 0.15025205, Training R2: 0.930706
Validation Loss: 0.52481109, Validation R2: 0.642853

Epoch 80/1000
Training Loss: 0.14914181, Training R2: 0.926379
Validation Loss: 0.52537495, Validation R2: 0.638187

Epoch 81/1000
Training Loss: 0.15748218, Training R2: 0.927773
Validation Loss: 0.54819787, Validation R2: 0.615986

Epoch 82/1000
Training Loss: 0.17032099, Training R2: 0.926149
Validation Loss: 0.54703778, Validation R2: 0.612592

Epoch 83/1000
Training Loss: 0.14686986, Training R2: 0.930379
Validation Loss: 0.52328956, Validation R2: 0.648301
Saved best model with validation R2 0.648301 to best_finetuned_model.pth

Epoch 84/1000
Training Loss: 0.13397138, Training R2: 0.929835
Validation Loss: 0.56007135, Validation R2: 0.592016

Epoch 85/1000
Training Loss: 0.16542680, Training R2: 0.929082
Validation Loss: 0.53619283, Validation R2: 0.634753

Epoch 86/1000
Training Loss: 0.13564193, Training R2: 0.933205
Validation Loss: 0.53520811, Validation R2: 0.625879

Epoch 87/1000
Training Loss: 0.14207986, Training R2: 0.932277
Validation Loss: 0.53075492, Validation R2: 0.644469

Epoch 88/1000
Training Loss: 0.12641887, Training R2: 0.931606
Validation Loss: 0.53449982, Validation R2: 0.629237

Epoch 89/1000
Training Loss: 0.12889267, Training R2: 0.938101
Validation Loss: 0.53914756, Validation R2: 0.638539

Epoch 90/1000
Training Loss: 0.12922168, Training R2: 0.936313
Validation Loss: 0.53111589, Validation R2: 0.627915

Epoch 91/1000
Training Loss: 0.12330847, Training R2: 0.939345
Validation Loss: 0.53658599, Validation R2: 0.637751

Epoch 92/1000
Training Loss: 0.16571963, Training R2: 0.936212
Validation Loss: 0.55917305, Validation R2: 0.631440

Epoch 93/1000
Training Loss: 0.17724817, Training R2: 0.929130
Validation Loss: 0.54390222, Validation R2: 0.618098

Epoch 94/1000
Training Loss: 0.13446553, Training R2: 0.942980
Validation Loss: 0.53909051, Validation R2: 0.625891

Epoch 95/1000
Training Loss: 0.12468490, Training R2: 0.942806
Validation Loss: 0.55003083, Validation R2: 0.621226

Epoch 96/1000
Training Loss: 0.12901550, Training R2: 0.945399
Validation Loss: 0.53038222, Validation R2: 0.641641

Epoch 97/1000
Training Loss: 0.13073947, Training R2: 0.939570
Validation Loss: 0.53555363, Validation R2: 0.620043

Epoch 98/1000
Training Loss: 0.14407974, Training R2: 0.940195
Validation Loss: 0.55116135, Validation R2: 0.623319

Epoch 99/1000
Training Loss: 0.18405312, Training R2: 0.933218
Validation Loss: 0.57796574, Validation R2: 0.567004

Epoch 100/1000
Training Loss: 0.22772372, Training R2: 0.926328
Validation Loss: 0.54939181, Validation R2: 0.622108

Epoch 101/1000
Training Loss: 0.20892519, Training R2: 0.930184
Validation Loss: 0.57970858, Validation R2: 0.624826

Epoch 102/1000
Training Loss: 0.22479136, Training R2: 0.923385
Validation Loss: 0.57250631, Validation R2: 0.595702

Epoch 103/1000
Training Loss: 0.19659952, Training R2: 0.933106
Validation Loss: 0.56217742, Validation R2: 0.611197

Epoch 104/1000
Epoch 00104: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.19265424, Training R2: 0.929455
Validation Loss: 0.53677994, Validation R2: 0.612447

Epoch 105/1000
学习率已减少 1 次
Training Loss: 0.14111196, Training R2: 0.948939
Validation Loss: 0.53696424, Validation R2: 0.633404

Epoch 106/1000
Training Loss: 0.13002624, Training R2: 0.948606
Validation Loss: 0.54251283, Validation R2: 0.610528

Epoch 107/1000
Training Loss: 0.11949877, Training R2: 0.951525
Validation Loss: 0.54160321, Validation R2: 0.611282

Epoch 108/1000
Training Loss: 0.10286302, Training R2: 0.955894
Validation Loss: 0.52691293, Validation R2: 0.628707

Epoch 109/1000
Training Loss: 0.09182160, Training R2: 0.956379
Validation Loss: 0.53476864, Validation R2: 0.612591

Epoch 110/1000
Training Loss: 0.08471404, Training R2: 0.957925
Validation Loss: 0.53218925, Validation R2: 0.622511

Epoch 111/1000
Training Loss: 0.08073409, Training R2: 0.956357
Validation Loss: 0.53599846, Validation R2: 0.619375

Epoch 112/1000
Training Loss: 0.08400998, Training R2: 0.958473
Validation Loss: 0.52424926, Validation R2: 0.625857

Epoch 113/1000
Training Loss: 0.07971835, Training R2: 0.957818
Validation Loss: 0.52429640, Validation R2: 0.621144

Epoch 114/1000
Training Loss: 0.07934348, Training R2: 0.960457
Validation Loss: 0.52422673, Validation R2: 0.627698

Epoch 115/1000
Training Loss: 0.07399217, Training R2: 0.958431
Validation Loss: 0.52552348, Validation R2: 0.621905

Epoch 116/1000
Training Loss: 0.07044065, Training R2: 0.960683
Validation Loss: 0.52379626, Validation R2: 0.626781

Epoch 117/1000
Training Loss: 0.07021265, Training R2: 0.960357
Validation Loss: 0.53898823, Validation R2: 0.619559

Epoch 118/1000
Training Loss: 0.07129406, Training R2: 0.962269
Validation Loss: 0.53232491, Validation R2: 0.624968

Epoch 119/1000
Training Loss: 0.06356847, Training R2: 0.963668
Validation Loss: 0.53167385, Validation R2: 0.616230

Epoch 120/1000
Training Loss: 0.06925715, Training R2: 0.964459
Validation Loss: 0.53009641, Validation R2: 0.627735

Epoch 121/1000
Training Loss: 0.06174878, Training R2: 0.961917
Validation Loss: 0.52794588, Validation R2: 0.623290

Epoch 122/1000
Training Loss: 0.06097244, Training R2: 0.964830
Validation Loss: 0.53682065, Validation R2: 0.622918

Epoch 123/1000
Training Loss: 0.06423690, Training R2: 0.964562
Validation Loss: 0.53747147, Validation R2: 0.615040

Epoch 124/1000
Training Loss: 0.06192882, Training R2: 0.964779
Validation Loss: 0.53123665, Validation R2: 0.620291

Epoch 125/1000
Epoch 00125: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.06929010, Training R2: 0.963480
Validation Loss: 0.53834289, Validation R2: 0.617008

Epoch 126/1000
学习率已减少 2 次
Training Loss: 0.06775150, Training R2: 0.964584
Validation Loss: 0.53349990, Validation R2: 0.625835

Epoch 127/1000
Training Loss: 0.06272599, Training R2: 0.964991
Validation Loss: 0.53391904, Validation R2: 0.625158

Epoch 128/1000
Training Loss: 0.05172891, Training R2: 0.967077
Validation Loss: 0.53948921, Validation R2: 0.620537

Epoch 129/1000
Training Loss: 0.05064988, Training R2: 0.967029
Validation Loss: 0.53845990, Validation R2: 0.624150

Epoch 130/1000
Training Loss: 0.04704032, Training R2: 0.966915
Validation Loss: 0.53599072, Validation R2: 0.623615

Epoch 131/1000
Training Loss: 0.04409481, Training R2: 0.967273
Validation Loss: 0.53818482, Validation R2: 0.621801

Epoch 132/1000
Training Loss: 0.04384214, Training R2: 0.967592
Validation Loss: 0.53690428, Validation R2: 0.622583

Epoch 133/1000
Training Loss: 0.04465235, Training R2: 0.967134
Validation Loss: 0.53637940, Validation R2: 0.621829

Epoch 134/1000
Training Loss: 0.04372392, Training R2: 0.968076
Validation Loss: 0.53843212, Validation R2: 0.620394

Epoch 135/1000
Training Loss: 0.04850023, Training R2: 0.967714
Validation Loss: 0.53819150, Validation R2: 0.623310

Epoch 136/1000
Training Loss: 0.03849475, Training R2: 0.968565
Validation Loss: 0.53477293, Validation R2: 0.626858

Epoch 137/1000
Training Loss: 0.03700531, Training R2: 0.968576
Validation Loss: 0.53561187, Validation R2: 0.626808

Epoch 138/1000
Training Loss: 0.03649728, Training R2: 0.968784
Validation Loss: 0.53415161, Validation R2: 0.628711

Epoch 139/1000
Training Loss: 0.03544969, Training R2: 0.969231
Validation Loss: 0.53358036, Validation R2: 0.625846

Epoch 140/1000
Training Loss: 0.03357060, Training R2: 0.969442
Validation Loss: 0.53593808, Validation R2: 0.622909

Epoch 141/1000
Training Loss: 0.03997805, Training R2: 0.969856
Validation Loss: 0.53675961, Validation R2: 0.627461

Epoch 142/1000
Training Loss: 0.04527734, Training R2: 0.969952
Validation Loss: 0.53902584, Validation R2: 0.631372

Epoch 143/1000
Training Loss: 0.06636568, Training R2: 0.968421
Validation Loss: 0.53539944, Validation R2: 0.626887

Epoch 144/1000
Training Loss: 0.04765554, Training R2: 0.970434
Validation Loss: 0.53889751, Validation R2: 0.623089

Epoch 145/1000
Training Loss: 0.04822155, Training R2: 0.970568
Validation Loss: 0.53839070, Validation R2: 0.616263

Epoch 146/1000
Epoch 00146: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.05407568, Training R2: 0.971746
Validation Loss: 0.53781044, Validation R2: 0.618495

Epoch 147/1000
学习率已减少 3 次
Training Loss: 0.04466288, Training R2: 0.972350
Validation Loss: 0.53928596, Validation R2: 0.622171

Epoch 148/1000
Training Loss: 0.03885243, Training R2: 0.972662
Validation Loss: 0.54204106, Validation R2: 0.621929

Epoch 149/1000
Training Loss: 0.03551426, Training R2: 0.973162
Validation Loss: 0.53764874, Validation R2: 0.624200

Epoch 150/1000
Training Loss: 0.03283639, Training R2: 0.973141
Validation Loss: 0.53774983, Validation R2: 0.623008

Epoch 151/1000
Training Loss: 0.03297670, Training R2: 0.973517
Validation Loss: 0.53654283, Validation R2: 0.625968

Epoch 152/1000
Training Loss: 0.03092379, Training R2: 0.973432
Validation Loss: 0.53618377, Validation R2: 0.625188

Epoch 153/1000
Training Loss: 0.03022331, Training R2: 0.973876
Validation Loss: 0.53352857, Validation R2: 0.624964

Epoch 154/1000
Training Loss: 0.03371551, Training R2: 0.973860
Validation Loss: 0.53377533, Validation R2: 0.622687

Epoch 155/1000
Training Loss: 0.03689105, Training R2: 0.973823
Validation Loss: 0.53586447, Validation R2: 0.623873

Epoch 156/1000
Training Loss: 0.03143437, Training R2: 0.973776
Validation Loss: 0.53597671, Validation R2: 0.627839

Epoch 157/1000
Training Loss: 0.03295821, Training R2: 0.973661
Validation Loss: 0.53723967, Validation R2: 0.626807

Epoch 158/1000
Training Loss: 0.03256894, Training R2: 0.973799
Validation Loss: 0.53413361, Validation R2: 0.626112

Epoch 159/1000
Training Loss: 0.02845573, Training R2: 0.973880
Validation Loss: 0.53494966, Validation R2: 0.625648

Epoch 160/1000
Training Loss: 0.02781798, Training R2: 0.974241
Validation Loss: 0.53433049, Validation R2: 0.625472

Epoch 161/1000
Training Loss: 0.02782460, Training R2: 0.974217
Validation Loss: 0.53311145, Validation R2: 0.628323

Epoch 162/1000
Training Loss: 0.02745927, Training R2: 0.974088
Validation Loss: 0.53723711, Validation R2: 0.624934

Epoch 163/1000
Training Loss: 0.02621343, Training R2: 0.974356
Validation Loss: 0.53536284, Validation R2: 0.627428

Epoch 164/1000
Training Loss: 0.02600250, Training R2: 0.974184
Validation Loss: 0.53445584, Validation R2: 0.625169

Epoch 165/1000
Training Loss: 0.02737523, Training R2: 0.974490
Validation Loss: 0.53463447, Validation R2: 0.625787

Epoch 166/1000
Training Loss: 0.02403703, Training R2: 0.974541
Validation Loss: 0.53567481, Validation R2: 0.625828

Epoch 167/1000
Epoch 00167: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.02306426, Training R2: 0.974513
Validation Loss: 0.53842330, Validation R2: 0.626482

Epoch 168/1000
学习率已减少 4 次
Training Loss: 0.02898117, Training R2: 0.974531
Validation Loss: 0.53486592, Validation R2: 0.624436

Epoch 169/1000
Training Loss: 0.02673586, Training R2: 0.974511
Validation Loss: 0.53432363, Validation R2: 0.625210

Epoch 170/1000
Training Loss: 0.02544627, Training R2: 0.974536
Validation Loss: 0.53551620, Validation R2: 0.627361

Epoch 171/1000
Training Loss: 0.02501215, Training R2: 0.974548
Validation Loss: 0.53427041, Validation R2: 0.627407

Epoch 172/1000
Training Loss: 0.02290663, Training R2: 0.974586
Validation Loss: 0.53621888, Validation R2: 0.625184

Epoch 173/1000
Training Loss: 0.02177302, Training R2: 0.974388
Validation Loss: 0.53452981, Validation R2: 0.626007

Epoch 174/1000
Training Loss: 0.02094575, Training R2: 0.974312
Validation Loss: 0.53510320, Validation R2: 0.623985

Epoch 175/1000
Training Loss: 0.02263274, Training R2: 0.974489
Validation Loss: 0.53502369, Validation R2: 0.624688

Epoch 176/1000
Training Loss: 0.02262491, Training R2: 0.974451
Validation Loss: 0.53533077, Validation R2: 0.624313

Epoch 177/1000
Training Loss: 0.02245918, Training R2: 0.974560
Validation Loss: 0.53495461, Validation R2: 0.626401

Epoch 178/1000
Training Loss: 0.02102678, Training R2: 0.974484
Validation Loss: 0.53408438, Validation R2: 0.627686

Epoch 179/1000
Training Loss: 0.02213611, Training R2: 0.974687
Validation Loss: 0.53596073, Validation R2: 0.625564

Epoch 180/1000
Training Loss: 0.02129394, Training R2: 0.974599
Validation Loss: 0.53495485, Validation R2: 0.626562

Epoch 181/1000
Training Loss: 0.02391815, Training R2: 0.974465
Validation Loss: 0.53425366, Validation R2: 0.625164

Epoch 182/1000
Training Loss: 0.02151375, Training R2: 0.974837
Validation Loss: 0.53370088, Validation R2: 0.626553

Epoch 183/1000
Training Loss: 0.02088880, Training R2: 0.974793
Validation Loss: 0.53461736, Validation R2: 0.626662

Epoch 184/1000
Training Loss: 0.01975484, Training R2: 0.974872
Validation Loss: 0.53350681, Validation R2: 0.627067

Epoch 185/1000
Training Loss: 0.01980070, Training R2: 0.974835
Validation Loss: 0.53315187, Validation R2: 0.627178

Epoch 186/1000
Training Loss: 0.01961874, Training R2: 0.974793
Validation Loss: 0.53422081, Validation R2: 0.625188

Epoch 187/1000
Training Loss: 0.02094626, Training R2: 0.974791
Validation Loss: 0.53269356, Validation R2: 0.627027

Epoch 188/1000
Epoch 00188: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.02179693, Training R2: 0.974739
Validation Loss: 0.53401017, Validation R2: 0.625418

Epoch 189/1000
学习率已减少 5 次
Training Loss: 0.02040681, Training R2: 0.974838
Validation Loss: 0.53439391, Validation R2: 0.626845

Epoch 190/1000
Training Loss: 0.02031640, Training R2: 0.974665
Validation Loss: 0.53368998, Validation R2: 0.626963

Epoch 191/1000
Training Loss: 0.01951579, Training R2: 0.974715
Validation Loss: 0.53352082, Validation R2: 0.626181

Epoch 192/1000
Training Loss: 0.01879360, Training R2: 0.974829
Validation Loss: 0.53377616, Validation R2: 0.627243

Epoch 193/1000
Training Loss: 0.01854334, Training R2: 0.974833
Validation Loss: 0.53426099, Validation R2: 0.627492

Epoch 194/1000
Training Loss: 0.01921245, Training R2: 0.974838
Validation Loss: 0.53432274, Validation R2: 0.625893

Epoch 195/1000
Training Loss: 0.01876657, Training R2: 0.974690
Validation Loss: 0.53365666, Validation R2: 0.626878

Epoch 196/1000
Training Loss: 0.01776890, Training R2: 0.974830
Validation Loss: 0.53399539, Validation R2: 0.626126

Epoch 197/1000
Training Loss: 0.01721285, Training R2: 0.974974
Validation Loss: 0.53362721, Validation R2: 0.626690

Epoch 198/1000
Training Loss: 0.01700011, Training R2: 0.974964
Validation Loss: 0.53389627, Validation R2: 0.625963

Epoch 199/1000
Training Loss: 0.01750168, Training R2: 0.974899
Validation Loss: 0.53333855, Validation R2: 0.626862

Epoch 200/1000
Training Loss: 0.01685571, Training R2: 0.974981
Validation Loss: 0.53456467, Validation R2: 0.625941

Epoch 201/1000
Training Loss: 0.01675919, Training R2: 0.975042
Validation Loss: 0.53407490, Validation R2: 0.626966

Epoch 202/1000
Training Loss: 0.01678691, Training R2: 0.974998
Validation Loss: 0.53429759, Validation R2: 0.625956

Epoch 203/1000
Training Loss: 0.01632039, Training R2: 0.975037
Validation Loss: 0.53440964, Validation R2: 0.625738

Epoch 204/1000
Training Loss: 0.01587764, Training R2: 0.975069
Validation Loss: 0.53420728, Validation R2: 0.626095

Epoch 205/1000
Training Loss: 0.01608450, Training R2: 0.975113
Validation Loss: 0.53406429, Validation R2: 0.626710

Epoch 206/1000
Training Loss: 0.01708782, Training R2: 0.974953
Validation Loss: 0.53449357, Validation R2: 0.626694

Epoch 207/1000
Training Loss: 0.01775255, Training R2: 0.975069
Validation Loss: 0.53359926, Validation R2: 0.627360

Epoch 208/1000
Training Loss: 0.01827763, Training R2: 0.975093
Validation Loss: 0.53392088, Validation R2: 0.626019

Epoch 209/1000
Epoch 00209: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.01755014, Training R2: 0.975081
Validation Loss: 0.53424388, Validation R2: 0.625165

Epoch 210/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_dipole.png
