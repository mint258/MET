Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 100000, Training: 80000, Validation: 20000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)
冻结层 6: interaction_blocks.3 (SimpleInteractionBlock)
冻结层 7: lins.0 (Linear)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Frozen
interaction_blocks.3.conv1.lin_rel.bias: Frozen
interaction_blocks.3.conv1.lin_root.weight: Frozen
interaction_blocks.3.conv2.lin_rel.weight: Frozen
interaction_blocks.3.conv2.lin_rel.bias: Frozen
interaction_blocks.3.conv2.lin_root.weight: Frozen
interaction_blocks.3.lin1.weight: Frozen
interaction_blocks.3.lin1.bias: Frozen
interaction_blocks.3.lin2.weight: Frozen
interaction_blocks.3.lin2.bias: Frozen
interaction_blocks.3.lin_cat.weight: Frozen
interaction_blocks.3.lin_cat.bias: Frozen
interaction_blocks.3.norm.weight: Frozen
interaction_blocks.3.norm.bias: Frozen
interaction_blocks.3.norm.mean_scale: Frozen
interaction_blocks.3.lin_feature1.lin1.weight: Frozen
interaction_blocks.3.lin_feature1.lin2.weight: Frozen
interaction_blocks.3.lin_feature2.lin1.weight: Frozen
interaction_blocks.3.lin_feature2.lin2.weight: Frozen
interaction_blocks.3.lin.weight: Frozen
interaction_blocks.3.lin.bias: Frozen
interaction_blocks.3.lins.0.weight: Frozen
interaction_blocks.3.lins.0.bias: Frozen
interaction_blocks.3.lins.1.weight: Frozen
interaction_blocks.3.lins.1.bias: Frozen
interaction_blocks.3.lins.2.weight: Frozen
interaction_blocks.3.lins.2.bias: Frozen
interaction_blocks.3.lins.3.weight: Frozen
interaction_blocks.3.lins.3.bias: Frozen
interaction_blocks.3.final.weight: Frozen
interaction_blocks.3.final.bias: Frozen
lins.0.weight: Frozen
lins.0.bias: Frozen
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 1158019

Epoch 1/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:46<00:00,  6.71it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.12it/s]
Training Loss: 0.97851452, Training R2: 0.229116
Validation Loss: 0.83816781, Validation R2: 0.404601
Saved best model with validation R2 0.404601 to finetune_dipole100000

Epoch 2/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:26<00:00, 11.61it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.52it/s]
Training Loss: 0.81689115, Training R2: 0.421052
Validation Loss: 0.79977547, Validation R2: 0.459703
Saved best model with validation R2 0.459703 to finetune_dipole100000

Epoch 3/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.25it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.62it/s]
Training Loss: 0.77211482, Training R2: 0.477302
Validation Loss: 0.85008720, Validation R2: 0.404226

Epoch 4/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.53it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.18it/s]
Training Loss: 0.73256180, Training R2: 0.530202
Validation Loss: 0.72461904, Validation R2: 0.552724
Saved best model with validation R2 0.552724 to finetune_dipole100000

Epoch 5/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.22it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.21it/s]
Training Loss: 0.70846497, Training R2: 0.566953
Validation Loss: 0.72078813, Validation R2: 0.571953
Saved best model with validation R2 0.571953 to finetune_dipole100000

Epoch 6/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.52it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.47it/s]
Training Loss: 0.68366365, Training R2: 0.606339
Validation Loss: 0.69027782, Validation R2: 0.625077
Saved best model with validation R2 0.625077 to finetune_dipole100000

Epoch 7/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:28<00:00, 11.16it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.88it/s]
Training Loss: 0.67079244, Training R2: 0.625766
Validation Loss: 0.71122655, Validation R2: 0.574548

Epoch 8/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:29<00:00, 10.75it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 15.14it/s]
Training Loss: 0.66145842, Training R2: 0.636721
Validation Loss: 0.65887206, Validation R2: 0.644125
Saved best model with validation R2 0.644125 to finetune_dipole100000

Epoch 9/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.33it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.51it/s]
Training Loss: 0.64715425, Training R2: 0.653269
Validation Loss: 0.65673318, Validation R2: 0.635364

Epoch 10/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.35it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.51it/s]
Training Loss: 0.64170789, Training R2: 0.657886
Validation Loss: 0.62714878, Validation R2: 0.675218
Saved best model with validation R2 0.675218 to finetune_dipole100000

Epoch 11/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.19it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 13.81it/s]
Training Loss: 0.63186105, Training R2: 0.667112
Validation Loss: 0.62457048, Validation R2: 0.675600
Saved best model with validation R2 0.675600 to finetune_dipole100000

Epoch 12/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:26<00:00, 11.68it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.54it/s]
Training Loss: 0.62320035, Training R2: 0.675157
Validation Loss: 0.63103294, Validation R2: 0.672153

Epoch 13/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:28<00:00, 10.93it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.56it/s]
Training Loss: 0.61284924, Training R2: 0.686120
Validation Loss: 0.60509675, Validation R2: 0.686043
Saved best model with validation R2 0.686043 to finetune_dipole100000

Epoch 14/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.24it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.15it/s]
Training Loss: 0.60783185, Training R2: 0.689656
Validation Loss: 0.60325722, Validation R2: 0.694442
Saved best model with validation R2 0.694442 to finetune_dipole100000

Epoch 15/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.33it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.51it/s]
Training Loss: 0.59934882, Training R2: 0.698785
Validation Loss: 0.59650636, Validation R2: 0.701766
Saved best model with validation R2 0.701766 to finetune_dipole100000

Epoch 16/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:26<00:00, 11.63it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.70it/s]
Training Loss: 0.59283885, Training R2: 0.703973
Validation Loss: 0.60681490, Validation R2: 0.679773

Epoch 17/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.19it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.01it/s]
Training Loss: 0.58535721, Training R2: 0.711382
Validation Loss: 0.57637226, Validation R2: 0.715573
Saved best model with validation R2 0.715573 to finetune_dipole100000

Epoch 18/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:28<00:00, 11.02it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.77it/s]
Training Loss: 0.58106161, Training R2: 0.716192
Validation Loss: 0.58780936, Validation R2: 0.700463

Epoch 19/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.22it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.19it/s]
Training Loss: 0.57644486, Training R2: 0.720277
Validation Loss: 0.58635044, Validation R2: 0.699595

Epoch 20/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:27<00:00, 11.51it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.46it/s]
Training Loss: 0.56843563, Training R2: 0.726818
Validation Loss: 0.58904873, Validation R2: 0.698625

Epoch 21/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:28<00:00, 10.84it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:05<00:00, 13.87it/s]
Training Loss: 0.56703767, Training R2: 0.728506
Validation Loss: 0.56794498, Validation R2: 0.727837
Saved best model with validation R2 0.727837 to finetune_dipole100000

Epoch 22/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:28<00:00, 10.88it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.17it/s]
Training Loss: 0.55939194, Training R2: 0.734196
Validation Loss: 0.58111926, Validation R2: 0.712207

Epoch 23/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.94it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.35it/s]
Training Loss: 0.55639909, Training R2: 0.736721
Validation Loss: 0.57100972, Validation R2: 0.717807

Epoch 24/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.73it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.78it/s]
Training Loss: 0.55309261, Training R2: 0.740481
Validation Loss: 0.54798084, Validation R2: 0.741913
Saved best model with validation R2 0.741913 to finetune_dipole100000

Epoch 25/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.49it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:10<00:00,  7.75it/s]
Training Loss: 0.54582668, Training R2: 0.747612
Validation Loss: 0.55495802, Validation R2: 0.737922

Epoch 26/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.58it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  8.99it/s]
Training Loss: 0.54111738, Training R2: 0.750567
Validation Loss: 0.57813858, Validation R2: 0.706703

Epoch 27/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.44it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:10<00:00,  7.89it/s]
Training Loss: 0.53813965, Training R2: 0.753198
Validation Loss: 0.57107640, Validation R2: 0.729164

Epoch 28/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.82it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  8.94it/s]
Training Loss: 0.53318282, Training R2: 0.757824
Validation Loss: 0.57092238, Validation R2: 0.724971

Epoch 29/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.45it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.71it/s]
Training Loss: 0.52937372, Training R2: 0.760112
Validation Loss: 0.70448852, Validation R2: 0.566644

Epoch 30/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.84it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.77it/s]
Training Loss: 0.52625054, Training R2: 0.762326
Validation Loss: 0.55819616, Validation R2: 0.731810

Epoch 31/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.56it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.13it/s]
Training Loss: 0.52002019, Training R2: 0.767931
Validation Loss: 0.56250776, Validation R2: 0.736953

Epoch 32/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:38<00:00,  8.18it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.15it/s]
Training Loss: 0.51789371, Training R2: 0.769383
Validation Loss: 0.51646956, Validation R2: 0.769801
Saved best model with validation R2 0.769801 to finetune_dipole100000

Epoch 33/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.85it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.46it/s]
Training Loss: 0.51601185, Training R2: 0.771388
Validation Loss: 0.53461381, Validation R2: 0.744741

Epoch 34/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.54it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.05it/s]
Training Loss: 0.50907656, Training R2: 0.776448
Validation Loss: 0.51769477, Validation R2: 0.769221

Epoch 35/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.50it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.60it/s]
Training Loss: 0.51284663, Training R2: 0.773820
Validation Loss: 0.54558367, Validation R2: 0.745202

Epoch 36/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.43it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.68it/s]
Training Loss: 0.50517722, Training R2: 0.779806
Validation Loss: 0.52952496, Validation R2: 0.747718

Epoch 37/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.47it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.42it/s]
Training Loss: 0.49890166, Training R2: 0.783785
Validation Loss: 0.51405418, Validation R2: 0.764037

Epoch 38/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.41it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.05it/s]
Training Loss: 0.49922350, Training R2: 0.785206
Validation Loss: 0.51349073, Validation R2: 0.773412
Saved best model with validation R2 0.773412 to finetune_dipole100000

Epoch 39/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.74it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.08it/s]
Training Loss: 0.49700170, Training R2: 0.786571
Validation Loss: 0.52107819, Validation R2: 0.760781

Epoch 40/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:34<00:00,  9.02it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  8.99it/s]
Training Loss: 0.49295938, Training R2: 0.789104
Validation Loss: 0.49768342, Validation R2: 0.779691
Saved best model with validation R2 0.779691 to finetune_dipole100000

Epoch 41/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.41it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.53it/s]
Training Loss: 0.49291061, Training R2: 0.790010
Validation Loss: 0.51394199, Validation R2: 0.762745

Epoch 42/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.57it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.46it/s]
Training Loss: 0.48624817, Training R2: 0.794660
Validation Loss: 0.50671910, Validation R2: 0.774698

Epoch 43/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.46it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.12it/s]
Training Loss: 0.48182059, Training R2: 0.797991
Validation Loss: 0.50683809, Validation R2: 0.777598

Epoch 44/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.42it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:10<00:00,  7.80it/s]
Training Loss: 0.47894004, Training R2: 0.800340
Validation Loss: 0.50049090, Validation R2: 0.772839

Epoch 45/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.42it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.08it/s]
Training Loss: 0.47971847, Training R2: 0.799748
Validation Loss: 0.49100149, Validation R2: 0.785085
Saved best model with validation R2 0.785085 to finetune_dipole100000

Epoch 46/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.35it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.01it/s]
Training Loss: 0.47597880, Training R2: 0.802431
Validation Loss: 0.50276811, Validation R2: 0.779981

Epoch 47/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:38<00:00,  8.14it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.24it/s]
Training Loss: 0.47545611, Training R2: 0.802892
Validation Loss: 0.49359962, Validation R2: 0.788949
Saved best model with validation R2 0.788949 to finetune_dipole100000

Epoch 48/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.50it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:10<00:00,  7.86it/s]
Training Loss: 0.47340338, Training R2: 0.804175
Validation Loss: 0.49687097, Validation R2: 0.776723

Epoch 49/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:38<00:00,  8.23it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.14it/s]
Training Loss: 0.47056102, Training R2: 0.805917
Validation Loss: 0.49406062, Validation R2: 0.782354

Epoch 50/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.81it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.18it/s]
Training Loss: 0.46738511, Training R2: 0.807927
Validation Loss: 0.50847249, Validation R2: 0.768158

Epoch 51/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.48it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.18it/s]
Training Loss: 0.46650561, Training R2: 0.809150
Validation Loss: 0.50824710, Validation R2: 0.769160

Epoch 52/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.55it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.11it/s]
Training Loss: 0.46762824, Training R2: 0.808842
Validation Loss: 0.49727773, Validation R2: 0.773500

Epoch 53/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.59it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.50it/s]
Training Loss: 0.46316146, Training R2: 0.811742
Validation Loss: 0.47934377, Validation R2: 0.796068
Saved best model with validation R2 0.796068 to finetune_dipole100000

Epoch 54/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.86it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.49it/s]
Training Loss: 0.46174531, Training R2: 0.813157
Validation Loss: 0.47077214, Validation R2: 0.798476
Saved best model with validation R2 0.798476 to finetune_dipole100000

Epoch 55/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.59it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  8.84it/s]
Training Loss: 0.45642945, Training R2: 0.816083
Validation Loss: 0.48760777, Validation R2: 0.788481

Epoch 56/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.31it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.29it/s]
Training Loss: 0.45814880, Training R2: 0.815430
Validation Loss: 0.48412831, Validation R2: 0.791577

Epoch 57/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.42it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.41it/s]
Training Loss: 0.45873534, Training R2: 0.816016
Validation Loss: 0.50612434, Validation R2: 0.765447

Epoch 58/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.46it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.57it/s]
Training Loss: 0.45172451, Training R2: 0.819314
Validation Loss: 0.46472655, Validation R2: 0.808499
Saved best model with validation R2 0.808499 to finetune_dipole100000

Epoch 59/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.59it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.15it/s]
Training Loss: 0.45249810, Training R2: 0.819337
Validation Loss: 0.49626333, Validation R2: 0.776732

Epoch 60/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.54it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.46it/s]
Training Loss: 0.45055555, Training R2: 0.821204
Validation Loss: 0.47552147, Validation R2: 0.800319

Epoch 61/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.35it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.77it/s]
Training Loss: 0.44883710, Training R2: 0.821649
Validation Loss: 0.47068364, Validation R2: 0.797765

Epoch 62/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.35it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  7.93it/s]
Training Loss: 0.44307012, Training R2: 0.826783
Validation Loss: 0.48839376, Validation R2: 0.785305

Epoch 63/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:38<00:00,  8.16it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.11it/s]
Training Loss: 0.44549789, Training R2: 0.824674
Validation Loss: 0.49521383, Validation R2: 0.771209

Epoch 64/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.41it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.37it/s]
Training Loss: 0.44073342, Training R2: 0.828250
Validation Loss: 0.47475686, Validation R2: 0.794637

Epoch 65/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.58it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.39it/s]
Training Loss: 0.44059607, Training R2: 0.828136
Validation Loss: 0.47439825, Validation R2: 0.796208

Epoch 66/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:38<00:00,  8.22it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.45it/s]
Training Loss: 0.43721001, Training R2: 0.830302
Validation Loss: 0.46786006, Validation R2: 0.800206

Epoch 67/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.75it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.69it/s]
Training Loss: 0.43705685, Training R2: 0.830141
Validation Loss: 0.48202558, Validation R2: 0.789674

Epoch 68/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.55it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.45it/s]
Training Loss: 0.43350501, Training R2: 0.833491
Validation Loss: 0.48550319, Validation R2: 0.787905

Epoch 69/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.33it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.17it/s]
Training Loss: 0.43436958, Training R2: 0.832205
Validation Loss: 0.45905447, Validation R2: 0.812763
Saved best model with validation R2 0.812763 to finetune_dipole100000

Epoch 70/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.69it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.29it/s]
Training Loss: 0.43111866, Training R2: 0.834832
Validation Loss: 0.47770269, Validation R2: 0.796307

Epoch 71/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.25it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:10<00:00,  7.77it/s]
Training Loss: 0.43067817, Training R2: 0.834526
Validation Loss: 0.45546897, Validation R2: 0.811279

Epoch 72/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.46it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.52it/s]
Training Loss: 0.42608381, Training R2: 0.838120
Validation Loss: 0.46386963, Validation R2: 0.803048

Epoch 73/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.60it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.51it/s]
Training Loss: 0.42591577, Training R2: 0.838099
Validation Loss: 0.45054811, Validation R2: 0.817210
Saved best model with validation R2 0.817210 to finetune_dipole100000

Epoch 74/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.45it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.03it/s]
Training Loss: 0.42638129, Training R2: 0.838405
Validation Loss: 0.46416077, Validation R2: 0.799804

Epoch 75/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.35it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.01it/s]
Training Loss: 0.42400278, Training R2: 0.839800
Validation Loss: 0.44517935, Validation R2: 0.818537
Saved best model with validation R2 0.818537 to finetune_dipole100000

Epoch 76/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.51it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  7.95it/s]
Training Loss: 0.42090114, Training R2: 0.840953
Validation Loss: 0.46326286, Validation R2: 0.806144

Epoch 77/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.49it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.72it/s]
Training Loss: 0.42384832, Training R2: 0.839411
Validation Loss: 0.46096470, Validation R2: 0.808031

Epoch 78/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.68it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.19it/s]
Training Loss: 0.41991314, Training R2: 0.841946
Validation Loss: 0.44981642, Validation R2: 0.813385

Epoch 79/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.41it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.21it/s]
Training Loss: 0.41532059, Training R2: 0.845382
Validation Loss: 0.43819588, Validation R2: 0.823899
Saved best model with validation R2 0.823899 to finetune_dipole100000

Epoch 80/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:35<00:00,  8.90it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.37it/s]
Training Loss: 0.41738590, Training R2: 0.844552
Validation Loss: 0.44837314, Validation R2: 0.817099

Epoch 81/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.54it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.04it/s]
Training Loss: 0.41631731, Training R2: 0.845032
Validation Loss: 0.46224384, Validation R2: 0.802909

Epoch 82/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.41it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.60it/s]
Training Loss: 0.41274909, Training R2: 0.847117
Validation Loss: 0.46618288, Validation R2: 0.800244

Epoch 83/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.47it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.32it/s]
Training Loss: 0.40927117, Training R2: 0.849266
Validation Loss: 0.45811409, Validation R2: 0.804740

Epoch 84/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.45it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.26it/s]
Training Loss: 0.41286342, Training R2: 0.846944
Validation Loss: 0.45500907, Validation R2: 0.807214

Epoch 85/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.40it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.15it/s]
Training Loss: 0.41299542, Training R2: 0.846863
Validation Loss: 0.45137537, Validation R2: 0.811184

Epoch 86/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.50it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.01it/s]
Training Loss: 0.40958852, Training R2: 0.849604
Validation Loss: 0.44220848, Validation R2: 0.820496

Epoch 87/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.47it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.51it/s]
Training Loss: 0.40626003, Training R2: 0.851584
Validation Loss: 0.45088763, Validation R2: 0.812642

Epoch 88/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.66it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.28it/s]
Training Loss: 0.40860222, Training R2: 0.849223
Validation Loss: 0.43334181, Validation R2: 0.827353
Saved best model with validation R2 0.827353 to finetune_dipole100000

Epoch 89/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.47it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.28it/s]
Training Loss: 0.40435171, Training R2: 0.851854
Validation Loss: 0.45357272, Validation R2: 0.810920

Epoch 90/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.46it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.43it/s]
Training Loss: 0.40473175, Training R2: 0.852201
Validation Loss: 0.43841335, Validation R2: 0.822785

Epoch 91/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.48it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.73it/s]
Training Loss: 0.40140404, Training R2: 0.854355
Validation Loss: 0.43597221, Validation R2: 0.826880

Epoch 92/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.44it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:10<00:00,  7.89it/s]
Training Loss: 0.40013853, Training R2: 0.854982
Validation Loss: 0.44313025, Validation R2: 0.816842

Epoch 93/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.45it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.36it/s]
Training Loss: 0.39955969, Training R2: 0.855122
Validation Loss: 0.44785368, Validation R2: 0.812368

Epoch 94/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.59it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.09it/s]
Training Loss: 0.39708838, Training R2: 0.856863
Validation Loss: 0.43814537, Validation R2: 0.821458

Epoch 95/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.48it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:10<00:00,  7.89it/s]
Training Loss: 0.39590107, Training R2: 0.857992
Validation Loss: 0.44636697, Validation R2: 0.815424

Epoch 96/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.45it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.42it/s]
Training Loss: 0.39386535, Training R2: 0.859292
Validation Loss: 0.43110094, Validation R2: 0.827695
Saved best model with validation R2 0.827695 to finetune_dipole100000

Epoch 97/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.26it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.26it/s]
Training Loss: 0.39625257, Training R2: 0.858087
Validation Loss: 0.43963169, Validation R2: 0.820277

Epoch 98/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:36<00:00,  8.65it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.53it/s]
Training Loss: 0.39392242, Training R2: 0.859680
Validation Loss: 0.43748463, Validation R2: 0.818786

Epoch 99/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:38<00:00,  8.13it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:08<00:00,  9.74it/s]
Training Loss: 0.39361616, Training R2: 0.859462
Validation Loss: 0.43873943, Validation R2: 0.821973

Epoch 100/100
Training: 100%|████████████████████████████████████████████████████| 313/313 [00:37<00:00,  8.40it/s]
Validation: 100%|████████████████████████████████████████████████████| 79/79 [00:09<00:00,  8.27it/s]
Training Loss: 0.39330464, Training R2: 0.860402
Validation Loss: 0.44381877, Validation R2: 0.813729

Training completed.
Saved loss curve to /share/home/alpha/block_predict/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/alpha/block_predict/block_predict/fine-tune/r2_curve_dipole.png
