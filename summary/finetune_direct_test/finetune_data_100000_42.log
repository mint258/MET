Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 100000, Training: 80000, Validation: 20000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3258499

Epoch 1/1000
Training Loss: 0.71394799, Training R2: 0.525055
Validation Loss: 0.50976752, Validation R2: 0.749264
Saved best model with validation R2 0.749264 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.40721091, Training R2: 0.823393
Validation Loss: 0.34998976, Validation R2: 0.866790
Saved best model with validation R2 0.866790 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.31613832, Training R2: 0.885454
Validation Loss: 0.34225340, Validation R2: 0.874912
Saved best model with validation R2 0.874912 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.26402498, Training R2: 0.921504
Validation Loss: 0.25973747, Validation R2: 0.922111
Saved best model with validation R2 0.922111 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.23162993, Training R2: 0.943241
Validation Loss: 0.27444525, Validation R2: 0.926808
Saved best model with validation R2 0.926808 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.20713728, Training R2: 0.954528
Validation Loss: 0.21960128, Validation R2: 0.945333
Saved best model with validation R2 0.945333 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.18867993, Training R2: 0.961521
Validation Loss: 0.21553764, Validation R2: 0.948555
Saved best model with validation R2 0.948555 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.17308419, Training R2: 0.966933
Validation Loss: 0.20139339, Validation R2: 0.953114
Saved best model with validation R2 0.953114 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.16485634, Training R2: 0.970120
Validation Loss: 0.19554749, Validation R2: 0.954982
Saved best model with validation R2 0.954982 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.15508389, Training R2: 0.973547
Validation Loss: 0.17883758, Validation R2: 0.960334
Saved best model with validation R2 0.960334 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.14448622, Training R2: 0.976795
Validation Loss: 0.19107184, Validation R2: 0.959730

Epoch 12/1000
Training Loss: 0.14345575, Training R2: 0.977718
Validation Loss: 0.20434856, Validation R2: 0.955072

Epoch 13/1000
Training Loss: 0.13044936, Training R2: 0.981012
Validation Loss: 0.18591735, Validation R2: 0.960169

Epoch 14/1000
Training Loss: 0.12872406, Training R2: 0.981995
Validation Loss: 0.16910399, Validation R2: 0.965557
Saved best model with validation R2 0.965557 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.12218445, Training R2: 0.983759
Validation Loss: 0.16103781, Validation R2: 0.967715
Saved best model with validation R2 0.967715 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.12248205, Training R2: 0.984130
Validation Loss: 0.19654060, Validation R2: 0.959941

Epoch 17/1000
Training Loss: 0.11761400, Training R2: 0.985047
Validation Loss: 0.15975255, Validation R2: 0.968416
Saved best model with validation R2 0.968416 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.11244017, Training R2: 0.986172
Validation Loss: 0.16866554, Validation R2: 0.966936

Epoch 19/1000
Training Loss: 0.10915379, Training R2: 0.987165
Validation Loss: 0.15606950, Validation R2: 0.968440
Saved best model with validation R2 0.968440 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.10517152, Training R2: 0.987991
Validation Loss: 0.15791172, Validation R2: 0.968034

Epoch 21/1000
Training Loss: 0.10447135, Training R2: 0.988270
Validation Loss: 0.14741751, Validation R2: 0.971470
Saved best model with validation R2 0.971470 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.09926216, Training R2: 0.989156
Validation Loss: 0.15156956, Validation R2: 0.970075

Epoch 23/1000
Training Loss: 0.09491081, Training R2: 0.989804
Validation Loss: 0.14917739, Validation R2: 0.971397

Epoch 24/1000
Training Loss: 0.09843144, Training R2: 0.989370
Validation Loss: 0.14872574, Validation R2: 0.972302
Saved best model with validation R2 0.972302 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.09085290, Training R2: 0.990637
Validation Loss: 0.14334116, Validation R2: 0.974278
Saved best model with validation R2 0.974278 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.09050717, Training R2: 0.990916
Validation Loss: 0.14836130, Validation R2: 0.971755

Epoch 27/1000
Training Loss: 0.09471866, Training R2: 0.990289
Validation Loss: 0.15512935, Validation R2: 0.971052

Epoch 28/1000
Training Loss: 0.08921020, Training R2: 0.991034
Validation Loss: 0.14457542, Validation R2: 0.972271

Epoch 29/1000
Training Loss: 0.08341219, Training R2: 0.991993
Validation Loss: 0.13900999, Validation R2: 0.975036
Saved best model with validation R2 0.975036 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.08366506, Training R2: 0.991937
Validation Loss: 0.13905425, Validation R2: 0.973615

Epoch 31/1000
Training Loss: 0.08249378, Training R2: 0.992277
Validation Loss: 0.14178374, Validation R2: 0.974451

Epoch 32/1000
Training Loss: 0.07955263, Training R2: 0.992729
Validation Loss: 0.13976943, Validation R2: 0.974521

Epoch 33/1000
Training Loss: 0.08189936, Training R2: 0.992342
Validation Loss: 0.13578635, Validation R2: 0.974413

Epoch 34/1000
Training Loss: 0.07910002, Training R2: 0.992654
Validation Loss: 0.13981467, Validation R2: 0.974924

Epoch 35/1000
Training Loss: 0.07243459, Training R2: 0.993456
Validation Loss: 0.13719670, Validation R2: 0.974419

Epoch 36/1000
Training Loss: 0.08022501, Training R2: 0.992716
Validation Loss: 0.13552827, Validation R2: 0.975768
Saved best model with validation R2 0.975768 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.07200727, Training R2: 0.993769
Validation Loss: 0.13483489, Validation R2: 0.975295

Epoch 38/1000
Training Loss: 0.07171608, Training R2: 0.993676
Validation Loss: 0.14040909, Validation R2: 0.975406

Epoch 39/1000
Training Loss: 0.07467847, Training R2: 0.993461
Validation Loss: 0.13304014, Validation R2: 0.976268
Saved best model with validation R2 0.976268 to best_finetuned_model.pth

Epoch 40/1000
Training Loss: 0.07117880, Training R2: 0.993792
Validation Loss: 0.13503967, Validation R2: 0.974984

Epoch 41/1000
Training Loss: 0.07301694, Training R2: 0.993597
Validation Loss: 0.14583289, Validation R2: 0.973085

Epoch 42/1000
Training Loss: 0.06911618, Training R2: 0.994032
Validation Loss: 0.13037461, Validation R2: 0.977110
Saved best model with validation R2 0.977110 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.06917918, Training R2: 0.994080
Validation Loss: 0.13049828, Validation R2: 0.976265

Epoch 44/1000
Training Loss: 0.06878976, Training R2: 0.994177
Validation Loss: 0.13576192, Validation R2: 0.975197

Epoch 45/1000
Training Loss: 0.06584061, Training R2: 0.994417
Validation Loss: 0.12862991, Validation R2: 0.976764

Epoch 46/1000
Training Loss: 0.06658462, Training R2: 0.994434
Validation Loss: 0.13324388, Validation R2: 0.976033

Epoch 47/1000
Training Loss: 0.06647908, Training R2: 0.994481
Validation Loss: 0.13069677, Validation R2: 0.977057

Epoch 48/1000
Training Loss: 0.06193278, Training R2: 0.994914
Validation Loss: 0.13235783, Validation R2: 0.974703

Epoch 49/1000
Training Loss: 0.06804195, Training R2: 0.994331
Validation Loss: 0.13394306, Validation R2: 0.976972

Epoch 50/1000
Training Loss: 0.06372453, Training R2: 0.994854
Validation Loss: 0.12893608, Validation R2: 0.977742
Saved best model with validation R2 0.977742 to best_finetuned_model.pth

Epoch 51/1000
Training Loss: 0.06212895, Training R2: 0.994981
Validation Loss: 0.13497983, Validation R2: 0.974398

Epoch 52/1000
Training Loss: 0.06113718, Training R2: 0.995027
Validation Loss: 0.12884802, Validation R2: 0.978083
Saved best model with validation R2 0.978083 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.06069384, Training R2: 0.995178
Validation Loss: 0.13065304, Validation R2: 0.976993

Epoch 54/1000
Training Loss: 0.06192256, Training R2: 0.994986
Validation Loss: 0.12550535, Validation R2: 0.977674

Epoch 55/1000
Training Loss: 0.05903995, Training R2: 0.995244
Validation Loss: 0.12634640, Validation R2: 0.976354

Epoch 56/1000
Training Loss: 0.06445651, Training R2: 0.994847
Validation Loss: 0.12938125, Validation R2: 0.975489

Epoch 57/1000
Training Loss: 0.06126299, Training R2: 0.995047
Validation Loss: 0.12593872, Validation R2: 0.978933
Saved best model with validation R2 0.978933 to best_finetuned_model.pth

Epoch 58/1000
Training Loss: 0.05859912, Training R2: 0.995373
Validation Loss: 0.13252631, Validation R2: 0.975690

Epoch 59/1000
Training Loss: 0.05563686, Training R2: 0.995715
Validation Loss: 0.14010048, Validation R2: 0.974750

Epoch 60/1000
Training Loss: 0.05938180, Training R2: 0.995362
Validation Loss: 0.12392610, Validation R2: 0.977246

Epoch 61/1000
Training Loss: 0.05803453, Training R2: 0.995514
Validation Loss: 0.13357809, Validation R2: 0.976787

Epoch 62/1000
Training Loss: 0.05672798, Training R2: 0.995642
Validation Loss: 0.12405903, Validation R2: 0.976568

Epoch 63/1000
Training Loss: 0.05630409, Training R2: 0.995658
Validation Loss: 0.12344467, Validation R2: 0.977618

Epoch 64/1000
Training Loss: 0.05626445, Training R2: 0.995655
Validation Loss: 0.13276997, Validation R2: 0.976540

Epoch 65/1000
Training Loss: 0.05765453, Training R2: 0.995637
Validation Loss: 0.12240456, Validation R2: 0.977516

Epoch 66/1000
Training Loss: 0.05435171, Training R2: 0.995930
Validation Loss: 0.12360370, Validation R2: 0.978703

Epoch 67/1000
Training Loss: 0.05433031, Training R2: 0.995839
Validation Loss: 0.12704590, Validation R2: 0.977532

Epoch 68/1000
Training Loss: 0.05772953, Training R2: 0.995644
Validation Loss: 0.12587080, Validation R2: 0.975652

Epoch 69/1000
Training Loss: 0.05690113, Training R2: 0.995704
Validation Loss: 0.12125475, Validation R2: 0.979177
Saved best model with validation R2 0.979177 to best_finetuned_model.pth

Epoch 70/1000
Training Loss: 0.05329075, Training R2: 0.996005
Validation Loss: 0.12262141, Validation R2: 0.978553

Epoch 71/1000
Training Loss: 0.05239465, Training R2: 0.996064
Validation Loss: 0.12736160, Validation R2: 0.975835

Epoch 72/1000
Training Loss: 0.05287524, Training R2: 0.996017
Validation Loss: 0.11959350, Validation R2: 0.978358

Epoch 73/1000
Training Loss: 0.05152500, Training R2: 0.996120
Validation Loss: 0.12057704, Validation R2: 0.977837

Epoch 74/1000
Training Loss: 0.05223371, Training R2: 0.996184
Validation Loss: 0.12462626, Validation R2: 0.979406
Saved best model with validation R2 0.979406 to best_finetuned_model.pth

Epoch 75/1000
Training Loss: 0.05432932, Training R2: 0.995979
Validation Loss: 0.12054993, Validation R2: 0.978083

Epoch 76/1000
Training Loss: 0.05351044, Training R2: 0.996088
Validation Loss: 0.12440100, Validation R2: 0.978345

Epoch 77/1000
Training Loss: 0.04922469, Training R2: 0.996400
Validation Loss: 0.12932250, Validation R2: 0.977171

Epoch 78/1000
Training Loss: 0.05088243, Training R2: 0.996328
Validation Loss: 0.12048727, Validation R2: 0.977765

Epoch 79/1000
