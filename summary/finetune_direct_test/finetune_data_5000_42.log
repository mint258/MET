Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3258499

Epoch 1/1000
Training Loss: 1.47861822, Training R2: -0.700913
Validation Loss: 1.16770520, Validation R2: 0.043342
Saved best model with validation R2 0.043342 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.14332274, Training R2: 0.050530
Validation Loss: 1.03105397, Validation R2: 0.153238
Saved best model with validation R2 0.153238 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.00005366, Training R2: 0.252017
Validation Loss: 0.88830780, Validation R2: 0.363382
Saved best model with validation R2 0.363382 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.86484902, Training R2: 0.396460
Validation Loss: 0.81200804, Validation R2: 0.434777
Saved best model with validation R2 0.434777 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.78160591, Training R2: 0.472939
Validation Loss: 0.75058821, Validation R2: 0.511685
Saved best model with validation R2 0.511685 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.72664151, Training R2: 0.532516
Validation Loss: 0.73012434, Validation R2: 0.533445
Saved best model with validation R2 0.533445 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.68925567, Training R2: 0.575699
Validation Loss: 0.71240664, Validation R2: 0.554659
Saved best model with validation R2 0.554659 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.61200160, Training R2: 0.652328
Validation Loss: 0.66291378, Validation R2: 0.616542
Saved best model with validation R2 0.616542 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.54910840, Training R2: 0.705653
Validation Loss: 0.62383640, Validation R2: 0.653751
Saved best model with validation R2 0.653751 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.50554823, Training R2: 0.742941
Validation Loss: 0.64110016, Validation R2: 0.651542

Epoch 11/1000
Training Loss: 0.50621307, Training R2: 0.763633
Validation Loss: 0.60894315, Validation R2: 0.673074
Saved best model with validation R2 0.673074 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.45420789, Training R2: 0.799379
Validation Loss: 0.59927566, Validation R2: 0.684600
Saved best model with validation R2 0.684600 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.40964521, Training R2: 0.827722
Validation Loss: 0.55786939, Validation R2: 0.719751
Saved best model with validation R2 0.719751 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.34802168, Training R2: 0.862866
Validation Loss: 0.55687914, Validation R2: 0.721570
Saved best model with validation R2 0.721570 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.31407222, Training R2: 0.883343
Validation Loss: 0.53665549, Validation R2: 0.738059
Saved best model with validation R2 0.738059 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.30082816, Training R2: 0.892989
Validation Loss: 0.52952616, Validation R2: 0.741236
Saved best model with validation R2 0.741236 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.29992177, Training R2: 0.898420
Validation Loss: 0.58033103, Validation R2: 0.705325

Epoch 18/1000
Training Loss: 0.34123585, Training R2: 0.884623
Validation Loss: 0.53891012, Validation R2: 0.739875

Epoch 19/1000
Training Loss: 0.29028599, Training R2: 0.905011
Validation Loss: 0.51583784, Validation R2: 0.754195
Saved best model with validation R2 0.754195 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.24008494, Training R2: 0.926397
Validation Loss: 0.54002141, Validation R2: 0.733467

Epoch 21/1000
Training Loss: 0.24755454, Training R2: 0.926646
Validation Loss: 0.52699226, Validation R2: 0.749347

Epoch 22/1000
Training Loss: 0.25036875, Training R2: 0.926786
Validation Loss: 0.56623433, Validation R2: 0.715308

Epoch 23/1000
Training Loss: 0.26192574, Training R2: 0.922965
Validation Loss: 0.52040697, Validation R2: 0.751748

Epoch 24/1000
Training Loss: 0.21461917, Training R2: 0.939349
Validation Loss: 0.50646307, Validation R2: 0.762666
Saved best model with validation R2 0.762666 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.19593344, Training R2: 0.946551
Validation Loss: 0.50898507, Validation R2: 0.757929

Epoch 26/1000
Training Loss: 0.18037920, Training R2: 0.951240
Validation Loss: 0.51582327, Validation R2: 0.756494

Epoch 27/1000
Training Loss: 0.17393034, Training R2: 0.953871
Validation Loss: 0.51296643, Validation R2: 0.752150

Epoch 28/1000
Training Loss: 0.18003078, Training R2: 0.952947
Validation Loss: 0.53183263, Validation R2: 0.740138

Epoch 29/1000
Training Loss: 0.20186899, Training R2: 0.948654
Validation Loss: 0.50119180, Validation R2: 0.766308
Saved best model with validation R2 0.766308 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.17061554, Training R2: 0.957317
Validation Loss: 0.50400378, Validation R2: 0.764581

Epoch 31/1000
Training Loss: 0.16800294, Training R2: 0.957410
Validation Loss: 0.51700442, Validation R2: 0.756393

Epoch 32/1000
Training Loss: 0.14626415, Training R2: 0.963149
Validation Loss: 0.50189795, Validation R2: 0.764599

Epoch 33/1000
Training Loss: 0.16076118, Training R2: 0.961779
Validation Loss: 0.51348623, Validation R2: 0.759167

Epoch 34/1000
Training Loss: 0.14955736, Training R2: 0.964128
Validation Loss: 0.49995462, Validation R2: 0.767508
Saved best model with validation R2 0.767508 to best_finetuned_model.pth

Epoch 35/1000
Training Loss: 0.15434470, Training R2: 0.963525
Validation Loss: 0.51025917, Validation R2: 0.762055

Epoch 36/1000
Training Loss: 0.16365166, Training R2: 0.960796
Validation Loss: 0.50234748, Validation R2: 0.768730
Saved best model with validation R2 0.768730 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.14096532, Training R2: 0.967006
Validation Loss: 0.50304662, Validation R2: 0.765238

Epoch 38/1000
Training Loss: 0.14583052, Training R2: 0.965925
Validation Loss: 0.49543770, Validation R2: 0.771525
Saved best model with validation R2 0.771525 to best_finetuned_model.pth

Epoch 39/1000
Training Loss: 0.15246254, Training R2: 0.965849
Validation Loss: 0.49171157, Validation R2: 0.774720
Saved best model with validation R2 0.774720 to best_finetuned_model.pth

Epoch 40/1000
Training Loss: 0.13929204, Training R2: 0.968065
Validation Loss: 0.48806348, Validation R2: 0.775287
Saved best model with validation R2 0.775287 to best_finetuned_model.pth

Epoch 41/1000
Training Loss: 0.11450682, Training R2: 0.972203
Validation Loss: 0.49704199, Validation R2: 0.768817

Epoch 42/1000
Training Loss: 0.13021478, Training R2: 0.970352
Validation Loss: 0.48893723, Validation R2: 0.779570
Saved best model with validation R2 0.779570 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.11337869, Training R2: 0.974415
Validation Loss: 0.49093058, Validation R2: 0.776849

Epoch 44/1000
Training Loss: 0.11767726, Training R2: 0.975118
Validation Loss: 0.50798208, Validation R2: 0.760498

Epoch 45/1000
Training Loss: 0.15643189, Training R2: 0.967832
Validation Loss: 0.52432607, Validation R2: 0.751451

Epoch 46/1000
Training Loss: 0.18456445, Training R2: 0.962737
Validation Loss: 0.50718056, Validation R2: 0.765164

Epoch 47/1000
Training Loss: 0.13418029, Training R2: 0.970854
Validation Loss: 0.48286028, Validation R2: 0.778700

Epoch 48/1000
Training Loss: 0.11029079, Training R2: 0.975646
Validation Loss: 0.48277640, Validation R2: 0.780060
Saved best model with validation R2 0.780060 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.11612966, Training R2: 0.976055
Validation Loss: 0.48781158, Validation R2: 0.777595

Epoch 50/1000
Training Loss: 0.12125050, Training R2: 0.974722
Validation Loss: 0.48203123, Validation R2: 0.779680

Epoch 51/1000
Training Loss: 0.12626289, Training R2: 0.975331
Validation Loss: 0.48623346, Validation R2: 0.776349

Epoch 52/1000
Training Loss: 0.10799616, Training R2: 0.977014
Validation Loss: 0.47402355, Validation R2: 0.786314
Saved best model with validation R2 0.786314 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.13062041, Training R2: 0.973456
Validation Loss: 0.47596011, Validation R2: 0.785867

Epoch 54/1000
Training Loss: 0.15053840, Training R2: 0.970519
Validation Loss: 0.47743884, Validation R2: 0.781629

Epoch 55/1000
Training Loss: 0.16114790, Training R2: 0.969117
Validation Loss: 0.48328959, Validation R2: 0.781097

Epoch 56/1000
Training Loss: 0.13451732, Training R2: 0.973531
Validation Loss: 0.48120311, Validation R2: 0.783755

Epoch 57/1000
Training Loss: 0.12279330, Training R2: 0.975877
Validation Loss: 0.47923835, Validation R2: 0.782376

Epoch 58/1000
Training Loss: 0.11324259, Training R2: 0.977959
Validation Loss: 0.48411547, Validation R2: 0.779771

Epoch 59/1000
Training Loss: 0.10278029, Training R2: 0.979165
Validation Loss: 0.47607847, Validation R2: 0.785801

Epoch 60/1000
Training Loss: 0.09213711, Training R2: 0.982000
Validation Loss: 0.47904163, Validation R2: 0.782746

Epoch 61/1000
Training Loss: 0.08869888, Training R2: 0.982426
Validation Loss: 0.47882105, Validation R2: 0.783206

Epoch 62/1000
Training Loss: 0.08854647, Training R2: 0.981938
Validation Loss: 0.47011795, Validation R2: 0.789522
Saved best model with validation R2 0.789522 to best_finetuned_model.pth

Epoch 63/1000
Training Loss: 0.09286868, Training R2: 0.982127
Validation Loss: 0.47696339, Validation R2: 0.785453

Epoch 64/1000
Training Loss: 0.09262074, Training R2: 0.982533
Validation Loss: 0.47644264, Validation R2: 0.785011

Epoch 65/1000
Training Loss: 0.08264316, Training R2: 0.983889
Validation Loss: 0.47269760, Validation R2: 0.788345

Epoch 66/1000
Training Loss: 0.07776402, Training R2: 0.984803
Validation Loss: 0.46839680, Validation R2: 0.788709

Epoch 67/1000
Training Loss: 0.08683477, Training R2: 0.983610
Validation Loss: 0.47821853, Validation R2: 0.782652

Epoch 68/1000
Training Loss: 0.08733387, Training R2: 0.984471
Validation Loss: 0.48270630, Validation R2: 0.778315

Epoch 69/1000
Training Loss: 0.08778848, Training R2: 0.984466
Validation Loss: 0.47703593, Validation R2: 0.785917

Epoch 70/1000
Training Loss: 0.07901954, Training R2: 0.984834
Validation Loss: 0.47934286, Validation R2: 0.783058

Epoch 71/1000
Training Loss: 0.08408038, Training R2: 0.984513
Validation Loss: 0.47359528, Validation R2: 0.788015

Epoch 72/1000
Training Loss: 0.07811089, Training R2: 0.985482
Validation Loss: 0.48092818, Validation R2: 0.783913

Epoch 73/1000
Training Loss: 0.08570693, Training R2: 0.983737
Validation Loss: 0.47091374, Validation R2: 0.789432

Epoch 74/1000
Training Loss: 0.08113157, Training R2: 0.985585
Validation Loss: 0.47125795, Validation R2: 0.788701

Epoch 75/1000
Training Loss: 0.07355122, Training R2: 0.986518
Validation Loss: 0.47061756, Validation R2: 0.787998

Epoch 76/1000
Training Loss: 0.07725982, Training R2: 0.986256
Validation Loss: 0.47975083, Validation R2: 0.784191

Epoch 77/1000
Training Loss: 0.08258130, Training R2: 0.985438
Validation Loss: 0.47042390, Validation R2: 0.789442

Epoch 78/1000
Training Loss: 0.07250136, Training R2: 0.987322
Validation Loss: 0.47538147, Validation R2: 0.786858

Epoch 79/1000
Training Loss: 0.07141695, Training R2: 0.987382
Validation Loss: 0.47167974, Validation R2: 0.789508

Epoch 80/1000
Training Loss: 0.06685413, Training R2: 0.987606
Validation Loss: 0.47550385, Validation R2: 0.785426

Epoch 81/1000
Training Loss: 0.07559688, Training R2: 0.987175
Validation Loss: 0.47528027, Validation R2: 0.785369

Epoch 82/1000
Training Loss: 0.08045584, Training R2: 0.985892
Validation Loss: 0.47253151, Validation R2: 0.788486

Epoch 83/1000
Epoch 00083: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.07268498, Training R2: 0.987143
Validation Loss: 0.47044402, Validation R2: 0.787644

Epoch 84/1000
学习率已减少 1 次
Training Loss: 0.05925675, Training R2: 0.988463
Validation Loss: 0.46858241, Validation R2: 0.790688
Saved best model with validation R2 0.790688 to best_finetuned_model.pth

Epoch 85/1000
Training Loss: 0.04914989, Training R2: 0.989440
Validation Loss: 0.46670281, Validation R2: 0.791266
Saved best model with validation R2 0.791266 to best_finetuned_model.pth

Epoch 86/1000
Training Loss: 0.04056529, Training R2: 0.990085
Validation Loss: 0.46859837, Validation R2: 0.789522

Epoch 87/1000
Training Loss: 0.03944476, Training R2: 0.990034
Validation Loss: 0.46603405, Validation R2: 0.792669
Saved best model with validation R2 0.792669 to best_finetuned_model.pth

Epoch 88/1000
Training Loss: 0.03929215, Training R2: 0.990398
Validation Loss: 0.46855020, Validation R2: 0.790707

Epoch 89/1000
Training Loss: 0.03717302, Training R2: 0.989757
Validation Loss: 0.46704027, Validation R2: 0.791226

Epoch 90/1000
Training Loss: 0.03622641, Training R2: 0.990322
Validation Loss: 0.46826493, Validation R2: 0.790308

Epoch 91/1000
Training Loss: 0.03975428, Training R2: 0.990546
Validation Loss: 0.46894749, Validation R2: 0.790216

Epoch 92/1000
Training Loss: 0.03973953, Training R2: 0.990430
Validation Loss: 0.47001728, Validation R2: 0.790347

Epoch 93/1000
Training Loss: 0.03577574, Training R2: 0.990672
Validation Loss: 0.46660564, Validation R2: 0.791910

Epoch 94/1000
Training Loss: 0.03814806, Training R2: 0.990552
Validation Loss: 0.46672408, Validation R2: 0.791452

Epoch 95/1000
Training Loss: 0.04821658, Training R2: 0.990001
Validation Loss: 0.46717611, Validation R2: 0.790655

Epoch 96/1000
Training Loss: 0.05688769, Training R2: 0.989284
Validation Loss: 0.46868389, Validation R2: 0.790893

Epoch 97/1000
Training Loss: 0.06593213, Training R2: 0.989003
Validation Loss: 0.46956647, Validation R2: 0.790509

Epoch 98/1000
Training Loss: 0.04672342, Training R2: 0.990089
Validation Loss: 0.47013576, Validation R2: 0.789572

Epoch 99/1000
Training Loss: 0.04508245, Training R2: 0.990086
Validation Loss: 0.47382471, Validation R2: 0.787772

Epoch 100/1000
Training Loss: 0.04404228, Training R2: 0.990438
Validation Loss: 0.47140544, Validation R2: 0.790629

Epoch 101/1000
Training Loss: 0.04456601, Training R2: 0.990321
Validation Loss: 0.46991766, Validation R2: 0.790208

Epoch 102/1000
Training Loss: 0.03921153, Training R2: 0.990830
Validation Loss: 0.46815080, Validation R2: 0.791008

Epoch 103/1000
Training Loss: 0.03529802, Training R2: 0.990982
Validation Loss: 0.46899100, Validation R2: 0.791054

Epoch 104/1000
Training Loss: 0.04107180, Training R2: 0.990659
Validation Loss: 0.46832513, Validation R2: 0.791330

Epoch 105/1000
Training Loss: 0.04169519, Training R2: 0.990702
Validation Loss: 0.46630108, Validation R2: 0.791800

Epoch 106/1000
Training Loss: 0.03802407, Training R2: 0.990968
Validation Loss: 0.47208985, Validation R2: 0.789618

Epoch 107/1000
Training Loss: 0.06446791, Training R2: 0.988741
Validation Loss: 0.46966671, Validation R2: 0.789527

Epoch 108/1000
Epoch 00108: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03822759, Training R2: 0.990668
Validation Loss: 0.46808421, Validation R2: 0.791518

Epoch 109/1000
学习率已减少 2 次
Training Loss: 0.03190949, Training R2: 0.991281
Validation Loss: 0.46669501, Validation R2: 0.792060

Epoch 110/1000
Training Loss: 0.03230477, Training R2: 0.991322
Validation Loss: 0.46701767, Validation R2: 0.791748

Epoch 111/1000
Training Loss: 0.02926270, Training R2: 0.991392
Validation Loss: 0.46984900, Validation R2: 0.790699

Epoch 112/1000
Training Loss: 0.02411619, Training R2: 0.991600
Validation Loss: 0.46663922, Validation R2: 0.791570

Epoch 113/1000
Training Loss: 0.02146017, Training R2: 0.991800
Validation Loss: 0.46913341, Validation R2: 0.790947

Epoch 114/1000
Training Loss: 0.02035442, Training R2: 0.991809
Validation Loss: 0.46680183, Validation R2: 0.792242

Epoch 115/1000
Training Loss: 0.02082103, Training R2: 0.991658
Validation Loss: 0.46813529, Validation R2: 0.791586

Epoch 116/1000
Training Loss: 0.02083054, Training R2: 0.991737
Validation Loss: 0.46896185, Validation R2: 0.791047

Epoch 117/1000
Training Loss: 0.01956632, Training R2: 0.991722
Validation Loss: 0.46733197, Validation R2: 0.791619

Epoch 118/1000
Training Loss: 0.01909022, Training R2: 0.991784
Validation Loss: 0.46722615, Validation R2: 0.791902

Epoch 119/1000
Training Loss: 0.02284610, Training R2: 0.991818
Validation Loss: 0.46737736, Validation R2: 0.791233

Epoch 120/1000
Training Loss: 0.02431790, Training R2: 0.991698
Validation Loss: 0.46920600, Validation R2: 0.790642

Epoch 121/1000
Training Loss: 0.02115592, Training R2: 0.991827
Validation Loss: 0.46718841, Validation R2: 0.791351

Epoch 122/1000
Training Loss: 0.02148567, Training R2: 0.991798
Validation Loss: 0.46869054, Validation R2: 0.791116

Epoch 123/1000
Training Loss: 0.02460759, Training R2: 0.991803
Validation Loss: 0.46843743, Validation R2: 0.791069

Epoch 124/1000
Training Loss: 0.02553481, Training R2: 0.991752
Validation Loss: 0.46866581, Validation R2: 0.791013

Epoch 125/1000
Training Loss: 0.02281234, Training R2: 0.991780
Validation Loss: 0.46690131, Validation R2: 0.791538

Epoch 126/1000
Training Loss: 0.02079061, Training R2: 0.991916
Validation Loss: 0.46882936, Validation R2: 0.791062

Epoch 127/1000
Training Loss: 0.01940906, Training R2: 0.991905
Validation Loss: 0.46711463, Validation R2: 0.792144

Epoch 128/1000
Training Loss: 0.02063308, Training R2: 0.991972
Validation Loss: 0.46690619, Validation R2: 0.791958

Epoch 129/1000
Epoch 00129: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.02679868, Training R2: 0.991724
Validation Loss: 0.46752721, Validation R2: 0.791208

Epoch 130/1000
学习率已减少 3 次
Training Loss: 0.01929141, Training R2: 0.991963
Validation Loss: 0.46660294, Validation R2: 0.792118

Epoch 131/1000
Training Loss: 0.01619658, Training R2: 0.992189
Validation Loss: 0.46812311, Validation R2: 0.791503

Epoch 132/1000
Training Loss: 0.01450911, Training R2: 0.992129
Validation Loss: 0.46749642, Validation R2: 0.791777

Epoch 133/1000
Training Loss: 0.01240163, Training R2: 0.992135
Validation Loss: 0.46701913, Validation R2: 0.791797

Epoch 134/1000
Training Loss: 0.01388780, Training R2: 0.992195
Validation Loss: 0.46740877, Validation R2: 0.791848

Epoch 135/1000
Training Loss: 0.01266885, Training R2: 0.992211
Validation Loss: 0.46743506, Validation R2: 0.791558

Epoch 136/1000
Training Loss: 0.01276471, Training R2: 0.992193
Validation Loss: 0.46754454, Validation R2: 0.791243

Epoch 137/1000
Training Loss: 0.01442952, Training R2: 0.992192
Validation Loss: 0.46720499, Validation R2: 0.791681

Epoch 138/1000
Training Loss: 0.01466965, Training R2: 0.992152
Validation Loss: 0.46761314, Validation R2: 0.791515

Epoch 139/1000
Training Loss: 0.01237089, Training R2: 0.992205
Validation Loss: 0.46768527, Validation R2: 0.791533

Epoch 140/1000
Training Loss: 0.01318441, Training R2: 0.992215
Validation Loss: 0.46744137, Validation R2: 0.791717

Epoch 141/1000
Training Loss: 0.01353128, Training R2: 0.992189
Validation Loss: 0.46736210, Validation R2: 0.791676

Epoch 142/1000
Training Loss: 0.01396460, Training R2: 0.992218
Validation Loss: 0.46794935, Validation R2: 0.791407

Epoch 143/1000
Training Loss: 0.01309033, Training R2: 0.992236
Validation Loss: 0.46730913, Validation R2: 0.791592

Epoch 144/1000
Training Loss: 0.01302519, Training R2: 0.992255
Validation Loss: 0.46705217, Validation R2: 0.792056

Epoch 145/1000
Training Loss: 0.01217479, Training R2: 0.992297
Validation Loss: 0.46717508, Validation R2: 0.791931

Epoch 146/1000
Training Loss: 0.01262838, Training R2: 0.992329
Validation Loss: 0.46745588, Validation R2: 0.791572

Epoch 147/1000
Training Loss: 0.01394539, Training R2: 0.992285
Validation Loss: 0.46729142, Validation R2: 0.791980

Epoch 148/1000
Training Loss: 0.01170236, Training R2: 0.992323
Validation Loss: 0.46705032, Validation R2: 0.791686

Epoch 149/1000
Training Loss: 0.01367070, Training R2: 0.992334
Validation Loss: 0.46777589, Validation R2: 0.791287

Epoch 150/1000
Epoch 00150: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.01362444, Training R2: 0.992292
Validation Loss: 0.46714918, Validation R2: 0.791853

Epoch 151/1000
学习率已减少 4 次
Training Loss: 0.01219827, Training R2: 0.992289
Validation Loss: 0.46754597, Validation R2: 0.791577

Epoch 152/1000
Training Loss: 0.01089964, Training R2: 0.992340
Validation Loss: 0.46722852, Validation R2: 0.791709

Epoch 153/1000
Training Loss: 0.01175130, Training R2: 0.992375
Validation Loss: 0.46690820, Validation R2: 0.791855

Epoch 154/1000
Training Loss: 0.01138346, Training R2: 0.992381
Validation Loss: 0.46740431, Validation R2: 0.791615

Epoch 155/1000
Training Loss: 0.00985319, Training R2: 0.992409
Validation Loss: 0.46718811, Validation R2: 0.791665

Epoch 156/1000
Training Loss: 0.00922191, Training R2: 0.992359
Validation Loss: 0.46715578, Validation R2: 0.791829

Epoch 157/1000
Training Loss: 0.00888080, Training R2: 0.992388
Validation Loss: 0.46742067, Validation R2: 0.791655

Epoch 158/1000
Training Loss: 0.00805900, Training R2: 0.992411
Validation Loss: 0.46707798, Validation R2: 0.791752

Epoch 159/1000
Training Loss: 0.00893467, Training R2: 0.992412
Validation Loss: 0.46720163, Validation R2: 0.791874

Epoch 160/1000
Training Loss: 0.00900844, Training R2: 0.992450
Validation Loss: 0.46774692, Validation R2: 0.791495

Epoch 161/1000
Training Loss: 0.00856761, Training R2: 0.992447
Validation Loss: 0.46748912, Validation R2: 0.791657

Epoch 162/1000
Training Loss: 0.00778358, Training R2: 0.992429
Validation Loss: 0.46798524, Validation R2: 0.791265

Epoch 163/1000
Training Loss: 0.00797562, Training R2: 0.992420
Validation Loss: 0.46769937, Validation R2: 0.791512

Epoch 164/1000
Training Loss: 0.00846617, Training R2: 0.992443
Validation Loss: 0.46773555, Validation R2: 0.791549

Epoch 165/1000
Training Loss: 0.00802915, Training R2: 0.992439
Validation Loss: 0.46715367, Validation R2: 0.791902

Epoch 166/1000
Training Loss: 0.00858303, Training R2: 0.992454
Validation Loss: 0.46729893, Validation R2: 0.791430

Epoch 167/1000
Training Loss: 0.00800445, Training R2: 0.992473
Validation Loss: 0.46768628, Validation R2: 0.791360

Epoch 168/1000
Training Loss: 0.00825689, Training R2: 0.992466
Validation Loss: 0.46718707, Validation R2: 0.791672

Epoch 169/1000
Training Loss: 0.00894087, Training R2: 0.992483
Validation Loss: 0.46776039, Validation R2: 0.791577

Epoch 170/1000
Training Loss: 0.00943117, Training R2: 0.992474
Validation Loss: 0.46724268, Validation R2: 0.791719

Epoch 171/1000
Epoch 00171: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00943857, Training R2: 0.992505
Validation Loss: 0.46718199, Validation R2: 0.791834

Epoch 172/1000
学习率已减少 5 次
Training Loss: 0.00766330, Training R2: 0.992505
Validation Loss: 0.46725992, Validation R2: 0.791625

Epoch 173/1000
Training Loss: 0.00676313, Training R2: 0.992508
Validation Loss: 0.46735688, Validation R2: 0.791689

Epoch 174/1000
Training Loss: 0.00641111, Training R2: 0.992514
Validation Loss: 0.46713740, Validation R2: 0.791766

Epoch 175/1000
Training Loss: 0.00657930, Training R2: 0.992517
Validation Loss: 0.46742867, Validation R2: 0.791501

Epoch 176/1000
Training Loss: 0.00644636, Training R2: 0.992527
Validation Loss: 0.46754798, Validation R2: 0.791563

Epoch 177/1000
Training Loss: 0.00651066, Training R2: 0.992520
Validation Loss: 0.46735552, Validation R2: 0.791590

Epoch 178/1000
Training Loss: 0.00753586, Training R2: 0.992530
Validation Loss: 0.46716248, Validation R2: 0.791693

Epoch 179/1000
Training Loss: 0.00791607, Training R2: 0.992536
Validation Loss: 0.46717061, Validation R2: 0.791798

Epoch 180/1000
Training Loss: 0.00721048, Training R2: 0.992516
Validation Loss: 0.46772395, Validation R2: 0.791457

Epoch 181/1000
Training Loss: 0.00655425, Training R2: 0.992516
Validation Loss: 0.46754574, Validation R2: 0.791702

Epoch 182/1000
Training Loss: 0.00622904, Training R2: 0.992530
Validation Loss: 0.46748608, Validation R2: 0.791585

Epoch 183/1000
Training Loss: 0.00601417, Training R2: 0.992543
Validation Loss: 0.46758661, Validation R2: 0.791604

Epoch 184/1000
Training Loss: 0.00632814, Training R2: 0.992547
Validation Loss: 0.46744736, Validation R2: 0.791657

Epoch 185/1000
Training Loss: 0.00629390, Training R2: 0.992548
Validation Loss: 0.46782367, Validation R2: 0.791378

Epoch 186/1000
Training Loss: 0.00640129, Training R2: 0.992549
Validation Loss: 0.46761832, Validation R2: 0.791534

Epoch 187/1000
Training Loss: 0.00596548, Training R2: 0.992566
Validation Loss: 0.46769985, Validation R2: 0.791433

Epoch 188/1000
Training Loss: 0.00632428, Training R2: 0.992550
Validation Loss: 0.46720852, Validation R2: 0.791723

Epoch 189/1000
Training Loss: 0.00647282, Training R2: 0.992539
Validation Loss: 0.46745771, Validation R2: 0.791654

Epoch 190/1000
Training Loss: 0.00668510, Training R2: 0.992557
Validation Loss: 0.46726012, Validation R2: 0.791626

Epoch 191/1000
Training Loss: 0.00819274, Training R2: 0.992551
Validation Loss: 0.46759981, Validation R2: 0.791472

Epoch 192/1000
Epoch 00192: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00792166, Training R2: 0.992538
Validation Loss: 0.46786690, Validation R2: 0.791376

Epoch 193/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
