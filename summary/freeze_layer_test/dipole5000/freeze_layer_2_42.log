Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5293187

Epoch 1/1000
Training Loss: 1.48526365, Training R2: -0.710285
Validation Loss: 1.19482110, Validation R2: 0.003588
Saved best model with validation R2 0.003588 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.20223415, Training R2: -0.034365
Validation Loss: 1.15846319, Validation R2: 0.043403
Saved best model with validation R2 0.043403 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.10989979, Training R2: 0.096174
Validation Loss: 0.95805100, Validation R2: 0.251639
Saved best model with validation R2 0.251639 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.87902261, Training R2: 0.386301
Validation Loss: 0.80387568, Validation R2: 0.441630
Saved best model with validation R2 0.441630 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.75747438, Training R2: 0.511680
Validation Loss: 0.71157693, Validation R2: 0.549572
Saved best model with validation R2 0.549572 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.66528802, Training R2: 0.601756
Validation Loss: 0.64423636, Validation R2: 0.619575
Saved best model with validation R2 0.619575 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.58584601, Training R2: 0.687064
Validation Loss: 0.59362503, Validation R2: 0.675116
Saved best model with validation R2 0.675116 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.54098733, Training R2: 0.734191
Validation Loss: 0.61027802, Validation R2: 0.670326

Epoch 9/1000
Training Loss: 0.47032726, Training R2: 0.791840
Validation Loss: 0.51644726, Validation R2: 0.744192
Saved best model with validation R2 0.744192 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.41612133, Training R2: 0.830214
Validation Loss: 0.53571054, Validation R2: 0.723101

Epoch 11/1000
Training Loss: 0.38708627, Training R2: 0.854830
Validation Loss: 0.49525427, Validation R2: 0.754893
Saved best model with validation R2 0.754893 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.36392146, Training R2: 0.869978
Validation Loss: 0.49419390, Validation R2: 0.766320
Saved best model with validation R2 0.766320 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.33795564, Training R2: 0.885612
Validation Loss: 0.51251700, Validation R2: 0.742703

Epoch 14/1000
Training Loss: 0.30623953, Training R2: 0.901623
Validation Loss: 0.45748344, Validation R2: 0.782892
Saved best model with validation R2 0.782892 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.30105880, Training R2: 0.906641
Validation Loss: 0.45106326, Validation R2: 0.789660
Saved best model with validation R2 0.789660 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.25885922, Training R2: 0.927387
Validation Loss: 0.45355361, Validation R2: 0.788725

Epoch 17/1000
Training Loss: 0.26156376, Training R2: 0.930484
Validation Loss: 0.44103214, Validation R2: 0.793797
Saved best model with validation R2 0.793797 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.24257024, Training R2: 0.935531
Validation Loss: 0.45001177, Validation R2: 0.798112
Saved best model with validation R2 0.798112 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.21759090, Training R2: 0.945338
Validation Loss: 0.49779152, Validation R2: 0.769287

Epoch 20/1000
Training Loss: 0.30572362, Training R2: 0.915357
Validation Loss: 0.47560907, Validation R2: 0.786354

Epoch 21/1000
Training Loss: 0.26157250, Training R2: 0.933090
Validation Loss: 0.44126161, Validation R2: 0.800817
Saved best model with validation R2 0.800817 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.19871679, Training R2: 0.953923
Validation Loss: 0.43800479, Validation R2: 0.809904
Saved best model with validation R2 0.809904 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.19676779, Training R2: 0.954255
Validation Loss: 0.43913016, Validation R2: 0.801986

Epoch 24/1000
Training Loss: 0.19588151, Training R2: 0.955060
Validation Loss: 0.42862672, Validation R2: 0.805681

Epoch 25/1000
Training Loss: 0.17614210, Training R2: 0.961905
Validation Loss: 0.42284022, Validation R2: 0.814938
Saved best model with validation R2 0.814938 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.16960010, Training R2: 0.963927
Validation Loss: 0.42654967, Validation R2: 0.811809

Epoch 27/1000
Training Loss: 0.15540495, Training R2: 0.968071
Validation Loss: 0.43107675, Validation R2: 0.809803

Epoch 28/1000
Training Loss: 0.15107988, Training R2: 0.970385
Validation Loss: 0.40200941, Validation R2: 0.824259
Saved best model with validation R2 0.824259 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.14793659, Training R2: 0.972316
Validation Loss: 0.41453379, Validation R2: 0.821344

Epoch 30/1000
Training Loss: 0.14262577, Training R2: 0.973364
Validation Loss: 0.41878270, Validation R2: 0.818192

Epoch 31/1000
Training Loss: 0.17098664, Training R2: 0.968240
Validation Loss: 0.41086960, Validation R2: 0.818221

Epoch 32/1000
Training Loss: 0.13167763, Training R2: 0.975888
Validation Loss: 0.41305123, Validation R2: 0.823321

Epoch 33/1000
Training Loss: 0.14283729, Training R2: 0.974437
Validation Loss: 0.41231849, Validation R2: 0.820047

Epoch 34/1000
Training Loss: 0.14244372, Training R2: 0.976059
Validation Loss: 0.45012608, Validation R2: 0.800584

Epoch 35/1000
Training Loss: 0.15373420, Training R2: 0.973778
Validation Loss: 0.41622695, Validation R2: 0.821780

Epoch 36/1000
Training Loss: 0.13520931, Training R2: 0.977045
Validation Loss: 0.40078039, Validation R2: 0.825882
Saved best model with validation R2 0.825882 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.13017776, Training R2: 0.978958
Validation Loss: 0.42493263, Validation R2: 0.813155

Epoch 38/1000
Training Loss: 0.13657450, Training R2: 0.977199
Validation Loss: 0.41170596, Validation R2: 0.820121

Epoch 39/1000
Training Loss: 0.11522034, Training R2: 0.982025
Validation Loss: 0.40837485, Validation R2: 0.819710

Epoch 40/1000
Training Loss: 0.13417980, Training R2: 0.978901
Validation Loss: 0.44277303, Validation R2: 0.802518

Epoch 41/1000
Training Loss: 0.14499577, Training R2: 0.977366
Validation Loss: 0.43088769, Validation R2: 0.814281

Epoch 42/1000
Training Loss: 0.12316136, Training R2: 0.980269
Validation Loss: 0.40664375, Validation R2: 0.823373

Epoch 43/1000
Training Loss: 0.10996135, Training R2: 0.983916
Validation Loss: 0.40372873, Validation R2: 0.826345
Saved best model with validation R2 0.826345 to best_finetuned_model.pth

Epoch 44/1000
Training Loss: 0.11923806, Training R2: 0.982092
Validation Loss: 0.39968413, Validation R2: 0.826088

Epoch 45/1000
Training Loss: 0.11157060, Training R2: 0.982765
Validation Loss: 0.41244019, Validation R2: 0.823966

Epoch 46/1000
Training Loss: 0.12487699, Training R2: 0.981474
Validation Loss: 0.40535049, Validation R2: 0.821394

Epoch 47/1000
Training Loss: 0.11775066, Training R2: 0.982290
Validation Loss: 0.39766849, Validation R2: 0.831004
Saved best model with validation R2 0.831004 to best_finetuned_model.pth

Epoch 48/1000
Training Loss: 0.10111003, Training R2: 0.985269
Validation Loss: 0.41301457, Validation R2: 0.824381

Epoch 49/1000
Training Loss: 0.09838636, Training R2: 0.986153
Validation Loss: 0.40767894, Validation R2: 0.829866

Epoch 50/1000
Training Loss: 0.10555096, Training R2: 0.985563
Validation Loss: 0.39687853, Validation R2: 0.832304
Saved best model with validation R2 0.832304 to best_finetuned_model.pth

Epoch 51/1000
Training Loss: 0.09146875, Training R2: 0.987906
Validation Loss: 0.40641142, Validation R2: 0.826150

Epoch 52/1000
Training Loss: 0.09318878, Training R2: 0.987854
Validation Loss: 0.39421006, Validation R2: 0.834958
Saved best model with validation R2 0.834958 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.09266142, Training R2: 0.987697
Validation Loss: 0.39922050, Validation R2: 0.831198

Epoch 54/1000
Training Loss: 0.09691136, Training R2: 0.986743
Validation Loss: 0.39754116, Validation R2: 0.830903

Epoch 55/1000
Training Loss: 0.09660394, Training R2: 0.987558
Validation Loss: 0.39590923, Validation R2: 0.833054

Epoch 56/1000
Training Loss: 0.08777539, Training R2: 0.988798
Validation Loss: 0.39182328, Validation R2: 0.834157

Epoch 57/1000
Training Loss: 0.09330905, Training R2: 0.989001
Validation Loss: 0.39781289, Validation R2: 0.833127

Epoch 58/1000
Training Loss: 0.09516311, Training R2: 0.987978
Validation Loss: 0.41390304, Validation R2: 0.823658

Epoch 59/1000
Training Loss: 0.17135520, Training R2: 0.975206
Validation Loss: 0.46629225, Validation R2: 0.793146

Epoch 60/1000
Training Loss: 0.17534074, Training R2: 0.973182
Validation Loss: 0.42364035, Validation R2: 0.814012

Epoch 61/1000
Training Loss: 0.13490511, Training R2: 0.981950
Validation Loss: 0.40661500, Validation R2: 0.827742

Epoch 62/1000
Training Loss: 0.10163492, Training R2: 0.988249
Validation Loss: 0.40481377, Validation R2: 0.826812

Epoch 63/1000
Training Loss: 0.09361344, Training R2: 0.989455
Validation Loss: 0.40128198, Validation R2: 0.829784

Epoch 64/1000
Training Loss: 0.08296453, Training R2: 0.990821
Validation Loss: 0.39598154, Validation R2: 0.832302

Epoch 65/1000
Training Loss: 0.08742982, Training R2: 0.990610
Validation Loss: 0.41832273, Validation R2: 0.820813

Epoch 66/1000
Training Loss: 0.15178433, Training R2: 0.980967
Validation Loss: 0.40662780, Validation R2: 0.825118

Epoch 67/1000
Training Loss: 0.12568782, Training R2: 0.985978
Validation Loss: 0.41232113, Validation R2: 0.820328

Epoch 68/1000
Training Loss: 0.11519827, Training R2: 0.987790
Validation Loss: 0.39445425, Validation R2: 0.832344

Epoch 69/1000
Training Loss: 0.08957807, Training R2: 0.991479
Validation Loss: 0.40058183, Validation R2: 0.830265

Epoch 70/1000
Training Loss: 0.08716051, Training R2: 0.991553
Validation Loss: 0.39397706, Validation R2: 0.832120

Epoch 71/1000
Training Loss: 0.07834811, Training R2: 0.993359
Validation Loss: 0.39398881, Validation R2: 0.831383

Epoch 72/1000
Training Loss: 0.07977944, Training R2: 0.993842
Validation Loss: 0.39311673, Validation R2: 0.833169

Epoch 73/1000
Epoch 00073: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.08517972, Training R2: 0.993200
Validation Loss: 0.40045969, Validation R2: 0.829914

Epoch 74/1000
学习率已减少 1 次
Training Loss: 0.07095334, Training R2: 0.995434
Validation Loss: 0.39265394, Validation R2: 0.833574

Epoch 75/1000
Training Loss: 0.06030776, Training R2: 0.996580
Validation Loss: 0.38983664, Validation R2: 0.834479

Epoch 76/1000
Training Loss: 0.05316218, Training R2: 0.997369
Validation Loss: 0.38702403, Validation R2: 0.836819
Saved best model with validation R2 0.836819 to best_finetuned_model.pth

Epoch 77/1000
Training Loss: 0.04910057, Training R2: 0.997724
Validation Loss: 0.39148759, Validation R2: 0.833966

Epoch 78/1000
Training Loss: 0.04999242, Training R2: 0.997758
Validation Loss: 0.38773568, Validation R2: 0.837132
Saved best model with validation R2 0.837132 to best_finetuned_model.pth

Epoch 79/1000
Training Loss: 0.04250517, Training R2: 0.998328
Validation Loss: 0.38653728, Validation R2: 0.837615
Saved best model with validation R2 0.837615 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.06214892, Training R2: 0.997001
Validation Loss: 0.38881384, Validation R2: 0.835672

Epoch 81/1000
Training Loss: 0.04685420, Training R2: 0.998104
Validation Loss: 0.38807135, Validation R2: 0.835884

Epoch 82/1000
Training Loss: 0.04596118, Training R2: 0.998258
Validation Loss: 0.38732686, Validation R2: 0.834889

Epoch 83/1000
Training Loss: 0.04419243, Training R2: 0.998407
Validation Loss: 0.38690655, Validation R2: 0.836037

Epoch 84/1000
Training Loss: 0.04651618, Training R2: 0.998294
Validation Loss: 0.38781284, Validation R2: 0.836899

Epoch 85/1000
Training Loss: 0.03989552, Training R2: 0.998663
Validation Loss: 0.38599118, Validation R2: 0.837360

Epoch 86/1000
Training Loss: 0.03875705, Training R2: 0.998758
Validation Loss: 0.38458131, Validation R2: 0.837813
Saved best model with validation R2 0.837813 to best_finetuned_model.pth

Epoch 87/1000
Training Loss: 0.03594189, Training R2: 0.998694
Validation Loss: 0.38883159, Validation R2: 0.835131

Epoch 88/1000
Training Loss: 0.03670550, Training R2: 0.998911
Validation Loss: 0.38688947, Validation R2: 0.836867

Epoch 89/1000
Training Loss: 0.04683981, Training R2: 0.998199
Validation Loss: 0.38953798, Validation R2: 0.835686

Epoch 90/1000
Training Loss: 0.03514979, Training R2: 0.998956
Validation Loss: 0.38736228, Validation R2: 0.837019

Epoch 91/1000
Training Loss: 0.04015218, Training R2: 0.998722
Validation Loss: 0.38825503, Validation R2: 0.834956

Epoch 92/1000
Training Loss: 0.03711686, Training R2: 0.998879
Validation Loss: 0.38736108, Validation R2: 0.836682

Epoch 93/1000
Training Loss: 0.03461311, Training R2: 0.999012
Validation Loss: 0.38767654, Validation R2: 0.836211

Epoch 94/1000
Training Loss: 0.03391433, Training R2: 0.999023
Validation Loss: 0.38395405, Validation R2: 0.839451
Saved best model with validation R2 0.839451 to best_finetuned_model.pth

Epoch 95/1000
Training Loss: 0.04224812, Training R2: 0.998617
Validation Loss: 0.38724840, Validation R2: 0.837281

Epoch 96/1000
Training Loss: 0.04553091, Training R2: 0.998146
Validation Loss: 0.38826280, Validation R2: 0.836205

Epoch 97/1000
Training Loss: 0.04429439, Training R2: 0.998451
Validation Loss: 0.38755067, Validation R2: 0.837124

Epoch 98/1000
Training Loss: 0.04323984, Training R2: 0.998486
Validation Loss: 0.38737853, Validation R2: 0.836904

Epoch 99/1000
Training Loss: 0.03453140, Training R2: 0.999015
Validation Loss: 0.38449735, Validation R2: 0.838044

Epoch 100/1000
Training Loss: 0.04386528, Training R2: 0.998548
Validation Loss: 0.38637028, Validation R2: 0.837018

Epoch 101/1000
Training Loss: 0.04034568, Training R2: 0.998719
Validation Loss: 0.38429849, Validation R2: 0.838345

Epoch 102/1000
Training Loss: 0.03297504, Training R2: 0.999131
Validation Loss: 0.38550199, Validation R2: 0.837848

Epoch 103/1000
Training Loss: 0.03364588, Training R2: 0.999119
Validation Loss: 0.38836809, Validation R2: 0.835546

Epoch 104/1000
Training Loss: 0.04297939, Training R2: 0.998580
Validation Loss: 0.38837230, Validation R2: 0.837394

Epoch 105/1000
Training Loss: 0.04602872, Training R2: 0.998356
Validation Loss: 0.38592509, Validation R2: 0.836592

Epoch 106/1000
Training Loss: 0.03816971, Training R2: 0.998777
Validation Loss: 0.38608997, Validation R2: 0.837078

Epoch 107/1000
Training Loss: 0.03975235, Training R2: 0.998755
Validation Loss: 0.38568565, Validation R2: 0.836695

Epoch 108/1000
Training Loss: 0.03914834, Training R2: 0.998847
Validation Loss: 0.38946442, Validation R2: 0.834498

Epoch 109/1000
Training Loss: 0.03442231, Training R2: 0.999052
Validation Loss: 0.38143252, Validation R2: 0.839766
Saved best model with validation R2 0.839766 to best_finetuned_model.pth

Epoch 110/1000
Training Loss: 0.04211588, Training R2: 0.998660
Validation Loss: 0.38305663, Validation R2: 0.838025

Epoch 111/1000
Training Loss: 0.05198877, Training R2: 0.998000
Validation Loss: 0.39351467, Validation R2: 0.833739

Epoch 112/1000
Training Loss: 0.05753599, Training R2: 0.997496
Validation Loss: 0.39103964, Validation R2: 0.833298

Epoch 113/1000
Training Loss: 0.04402287, Training R2: 0.998470
Validation Loss: 0.38669576, Validation R2: 0.837271

Epoch 114/1000
Training Loss: 0.04541902, Training R2: 0.998458
Validation Loss: 0.38971077, Validation R2: 0.834166

Epoch 115/1000
Training Loss: 0.03788072, Training R2: 0.998843
Validation Loss: 0.38863713, Validation R2: 0.836608

Epoch 116/1000
Training Loss: 0.03605953, Training R2: 0.998988
Validation Loss: 0.38472397, Validation R2: 0.837184

Epoch 117/1000
Training Loss: 0.03332734, Training R2: 0.999105
Validation Loss: 0.38717532, Validation R2: 0.838889

Epoch 118/1000
Training Loss: 0.03686475, Training R2: 0.998943
Validation Loss: 0.38736812, Validation R2: 0.835624

Epoch 119/1000
Training Loss: 0.03383593, Training R2: 0.999103
Validation Loss: 0.38430250, Validation R2: 0.838799

Epoch 120/1000
Training Loss: 0.03921905, Training R2: 0.998800
Validation Loss: 0.38664382, Validation R2: 0.838611

Epoch 121/1000
Training Loss: 0.03397179, Training R2: 0.999094
Validation Loss: 0.38742816, Validation R2: 0.837414

Epoch 122/1000
Training Loss: 0.03621882, Training R2: 0.998957
Validation Loss: 0.38870088, Validation R2: 0.837223

Epoch 123/1000
Training Loss: 0.03544263, Training R2: 0.999026
Validation Loss: 0.38225705, Validation R2: 0.838661

Epoch 124/1000
Training Loss: 0.03527513, Training R2: 0.999037
Validation Loss: 0.38452721, Validation R2: 0.837144

Epoch 125/1000
Training Loss: 0.03823807, Training R2: 0.998908
Validation Loss: 0.39480647, Validation R2: 0.833061

Epoch 126/1000
Training Loss: 0.03875853, Training R2: 0.998825
Validation Loss: 0.38548266, Validation R2: 0.836565

Epoch 127/1000
Training Loss: 0.04217371, Training R2: 0.998640
Validation Loss: 0.38625017, Validation R2: 0.838024

Epoch 128/1000
Training Loss: 0.03667175, Training R2: 0.998959
Validation Loss: 0.38026282, Validation R2: 0.841486
Saved best model with validation R2 0.841486 to best_finetuned_model.pth

Epoch 129/1000
Training Loss: 0.03558222, Training R2: 0.998991
Validation Loss: 0.38582035, Validation R2: 0.836096

Epoch 130/1000
Training Loss: 0.03945757, Training R2: 0.998835
Validation Loss: 0.38455351, Validation R2: 0.837969

Epoch 131/1000
Training Loss: 0.03758897, Training R2: 0.998909
Validation Loss: 0.38685278, Validation R2: 0.836614

Epoch 132/1000
Training Loss: 0.03743920, Training R2: 0.998955
Validation Loss: 0.38595076, Validation R2: 0.837758

Epoch 133/1000
Training Loss: 0.03930145, Training R2: 0.998843
Validation Loss: 0.38590953, Validation R2: 0.837732

Epoch 134/1000
Training Loss: 0.03433840, Training R2: 0.999085
Validation Loss: 0.38228903, Validation R2: 0.838566

Epoch 135/1000
Training Loss: 0.03380964, Training R2: 0.999093
Validation Loss: 0.38466330, Validation R2: 0.838215

Epoch 136/1000
Training Loss: 0.03505444, Training R2: 0.999050
Validation Loss: 0.38445668, Validation R2: 0.839292

Epoch 137/1000
Training Loss: 0.03477370, Training R2: 0.999039
Validation Loss: 0.38266018, Validation R2: 0.839917

Epoch 138/1000
Training Loss: 0.03932060, Training R2: 0.998852
Validation Loss: 0.38362290, Validation R2: 0.838311

Epoch 139/1000
Training Loss: 0.03229956, Training R2: 0.999193
Validation Loss: 0.38186415, Validation R2: 0.841100

Epoch 140/1000
Training Loss: 0.04092310, Training R2: 0.998721
Validation Loss: 0.38559401, Validation R2: 0.838814

Epoch 141/1000
Training Loss: 0.04283291, Training R2: 0.998667
Validation Loss: 0.38235300, Validation R2: 0.839981

Epoch 142/1000
Training Loss: 0.03335412, Training R2: 0.999123
Validation Loss: 0.38641262, Validation R2: 0.836985

Epoch 143/1000
Training Loss: 0.03332954, Training R2: 0.999132
Validation Loss: 0.38608960, Validation R2: 0.837521

Epoch 144/1000
Training Loss: 0.03633449, Training R2: 0.998965
Validation Loss: 0.38503645, Validation R2: 0.838012

Epoch 145/1000
Training Loss: 0.04034430, Training R2: 0.998739
Validation Loss: 0.39134778, Validation R2: 0.833798

Epoch 146/1000
Training Loss: 0.03860728, Training R2: 0.998873
Validation Loss: 0.38632108, Validation R2: 0.836481

Epoch 147/1000
Training Loss: 0.04702251, Training R2: 0.998382
Validation Loss: 0.38209520, Validation R2: 0.839903

Epoch 148/1000
Training Loss: 0.04548112, Training R2: 0.998430
Validation Loss: 0.38733957, Validation R2: 0.835400

Epoch 149/1000
Epoch 00149: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03953462, Training R2: 0.998758
Validation Loss: 0.38670595, Validation R2: 0.836209

Epoch 150/1000
学习率已减少 2 次
Training Loss: 0.03380809, Training R2: 0.999075
Validation Loss: 0.38350810, Validation R2: 0.837230

Epoch 151/1000
Training Loss: 0.02456572, Training R2: 0.999526
Validation Loss: 0.38256912, Validation R2: 0.838061

Epoch 152/1000
Training Loss: 0.02246372, Training R2: 0.999617
Validation Loss: 0.38567053, Validation R2: 0.836592

Epoch 153/1000
Training Loss: 0.02154298, Training R2: 0.999649
Validation Loss: 0.38429719, Validation R2: 0.837795

Epoch 154/1000
Training Loss: 0.02038220, Training R2: 0.999684
Validation Loss: 0.38220934, Validation R2: 0.838464

Epoch 155/1000
Training Loss: 0.01785245, Training R2: 0.999752
Validation Loss: 0.38410861, Validation R2: 0.837403

Epoch 156/1000
Training Loss: 0.01810082, Training R2: 0.999743
Validation Loss: 0.38271585, Validation R2: 0.838640

Epoch 157/1000
Training Loss: 0.01767544, Training R2: 0.999760
Validation Loss: 0.38216469, Validation R2: 0.839071

Epoch 158/1000
Training Loss: 0.02710731, Training R2: 0.999455
Validation Loss: 0.38760904, Validation R2: 0.836627

Epoch 159/1000
Training Loss: 0.02929391, Training R2: 0.999390
Validation Loss: 0.38659871, Validation R2: 0.837006

Epoch 160/1000
Training Loss: 0.02985676, Training R2: 0.999359
Validation Loss: 0.38406373, Validation R2: 0.838017

Epoch 161/1000
Training Loss: 0.02729694, Training R2: 0.999467
Validation Loss: 0.38339168, Validation R2: 0.837674

Epoch 162/1000
Training Loss: 0.02361303, Training R2: 0.999588
Validation Loss: 0.38461720, Validation R2: 0.837526

Epoch 163/1000
Training Loss: 0.02059888, Training R2: 0.999659
Validation Loss: 0.38294934, Validation R2: 0.838291

Epoch 164/1000
Training Loss: 0.01902127, Training R2: 0.999722
Validation Loss: 0.38470422, Validation R2: 0.837341

Epoch 165/1000
Training Loss: 0.01796816, Training R2: 0.999750
Validation Loss: 0.38480811, Validation R2: 0.837204

Epoch 166/1000
Training Loss: 0.01961121, Training R2: 0.999712
Validation Loss: 0.38421685, Validation R2: 0.837252

Epoch 167/1000
Training Loss: 0.01646243, Training R2: 0.999781
Validation Loss: 0.38284943, Validation R2: 0.838147

Epoch 168/1000
Training Loss: 0.01523661, Training R2: 0.999814
Validation Loss: 0.38187790, Validation R2: 0.839432

Epoch 169/1000
Training Loss: 0.01546111, Training R2: 0.999814
Validation Loss: 0.38394025, Validation R2: 0.837497

Epoch 170/1000
Epoch 00170: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.01654057, Training R2: 0.999790
Validation Loss: 0.38239557, Validation R2: 0.838465

Epoch 171/1000
学习率已减少 3 次
Training Loss: 0.01375968, Training R2: 0.999838
Validation Loss: 0.38352882, Validation R2: 0.837607

Epoch 172/1000
Training Loss: 0.01232697, Training R2: 0.999882
Validation Loss: 0.38297564, Validation R2: 0.838243

Epoch 173/1000
Training Loss: 0.01151217, Training R2: 0.999895
Validation Loss: 0.38388271, Validation R2: 0.837672

Epoch 174/1000
Training Loss: 0.01138900, Training R2: 0.999900
Validation Loss: 0.38255276, Validation R2: 0.838363

Epoch 175/1000
Training Loss: 0.01020424, Training R2: 0.999917
Validation Loss: 0.38171242, Validation R2: 0.838809

Epoch 176/1000
Training Loss: 0.00986973, Training R2: 0.999920
Validation Loss: 0.38368452, Validation R2: 0.837910

Epoch 177/1000
Training Loss: 0.00951062, Training R2: 0.999929
Validation Loss: 0.38360532, Validation R2: 0.837807

Epoch 178/1000
Training Loss: 0.01021389, Training R2: 0.999915
Validation Loss: 0.38396708, Validation R2: 0.837473

Epoch 179/1000
Training Loss: 0.01005329, Training R2: 0.999919
Validation Loss: 0.38386085, Validation R2: 0.837729

Epoch 180/1000
Training Loss: 0.01022355, Training R2: 0.999912
Validation Loss: 0.38270949, Validation R2: 0.838163

Epoch 181/1000
Training Loss: 0.01104812, Training R2: 0.999904
Validation Loss: 0.38220535, Validation R2: 0.838686

Epoch 182/1000
Training Loss: 0.01066531, Training R2: 0.999908
Validation Loss: 0.38335593, Validation R2: 0.838186

Epoch 183/1000
Training Loss: 0.01055140, Training R2: 0.999913
Validation Loss: 0.38267142, Validation R2: 0.838519

Epoch 184/1000
Training Loss: 0.00981855, Training R2: 0.999922
Validation Loss: 0.38331210, Validation R2: 0.838083

Epoch 185/1000
Training Loss: 0.00945008, Training R2: 0.999926
Validation Loss: 0.38233535, Validation R2: 0.838443

Epoch 186/1000
Training Loss: 0.00995102, Training R2: 0.999916
Validation Loss: 0.38218728, Validation R2: 0.838566

Epoch 187/1000
Training Loss: 0.01115557, Training R2: 0.999903
Validation Loss: 0.38398031, Validation R2: 0.837832

Epoch 188/1000
Training Loss: 0.01639793, Training R2: 0.999813
Validation Loss: 0.38409468, Validation R2: 0.837550

Epoch 189/1000
Training Loss: 0.01600863, Training R2: 0.999813
Validation Loss: 0.38390630, Validation R2: 0.838065

Epoch 190/1000
Training Loss: 0.01355688, Training R2: 0.999859
Validation Loss: 0.38279909, Validation R2: 0.838333

Epoch 191/1000
Epoch 00191: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.01356049, Training R2: 0.999863
Validation Loss: 0.38283903, Validation R2: 0.838582

Epoch 192/1000
学习率已减少 4 次
Training Loss: 0.00925655, Training R2: 0.999931
Validation Loss: 0.38232459, Validation R2: 0.838435

Epoch 193/1000
Training Loss: 0.00664388, Training R2: 0.999960
Validation Loss: 0.38280477, Validation R2: 0.838184

Epoch 194/1000
Training Loss: 0.00537933, Training R2: 0.999971
Validation Loss: 0.38304544, Validation R2: 0.838058

Epoch 195/1000
Training Loss: 0.00546622, Training R2: 0.999972
Validation Loss: 0.38262997, Validation R2: 0.838136

Epoch 196/1000
Training Loss: 0.00558777, Training R2: 0.999972
Validation Loss: 0.38239105, Validation R2: 0.838491

Epoch 197/1000
Training Loss: 0.00510117, Training R2: 0.999975
Validation Loss: 0.38250529, Validation R2: 0.838332

Epoch 198/1000
Training Loss: 0.00476620, Training R2: 0.999978
Validation Loss: 0.38279300, Validation R2: 0.837987

Epoch 199/1000
Training Loss: 0.00588018, Training R2: 0.999969
Validation Loss: 0.38291668, Validation R2: 0.838181

Epoch 200/1000
Training Loss: 0.00574018, Training R2: 0.999971
Validation Loss: 0.38323651, Validation R2: 0.838003

Epoch 201/1000
Training Loss: 0.00538154, Training R2: 0.999974
Validation Loss: 0.38324926, Validation R2: 0.838008

Epoch 202/1000
Training Loss: 0.00567990, Training R2: 0.999971
Validation Loss: 0.38267902, Validation R2: 0.838299

Epoch 203/1000
Training Loss: 0.00518217, Training R2: 0.999975
Validation Loss: 0.38288370, Validation R2: 0.838213

Epoch 204/1000
Training Loss: 0.00500571, Training R2: 0.999975
Validation Loss: 0.38295918, Validation R2: 0.838131

Epoch 205/1000
Training Loss: 0.00412557, Training R2: 0.999982
Validation Loss: 0.38255445, Validation R2: 0.838266

Epoch 206/1000
Training Loss: 0.00480431, Training R2: 0.999978
Validation Loss: 0.38301273, Validation R2: 0.838209

Epoch 207/1000
Training Loss: 0.00427956, Training R2: 0.999978
Validation Loss: 0.38267846, Validation R2: 0.838156

Epoch 208/1000
Training Loss: 0.00460060, Training R2: 0.999980
Validation Loss: 0.38277900, Validation R2: 0.838250

Epoch 209/1000
Training Loss: 0.00447265, Training R2: 0.999981
Validation Loss: 0.38264486, Validation R2: 0.838246

Epoch 210/1000
Training Loss: 0.00463835, Training R2: 0.999976
Validation Loss: 0.38298558, Validation R2: 0.838263

Epoch 211/1000
Training Loss: 0.00471071, Training R2: 0.999978
Validation Loss: 0.38283928, Validation R2: 0.838090

Epoch 212/1000
Epoch 00212: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00476952, Training R2: 0.999979
Validation Loss: 0.38345130, Validation R2: 0.837992

Epoch 213/1000
学习率已减少 5 次
Training Loss: 0.00415583, Training R2: 0.999982
Validation Loss: 0.38272189, Validation R2: 0.838223

Epoch 214/1000
Training Loss: 0.00326042, Training R2: 0.999987
Validation Loss: 0.38265232, Validation R2: 0.838347

Epoch 215/1000
Training Loss: 0.00293080, Training R2: 0.999987
Validation Loss: 0.38312324, Validation R2: 0.838107

Epoch 216/1000
Training Loss: 0.00255912, Training R2: 0.999991
Validation Loss: 0.38290399, Validation R2: 0.838291

Epoch 217/1000
Training Loss: 0.00281010, Training R2: 0.999990
Validation Loss: 0.38306110, Validation R2: 0.838206

Epoch 218/1000
Training Loss: 0.00283204, Training R2: 0.999987
Validation Loss: 0.38239401, Validation R2: 0.838398

Epoch 219/1000
Training Loss: 0.00263093, Training R2: 0.999990
Validation Loss: 0.38295672, Validation R2: 0.838121

Epoch 220/1000
Training Loss: 0.00261122, Training R2: 0.999989
Validation Loss: 0.38266262, Validation R2: 0.838171

Epoch 221/1000
Training Loss: 0.00288976, Training R2: 0.999990
Validation Loss: 0.38257286, Validation R2: 0.838363

Epoch 222/1000
Training Loss: 0.00256286, Training R2: 0.999990
Validation Loss: 0.38283592, Validation R2: 0.838273

Epoch 223/1000
Training Loss: 0.00296501, Training R2: 0.999988
Validation Loss: 0.38251382, Validation R2: 0.838364

Epoch 224/1000
Training Loss: 0.00273133, Training R2: 0.999990
Validation Loss: 0.38257664, Validation R2: 0.838413

Epoch 225/1000
Training Loss: 0.00277065, Training R2: 0.999990
Validation Loss: 0.38279739, Validation R2: 0.838158

Epoch 226/1000
Training Loss: 0.00250193, Training R2: 0.999991
Validation Loss: 0.38281716, Validation R2: 0.838133

Epoch 227/1000
Training Loss: 0.00274544, Training R2: 0.999986
Validation Loss: 0.38312123, Validation R2: 0.838103

Epoch 228/1000
Training Loss: 0.00236116, Training R2: 0.999992
Validation Loss: 0.38293377, Validation R2: 0.838129

Epoch 229/1000
Training Loss: 0.00245383, Training R2: 0.999987
Validation Loss: 0.38309316, Validation R2: 0.837989

Epoch 230/1000
Training Loss: 0.00228660, Training R2: 0.999992
Validation Loss: 0.38264212, Validation R2: 0.838392

Epoch 231/1000
Training Loss: 0.00242981, Training R2: 0.999992
Validation Loss: 0.38280340, Validation R2: 0.838165

Epoch 232/1000
Training Loss: 0.00289043, Training R2: 0.999989
Validation Loss: 0.38246809, Validation R2: 0.838321

Epoch 233/1000
Epoch 00233: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00330043, Training R2: 0.999988
Validation Loss: 0.38312714, Validation R2: 0.838010

Epoch 234/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
