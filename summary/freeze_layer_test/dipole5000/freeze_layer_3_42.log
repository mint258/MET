Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4275843

Epoch 1/1000
Training Loss: 1.48222224, Training R2: -0.704721
Validation Loss: 1.19276557, Validation R2: 0.010433
Saved best model with validation R2 0.010433 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.19378391, Training R2: -0.018467
Validation Loss: 1.15229396, Validation R2: 0.069170
Saved best model with validation R2 0.069170 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.08251227, Training R2: 0.132351
Validation Loss: 0.95731049, Validation R2: 0.251394
Saved best model with validation R2 0.251394 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.90091670, Training R2: 0.352600
Validation Loss: 0.82356360, Validation R2: 0.433261
Saved best model with validation R2 0.433261 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.80630903, Training R2: 0.463808
Validation Loss: 0.75874739, Validation R2: 0.507507
Saved best model with validation R2 0.507507 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.73510509, Training R2: 0.537854
Validation Loss: 0.73549954, Validation R2: 0.544136
Saved best model with validation R2 0.544136 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.68464832, Training R2: 0.591330
Validation Loss: 0.64610352, Validation R2: 0.626336
Saved best model with validation R2 0.626336 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.60242164, Training R2: 0.662036
Validation Loss: 0.65442366, Validation R2: 0.624794

Epoch 9/1000
Training Loss: 0.54495766, Training R2: 0.718248
Validation Loss: 0.60757094, Validation R2: 0.667714
Saved best model with validation R2 0.667714 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.50106142, Training R2: 0.758385
Validation Loss: 0.56277275, Validation R2: 0.706270
Saved best model with validation R2 0.706270 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.44776971, Training R2: 0.804305
Validation Loss: 0.55127946, Validation R2: 0.721944
Saved best model with validation R2 0.721944 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.40287803, Training R2: 0.835926
Validation Loss: 0.58017298, Validation R2: 0.712963

Epoch 13/1000
Training Loss: 0.40205805, Training R2: 0.846538
Validation Loss: 0.57483071, Validation R2: 0.706590

Epoch 14/1000
Training Loss: 0.38410031, Training R2: 0.856084
Validation Loss: 0.57705113, Validation R2: 0.709670

Epoch 15/1000
Training Loss: 0.37764014, Training R2: 0.866491
Validation Loss: 0.51286478, Validation R2: 0.758280
Saved best model with validation R2 0.758280 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.31820628, Training R2: 0.893267
Validation Loss: 0.49769529, Validation R2: 0.767268
Saved best model with validation R2 0.767268 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.28165764, Training R2: 0.912017
Validation Loss: 0.50769926, Validation R2: 0.764686

Epoch 18/1000
Training Loss: 0.28004571, Training R2: 0.917254
Validation Loss: 0.47586126, Validation R2: 0.788808
Saved best model with validation R2 0.788808 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.24762933, Training R2: 0.931128
Validation Loss: 0.47948676, Validation R2: 0.784626

Epoch 20/1000
Training Loss: 0.24206850, Training R2: 0.934509
Validation Loss: 0.48119116, Validation R2: 0.782343

Epoch 21/1000
Training Loss: 0.27029856, Training R2: 0.923463
Validation Loss: 0.49524266, Validation R2: 0.765659

Epoch 22/1000
Training Loss: 0.22699384, Training R2: 0.942543
Validation Loss: 0.48666338, Validation R2: 0.787626

Epoch 23/1000
Training Loss: 0.21486552, Training R2: 0.948126
Validation Loss: 0.46348464, Validation R2: 0.794965
Saved best model with validation R2 0.794965 to best_finetuned_model.pth

Epoch 24/1000
Training Loss: 0.21771488, Training R2: 0.947367
Validation Loss: 0.50484458, Validation R2: 0.766600

Epoch 25/1000
Training Loss: 0.25826984, Training R2: 0.936603
Validation Loss: 0.47769220, Validation R2: 0.784286

Epoch 26/1000
Training Loss: 0.21330897, Training R2: 0.952217
Validation Loss: 0.46812948, Validation R2: 0.793711

Epoch 27/1000
Training Loss: 0.18405130, Training R2: 0.959994
Validation Loss: 0.47947105, Validation R2: 0.779472

Epoch 28/1000
Training Loss: 0.16623264, Training R2: 0.964728
Validation Loss: 0.45266468, Validation R2: 0.801542
Saved best model with validation R2 0.801542 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.16421476, Training R2: 0.966402
Validation Loss: 0.45639286, Validation R2: 0.800557

Epoch 30/1000
Training Loss: 0.16294893, Training R2: 0.967175
Validation Loss: 0.44948670, Validation R2: 0.803040
Saved best model with validation R2 0.803040 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.15138703, Training R2: 0.969503
Validation Loss: 0.45480100, Validation R2: 0.796471

Epoch 32/1000
Training Loss: 0.15134641, Training R2: 0.972141
Validation Loss: 0.45211186, Validation R2: 0.802531

Epoch 33/1000
Training Loss: 0.13931355, Training R2: 0.975012
Validation Loss: 0.45581838, Validation R2: 0.798336

Epoch 34/1000
Training Loss: 0.14252928, Training R2: 0.974919
Validation Loss: 0.45724999, Validation R2: 0.803629
Saved best model with validation R2 0.803629 to best_finetuned_model.pth

Epoch 35/1000
Training Loss: 0.14844045, Training R2: 0.973854
Validation Loss: 0.45190034, Validation R2: 0.803766
Saved best model with validation R2 0.803766 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.14447193, Training R2: 0.974385
Validation Loss: 0.45343143, Validation R2: 0.802412

Epoch 37/1000
Training Loss: 0.11633450, Training R2: 0.980000
Validation Loss: 0.45376644, Validation R2: 0.801152

Epoch 38/1000
Training Loss: 0.11640835, Training R2: 0.979824
Validation Loss: 0.46026206, Validation R2: 0.794750

Epoch 39/1000
Training Loss: 0.15166172, Training R2: 0.975612
Validation Loss: 0.47265422, Validation R2: 0.784076

Epoch 40/1000
Training Loss: 0.13766373, Training R2: 0.977388
Validation Loss: 0.45582405, Validation R2: 0.799337

Epoch 41/1000
Training Loss: 0.13313875, Training R2: 0.977939
Validation Loss: 0.43605869, Validation R2: 0.813788
Saved best model with validation R2 0.813788 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.11723500, Training R2: 0.980883
Validation Loss: 0.44112313, Validation R2: 0.810744

Epoch 43/1000
Training Loss: 0.10546481, Training R2: 0.983064
Validation Loss: 0.43556714, Validation R2: 0.812022

Epoch 44/1000
Training Loss: 0.09742754, Training R2: 0.984429
Validation Loss: 0.43961050, Validation R2: 0.810796

Epoch 45/1000
Training Loss: 0.10670324, Training R2: 0.983329
Validation Loss: 0.46492299, Validation R2: 0.800611

Epoch 46/1000
Training Loss: 0.11971588, Training R2: 0.980267
Validation Loss: 0.43903060, Validation R2: 0.810911

Epoch 47/1000
Training Loss: 0.12876703, Training R2: 0.979624
Validation Loss: 0.45411901, Validation R2: 0.799897

Epoch 48/1000
Training Loss: 0.11575299, Training R2: 0.981963
Validation Loss: 0.43756835, Validation R2: 0.810292

Epoch 49/1000
Training Loss: 0.10667736, Training R2: 0.983523
Validation Loss: 0.43907678, Validation R2: 0.809995

Epoch 50/1000
Training Loss: 0.12440388, Training R2: 0.981088
Validation Loss: 0.43489782, Validation R2: 0.808686

Epoch 51/1000
Training Loss: 0.10691758, Training R2: 0.983930
Validation Loss: 0.43511035, Validation R2: 0.811250

Epoch 52/1000
Training Loss: 0.08744627, Training R2: 0.986325
Validation Loss: 0.43161407, Validation R2: 0.814477
Saved best model with validation R2 0.814477 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.09684492, Training R2: 0.985170
Validation Loss: 0.43722339, Validation R2: 0.810410

Epoch 54/1000
Training Loss: 0.10234288, Training R2: 0.984369
Validation Loss: 0.43167957, Validation R2: 0.814597
Saved best model with validation R2 0.814597 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.11565307, Training R2: 0.982075
Validation Loss: 0.44782208, Validation R2: 0.805534

Epoch 56/1000
Training Loss: 0.10664494, Training R2: 0.983776
Validation Loss: 0.43939974, Validation R2: 0.811677

Epoch 57/1000
Training Loss: 0.09379281, Training R2: 0.985907
Validation Loss: 0.43599627, Validation R2: 0.815278
Saved best model with validation R2 0.815278 to best_finetuned_model.pth

Epoch 58/1000
Training Loss: 0.08710035, Training R2: 0.987015
Validation Loss: 0.43591531, Validation R2: 0.813411

Epoch 59/1000
Training Loss: 0.10565146, Training R2: 0.984877
Validation Loss: 0.43357803, Validation R2: 0.811755

Epoch 60/1000
Training Loss: 0.09148140, Training R2: 0.987093
Validation Loss: 0.43600425, Validation R2: 0.812787

Epoch 61/1000
Training Loss: 0.10825974, Training R2: 0.984479
Validation Loss: 0.43526358, Validation R2: 0.815021

Epoch 62/1000
Training Loss: 0.10588049, Training R2: 0.984973
Validation Loss: 0.44238050, Validation R2: 0.809255

Epoch 63/1000
Training Loss: 0.09047243, Training R2: 0.987647
Validation Loss: 0.43219290, Validation R2: 0.812588

Epoch 64/1000
Training Loss: 0.08146022, Training R2: 0.988210
Validation Loss: 0.43823188, Validation R2: 0.811756

Epoch 65/1000
Training Loss: 0.07790259, Training R2: 0.988707
Validation Loss: 0.43571129, Validation R2: 0.812670

Epoch 66/1000
Training Loss: 0.08563359, Training R2: 0.987724
Validation Loss: 0.44975111, Validation R2: 0.803498

Epoch 67/1000
Training Loss: 0.11006448, Training R2: 0.985552
Validation Loss: 0.43565301, Validation R2: 0.811169

Epoch 68/1000
Training Loss: 0.09542706, Training R2: 0.987019
Validation Loss: 0.43872862, Validation R2: 0.810094

Epoch 69/1000
Training Loss: 0.08578321, Training R2: 0.988382
Validation Loss: 0.43770499, Validation R2: 0.812395

Epoch 70/1000
Training Loss: 0.10716473, Training R2: 0.986021
Validation Loss: 0.43573769, Validation R2: 0.815936
Saved best model with validation R2 0.815936 to best_finetuned_model.pth

Epoch 71/1000
Training Loss: 0.09920005, Training R2: 0.986770
Validation Loss: 0.44050357, Validation R2: 0.814948

Epoch 72/1000
Training Loss: 0.08546336, Training R2: 0.988985
Validation Loss: 0.43388249, Validation R2: 0.810722

Epoch 73/1000
Training Loss: 0.07972087, Training R2: 0.989747
Validation Loss: 0.43665081, Validation R2: 0.811458

Epoch 74/1000
Training Loss: 0.13433849, Training R2: 0.981347
Validation Loss: 0.44236944, Validation R2: 0.809048

Epoch 75/1000
Training Loss: 0.14566313, Training R2: 0.980254
Validation Loss: 0.44820528, Validation R2: 0.806446

Epoch 76/1000
Training Loss: 0.10331451, Training R2: 0.986940
Validation Loss: 0.42561348, Validation R2: 0.815947
Saved best model with validation R2 0.815947 to best_finetuned_model.pth

Epoch 77/1000
Training Loss: 0.08473110, Training R2: 0.988820
Validation Loss: 0.42723836, Validation R2: 0.813753

Epoch 78/1000
Training Loss: 0.07401124, Training R2: 0.990961
Validation Loss: 0.43271948, Validation R2: 0.814927

Epoch 79/1000
Training Loss: 0.07130556, Training R2: 0.991368
Validation Loss: 0.42634835, Validation R2: 0.816006
Saved best model with validation R2 0.816006 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.07333757, Training R2: 0.991400
Validation Loss: 0.42570840, Validation R2: 0.819289
Saved best model with validation R2 0.819289 to best_finetuned_model.pth

Epoch 81/1000
Training Loss: 0.07568800, Training R2: 0.991887
Validation Loss: 0.42866310, Validation R2: 0.815772

Epoch 82/1000
Training Loss: 0.07323485, Training R2: 0.992284
Validation Loss: 0.42504767, Validation R2: 0.816568

Epoch 83/1000
Training Loss: 0.07325120, Training R2: 0.992819
Validation Loss: 0.43531170, Validation R2: 0.812014

Epoch 84/1000
Training Loss: 0.08078620, Training R2: 0.992351
Validation Loss: 0.43168990, Validation R2: 0.812527

Epoch 85/1000
Training Loss: 0.08690865, Training R2: 0.991918
Validation Loss: 0.43037302, Validation R2: 0.815589

Epoch 86/1000
Training Loss: 0.08746598, Training R2: 0.992526
Validation Loss: 0.42900558, Validation R2: 0.815441

Epoch 87/1000
Training Loss: 0.10024469, Training R2: 0.991109
Validation Loss: 0.43696994, Validation R2: 0.812278

Epoch 88/1000
Training Loss: 0.15204252, Training R2: 0.983393
Validation Loss: 0.43345951, Validation R2: 0.814446

Epoch 89/1000
Training Loss: 0.09140762, Training R2: 0.991119
Validation Loss: 0.42826914, Validation R2: 0.815554

Epoch 90/1000
Training Loss: 0.06871536, Training R2: 0.995070
Validation Loss: 0.43297072, Validation R2: 0.813708

Epoch 91/1000
Training Loss: 0.07479022, Training R2: 0.994991
Validation Loss: 0.42634521, Validation R2: 0.816681

Epoch 92/1000
Training Loss: 0.08102778, Training R2: 0.994176
Validation Loss: 0.42708000, Validation R2: 0.813737

Epoch 93/1000
Training Loss: 0.07493219, Training R2: 0.994653
Validation Loss: 0.43191467, Validation R2: 0.812893

Epoch 94/1000
Training Loss: 0.07586431, Training R2: 0.994984
Validation Loss: 0.42520555, Validation R2: 0.814689

Epoch 95/1000
Training Loss: 0.09512490, Training R2: 0.992720
Validation Loss: 0.43983487, Validation R2: 0.806483

Epoch 96/1000
Training Loss: 0.11065534, Training R2: 0.990527
Validation Loss: 0.44489100, Validation R2: 0.804790

Epoch 97/1000
Training Loss: 0.12357387, Training R2: 0.988901
Validation Loss: 0.45511077, Validation R2: 0.801293

Epoch 98/1000
Training Loss: 0.11612539, Training R2: 0.989557
Validation Loss: 0.43192697, Validation R2: 0.811866

Epoch 99/1000
Training Loss: 0.11106058, Training R2: 0.990426
Validation Loss: 0.44244880, Validation R2: 0.803470

Epoch 100/1000
Training Loss: 0.12011079, Training R2: 0.989082
Validation Loss: 0.44592965, Validation R2: 0.805859

Epoch 101/1000
Epoch 00101: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.10650154, Training R2: 0.990968
Validation Loss: 0.42423136, Validation R2: 0.814689

Epoch 102/1000
学习率已减少 1 次
Training Loss: 0.06964202, Training R2: 0.995548
Validation Loss: 0.42426740, Validation R2: 0.815816

Epoch 103/1000
Training Loss: 0.05352931, Training R2: 0.997310
Validation Loss: 0.42346166, Validation R2: 0.815002

Epoch 104/1000
Training Loss: 0.04531236, Training R2: 0.997927
Validation Loss: 0.42972470, Validation R2: 0.812449

Epoch 105/1000
Training Loss: 0.04215355, Training R2: 0.998229
Validation Loss: 0.42397329, Validation R2: 0.815167

Epoch 106/1000
Training Loss: 0.04017257, Training R2: 0.998325
Validation Loss: 0.42521011, Validation R2: 0.815564

Epoch 107/1000
Training Loss: 0.03618444, Training R2: 0.998587
Validation Loss: 0.42948466, Validation R2: 0.813334

Epoch 108/1000
Training Loss: 0.04232538, Training R2: 0.998304
Validation Loss: 0.42687694, Validation R2: 0.814876

Epoch 109/1000
Training Loss: 0.04316636, Training R2: 0.998217
Validation Loss: 0.43045433, Validation R2: 0.812436

Epoch 110/1000
Training Loss: 0.03918507, Training R2: 0.998437
Validation Loss: 0.42477078, Validation R2: 0.816703

Epoch 111/1000
Training Loss: 0.03047072, Training R2: 0.998888
Validation Loss: 0.42592227, Validation R2: 0.814788

Epoch 112/1000
Training Loss: 0.03294775, Training R2: 0.998796
Validation Loss: 0.42612100, Validation R2: 0.815169

Epoch 113/1000
Training Loss: 0.03560009, Training R2: 0.998663
Validation Loss: 0.42683196, Validation R2: 0.815987

Epoch 114/1000
Training Loss: 0.03630166, Training R2: 0.998579
Validation Loss: 0.42568447, Validation R2: 0.815523

Epoch 115/1000
Training Loss: 0.05416213, Training R2: 0.997591
Validation Loss: 0.42753006, Validation R2: 0.813717

Epoch 116/1000
Training Loss: 0.04478923, Training R2: 0.998144
Validation Loss: 0.42316592, Validation R2: 0.817063

Epoch 117/1000
Training Loss: 0.03295466, Training R2: 0.998801
Validation Loss: 0.42788072, Validation R2: 0.814323

Epoch 118/1000
Training Loss: 0.03372048, Training R2: 0.998750
Validation Loss: 0.42430564, Validation R2: 0.814844

Epoch 119/1000
Training Loss: 0.03712140, Training R2: 0.998599
Validation Loss: 0.42370724, Validation R2: 0.816467

Epoch 120/1000
Training Loss: 0.03598393, Training R2: 0.998659
Validation Loss: 0.42515901, Validation R2: 0.816227

Epoch 121/1000
Training Loss: 0.03278434, Training R2: 0.998867
Validation Loss: 0.42706211, Validation R2: 0.815354

Epoch 122/1000
Epoch 00122: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03217903, Training R2: 0.998900
Validation Loss: 0.42391855, Validation R2: 0.816682

Epoch 123/1000
学习率已减少 2 次
Training Loss: 0.02672869, Training R2: 0.999133
Validation Loss: 0.42324833, Validation R2: 0.817634

Epoch 124/1000
Training Loss: 0.02767760, Training R2: 0.999153
Validation Loss: 0.42317273, Validation R2: 0.817362

Epoch 125/1000
Training Loss: 0.03052808, Training R2: 0.999032
Validation Loss: 0.42342921, Validation R2: 0.816897

Epoch 126/1000
Training Loss: 0.02198895, Training R2: 0.999324
Validation Loss: 0.42452119, Validation R2: 0.817016

Epoch 127/1000
Training Loss: 0.01812505, Training R2: 0.999444
Validation Loss: 0.42447331, Validation R2: 0.816944

Epoch 128/1000
Training Loss: 0.02159864, Training R2: 0.999349
Validation Loss: 0.42289995, Validation R2: 0.817304

Epoch 129/1000
Training Loss: 0.01743236, Training R2: 0.999472
Validation Loss: 0.42270534, Validation R2: 0.817511

Epoch 130/1000
Training Loss: 0.01645286, Training R2: 0.999483
Validation Loss: 0.42305806, Validation R2: 0.817887

Epoch 131/1000
Training Loss: 0.01675618, Training R2: 0.999484
Validation Loss: 0.42243889, Validation R2: 0.817594

Epoch 132/1000
Training Loss: 0.01570473, Training R2: 0.999505
Validation Loss: 0.42217827, Validation R2: 0.817972

Epoch 133/1000
Training Loss: 0.01593003, Training R2: 0.999506
Validation Loss: 0.42183515, Validation R2: 0.818172

Epoch 134/1000
Training Loss: 0.01949384, Training R2: 0.999432
Validation Loss: 0.42177255, Validation R2: 0.818058

Epoch 135/1000
Training Loss: 0.02032640, Training R2: 0.999384
Validation Loss: 0.42241834, Validation R2: 0.817737

Epoch 136/1000
Training Loss: 0.02218927, Training R2: 0.999357
Validation Loss: 0.42159340, Validation R2: 0.818607

Epoch 137/1000
Training Loss: 0.02029037, Training R2: 0.999411
Validation Loss: 0.42193743, Validation R2: 0.817947

Epoch 138/1000
Training Loss: 0.02145147, Training R2: 0.999375
Validation Loss: 0.42492073, Validation R2: 0.816271

Epoch 139/1000
Training Loss: 0.02028055, Training R2: 0.999405
Validation Loss: 0.42425406, Validation R2: 0.816288

Epoch 140/1000
Training Loss: 0.01993029, Training R2: 0.999410
Validation Loss: 0.42338425, Validation R2: 0.817601

Epoch 141/1000
Training Loss: 0.02590579, Training R2: 0.999223
Validation Loss: 0.42492563, Validation R2: 0.816998

Epoch 142/1000
Training Loss: 0.02514762, Training R2: 0.999241
Validation Loss: 0.42339798, Validation R2: 0.817457

Epoch 143/1000
Epoch 00143: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.01796612, Training R2: 0.999441
Validation Loss: 0.42227078, Validation R2: 0.816960

Epoch 144/1000
学习率已减少 3 次
Training Loss: 0.01625056, Training R2: 0.999512
Validation Loss: 0.42364551, Validation R2: 0.817305

Epoch 145/1000
Training Loss: 0.01177097, Training R2: 0.999610
Validation Loss: 0.42189572, Validation R2: 0.817885

Epoch 146/1000
Training Loss: 0.01108595, Training R2: 0.999618
Validation Loss: 0.42268961, Validation R2: 0.817869

Epoch 147/1000
Training Loss: 0.00984194, Training R2: 0.999634
Validation Loss: 0.42240046, Validation R2: 0.817341

Epoch 148/1000
Training Loss: 0.00936160, Training R2: 0.999645
Validation Loss: 0.42197455, Validation R2: 0.817639

Epoch 149/1000
Training Loss: 0.01185565, Training R2: 0.999609
Validation Loss: 0.42156142, Validation R2: 0.817869

Epoch 150/1000
Training Loss: 0.01048943, Training R2: 0.999634
Validation Loss: 0.42193245, Validation R2: 0.817842

Epoch 151/1000
Training Loss: 0.01015386, Training R2: 0.999640
Validation Loss: 0.42209064, Validation R2: 0.817974

Epoch 152/1000
Training Loss: 0.01113348, Training R2: 0.999622
Validation Loss: 0.42269167, Validation R2: 0.817531

Epoch 153/1000
Training Loss: 0.00990699, Training R2: 0.999641
Validation Loss: 0.42249928, Validation R2: 0.817605

Epoch 154/1000
Training Loss: 0.00891615, Training R2: 0.999652
Validation Loss: 0.42252836, Validation R2: 0.817481

Epoch 155/1000
Training Loss: 0.00924653, Training R2: 0.999652
Validation Loss: 0.42225351, Validation R2: 0.817676

Epoch 156/1000
Training Loss: 0.00833165, Training R2: 0.999663
Validation Loss: 0.42223474, Validation R2: 0.817709

Epoch 157/1000
Training Loss: 0.00928663, Training R2: 0.999651
Validation Loss: 0.42275805, Validation R2: 0.817851

Epoch 158/1000
Training Loss: 0.01261105, Training R2: 0.999612
Validation Loss: 0.42115832, Validation R2: 0.817800

Epoch 159/1000
Training Loss: 0.01059526, Training R2: 0.999628
Validation Loss: 0.42221145, Validation R2: 0.817625

Epoch 160/1000
Training Loss: 0.00898384, Training R2: 0.999658
Validation Loss: 0.42155058, Validation R2: 0.817835

Epoch 161/1000
Training Loss: 0.01130510, Training R2: 0.999636
Validation Loss: 0.42087274, Validation R2: 0.818009

Epoch 162/1000
Training Loss: 0.00925033, Training R2: 0.999659
Validation Loss: 0.42285892, Validation R2: 0.817493

Epoch 163/1000
Training Loss: 0.00910657, Training R2: 0.999660
Validation Loss: 0.42221468, Validation R2: 0.817504

Epoch 164/1000
Epoch 00164: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00924559, Training R2: 0.999665
Validation Loss: 0.42158934, Validation R2: 0.817862

Epoch 165/1000
学习率已减少 4 次
Training Loss: 0.00768367, Training R2: 0.999674
Validation Loss: 0.42187541, Validation R2: 0.817847

Epoch 166/1000
Training Loss: 0.00608653, Training R2: 0.999686
Validation Loss: 0.42149709, Validation R2: 0.818109

Epoch 167/1000
Training Loss: 0.00523136, Training R2: 0.999699
Validation Loss: 0.42176098, Validation R2: 0.817906

Epoch 168/1000
Training Loss: 0.00551357, Training R2: 0.999697
Validation Loss: 0.42150090, Validation R2: 0.817949

Epoch 169/1000
Training Loss: 0.00559798, Training R2: 0.999649
Validation Loss: 0.42135171, Validation R2: 0.817891

Epoch 170/1000
Training Loss: 0.00523985, Training R2: 0.999701
Validation Loss: 0.42179900, Validation R2: 0.817891

Epoch 171/1000
Training Loss: 0.00636867, Training R2: 0.999537
Validation Loss: 0.42206171, Validation R2: 0.817746

Epoch 172/1000
Training Loss: 0.00556943, Training R2: 0.999697
Validation Loss: 0.42131653, Validation R2: 0.817841

Epoch 173/1000
Training Loss: 0.00505646, Training R2: 0.999701
Validation Loss: 0.42183476, Validation R2: 0.817837

Epoch 174/1000
Training Loss: 0.00483666, Training R2: 0.999704
Validation Loss: 0.42199871, Validation R2: 0.817731

Epoch 175/1000
Training Loss: 0.00502750, Training R2: 0.999698
Validation Loss: 0.42196261, Validation R2: 0.817728

Epoch 176/1000
Training Loss: 0.00498257, Training R2: 0.999698
Validation Loss: 0.42151431, Validation R2: 0.817953

Epoch 177/1000
Training Loss: 0.00494973, Training R2: 0.999702
Validation Loss: 0.42179059, Validation R2: 0.817909

Epoch 178/1000
Training Loss: 0.00484688, Training R2: 0.999705
Validation Loss: 0.42176854, Validation R2: 0.817864

Epoch 179/1000
Training Loss: 0.00510295, Training R2: 0.999705
Validation Loss: 0.42140514, Validation R2: 0.818108

Epoch 180/1000
Training Loss: 0.00642797, Training R2: 0.999690
Validation Loss: 0.42216433, Validation R2: 0.817886

Epoch 181/1000
Training Loss: 0.00535831, Training R2: 0.999704
Validation Loss: 0.42143703, Validation R2: 0.818004

Epoch 182/1000
Training Loss: 0.00816377, Training R2: 0.999676
Validation Loss: 0.42139642, Validation R2: 0.817813

Epoch 183/1000
Training Loss: 0.00623272, Training R2: 0.999698
Validation Loss: 0.42163701, Validation R2: 0.817918

Epoch 184/1000
Training Loss: 0.00523999, Training R2: 0.999704
Validation Loss: 0.42173825, Validation R2: 0.817957

Epoch 185/1000
Epoch 00185: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00812404, Training R2: 0.999680
Validation Loss: 0.42221349, Validation R2: 0.817953

Epoch 186/1000
学习率已减少 5 次
Training Loss: 0.00720380, Training R2: 0.999677
Validation Loss: 0.42151035, Validation R2: 0.818136

Epoch 187/1000
Training Loss: 0.00542094, Training R2: 0.999698
Validation Loss: 0.42105886, Validation R2: 0.818235

Epoch 188/1000
Training Loss: 0.00424126, Training R2: 0.999709
Validation Loss: 0.42150271, Validation R2: 0.818112

Epoch 189/1000
Training Loss: 0.00353450, Training R2: 0.999712
Validation Loss: 0.42160224, Validation R2: 0.817910

Epoch 190/1000
Training Loss: 0.00340707, Training R2: 0.999712
Validation Loss: 0.42170493, Validation R2: 0.817932

Epoch 191/1000
Training Loss: 0.00301380, Training R2: 0.999719
Validation Loss: 0.42176426, Validation R2: 0.817841

Epoch 192/1000
Training Loss: 0.00325464, Training R2: 0.999712
Validation Loss: 0.42152320, Validation R2: 0.818011

Epoch 193/1000
Training Loss: 0.00322101, Training R2: 0.999716
Validation Loss: 0.42174773, Validation R2: 0.817824

Epoch 194/1000
Training Loss: 0.00289239, Training R2: 0.999714
Validation Loss: 0.42208660, Validation R2: 0.817728

Epoch 195/1000
Training Loss: 0.00306027, Training R2: 0.999717
Validation Loss: 0.42145836, Validation R2: 0.818029

Epoch 196/1000
Training Loss: 0.00325068, Training R2: 0.999718
Validation Loss: 0.42181526, Validation R2: 0.817928

Epoch 197/1000
Training Loss: 0.00308626, Training R2: 0.999718
Validation Loss: 0.42149261, Validation R2: 0.817936

Epoch 198/1000
Training Loss: 0.00313844, Training R2: 0.999715
Validation Loss: 0.42153109, Validation R2: 0.818022

Epoch 199/1000
Training Loss: 0.00322491, Training R2: 0.999717
Validation Loss: 0.42148120, Validation R2: 0.817956

Epoch 200/1000
Training Loss: 0.00361358, Training R2: 0.999713
Validation Loss: 0.42159058, Validation R2: 0.817877

Epoch 201/1000
Training Loss: 0.00439115, Training R2: 0.999711
Validation Loss: 0.42138640, Validation R2: 0.817964

Epoch 202/1000
Training Loss: 0.00457117, Training R2: 0.999712
Validation Loss: 0.42157958, Validation R2: 0.817946

Epoch 203/1000
Training Loss: 0.00443595, Training R2: 0.999712
Validation Loss: 0.42203007, Validation R2: 0.817690

Epoch 204/1000
Training Loss: 0.00378465, Training R2: 0.999711
Validation Loss: 0.42173022, Validation R2: 0.817891

Epoch 205/1000
Training Loss: 0.00354406, Training R2: 0.999716
Validation Loss: 0.42150917, Validation R2: 0.817972

Epoch 206/1000
Epoch 00206: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00332891, Training R2: 0.999718
Validation Loss: 0.42163303, Validation R2: 0.817949

Epoch 207/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
