Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)

Frozen layers status:
emb_z.emb.weight: Trainable
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5317507

Epoch 1/1000
Training Loss: 1.38278165, Training R2: -0.418388
Validation Loss: 1.12751497, Validation R2: 0.111707
Saved best model with validation R2 0.111707 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.08436634, Training R2: 0.145786
Validation Loss: 1.00079353, Validation R2: 0.219397
Saved best model with validation R2 0.219397 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.91062150, Training R2: 0.346055
Validation Loss: 0.82658360, Validation R2: 0.452900
Saved best model with validation R2 0.452900 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.81899229, Training R2: 0.447561
Validation Loss: 0.76857126, Validation R2: 0.507275
Saved best model with validation R2 0.507275 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.74333789, Training R2: 0.518982
Validation Loss: 0.70949418, Validation R2: 0.564352
Saved best model with validation R2 0.564352 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.66366145, Training R2: 0.597057
Validation Loss: 0.64305028, Validation R2: 0.619286
Saved best model with validation R2 0.619286 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.58877285, Training R2: 0.659996
Validation Loss: 0.61543733, Validation R2: 0.645790
Saved best model with validation R2 0.645790 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.52267101, Training R2: 0.716617
Validation Loss: 0.55002640, Validation R2: 0.699132
Saved best model with validation R2 0.699132 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.47130876, Training R2: 0.767169
Validation Loss: 0.54808290, Validation R2: 0.720019
Saved best model with validation R2 0.720019 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.42640038, Training R2: 0.803394
Validation Loss: 0.52020194, Validation R2: 0.733973
Saved best model with validation R2 0.733973 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.39943009, Training R2: 0.826650
Validation Loss: 0.54424031, Validation R2: 0.729968

Epoch 12/1000
Training Loss: 0.38824838, Training R2: 0.846010
Validation Loss: 0.53259044, Validation R2: 0.737981
Saved best model with validation R2 0.737981 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.34618552, Training R2: 0.865584
Validation Loss: 0.50919405, Validation R2: 0.766523
Saved best model with validation R2 0.766523 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.33894526, Training R2: 0.873473
Validation Loss: 0.47246745, Validation R2: 0.785407
Saved best model with validation R2 0.785407 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.29392581, Training R2: 0.899667
Validation Loss: 0.48075885, Validation R2: 0.791345
Saved best model with validation R2 0.791345 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.27106196, Training R2: 0.914816
Validation Loss: 0.44740913, Validation R2: 0.803517
Saved best model with validation R2 0.803517 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.25657488, Training R2: 0.920509
Validation Loss: 0.44540028, Validation R2: 0.812944
Saved best model with validation R2 0.812944 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.23487179, Training R2: 0.934627
Validation Loss: 0.44404428, Validation R2: 0.798835

Epoch 19/1000
Training Loss: 0.22046915, Training R2: 0.940592
Validation Loss: 0.44437995, Validation R2: 0.806543

Epoch 20/1000
Training Loss: 0.21172028, Training R2: 0.944446
Validation Loss: 0.44755547, Validation R2: 0.806934

Epoch 21/1000
Training Loss: 0.19610738, Training R2: 0.951796
Validation Loss: 0.43828141, Validation R2: 0.811976

Epoch 22/1000
Training Loss: 0.19958272, Training R2: 0.952128
Validation Loss: 0.44036666, Validation R2: 0.808246

Epoch 23/1000
Training Loss: 0.18359868, Training R2: 0.957680
Validation Loss: 0.42943208, Validation R2: 0.816432
Saved best model with validation R2 0.816432 to best_finetuned_model.pth

Epoch 24/1000
Training Loss: 0.18014519, Training R2: 0.960178
Validation Loss: 0.42664490, Validation R2: 0.822542
Saved best model with validation R2 0.822542 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.16511449, Training R2: 0.964975
Validation Loss: 0.42525029, Validation R2: 0.823587
Saved best model with validation R2 0.823587 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.15925451, Training R2: 0.966032
Validation Loss: 0.44083641, Validation R2: 0.808429

Epoch 27/1000
Training Loss: 0.17281077, Training R2: 0.964841
Validation Loss: 0.45399780, Validation R2: 0.808847

Epoch 28/1000
Training Loss: 0.17933744, Training R2: 0.961085
Validation Loss: 0.42816084, Validation R2: 0.821772

Epoch 29/1000
Training Loss: 0.15848261, Training R2: 0.967056
Validation Loss: 0.43666592, Validation R2: 0.814104

Epoch 30/1000
Training Loss: 0.15996819, Training R2: 0.968822
Validation Loss: 0.42388340, Validation R2: 0.832214
Saved best model with validation R2 0.832214 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.16212991, Training R2: 0.968807
Validation Loss: 0.42384075, Validation R2: 0.827689

Epoch 32/1000
Training Loss: 0.16251178, Training R2: 0.971296
Validation Loss: 0.41295740, Validation R2: 0.832573
Saved best model with validation R2 0.832573 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.16064049, Training R2: 0.970570
Validation Loss: 0.41104444, Validation R2: 0.835687
Saved best model with validation R2 0.835687 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.13485932, Training R2: 0.976918
Validation Loss: 0.41885149, Validation R2: 0.834714

Epoch 35/1000
Training Loss: 0.13995274, Training R2: 0.976457
Validation Loss: 0.42251487, Validation R2: 0.830344

Epoch 36/1000
Training Loss: 0.13830196, Training R2: 0.978285
Validation Loss: 0.42202383, Validation R2: 0.825507

Epoch 37/1000
Training Loss: 0.11993256, Training R2: 0.981609
Validation Loss: 0.42085664, Validation R2: 0.829042

Epoch 38/1000
Training Loss: 0.11676399, Training R2: 0.983035
Validation Loss: 0.41577522, Validation R2: 0.831464

Epoch 39/1000
Training Loss: 0.12022280, Training R2: 0.981583
Validation Loss: 0.42050852, Validation R2: 0.826306

Epoch 40/1000
Training Loss: 0.12037007, Training R2: 0.983012
Validation Loss: 0.42058632, Validation R2: 0.831208

Epoch 41/1000
Training Loss: 0.10895787, Training R2: 0.983767
Validation Loss: 0.42059875, Validation R2: 0.827663

Epoch 42/1000
Training Loss: 0.11740829, Training R2: 0.983614
Validation Loss: 0.42762351, Validation R2: 0.824373

Epoch 43/1000
Training Loss: 0.12297729, Training R2: 0.983130
Validation Loss: 0.41848226, Validation R2: 0.830876

Epoch 44/1000
Training Loss: 0.17363336, Training R2: 0.972939
Validation Loss: 0.44604298, Validation R2: 0.817290

Epoch 45/1000
Training Loss: 0.15328036, Training R2: 0.974497
Validation Loss: 0.41824336, Validation R2: 0.832923

Epoch 46/1000
Training Loss: 0.12585329, Training R2: 0.971833
Validation Loss: 0.41320667, Validation R2: 0.834911

Epoch 47/1000
Training Loss: 0.14404933, Training R2: 0.974251
Validation Loss: 0.47507882, Validation R2: 0.811686

Epoch 48/1000
Training Loss: 0.14760863, Training R2: 0.973820
Validation Loss: 0.40758229, Validation R2: 0.835190

Epoch 49/1000
Training Loss: 0.10212976, Training R2: 0.983671
Validation Loss: 0.41010692, Validation R2: 0.839040
Saved best model with validation R2 0.839040 to best_finetuned_model.pth

Epoch 50/1000
Training Loss: 0.10289667, Training R2: 0.984302
Validation Loss: 0.41137784, Validation R2: 0.833107

Epoch 51/1000
Training Loss: 0.11374343, Training R2: 0.984183
Validation Loss: 0.40702347, Validation R2: 0.837799

Epoch 52/1000
Training Loss: 0.10760358, Training R2: 0.984139
Validation Loss: 0.41846000, Validation R2: 0.828913

Epoch 53/1000
Training Loss: 0.09746576, Training R2: 0.985801
Validation Loss: 0.40738829, Validation R2: 0.836847

Epoch 54/1000
Training Loss: 0.11039636, Training R2: 0.985268
Validation Loss: 0.40100647, Validation R2: 0.841873
Saved best model with validation R2 0.841873 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.09744382, Training R2: 0.987516
Validation Loss: 0.40282378, Validation R2: 0.842078
Saved best model with validation R2 0.842078 to best_finetuned_model.pth

Epoch 56/1000
Training Loss: 0.09290468, Training R2: 0.988175
Validation Loss: 0.40123004, Validation R2: 0.839967

Epoch 57/1000
Training Loss: 0.08608206, Training R2: 0.988492
Validation Loss: 0.41060361, Validation R2: 0.829545

Epoch 58/1000
Training Loss: 0.10465093, Training R2: 0.987686
Validation Loss: 0.40960285, Validation R2: 0.833279

Epoch 59/1000
Training Loss: 0.15370567, Training R2: 0.979917
Validation Loss: 0.40828764, Validation R2: 0.835530

Epoch 60/1000
Training Loss: 0.10779848, Training R2: 0.988010
Validation Loss: 0.40195515, Validation R2: 0.844206
Saved best model with validation R2 0.844206 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.09155660, Training R2: 0.990682
Validation Loss: 0.40374780, Validation R2: 0.838891

Epoch 62/1000
Training Loss: 0.08908500, Training R2: 0.991520
Validation Loss: 0.40650642, Validation R2: 0.834123

Epoch 63/1000
Training Loss: 0.09167643, Training R2: 0.990753
Validation Loss: 0.40925360, Validation R2: 0.835195

Epoch 64/1000
Training Loss: 0.10578112, Training R2: 0.989609
Validation Loss: 0.40360931, Validation R2: 0.846076
Saved best model with validation R2 0.846076 to best_finetuned_model.pth

Epoch 65/1000
Training Loss: 0.14648345, Training R2: 0.982188
Validation Loss: 0.40877365, Validation R2: 0.837688

Epoch 66/1000
Training Loss: 0.10257877, Training R2: 0.989403
Validation Loss: 0.40828463, Validation R2: 0.840428

Epoch 67/1000
Training Loss: 0.10375501, Training R2: 0.987043
Validation Loss: 0.40640305, Validation R2: 0.839803

Epoch 68/1000
Training Loss: 0.10301432, Training R2: 0.986087
Validation Loss: 0.40280087, Validation R2: 0.844444

Epoch 69/1000
Training Loss: 0.09127278, Training R2: 0.990486
Validation Loss: 0.40145990, Validation R2: 0.843704

Epoch 70/1000
Training Loss: 0.08846114, Training R2: 0.991262
Validation Loss: 0.39819801, Validation R2: 0.847266
Saved best model with validation R2 0.847266 to best_finetuned_model.pth

Epoch 71/1000
Training Loss: 0.07903094, Training R2: 0.994103
Validation Loss: 0.40360677, Validation R2: 0.837675

Epoch 72/1000
Training Loss: 0.09388038, Training R2: 0.993004
Validation Loss: 0.40605658, Validation R2: 0.839376

Epoch 73/1000
Training Loss: 0.08589370, Training R2: 0.994062
Validation Loss: 0.39933550, Validation R2: 0.841798

Epoch 74/1000
Training Loss: 0.07332253, Training R2: 0.994469
Validation Loss: 0.39939045, Validation R2: 0.842364

Epoch 75/1000
Training Loss: 0.07611388, Training R2: 0.995502
Validation Loss: 0.40448825, Validation R2: 0.839003

Epoch 76/1000
Training Loss: 0.09843031, Training R2: 0.992036
Validation Loss: 0.40021816, Validation R2: 0.845857

Epoch 77/1000
Training Loss: 0.10776531, Training R2: 0.990492
Validation Loss: 0.41824595, Validation R2: 0.834172

Epoch 78/1000
Training Loss: 0.13000026, Training R2: 0.987614
Validation Loss: 0.40389259, Validation R2: 0.840080

Epoch 79/1000
Training Loss: 0.11541622, Training R2: 0.989729
Validation Loss: 0.40499481, Validation R2: 0.833524

Epoch 80/1000
Training Loss: 0.08902342, Training R2: 0.993621
Validation Loss: 0.40912516, Validation R2: 0.841887

Epoch 81/1000
Training Loss: 0.07668618, Training R2: 0.995179
Validation Loss: 0.39415347, Validation R2: 0.845783

Epoch 82/1000
Training Loss: 0.07027597, Training R2: 0.995954
Validation Loss: 0.39432528, Validation R2: 0.845458

Epoch 83/1000
Training Loss: 0.07877065, Training R2: 0.994850
Validation Loss: 0.38941710, Validation R2: 0.848558
Saved best model with validation R2 0.848558 to best_finetuned_model.pth

Epoch 84/1000
Training Loss: 0.08202803, Training R2: 0.994664
Validation Loss: 0.39931923, Validation R2: 0.838562

Epoch 85/1000
Training Loss: 0.09498597, Training R2: 0.993134
Validation Loss: 0.40594054, Validation R2: 0.842053

Epoch 86/1000
Training Loss: 0.09904876, Training R2: 0.992280
Validation Loss: 0.40348598, Validation R2: 0.845867

Epoch 87/1000
Training Loss: 0.07101147, Training R2: 0.995744
Validation Loss: 0.39276443, Validation R2: 0.851795
Saved best model with validation R2 0.851795 to best_finetuned_model.pth

Epoch 88/1000
Training Loss: 0.07518184, Training R2: 0.995600
Validation Loss: 0.40264061, Validation R2: 0.839312

Epoch 89/1000
Training Loss: 0.07583575, Training R2: 0.995274
Validation Loss: 0.40105149, Validation R2: 0.844031

Epoch 90/1000
Training Loss: 0.07282011, Training R2: 0.995844
Validation Loss: 0.39843636, Validation R2: 0.845837

Epoch 91/1000
Training Loss: 0.07931849, Training R2: 0.995198
Validation Loss: 0.39626349, Validation R2: 0.846345

Epoch 92/1000
Training Loss: 0.07413963, Training R2: 0.995693
Validation Loss: 0.39158494, Validation R2: 0.849581

Epoch 93/1000
Training Loss: 0.06991267, Training R2: 0.996082
Validation Loss: 0.38662679, Validation R2: 0.849868

Epoch 94/1000
Training Loss: 0.07660027, Training R2: 0.995438
Validation Loss: 0.39649581, Validation R2: 0.845568

Epoch 95/1000
Training Loss: 0.07837046, Training R2: 0.995357
Validation Loss: 0.39519227, Validation R2: 0.843243

Epoch 96/1000
Training Loss: 0.07689732, Training R2: 0.995539
Validation Loss: 0.39385139, Validation R2: 0.847136

Epoch 97/1000
Training Loss: 0.08919483, Training R2: 0.993803
Validation Loss: 0.39024227, Validation R2: 0.846607

Epoch 98/1000
Training Loss: 0.08170746, Training R2: 0.994200
Validation Loss: 0.39181134, Validation R2: 0.846384

Epoch 99/1000
Training Loss: 0.08086020, Training R2: 0.994390
Validation Loss: 0.39140857, Validation R2: 0.847129

Epoch 100/1000
Training Loss: 0.07543648, Training R2: 0.994209
Validation Loss: 0.39635582, Validation R2: 0.844081

Epoch 101/1000
Training Loss: 0.06542563, Training R2: 0.995849
Validation Loss: 0.39197867, Validation R2: 0.843116

Epoch 102/1000
Training Loss: 0.06587477, Training R2: 0.996239
Validation Loss: 0.39574171, Validation R2: 0.848634

Epoch 103/1000
Training Loss: 0.07207907, Training R2: 0.995992
Validation Loss: 0.39731531, Validation R2: 0.845300

Epoch 104/1000
Training Loss: 0.08414810, Training R2: 0.994430
Validation Loss: 0.39424655, Validation R2: 0.843477

Epoch 105/1000
Training Loss: 0.06745631, Training R2: 0.996404
Validation Loss: 0.39357488, Validation R2: 0.846879

Epoch 106/1000
Training Loss: 0.06570453, Training R2: 0.996535
Validation Loss: 0.38546305, Validation R2: 0.850266

Epoch 107/1000
Training Loss: 0.07533819, Training R2: 0.995725
Validation Loss: 0.39308051, Validation R2: 0.847539

Epoch 108/1000
Epoch 00108: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.07356898, Training R2: 0.995909
Validation Loss: 0.39102495, Validation R2: 0.845424

Epoch 109/1000
学习率已减少 1 次
Training Loss: 0.05706824, Training R2: 0.997478
Validation Loss: 0.38601891, Validation R2: 0.848758

Epoch 110/1000
Training Loss: 0.04134833, Training R2: 0.998655
Validation Loss: 0.38828294, Validation R2: 0.849307

Epoch 111/1000
Training Loss: 0.03591063, Training R2: 0.998996
Validation Loss: 0.38350018, Validation R2: 0.851963
Saved best model with validation R2 0.851963 to best_finetuned_model.pth

Epoch 112/1000
Training Loss: 0.03209249, Training R2: 0.999219
Validation Loss: 0.38515228, Validation R2: 0.850374

Epoch 113/1000
Training Loss: 0.03836417, Training R2: 0.998922
Validation Loss: 0.38706865, Validation R2: 0.846755

Epoch 114/1000
Training Loss: 0.03521986, Training R2: 0.999074
Validation Loss: 0.38498593, Validation R2: 0.851160

Epoch 115/1000
Training Loss: 0.03180104, Training R2: 0.999191
Validation Loss: 0.38572533, Validation R2: 0.849485

Epoch 116/1000
Training Loss: 0.03368576, Training R2: 0.999145
Validation Loss: 0.38362536, Validation R2: 0.851426

Epoch 117/1000
Training Loss: 0.03027948, Training R2: 0.999284
Validation Loss: 0.39173181, Validation R2: 0.848330

Epoch 118/1000
Training Loss: 0.04410720, Training R2: 0.998593
Validation Loss: 0.38488335, Validation R2: 0.849638

Epoch 119/1000
Training Loss: 0.04893500, Training R2: 0.998241
Validation Loss: 0.38989166, Validation R2: 0.846912

Epoch 120/1000
Training Loss: 0.04457101, Training R2: 0.998544
Validation Loss: 0.38549011, Validation R2: 0.849334

Epoch 121/1000
Training Loss: 0.03173199, Training R2: 0.999195
Validation Loss: 0.38429347, Validation R2: 0.849340

Epoch 122/1000
Training Loss: 0.03115505, Training R2: 0.999246
Validation Loss: 0.38652685, Validation R2: 0.850747

Epoch 123/1000
Training Loss: 0.03072310, Training R2: 0.999273
Validation Loss: 0.38598309, Validation R2: 0.848950

Epoch 124/1000
Training Loss: 0.03124378, Training R2: 0.999280
Validation Loss: 0.38393717, Validation R2: 0.850372

Epoch 125/1000
Training Loss: 0.03975079, Training R2: 0.998868
Validation Loss: 0.38506787, Validation R2: 0.848931

Epoch 126/1000
Training Loss: 0.05409147, Training R2: 0.997949
Validation Loss: 0.39196116, Validation R2: 0.843704

Epoch 127/1000
Training Loss: 0.05081613, Training R2: 0.998155
Validation Loss: 0.38289495, Validation R2: 0.850774

Epoch 128/1000
Training Loss: 0.03831728, Training R2: 0.998881
Validation Loss: 0.38612070, Validation R2: 0.849585

Epoch 129/1000
Training Loss: 0.03145700, Training R2: 0.999228
Validation Loss: 0.38839314, Validation R2: 0.849197

Epoch 130/1000
Training Loss: 0.03176779, Training R2: 0.999188
Validation Loss: 0.38387526, Validation R2: 0.850039

Epoch 131/1000
Training Loss: 0.03206801, Training R2: 0.999218
Validation Loss: 0.38336846, Validation R2: 0.851283

Epoch 132/1000
Epoch 00132: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03656851, Training R2: 0.998997
Validation Loss: 0.38505342, Validation R2: 0.850567

Epoch 133/1000
学习率已减少 2 次
Training Loss: 0.02670325, Training R2: 0.999417
Validation Loss: 0.38638117, Validation R2: 0.850149

Epoch 134/1000
Training Loss: 0.02441634, Training R2: 0.999541
Validation Loss: 0.38480867, Validation R2: 0.851636

Epoch 135/1000
Training Loss: 0.01856739, Training R2: 0.999733
Validation Loss: 0.38513236, Validation R2: 0.849424

Epoch 136/1000
Training Loss: 0.01621757, Training R2: 0.999799
Validation Loss: 0.38419335, Validation R2: 0.850265

Epoch 137/1000
Training Loss: 0.01889968, Training R2: 0.999741
Validation Loss: 0.38460257, Validation R2: 0.850651

Epoch 138/1000
Training Loss: 0.01915065, Training R2: 0.999721
Validation Loss: 0.38350301, Validation R2: 0.851282

Epoch 139/1000
Training Loss: 0.02953715, Training R2: 0.999394
Validation Loss: 0.38390526, Validation R2: 0.849633

Epoch 140/1000
Training Loss: 0.02919346, Training R2: 0.999410
Validation Loss: 0.38423429, Validation R2: 0.851465

Epoch 141/1000
Training Loss: 0.02109225, Training R2: 0.999661
Validation Loss: 0.38410203, Validation R2: 0.850654

Epoch 142/1000
Training Loss: 0.01687625, Training R2: 0.999778
Validation Loss: 0.38449220, Validation R2: 0.850681

Epoch 143/1000
Training Loss: 0.01663744, Training R2: 0.999791
Validation Loss: 0.38507475, Validation R2: 0.851387

Epoch 144/1000
Training Loss: 0.02250500, Training R2: 0.999635
Validation Loss: 0.38409197, Validation R2: 0.848973

Epoch 145/1000
Training Loss: 0.02655993, Training R2: 0.999510
Validation Loss: 0.38481302, Validation R2: 0.849660

Epoch 146/1000
Training Loss: 0.02141084, Training R2: 0.999669
Validation Loss: 0.38534090, Validation R2: 0.851606

Epoch 147/1000
Training Loss: 0.01737618, Training R2: 0.999757
Validation Loss: 0.38364799, Validation R2: 0.852277
Saved best model with validation R2 0.852277 to best_finetuned_model.pth

Epoch 148/1000
Training Loss: 0.01744855, Training R2: 0.999758
Validation Loss: 0.38476226, Validation R2: 0.850656

Epoch 149/1000
Training Loss: 0.01906181, Training R2: 0.999701
Validation Loss: 0.38617390, Validation R2: 0.850474

Epoch 150/1000
Training Loss: 0.01839078, Training R2: 0.999748
Validation Loss: 0.38609587, Validation R2: 0.850804

Epoch 151/1000
Training Loss: 0.01994927, Training R2: 0.999699
Validation Loss: 0.38419432, Validation R2: 0.850505

Epoch 152/1000
Training Loss: 0.01840889, Training R2: 0.999729
Validation Loss: 0.38394905, Validation R2: 0.851300

Epoch 153/1000
Training Loss: 0.01714552, Training R2: 0.999769
Validation Loss: 0.38566823, Validation R2: 0.850945

Epoch 154/1000
Training Loss: 0.01745188, Training R2: 0.999761
Validation Loss: 0.38301468, Validation R2: 0.851223

Epoch 155/1000
Training Loss: 0.01933261, Training R2: 0.999719
Validation Loss: 0.38442390, Validation R2: 0.851632

Epoch 156/1000
Training Loss: 0.01677506, Training R2: 0.999775
Validation Loss: 0.38343533, Validation R2: 0.851217

Epoch 157/1000
Training Loss: 0.01849989, Training R2: 0.999738
Validation Loss: 0.38467247, Validation R2: 0.852284
Saved best model with validation R2 0.852284 to best_finetuned_model.pth

Epoch 158/1000
Training Loss: 0.01760687, Training R2: 0.999763
Validation Loss: 0.38357982, Validation R2: 0.852215

Epoch 159/1000
Training Loss: 0.01745230, Training R2: 0.999766
Validation Loss: 0.38704285, Validation R2: 0.850081

Epoch 160/1000
Training Loss: 0.01902529, Training R2: 0.999737
Validation Loss: 0.38419549, Validation R2: 0.851180

Epoch 161/1000
Training Loss: 0.01670198, Training R2: 0.999788
Validation Loss: 0.38346459, Validation R2: 0.852173

Epoch 162/1000
Training Loss: 0.01578297, Training R2: 0.999813
Validation Loss: 0.38491728, Validation R2: 0.849927

Epoch 163/1000
Training Loss: 0.01526155, Training R2: 0.999822
Validation Loss: 0.38330135, Validation R2: 0.852210

Epoch 164/1000
Training Loss: 0.01687572, Training R2: 0.999783
Validation Loss: 0.38447491, Validation R2: 0.851258

Epoch 165/1000
Training Loss: 0.01489188, Training R2: 0.999821
Validation Loss: 0.38384310, Validation R2: 0.851543

Epoch 166/1000
Training Loss: 0.01698608, Training R2: 0.999773
Validation Loss: 0.38365671, Validation R2: 0.852055

Epoch 167/1000
Training Loss: 0.01982096, Training R2: 0.999710
Validation Loss: 0.38438448, Validation R2: 0.852000

Epoch 168/1000
Epoch 00168: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.02374802, Training R2: 0.999597
Validation Loss: 0.38531154, Validation R2: 0.850636

Epoch 169/1000
学习率已减少 3 次
Training Loss: 0.01544257, Training R2: 0.999811
Validation Loss: 0.38310322, Validation R2: 0.852085

Epoch 170/1000
Training Loss: 0.01152811, Training R2: 0.999889
Validation Loss: 0.38312876, Validation R2: 0.852381
Saved best model with validation R2 0.852381 to best_finetuned_model.pth

Epoch 171/1000
Training Loss: 0.00980979, Training R2: 0.999925
Validation Loss: 0.38483005, Validation R2: 0.850923

Epoch 172/1000
Training Loss: 0.00985894, Training R2: 0.999924
Validation Loss: 0.38408072, Validation R2: 0.851067

Epoch 173/1000
Training Loss: 0.00872433, Training R2: 0.999937
Validation Loss: 0.38453969, Validation R2: 0.851147

Epoch 174/1000
Training Loss: 0.00907887, Training R2: 0.999936
Validation Loss: 0.38454271, Validation R2: 0.851789

Epoch 175/1000
Training Loss: 0.00862512, Training R2: 0.999942
Validation Loss: 0.38444705, Validation R2: 0.850756

Epoch 176/1000
Training Loss: 0.00918724, Training R2: 0.999935
Validation Loss: 0.38352123, Validation R2: 0.851274

Epoch 177/1000
Training Loss: 0.01106612, Training R2: 0.999911
Validation Loss: 0.38453343, Validation R2: 0.850995

Epoch 178/1000
Training Loss: 0.01310324, Training R2: 0.999879
Validation Loss: 0.38625963, Validation R2: 0.850430

Epoch 179/1000
Training Loss: 0.01676547, Training R2: 0.999812
Validation Loss: 0.38389747, Validation R2: 0.850870

Epoch 180/1000
Training Loss: 0.01347046, Training R2: 0.999869
Validation Loss: 0.38412780, Validation R2: 0.850690

Epoch 181/1000
Training Loss: 0.01515822, Training R2: 0.999838
Validation Loss: 0.38423056, Validation R2: 0.851967

Epoch 182/1000
Training Loss: 0.01379047, Training R2: 0.999864
Validation Loss: 0.38460760, Validation R2: 0.851604

Epoch 183/1000
Training Loss: 0.00986953, Training R2: 0.999925
Validation Loss: 0.38432390, Validation R2: 0.851271

Epoch 184/1000
Training Loss: 0.00943352, Training R2: 0.999932
Validation Loss: 0.38325396, Validation R2: 0.851555

Epoch 185/1000
Training Loss: 0.00945449, Training R2: 0.999933
Validation Loss: 0.38288108, Validation R2: 0.852036

Epoch 186/1000
Training Loss: 0.00960595, Training R2: 0.999930
Validation Loss: 0.38506506, Validation R2: 0.850622

Epoch 187/1000
Training Loss: 0.00950808, Training R2: 0.999928
Validation Loss: 0.38453282, Validation R2: 0.851490

Epoch 188/1000
Training Loss: 0.00834624, Training R2: 0.999940
Validation Loss: 0.38390948, Validation R2: 0.852128

Epoch 189/1000
Training Loss: 0.01018058, Training R2: 0.999923
Validation Loss: 0.38413693, Validation R2: 0.852005

Epoch 190/1000
Training Loss: 0.00991475, Training R2: 0.999926
Validation Loss: 0.38461340, Validation R2: 0.851697

Epoch 191/1000
Epoch 00191: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00808425, Training R2: 0.999947
Validation Loss: 0.38396458, Validation R2: 0.852081

Epoch 192/1000
学习率已减少 4 次
Training Loss: 0.00636478, Training R2: 0.999967
Validation Loss: 0.38400429, Validation R2: 0.851949

Epoch 193/1000
Training Loss: 0.00514147, Training R2: 0.999978
Validation Loss: 0.38363691, Validation R2: 0.851897

Epoch 194/1000
Training Loss: 0.00464975, Training R2: 0.999982
Validation Loss: 0.38406222, Validation R2: 0.851270

Epoch 195/1000
Training Loss: 0.00454751, Training R2: 0.999981
Validation Loss: 0.38389271, Validation R2: 0.851573

Epoch 196/1000
Training Loss: 0.00411753, Training R2: 0.999985
Validation Loss: 0.38394914, Validation R2: 0.851582

Epoch 197/1000
Training Loss: 0.00412118, Training R2: 0.999986
Validation Loss: 0.38397556, Validation R2: 0.851774

Epoch 198/1000
Training Loss: 0.00408358, Training R2: 0.999982
Validation Loss: 0.38392779, Validation R2: 0.851810

Epoch 199/1000
Training Loss: 0.00422613, Training R2: 0.999985
Validation Loss: 0.38429921, Validation R2: 0.851546

Epoch 200/1000
Training Loss: 0.00432991, Training R2: 0.999984
Validation Loss: 0.38381936, Validation R2: 0.851685

Epoch 201/1000
Training Loss: 0.00447048, Training R2: 0.999982
Validation Loss: 0.38365498, Validation R2: 0.851816

Epoch 202/1000
Training Loss: 0.00626043, Training R2: 0.999971
Validation Loss: 0.38403202, Validation R2: 0.851838

Epoch 203/1000
Training Loss: 0.00626595, Training R2: 0.999971
Validation Loss: 0.38338389, Validation R2: 0.852233

Epoch 204/1000
Training Loss: 0.00485854, Training R2: 0.999981
Validation Loss: 0.38354200, Validation R2: 0.851854

Epoch 205/1000
Training Loss: 0.00437180, Training R2: 0.999979
Validation Loss: 0.38388185, Validation R2: 0.851503

Epoch 206/1000
Training Loss: 0.00422762, Training R2: 0.999983
Validation Loss: 0.38379572, Validation R2: 0.851862

Epoch 207/1000
Training Loss: 0.00503365, Training R2: 0.999980
Validation Loss: 0.38402283, Validation R2: 0.851219

Epoch 208/1000
Training Loss: 0.00495516, Training R2: 0.999981
Validation Loss: 0.38342032, Validation R2: 0.852158

Epoch 209/1000
Training Loss: 0.00437850, Training R2: 0.999985
Validation Loss: 0.38359334, Validation R2: 0.852000

Epoch 210/1000
Training Loss: 0.00423756, Training R2: 0.999984
Validation Loss: 0.38361378, Validation R2: 0.851910

Epoch 211/1000
Training Loss: 0.00447518, Training R2: 0.999983
Validation Loss: 0.38366844, Validation R2: 0.852163

Epoch 212/1000
Epoch 00212: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00560600, Training R2: 0.999976
Validation Loss: 0.38368013, Validation R2: 0.851807

Epoch 213/1000
学习率已减少 5 次
Training Loss: 0.00495750, Training R2: 0.999981
Validation Loss: 0.38402532, Validation R2: 0.851730

Epoch 214/1000
Training Loss: 0.00345077, Training R2: 0.999989
Validation Loss: 0.38358319, Validation R2: 0.851750

Epoch 215/1000
Training Loss: 0.00273618, Training R2: 0.999993
Validation Loss: 0.38401648, Validation R2: 0.851493

Epoch 216/1000
Training Loss: 0.00233127, Training R2: 0.999995
Validation Loss: 0.38381045, Validation R2: 0.851628

Epoch 217/1000
Training Loss: 0.00255345, Training R2: 0.999995
Validation Loss: 0.38367564, Validation R2: 0.851860

Epoch 218/1000
Training Loss: 0.00268292, Training R2: 0.999986
Validation Loss: 0.38384314, Validation R2: 0.851597

Epoch 219/1000
Training Loss: 0.00245437, Training R2: 0.999992
Validation Loss: 0.38387025, Validation R2: 0.851742

Epoch 220/1000
Training Loss: 0.00254415, Training R2: 0.999994
Validation Loss: 0.38385527, Validation R2: 0.851773

Epoch 221/1000
Training Loss: 0.00245075, Training R2: 0.999992
Validation Loss: 0.38336244, Validation R2: 0.851898

Epoch 222/1000
Training Loss: 0.00221323, Training R2: 0.999995
Validation Loss: 0.38380473, Validation R2: 0.851766

Epoch 223/1000
Training Loss: 0.00305308, Training R2: 0.999987
Validation Loss: 0.38375419, Validation R2: 0.851674

Epoch 224/1000
Training Loss: 0.00304904, Training R2: 0.999991
Validation Loss: 0.38358795, Validation R2: 0.851670

Epoch 225/1000
Training Loss: 0.00284615, Training R2: 0.999993
Validation Loss: 0.38368855, Validation R2: 0.851833

Epoch 226/1000
Training Loss: 0.00249115, Training R2: 0.999995
Validation Loss: 0.38377918, Validation R2: 0.851785

Epoch 227/1000
Training Loss: 0.00255837, Training R2: 0.999993
Validation Loss: 0.38355284, Validation R2: 0.851847

Epoch 228/1000
Training Loss: 0.00243937, Training R2: 0.999993
Validation Loss: 0.38415861, Validation R2: 0.851349

Epoch 229/1000
Training Loss: 0.00228063, Training R2: 0.999995
Validation Loss: 0.38397807, Validation R2: 0.851699

Epoch 230/1000
Training Loss: 0.00235041, Training R2: 0.999995
Validation Loss: 0.38372591, Validation R2: 0.852051

Epoch 231/1000
Training Loss: 0.00244553, Training R2: 0.999994
Validation Loss: 0.38388243, Validation R2: 0.851510

Epoch 232/1000
Training Loss: 0.00243923, Training R2: 0.999994
Validation Loss: 0.38380752, Validation R2: 0.851651

Epoch 233/1000
Epoch 00233: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00221691, Training R2: 0.999995
Validation Loss: 0.38353784, Validation R2: 0.852087

Epoch 234/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
