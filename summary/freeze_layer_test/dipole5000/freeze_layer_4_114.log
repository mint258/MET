Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3258499

Epoch 1/1000
Training Loss: 1.23545918, Training R2: -0.110952
Validation Loss: 1.17916516, Validation R2: -0.037529
Saved best model with validation R2 -0.037529 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.07820158, Training R2: 0.109529
Validation Loss: 1.00382009, Validation R2: 0.248025
Saved best model with validation R2 0.248025 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.91091032, Training R2: 0.314044
Validation Loss: 0.86827186, Validation R2: 0.403851
Saved best model with validation R2 0.403851 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.80815832, Training R2: 0.435289
Validation Loss: 0.81914967, Validation R2: 0.455152
Saved best model with validation R2 0.455152 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.74894523, Training R2: 0.506713
Validation Loss: 0.84014378, Validation R2: 0.436422

Epoch 6/1000
Training Loss: 0.69731155, Training R2: 0.561959
Validation Loss: 0.74976352, Validation R2: 0.522928
Saved best model with validation R2 0.522928 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.62439531, Training R2: 0.633849
Validation Loss: 0.73186997, Validation R2: 0.541988
Saved best model with validation R2 0.541988 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.59259592, Training R2: 0.665862
Validation Loss: 0.69902192, Validation R2: 0.575885
Saved best model with validation R2 0.575885 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.52466003, Training R2: 0.717780
Validation Loss: 0.66387548, Validation R2: 0.599992
Saved best model with validation R2 0.599992 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.54856065, Training R2: 0.721019
Validation Loss: 0.65946572, Validation R2: 0.634026
Saved best model with validation R2 0.634026 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.48005484, Training R2: 0.770499
Validation Loss: 0.70336976, Validation R2: 0.586206

Epoch 12/1000
Training Loss: 0.47103345, Training R2: 0.784069
Validation Loss: 0.62758619, Validation R2: 0.650229
Saved best model with validation R2 0.650229 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.39551230, Training R2: 0.829002
Validation Loss: 0.60929583, Validation R2: 0.668272
Saved best model with validation R2 0.668272 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.35157149, Training R2: 0.853916
Validation Loss: 0.61220038, Validation R2: 0.671784
Saved best model with validation R2 0.671784 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.32409095, Training R2: 0.875547
Validation Loss: 0.59737399, Validation R2: 0.677380
Saved best model with validation R2 0.677380 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.29901075, Training R2: 0.891096
Validation Loss: 0.59774038, Validation R2: 0.692395
Saved best model with validation R2 0.692395 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.29922596, Training R2: 0.893153
Validation Loss: 0.59286436, Validation R2: 0.686332

Epoch 18/1000
Training Loss: 0.28841940, Training R2: 0.900617
Validation Loss: 0.58612420, Validation R2: 0.700094
Saved best model with validation R2 0.700094 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.25681362, Training R2: 0.916381
Validation Loss: 0.59660928, Validation R2: 0.690887

Epoch 20/1000
Training Loss: 0.24855872, Training R2: 0.922443
Validation Loss: 0.57990180, Validation R2: 0.702170
Saved best model with validation R2 0.702170 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.23049161, Training R2: 0.932109
Validation Loss: 0.56215397, Validation R2: 0.716349
Saved best model with validation R2 0.716349 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.28821130, Training R2: 0.917088
Validation Loss: 0.59443917, Validation R2: 0.690700

Epoch 23/1000
Training Loss: 0.23128993, Training R2: 0.933638
Validation Loss: 0.58075442, Validation R2: 0.713796

Epoch 24/1000
Training Loss: 0.20133732, Training R2: 0.946358
Validation Loss: 0.57571427, Validation R2: 0.706214

Epoch 25/1000
Training Loss: 0.19503206, Training R2: 0.948125
Validation Loss: 0.56210034, Validation R2: 0.719152
Saved best model with validation R2 0.719152 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.18545143, Training R2: 0.952604
Validation Loss: 0.55761800, Validation R2: 0.722774
Saved best model with validation R2 0.722774 to best_finetuned_model.pth

Epoch 27/1000
Training Loss: 0.16638530, Training R2: 0.957354
Validation Loss: 0.55533014, Validation R2: 0.722354

Epoch 28/1000
Training Loss: 0.16417715, Training R2: 0.959905
Validation Loss: 0.57067441, Validation R2: 0.720497

Epoch 29/1000
Training Loss: 0.17788839, Training R2: 0.958035
Validation Loss: 0.56277225, Validation R2: 0.724287
Saved best model with validation R2 0.724287 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.16647521, Training R2: 0.961676
Validation Loss: 0.55631028, Validation R2: 0.726735
Saved best model with validation R2 0.726735 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.18203962, Training R2: 0.958716
Validation Loss: 0.55696814, Validation R2: 0.726046

Epoch 32/1000
Training Loss: 0.15456925, Training R2: 0.964922
Validation Loss: 0.56434702, Validation R2: 0.721971

Epoch 33/1000
Training Loss: 0.14664383, Training R2: 0.967567
Validation Loss: 0.56070181, Validation R2: 0.719591

Epoch 34/1000
Training Loss: 0.18428306, Training R2: 0.958975
Validation Loss: 0.57132464, Validation R2: 0.713041

Epoch 35/1000
Training Loss: 0.14984992, Training R2: 0.968204
Validation Loss: 0.55398387, Validation R2: 0.725821

Epoch 36/1000
Training Loss: 0.13464147, Training R2: 0.972118
Validation Loss: 0.55379991, Validation R2: 0.729867
Saved best model with validation R2 0.729867 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.12525488, Training R2: 0.974635
Validation Loss: 0.54411467, Validation R2: 0.736540
Saved best model with validation R2 0.736540 to best_finetuned_model.pth

Epoch 38/1000
Training Loss: 0.14712843, Training R2: 0.970354
Validation Loss: 0.55221233, Validation R2: 0.728794

Epoch 39/1000
Training Loss: 0.21870779, Training R2: 0.953944
Validation Loss: 0.56999627, Validation R2: 0.712568

Epoch 40/1000
Training Loss: 0.19273296, Training R2: 0.959782
Validation Loss: 0.56634616, Validation R2: 0.725886

Epoch 41/1000
Training Loss: 0.13824054, Training R2: 0.973777
Validation Loss: 0.54684338, Validation R2: 0.733201

Epoch 42/1000
Training Loss: 0.11728563, Training R2: 0.976826
Validation Loss: 0.52898470, Validation R2: 0.741349
Saved best model with validation R2 0.741349 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.12386630, Training R2: 0.977420
Validation Loss: 0.55586554, Validation R2: 0.726803

Epoch 44/1000
Training Loss: 0.11047600, Training R2: 0.979989
Validation Loss: 0.54355270, Validation R2: 0.738840

Epoch 45/1000
Training Loss: 0.11212262, Training R2: 0.980000
Validation Loss: 0.54446337, Validation R2: 0.734726

Epoch 46/1000
Training Loss: 0.13801901, Training R2: 0.975935
Validation Loss: 0.54955598, Validation R2: 0.730315

Epoch 47/1000
Training Loss: 0.12320600, Training R2: 0.978207
Validation Loss: 0.54571101, Validation R2: 0.738007

Epoch 48/1000
Training Loss: 0.11564086, Training R2: 0.979929
Validation Loss: 0.53945515, Validation R2: 0.733948

Epoch 49/1000
Training Loss: 0.11752861, Training R2: 0.979835
Validation Loss: 0.54378646, Validation R2: 0.736951

Epoch 50/1000
Training Loss: 0.12470112, Training R2: 0.979101
Validation Loss: 0.55158160, Validation R2: 0.728183

Epoch 51/1000
Training Loss: 0.11456840, Training R2: 0.980415
Validation Loss: 0.54033516, Validation R2: 0.737818

Epoch 52/1000
Training Loss: 0.11093793, Training R2: 0.981284
Validation Loss: 0.54035510, Validation R2: 0.740292

Epoch 53/1000
Training Loss: 0.09361246, Training R2: 0.983991
Validation Loss: 0.53391794, Validation R2: 0.743654
Saved best model with validation R2 0.743654 to best_finetuned_model.pth

Epoch 54/1000
Training Loss: 0.09717885, Training R2: 0.984644
Validation Loss: 0.54071157, Validation R2: 0.741192

Epoch 55/1000
Training Loss: 0.10387175, Training R2: 0.982937
Validation Loss: 0.54144141, Validation R2: 0.736258

Epoch 56/1000
Training Loss: 0.18245363, Training R2: 0.968902
Validation Loss: 0.53833780, Validation R2: 0.738806

Epoch 57/1000
Training Loss: 0.12405259, Training R2: 0.979543
Validation Loss: 0.54797810, Validation R2: 0.733220

Epoch 58/1000
Training Loss: 0.10877712, Training R2: 0.981864
Validation Loss: 0.54382503, Validation R2: 0.736577

Epoch 59/1000
Training Loss: 0.11585420, Training R2: 0.981544
Validation Loss: 0.54700920, Validation R2: 0.731491

Epoch 60/1000
Training Loss: 0.11274161, Training R2: 0.981831
Validation Loss: 0.53179804, Validation R2: 0.743665
Saved best model with validation R2 0.743665 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.09737635, Training R2: 0.984416
Validation Loss: 0.53778993, Validation R2: 0.737913

Epoch 62/1000
Training Loss: 0.09473932, Training R2: 0.985370
Validation Loss: 0.53266228, Validation R2: 0.748416
Saved best model with validation R2 0.748416 to best_finetuned_model.pth

Epoch 63/1000
Training Loss: 0.09190101, Training R2: 0.986231
Validation Loss: 0.53713488, Validation R2: 0.740863

Epoch 64/1000
Training Loss: 0.09384939, Training R2: 0.985332
Validation Loss: 0.53334603, Validation R2: 0.748536
Saved best model with validation R2 0.748536 to best_finetuned_model.pth

Epoch 65/1000
Training Loss: 0.09539479, Training R2: 0.985639
Validation Loss: 0.53513060, Validation R2: 0.741933

Epoch 66/1000
Training Loss: 0.09979661, Training R2: 0.985300
Validation Loss: 0.53658505, Validation R2: 0.743938

Epoch 67/1000
Training Loss: 0.09189849, Training R2: 0.985777
Validation Loss: 0.54176676, Validation R2: 0.734649

Epoch 68/1000
Training Loss: 0.09646945, Training R2: 0.985701
Validation Loss: 0.54304443, Validation R2: 0.739849

Epoch 69/1000
Training Loss: 0.09769970, Training R2: 0.984708
Validation Loss: 0.53934558, Validation R2: 0.735707

Epoch 70/1000
Training Loss: 0.10036286, Training R2: 0.985324
Validation Loss: 0.52914380, Validation R2: 0.745369

Epoch 71/1000
Training Loss: 0.10279562, Training R2: 0.985260
Validation Loss: 0.55205703, Validation R2: 0.736389

Epoch 72/1000
Training Loss: 0.10976700, Training R2: 0.984044
Validation Loss: 0.54470704, Validation R2: 0.736344

Epoch 73/1000
Training Loss: 0.08781929, Training R2: 0.987019
Validation Loss: 0.52949553, Validation R2: 0.747773

Epoch 74/1000
Training Loss: 0.09078957, Training R2: 0.986716
Validation Loss: 0.53354000, Validation R2: 0.742953

Epoch 75/1000
Training Loss: 0.08854571, Training R2: 0.987747
Validation Loss: 0.53491569, Validation R2: 0.742271

Epoch 76/1000
Training Loss: 0.09138208, Training R2: 0.986710
Validation Loss: 0.53074407, Validation R2: 0.747017

Epoch 77/1000
Training Loss: 0.07892086, Training R2: 0.988381
Validation Loss: 0.52963576, Validation R2: 0.745241

Epoch 78/1000
Training Loss: 0.07502399, Training R2: 0.989457
Validation Loss: 0.52739080, Validation R2: 0.747167

Epoch 79/1000
Training Loss: 0.08198619, Training R2: 0.988479
Validation Loss: 0.53340228, Validation R2: 0.745578

Epoch 80/1000
Training Loss: 0.09196282, Training R2: 0.987437
Validation Loss: 0.53275397, Validation R2: 0.745956

Epoch 81/1000
Training Loss: 0.08613823, Training R2: 0.988205
Validation Loss: 0.53667840, Validation R2: 0.740487

Epoch 82/1000
Training Loss: 0.07584366, Training R2: 0.989374
Validation Loss: 0.53751670, Validation R2: 0.738674

Epoch 83/1000
Training Loss: 0.07870289, Training R2: 0.989352
Validation Loss: 0.52716745, Validation R2: 0.747850

Epoch 84/1000
Training Loss: 0.07374229, Training R2: 0.990233
Validation Loss: 0.52909896, Validation R2: 0.745718

Epoch 85/1000
Epoch 00085: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.07322840, Training R2: 0.990472
Validation Loss: 0.53955322, Validation R2: 0.741484

Epoch 86/1000
学习率已减少 1 次
Training Loss: 0.07197629, Training R2: 0.990034
Validation Loss: 0.52397889, Validation R2: 0.748394

Epoch 87/1000
Training Loss: 0.05535957, Training R2: 0.991902
Validation Loss: 0.53137994, Validation R2: 0.748385

Epoch 88/1000
Training Loss: 0.05322024, Training R2: 0.992598
Validation Loss: 0.52703133, Validation R2: 0.747149

Epoch 89/1000
Training Loss: 0.05207694, Training R2: 0.992655
Validation Loss: 0.53067207, Validation R2: 0.747441

Epoch 90/1000
Training Loss: 0.05129838, Training R2: 0.992977
Validation Loss: 0.52657466, Validation R2: 0.751715
Saved best model with validation R2 0.751715 to best_finetuned_model.pth

Epoch 91/1000
Training Loss: 0.06811518, Training R2: 0.991590
Validation Loss: 0.53563543, Validation R2: 0.746655

Epoch 92/1000
Training Loss: 0.06214105, Training R2: 0.992498
Validation Loss: 0.52582300, Validation R2: 0.750369

Epoch 93/1000
Training Loss: 0.06703137, Training R2: 0.992123
Validation Loss: 0.52483220, Validation R2: 0.751443

Epoch 94/1000
Training Loss: 0.05877155, Training R2: 0.992027
Validation Loss: 0.52737782, Validation R2: 0.747548

Epoch 95/1000
Training Loss: 0.05268819, Training R2: 0.993457
Validation Loss: 0.52720518, Validation R2: 0.747819

Epoch 96/1000
Training Loss: 0.04221069, Training R2: 0.994095
Validation Loss: 0.52589037, Validation R2: 0.750714

Epoch 97/1000
Training Loss: 0.05870083, Training R2: 0.992779
Validation Loss: 0.52778289, Validation R2: 0.751528

Epoch 98/1000
Training Loss: 0.06011193, Training R2: 0.992933
Validation Loss: 0.52547521, Validation R2: 0.751650

Epoch 99/1000
Training Loss: 0.05964357, Training R2: 0.993056
Validation Loss: 0.52651425, Validation R2: 0.750219

Epoch 100/1000
Training Loss: 0.04851397, Training R2: 0.994026
Validation Loss: 0.52418974, Validation R2: 0.751022

Epoch 101/1000
Training Loss: 0.03746199, Training R2: 0.994654
Validation Loss: 0.52343538, Validation R2: 0.752560
Saved best model with validation R2 0.752560 to best_finetuned_model.pth

Epoch 102/1000
Training Loss: 0.03541556, Training R2: 0.995100
Validation Loss: 0.52349935, Validation R2: 0.751758

Epoch 103/1000
Training Loss: 0.03738076, Training R2: 0.994997
Validation Loss: 0.52523846, Validation R2: 0.750198

Epoch 104/1000
Training Loss: 0.03837008, Training R2: 0.994990
Validation Loss: 0.52274671, Validation R2: 0.751784

Epoch 105/1000
Training Loss: 0.03586681, Training R2: 0.995478
Validation Loss: 0.52574235, Validation R2: 0.750437

Epoch 106/1000
Training Loss: 0.03462555, Training R2: 0.995519
Validation Loss: 0.52870354, Validation R2: 0.751580

Epoch 107/1000
Training Loss: 0.03450837, Training R2: 0.995674
Validation Loss: 0.52133728, Validation R2: 0.754466
Saved best model with validation R2 0.754466 to best_finetuned_model.pth

Epoch 108/1000
Training Loss: 0.03372792, Training R2: 0.996004
Validation Loss: 0.52413067, Validation R2: 0.751783

Epoch 109/1000
Training Loss: 0.03676317, Training R2: 0.995847
Validation Loss: 0.52618577, Validation R2: 0.748534

Epoch 110/1000
Training Loss: 0.04569628, Training R2: 0.995632
Validation Loss: 0.52680789, Validation R2: 0.749744

Epoch 111/1000
Training Loss: 0.04396462, Training R2: 0.995751
Validation Loss: 0.52521717, Validation R2: 0.750507

Epoch 112/1000
Training Loss: 0.04444007, Training R2: 0.995895
Validation Loss: 0.52745183, Validation R2: 0.749901

Epoch 113/1000
Training Loss: 0.05054486, Training R2: 0.995623
Validation Loss: 0.52460810, Validation R2: 0.752427

Epoch 114/1000
Training Loss: 0.05952046, Training R2: 0.994874
Validation Loss: 0.52231801, Validation R2: 0.754081

Epoch 115/1000
Training Loss: 0.04540525, Training R2: 0.996181
Validation Loss: 0.52322421, Validation R2: 0.753546

Epoch 116/1000
Training Loss: 0.04537506, Training R2: 0.995837
Validation Loss: 0.52524957, Validation R2: 0.752186

Epoch 117/1000
Training Loss: 0.04586715, Training R2: 0.996412
Validation Loss: 0.52416870, Validation R2: 0.752278

Epoch 118/1000
Training Loss: 0.04240454, Training R2: 0.996676
Validation Loss: 0.52564492, Validation R2: 0.748846

Epoch 119/1000
Training Loss: 0.04099321, Training R2: 0.996938
Validation Loss: 0.52515501, Validation R2: 0.752562

Epoch 120/1000
Training Loss: 0.04530230, Training R2: 0.996717
Validation Loss: 0.52371936, Validation R2: 0.751186

Epoch 121/1000
Training Loss: 0.06342741, Training R2: 0.995583
Validation Loss: 0.52381948, Validation R2: 0.751567

Epoch 122/1000
Training Loss: 0.04794023, Training R2: 0.996790
Validation Loss: 0.52439193, Validation R2: 0.752582

Epoch 123/1000
Training Loss: 0.04114783, Training R2: 0.997336
Validation Loss: 0.52459608, Validation R2: 0.751537

Epoch 124/1000
Training Loss: 0.03618841, Training R2: 0.997675
Validation Loss: 0.52378020, Validation R2: 0.752903

Epoch 125/1000
Training Loss: 0.03945269, Training R2: 0.997489
Validation Loss: 0.51905424, Validation R2: 0.755394
Saved best model with validation R2 0.755394 to best_finetuned_model.pth

Epoch 126/1000
Training Loss: 0.04453815, Training R2: 0.997290
Validation Loss: 0.52430260, Validation R2: 0.752321

Epoch 127/1000
Training Loss: 0.03729649, Training R2: 0.997787
Validation Loss: 0.52455317, Validation R2: 0.751650

Epoch 128/1000
Training Loss: 0.04701422, Training R2: 0.997308
Validation Loss: 0.53100562, Validation R2: 0.746967

Epoch 129/1000
Training Loss: 0.05745294, Training R2: 0.996594
Validation Loss: 0.52613518, Validation R2: 0.750265

Epoch 130/1000
Training Loss: 0.04489306, Training R2: 0.997678
Validation Loss: 0.52435656, Validation R2: 0.752529

Epoch 131/1000
Training Loss: 0.03579716, Training R2: 0.998285
Validation Loss: 0.52079431, Validation R2: 0.753608

Epoch 132/1000
Training Loss: 0.03403102, Training R2: 0.998468
Validation Loss: 0.52528103, Validation R2: 0.750844

Epoch 133/1000
Training Loss: 0.05256686, Training R2: 0.997261
Validation Loss: 0.52752700, Validation R2: 0.753395

Epoch 134/1000
Training Loss: 0.06026148, Training R2: 0.996859
Validation Loss: 0.52418249, Validation R2: 0.751430

Epoch 135/1000
Training Loss: 0.04799255, Training R2: 0.997676
Validation Loss: 0.52956326, Validation R2: 0.748523

Epoch 136/1000
Training Loss: 0.04988134, Training R2: 0.997665
Validation Loss: 0.52930554, Validation R2: 0.748381

Epoch 137/1000
Training Loss: 0.05801780, Training R2: 0.996901
Validation Loss: 0.52133972, Validation R2: 0.755603
Saved best model with validation R2 0.755603 to best_finetuned_model.pth

Epoch 138/1000
Training Loss: 0.04775358, Training R2: 0.997826
Validation Loss: 0.52617817, Validation R2: 0.749478

Epoch 139/1000
Training Loss: 0.03820564, Training R2: 0.998461
Validation Loss: 0.52330379, Validation R2: 0.752857

Epoch 140/1000
Training Loss: 0.03364709, Training R2: 0.998718
Validation Loss: 0.52381578, Validation R2: 0.752050

Epoch 141/1000
Training Loss: 0.03406636, Training R2: 0.998762
Validation Loss: 0.52757568, Validation R2: 0.750377

Epoch 142/1000
Training Loss: 0.03674596, Training R2: 0.998666
Validation Loss: 0.52254262, Validation R2: 0.753520

Epoch 143/1000
Training Loss: 0.03560305, Training R2: 0.998755
Validation Loss: 0.52425605, Validation R2: 0.751408

Epoch 144/1000
Training Loss: 0.03902399, Training R2: 0.998467
Validation Loss: 0.52192326, Validation R2: 0.752813

Epoch 145/1000
Training Loss: 0.04179070, Training R2: 0.998405
Validation Loss: 0.52461025, Validation R2: 0.753970

Epoch 146/1000
Training Loss: 0.04266650, Training R2: 0.998392
Validation Loss: 0.52432989, Validation R2: 0.751549

Epoch 147/1000
Training Loss: 0.03561767, Training R2: 0.998779
Validation Loss: 0.52754423, Validation R2: 0.749538

Epoch 148/1000
Training Loss: 0.03406053, Training R2: 0.998888
Validation Loss: 0.52276450, Validation R2: 0.752069

Epoch 149/1000
Training Loss: 0.03626071, Training R2: 0.998771
Validation Loss: 0.52503945, Validation R2: 0.753451

Epoch 150/1000
Training Loss: 0.03177723, Training R2: 0.999006
Validation Loss: 0.52253854, Validation R2: 0.754430

Epoch 151/1000
Training Loss: 0.03586849, Training R2: 0.998821
Validation Loss: 0.52629046, Validation R2: 0.749705

Epoch 152/1000
Training Loss: 0.03488234, Training R2: 0.998887
Validation Loss: 0.52457908, Validation R2: 0.751365

Epoch 153/1000
Training Loss: 0.03293217, Training R2: 0.998919
Validation Loss: 0.52226631, Validation R2: 0.753259

Epoch 154/1000
Training Loss: 0.03404349, Training R2: 0.998946
Validation Loss: 0.52725712, Validation R2: 0.749499

Epoch 155/1000
Training Loss: 0.03685788, Training R2: 0.998798
Validation Loss: 0.52452428, Validation R2: 0.749633

Epoch 156/1000
Training Loss: 0.03497512, Training R2: 0.998866
Validation Loss: 0.52386893, Validation R2: 0.751778

Epoch 157/1000
Training Loss: 0.03659150, Training R2: 0.998765
Validation Loss: 0.52578695, Validation R2: 0.752167

Epoch 158/1000
Epoch 00158: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03417492, Training R2: 0.998860
Validation Loss: 0.52301681, Validation R2: 0.753870

Epoch 159/1000
学习率已减少 2 次
Training Loss: 0.02638101, Training R2: 0.999257
Validation Loss: 0.52414743, Validation R2: 0.751947

Epoch 160/1000
Training Loss: 0.02078085, Training R2: 0.999484
Validation Loss: 0.52389287, Validation R2: 0.752789

Epoch 161/1000
Training Loss: 0.01946336, Training R2: 0.999539
Validation Loss: 0.52370342, Validation R2: 0.752345

Epoch 162/1000
Training Loss: 0.02059319, Training R2: 0.999519
Validation Loss: 0.52382561, Validation R2: 0.752626

Epoch 163/1000
Training Loss: 0.02592231, Training R2: 0.999368
Validation Loss: 0.52443122, Validation R2: 0.751055

Epoch 164/1000
Training Loss: 0.02837213, Training R2: 0.999268
Validation Loss: 0.52372459, Validation R2: 0.752317

Epoch 165/1000
Training Loss: 0.02030464, Training R2: 0.999523
Validation Loss: 0.52310216, Validation R2: 0.753247

Epoch 166/1000
Training Loss: 0.01790371, Training R2: 0.999608
Validation Loss: 0.52334635, Validation R2: 0.753064

Epoch 167/1000
Training Loss: 0.01691535, Training R2: 0.999615
Validation Loss: 0.52209882, Validation R2: 0.752711

Epoch 168/1000
Training Loss: 0.01894668, Training R2: 0.999573
Validation Loss: 0.52310311, Validation R2: 0.752915

Epoch 169/1000
Training Loss: 0.01736193, Training R2: 0.999616
Validation Loss: 0.52312761, Validation R2: 0.752551

Epoch 170/1000
Training Loss: 0.02049894, Training R2: 0.999554
Validation Loss: 0.52424123, Validation R2: 0.752673

Epoch 171/1000
Training Loss: 0.02980042, Training R2: 0.999229
Validation Loss: 0.52283167, Validation R2: 0.753546

Epoch 172/1000
Training Loss: 0.02470791, Training R2: 0.999396
Validation Loss: 0.52217581, Validation R2: 0.754250

Epoch 173/1000
Training Loss: 0.02418474, Training R2: 0.999416
Validation Loss: 0.52661111, Validation R2: 0.751412

Epoch 174/1000
Training Loss: 0.02953909, Training R2: 0.999223
Validation Loss: 0.52415109, Validation R2: 0.752924

Epoch 175/1000
Training Loss: 0.02486574, Training R2: 0.999401
Validation Loss: 0.52322969, Validation R2: 0.752677

Epoch 176/1000
Training Loss: 0.02566433, Training R2: 0.999345
Validation Loss: 0.52403882, Validation R2: 0.752452

Epoch 177/1000
Training Loss: 0.01986511, Training R2: 0.999555
Validation Loss: 0.52509656, Validation R2: 0.752001

Epoch 178/1000
Training Loss: 0.02130138, Training R2: 0.999520
Validation Loss: 0.52324941, Validation R2: 0.753358

Epoch 179/1000
Epoch 00179: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.01762151, Training R2: 0.999627
Validation Loss: 0.52250063, Validation R2: 0.752911

Epoch 180/1000
学习率已减少 3 次
Training Loss: 0.01397610, Training R2: 0.999716
Validation Loss: 0.52263540, Validation R2: 0.752884

Epoch 181/1000
Training Loss: 0.01107097, Training R2: 0.999770
Validation Loss: 0.52315491, Validation R2: 0.752606

Epoch 182/1000
Training Loss: 0.01012136, Training R2: 0.999794
Validation Loss: 0.52269463, Validation R2: 0.753108

Epoch 183/1000
Training Loss: 0.01504231, Training R2: 0.999711
Validation Loss: 0.52285828, Validation R2: 0.753098

Epoch 184/1000
Training Loss: 0.01235303, Training R2: 0.999751
Validation Loss: 0.52379796, Validation R2: 0.752336

Epoch 185/1000
Training Loss: 0.01058931, Training R2: 0.999774
Validation Loss: 0.52256662, Validation R2: 0.753183

Epoch 186/1000
Training Loss: 0.00954538, Training R2: 0.999797
Validation Loss: 0.52310451, Validation R2: 0.753451

Epoch 187/1000
Training Loss: 0.01100668, Training R2: 0.999772
Validation Loss: 0.52248252, Validation R2: 0.753541

Epoch 188/1000
Training Loss: 0.01163093, Training R2: 0.999773
Validation Loss: 0.52385636, Validation R2: 0.752069

Epoch 189/1000
Training Loss: 0.01105968, Training R2: 0.999779
Validation Loss: 0.52332573, Validation R2: 0.752807

Epoch 190/1000
Training Loss: 0.00978337, Training R2: 0.999798
Validation Loss: 0.52337905, Validation R2: 0.753115

Epoch 191/1000
Training Loss: 0.01532584, Training R2: 0.999697
Validation Loss: 0.52282871, Validation R2: 0.753211

Epoch 192/1000
Training Loss: 0.01481184, Training R2: 0.999711
Validation Loss: 0.52243895, Validation R2: 0.753672

Epoch 193/1000
Training Loss: 0.01092589, Training R2: 0.999781
Validation Loss: 0.52145642, Validation R2: 0.754074

Epoch 194/1000
Training Loss: 0.00975967, Training R2: 0.999798
Validation Loss: 0.52280576, Validation R2: 0.753350

Epoch 195/1000
Training Loss: 0.00928759, Training R2: 0.999809
Validation Loss: 0.52338031, Validation R2: 0.752733

Epoch 196/1000
Training Loss: 0.00926230, Training R2: 0.999805
Validation Loss: 0.52342800, Validation R2: 0.752629

Epoch 197/1000
Training Loss: 0.00863215, Training R2: 0.999815
Validation Loss: 0.52342076, Validation R2: 0.753035

Epoch 198/1000
Training Loss: 0.00962735, Training R2: 0.999801
Validation Loss: 0.52269337, Validation R2: 0.753214

Epoch 199/1000
Training Loss: 0.00910771, Training R2: 0.999810
Validation Loss: 0.52231853, Validation R2: 0.753692

Epoch 200/1000
Epoch 00200: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.01127182, Training R2: 0.999783
Validation Loss: 0.52392037, Validation R2: 0.752928

Epoch 201/1000
学习率已减少 4 次
Training Loss: 0.00954440, Training R2: 0.999809
Validation Loss: 0.52363891, Validation R2: 0.752579

Epoch 202/1000
Training Loss: 0.00693644, Training R2: 0.999837
Validation Loss: 0.52223120, Validation R2: 0.753474

Epoch 203/1000
Training Loss: 0.00549748, Training R2: 0.999850
Validation Loss: 0.52259035, Validation R2: 0.753446

Epoch 204/1000
Training Loss: 0.00536119, Training R2: 0.999854
Validation Loss: 0.52226016, Validation R2: 0.753626

Epoch 205/1000
Training Loss: 0.00521096, Training R2: 0.999856
Validation Loss: 0.52263434, Validation R2: 0.753397

Epoch 206/1000
Training Loss: 0.00497064, Training R2: 0.999855
Validation Loss: 0.52258945, Validation R2: 0.753637

Epoch 207/1000
Training Loss: 0.00566890, Training R2: 0.999849
Validation Loss: 0.52275900, Validation R2: 0.753510

Epoch 208/1000
Training Loss: 0.00813382, Training R2: 0.999836
Validation Loss: 0.52281558, Validation R2: 0.753434

Epoch 209/1000
Training Loss: 0.00662334, Training R2: 0.999844
Validation Loss: 0.52255887, Validation R2: 0.753342

Epoch 210/1000
Training Loss: 0.00500324, Training R2: 0.999857
Validation Loss: 0.52221237, Validation R2: 0.753594

Epoch 211/1000
Training Loss: 0.00488180, Training R2: 0.999860
Validation Loss: 0.52311283, Validation R2: 0.753062

Epoch 212/1000
Training Loss: 0.00523451, Training R2: 0.999860
Validation Loss: 0.52306158, Validation R2: 0.753066

Epoch 213/1000
Training Loss: 0.00570339, Training R2: 0.999854
Validation Loss: 0.52309611, Validation R2: 0.752937

Epoch 214/1000
Training Loss: 0.00475882, Training R2: 0.999864
Validation Loss: 0.52265760, Validation R2: 0.753262

Epoch 215/1000
Training Loss: 0.00490339, Training R2: 0.999862
Validation Loss: 0.52300149, Validation R2: 0.752748

Epoch 216/1000
Training Loss: 0.00532071, Training R2: 0.999858
Validation Loss: 0.52334891, Validation R2: 0.752896

Epoch 217/1000
Training Loss: 0.00502612, Training R2: 0.999862
Validation Loss: 0.52240750, Validation R2: 0.753519

Epoch 218/1000
Training Loss: 0.00511090, Training R2: 0.999863
Validation Loss: 0.52306538, Validation R2: 0.753119

Epoch 219/1000
Training Loss: 0.00487061, Training R2: 0.999864
Validation Loss: 0.52326567, Validation R2: 0.753111

Epoch 220/1000
Training Loss: 0.00559360, Training R2: 0.999858
Validation Loss: 0.52296511, Validation R2: 0.753110

Epoch 221/1000
Epoch 00221: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00511668, Training R2: 0.999862
Validation Loss: 0.52242415, Validation R2: 0.753459

Epoch 222/1000
学习率已减少 5 次
Training Loss: 0.00434807, Training R2: 0.999864
Validation Loss: 0.52274853, Validation R2: 0.753196

Epoch 223/1000
Training Loss: 0.00348518, Training R2: 0.999873
Validation Loss: 0.52256807, Validation R2: 0.753516

Epoch 224/1000
Training Loss: 0.00300376, Training R2: 0.999873
Validation Loss: 0.52277295, Validation R2: 0.753306

Epoch 225/1000
Training Loss: 0.00274497, Training R2: 0.999872
Validation Loss: 0.52265542, Validation R2: 0.753223

Epoch 226/1000
Training Loss: 0.00295243, Training R2: 0.999873
Validation Loss: 0.52256829, Validation R2: 0.753373

Epoch 227/1000
Training Loss: 0.00327395, Training R2: 0.999874
Validation Loss: 0.52275476, Validation R2: 0.753539

Epoch 228/1000
Training Loss: 0.00336027, Training R2: 0.999872
Validation Loss: 0.52266496, Validation R2: 0.753223

Epoch 229/1000
Training Loss: 0.00355882, Training R2: 0.999869
Validation Loss: 0.52268367, Validation R2: 0.753380

Epoch 230/1000
Training Loss: 0.00291254, Training R2: 0.999874
Validation Loss: 0.52266907, Validation R2: 0.753404

Epoch 231/1000
Training Loss: 0.00286314, Training R2: 0.999876
Validation Loss: 0.52268161, Validation R2: 0.753248

Epoch 232/1000
Training Loss: 0.00252978, Training R2: 0.999880
Validation Loss: 0.52289258, Validation R2: 0.753199

Epoch 233/1000
Training Loss: 0.00338472, Training R2: 0.999875
Validation Loss: 0.52306884, Validation R2: 0.753077

Epoch 234/1000
Training Loss: 0.00302670, Training R2: 0.999878
Validation Loss: 0.52282053, Validation R2: 0.753158

Epoch 235/1000
Training Loss: 0.00317077, Training R2: 0.999872
Validation Loss: 0.52286283, Validation R2: 0.753179

Epoch 236/1000
Training Loss: 0.00444216, Training R2: 0.999868
Validation Loss: 0.52259832, Validation R2: 0.753334

Epoch 237/1000
Training Loss: 0.00311374, Training R2: 0.999877
Validation Loss: 0.52275592, Validation R2: 0.753309

Epoch 238/1000
Training Loss: 0.00287092, Training R2: 0.999876
Validation Loss: 0.52292942, Validation R2: 0.753087

Epoch 239/1000
Training Loss: 0.00330396, Training R2: 0.999877
Validation Loss: 0.52279150, Validation R2: 0.753431

Epoch 240/1000
Training Loss: 0.00366806, Training R2: 0.999871
Validation Loss: 0.52270712, Validation R2: 0.753394

Epoch 241/1000
Training Loss: 0.00299497, Training R2: 0.999878
Validation Loss: 0.52268507, Validation R2: 0.753496

Epoch 242/1000
Epoch 00242: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00322055, Training R2: 0.999877
Validation Loss: 0.52284320, Validation R2: 0.753165

Epoch 243/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
