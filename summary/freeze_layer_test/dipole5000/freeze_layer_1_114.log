Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)

Frozen layers status:
emb_z.emb.weight: Trainable
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5317507

Epoch 1/1000
Training Loss: 1.47739874, Training R2: -0.694242
Validation Loss: 1.15360138, Validation R2: 0.063600
Saved best model with validation R2 0.063600 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.10946363, Training R2: 0.102101
Validation Loss: 1.00095364, Validation R2: 0.211988
Saved best model with validation R2 0.211988 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.95079068, Training R2: 0.306902
Validation Loss: 0.86523986, Validation R2: 0.370994
Saved best model with validation R2 0.370994 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.85532359, Training R2: 0.407014
Validation Loss: 0.78641670, Validation R2: 0.466762
Saved best model with validation R2 0.466762 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.76981760, Training R2: 0.491603
Validation Loss: 0.73474175, Validation R2: 0.523898
Saved best model with validation R2 0.523898 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.69582424, Training R2: 0.564876
Validation Loss: 0.69410268, Validation R2: 0.573449
Saved best model with validation R2 0.573449 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.64442301, Training R2: 0.620858
Validation Loss: 0.62341334, Validation R2: 0.619085
Saved best model with validation R2 0.619085 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.57992960, Training R2: 0.683425
Validation Loss: 0.61714118, Validation R2: 0.636912
Saved best model with validation R2 0.636912 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.57247410, Training R2: 0.697217
Validation Loss: 0.59636300, Validation R2: 0.668726
Saved best model with validation R2 0.668726 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.50654801, Training R2: 0.746864
Validation Loss: 0.58963580, Validation R2: 0.669555
Saved best model with validation R2 0.669555 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.46241965, Training R2: 0.785288
Validation Loss: 0.55310623, Validation R2: 0.718480
Saved best model with validation R2 0.718480 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.42550699, Training R2: 0.814719
Validation Loss: 0.49862055, Validation R2: 0.746570
Saved best model with validation R2 0.746570 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.37959276, Training R2: 0.847535
Validation Loss: 0.49019090, Validation R2: 0.757873
Saved best model with validation R2 0.757873 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.37169697, Training R2: 0.856530
Validation Loss: 0.49851428, Validation R2: 0.749655

Epoch 15/1000
Training Loss: 0.33364525, Training R2: 0.880094
Validation Loss: 0.49452696, Validation R2: 0.749467

Epoch 16/1000
Training Loss: 0.30703279, Training R2: 0.894955
Validation Loss: 0.50348623, Validation R2: 0.746051

Epoch 17/1000
Training Loss: 0.33128769, Training R2: 0.886702
Validation Loss: 0.48752504, Validation R2: 0.764928
Saved best model with validation R2 0.764928 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.30373108, Training R2: 0.901406
Validation Loss: 0.49166572, Validation R2: 0.772295
Saved best model with validation R2 0.772295 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.27272558, Training R2: 0.916328
Validation Loss: 0.45310316, Validation R2: 0.783711
Saved best model with validation R2 0.783711 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.23803976, Training R2: 0.930842
Validation Loss: 0.43166670, Validation R2: 0.797540
Saved best model with validation R2 0.797540 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.22281469, Training R2: 0.937537
Validation Loss: 0.43303315, Validation R2: 0.803989
Saved best model with validation R2 0.803989 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.20857916, Training R2: 0.942223
Validation Loss: 0.43846479, Validation R2: 0.795443

Epoch 23/1000
Training Loss: 0.20647355, Training R2: 0.945629
Validation Loss: 0.42420867, Validation R2: 0.799069

Epoch 24/1000
Training Loss: 0.19036479, Training R2: 0.951938
Validation Loss: 0.42544416, Validation R2: 0.811029
Saved best model with validation R2 0.811029 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.20487350, Training R2: 0.948882
Validation Loss: 0.45173081, Validation R2: 0.789032

Epoch 26/1000
Training Loss: 0.21300681, Training R2: 0.947588
Validation Loss: 0.43031416, Validation R2: 0.803600

Epoch 27/1000
Training Loss: 0.22535954, Training R2: 0.945206
Validation Loss: 0.49402889, Validation R2: 0.758507

Epoch 28/1000
Training Loss: 0.22808612, Training R2: 0.945528
Validation Loss: 0.41699491, Validation R2: 0.817433
Saved best model with validation R2 0.817433 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.17703141, Training R2: 0.958719
Validation Loss: 0.41306026, Validation R2: 0.813236

Epoch 30/1000
Training Loss: 0.16514330, Training R2: 0.962995
Validation Loss: 0.42547450, Validation R2: 0.809906

Epoch 31/1000
Training Loss: 0.16546331, Training R2: 0.964887
Validation Loss: 0.41611841, Validation R2: 0.819937
Saved best model with validation R2 0.819937 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 0.15503644, Training R2: 0.966117
Validation Loss: 0.42112479, Validation R2: 0.822665
Saved best model with validation R2 0.822665 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.17379086, Training R2: 0.964098
Validation Loss: 0.41577264, Validation R2: 0.817291

Epoch 34/1000
Training Loss: 0.17265455, Training R2: 0.964489
Validation Loss: 0.43249558, Validation R2: 0.804864

Epoch 35/1000
Training Loss: 0.16861186, Training R2: 0.966457
Validation Loss: 0.40953292, Validation R2: 0.824486
Saved best model with validation R2 0.824486 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.13199117, Training R2: 0.972288
Validation Loss: 0.40721962, Validation R2: 0.820906

Epoch 37/1000
Training Loss: 0.12769267, Training R2: 0.975333
Validation Loss: 0.40359200, Validation R2: 0.820380

Epoch 38/1000
Training Loss: 0.12875388, Training R2: 0.975531
Validation Loss: 0.40639919, Validation R2: 0.823001

Epoch 39/1000
Training Loss: 0.14700493, Training R2: 0.972005
Validation Loss: 0.42199616, Validation R2: 0.817007

Epoch 40/1000
Training Loss: 0.16671678, Training R2: 0.968669
Validation Loss: 0.41002550, Validation R2: 0.817626

Epoch 41/1000
Training Loss: 0.14848212, Training R2: 0.971967
Validation Loss: 0.41198240, Validation R2: 0.820586

Epoch 42/1000
Training Loss: 0.13214307, Training R2: 0.976538
Validation Loss: 0.39326430, Validation R2: 0.827472
Saved best model with validation R2 0.827472 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.11181351, Training R2: 0.980016
Validation Loss: 0.38961893, Validation R2: 0.828902
Saved best model with validation R2 0.828902 to best_finetuned_model.pth

Epoch 44/1000
Training Loss: 0.11925617, Training R2: 0.979750
Validation Loss: 0.41299782, Validation R2: 0.818263

Epoch 45/1000
Training Loss: 0.16228212, Training R2: 0.972110
Validation Loss: 0.43200167, Validation R2: 0.810775

Epoch 46/1000
Training Loss: 0.18769189, Training R2: 0.965695
Validation Loss: 0.40863655, Validation R2: 0.819394

Epoch 47/1000
Training Loss: 0.15546121, Training R2: 0.973539
Validation Loss: 0.42636143, Validation R2: 0.812326

Epoch 48/1000
Training Loss: 0.16402912, Training R2: 0.972514
Validation Loss: 0.40892199, Validation R2: 0.819307

Epoch 49/1000
Training Loss: 0.13184539, Training R2: 0.977671
Validation Loss: 0.40704054, Validation R2: 0.822283

Epoch 50/1000
Training Loss: 0.11550095, Training R2: 0.981334
Validation Loss: 0.39510848, Validation R2: 0.829923
Saved best model with validation R2 0.829923 to best_finetuned_model.pth

Epoch 51/1000
Training Loss: 0.10119566, Training R2: 0.983048
Validation Loss: 0.39549210, Validation R2: 0.827430

Epoch 52/1000
Training Loss: 0.11021983, Training R2: 0.982390
Validation Loss: 0.40888121, Validation R2: 0.818432

Epoch 53/1000
Training Loss: 0.11370607, Training R2: 0.981418
Validation Loss: 0.38936254, Validation R2: 0.827563

Epoch 54/1000
Training Loss: 0.09892828, Training R2: 0.983925
Validation Loss: 0.39172880, Validation R2: 0.829726

Epoch 55/1000
Training Loss: 0.09983128, Training R2: 0.984173
Validation Loss: 0.39589452, Validation R2: 0.827089

Epoch 56/1000
Training Loss: 0.09322688, Training R2: 0.985385
Validation Loss: 0.39190966, Validation R2: 0.827616

Epoch 57/1000
Training Loss: 0.09049766, Training R2: 0.985733
Validation Loss: 0.40239981, Validation R2: 0.822325

Epoch 58/1000
Training Loss: 0.14244400, Training R2: 0.977953
Validation Loss: 0.42071066, Validation R2: 0.817538

Epoch 59/1000
Training Loss: 0.13997634, Training R2: 0.978119
Validation Loss: 0.40455173, Validation R2: 0.824144

Epoch 60/1000
Training Loss: 0.11241827, Training R2: 0.981539
Validation Loss: 0.38970767, Validation R2: 0.833557
Saved best model with validation R2 0.833557 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.09129968, Training R2: 0.985956
Validation Loss: 0.39159236, Validation R2: 0.832962

Epoch 62/1000
Training Loss: 0.11271478, Training R2: 0.982500
Validation Loss: 0.43281031, Validation R2: 0.810557

Epoch 63/1000
Training Loss: 0.14425297, Training R2: 0.976499
Validation Loss: 0.40087783, Validation R2: 0.825648

Epoch 64/1000
Training Loss: 0.13304259, Training R2: 0.979953
Validation Loss: 0.38961228, Validation R2: 0.830173

Epoch 65/1000
Training Loss: 0.09566619, Training R2: 0.985171
Validation Loss: 0.39573645, Validation R2: 0.826161

Epoch 66/1000
Training Loss: 0.08334152, Training R2: 0.987298
Validation Loss: 0.38198272, Validation R2: 0.832163

Epoch 67/1000
Training Loss: 0.07816402, Training R2: 0.987787
Validation Loss: 0.38808456, Validation R2: 0.829941

Epoch 68/1000
Training Loss: 0.07560124, Training R2: 0.988168
Validation Loss: 0.38340242, Validation R2: 0.835923
Saved best model with validation R2 0.835923 to best_finetuned_model.pth

Epoch 69/1000
Training Loss: 0.07562227, Training R2: 0.988266
Validation Loss: 0.38537341, Validation R2: 0.832662

Epoch 70/1000
Training Loss: 0.11248509, Training R2: 0.983319
Validation Loss: 0.40298687, Validation R2: 0.827808

Epoch 71/1000
Training Loss: 0.09876859, Training R2: 0.985862
Validation Loss: 0.39410003, Validation R2: 0.830676

Epoch 72/1000
Training Loss: 0.07829683, Training R2: 0.987698
Validation Loss: 0.38246367, Validation R2: 0.838759
Saved best model with validation R2 0.838759 to best_finetuned_model.pth

Epoch 73/1000
Training Loss: 0.07339056, Training R2: 0.988162
Validation Loss: 0.38278135, Validation R2: 0.833439

Epoch 74/1000
Training Loss: 0.08385430, Training R2: 0.987513
Validation Loss: 0.39334318, Validation R2: 0.828476

Epoch 75/1000
Training Loss: 0.08405233, Training R2: 0.987160
Validation Loss: 0.38444795, Validation R2: 0.834140

Epoch 76/1000
Training Loss: 0.07613326, Training R2: 0.987947
Validation Loss: 0.38322155, Validation R2: 0.836075

Epoch 77/1000
Training Loss: 0.07700528, Training R2: 0.988300
Validation Loss: 0.38423053, Validation R2: 0.833275

Epoch 78/1000
Training Loss: 0.08281762, Training R2: 0.988166
Validation Loss: 0.38146522, Validation R2: 0.839352
Saved best model with validation R2 0.839352 to best_finetuned_model.pth

Epoch 79/1000
Training Loss: 0.07497257, Training R2: 0.988756
Validation Loss: 0.37934615, Validation R2: 0.839731
Saved best model with validation R2 0.839731 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.08166073, Training R2: 0.987705
Validation Loss: 0.39172993, Validation R2: 0.831019

Epoch 81/1000
Training Loss: 0.08995276, Training R2: 0.986925
Validation Loss: 0.38378738, Validation R2: 0.838235

Epoch 82/1000
Training Loss: 0.09181169, Training R2: 0.986556
Validation Loss: 0.38861765, Validation R2: 0.835682

Epoch 83/1000
Training Loss: 0.08746601, Training R2: 0.987358
Validation Loss: 0.38770803, Validation R2: 0.836536

Epoch 84/1000
Training Loss: 0.08198656, Training R2: 0.987966
Validation Loss: 0.38487944, Validation R2: 0.837037

Epoch 85/1000
Training Loss: 0.07100562, Training R2: 0.989122
Validation Loss: 0.38311000, Validation R2: 0.832352

Epoch 86/1000
Training Loss: 0.08877070, Training R2: 0.986965
Validation Loss: 0.39603022, Validation R2: 0.830155

Epoch 87/1000
Training Loss: 0.08815465, Training R2: 0.987508
Validation Loss: 0.38478255, Validation R2: 0.836849

Epoch 88/1000
Training Loss: 0.08927678, Training R2: 0.986851
Validation Loss: 0.38249773, Validation R2: 0.837470

Epoch 89/1000
Training Loss: 0.07401442, Training R2: 0.988731
Validation Loss: 0.38549381, Validation R2: 0.836108

Epoch 90/1000
Training Loss: 0.08554324, Training R2: 0.987761
Validation Loss: 0.38093660, Validation R2: 0.840211
Saved best model with validation R2 0.840211 to best_finetuned_model.pth

Epoch 91/1000
Training Loss: 0.08145702, Training R2: 0.988424
Validation Loss: 0.38461291, Validation R2: 0.833660

Epoch 92/1000
Training Loss: 0.08350670, Training R2: 0.987934
Validation Loss: 0.37827156, Validation R2: 0.838998

Epoch 93/1000
Training Loss: 0.07137287, Training R2: 0.989357
Validation Loss: 0.37654813, Validation R2: 0.842699
Saved best model with validation R2 0.842699 to best_finetuned_model.pth

Epoch 94/1000
Training Loss: 0.07030014, Training R2: 0.989497
Validation Loss: 0.38603833, Validation R2: 0.836007

Epoch 95/1000
Training Loss: 0.07116007, Training R2: 0.989265
Validation Loss: 0.37674306, Validation R2: 0.842301

Epoch 96/1000
Training Loss: 0.06891681, Training R2: 0.989502
Validation Loss: 0.38116849, Validation R2: 0.835556

Epoch 97/1000
Training Loss: 0.07120206, Training R2: 0.989645
Validation Loss: 0.37524406, Validation R2: 0.839579

Epoch 98/1000
Training Loss: 0.06775133, Training R2: 0.990168
Validation Loss: 0.38022005, Validation R2: 0.837816

Epoch 99/1000
Training Loss: 0.06543007, Training R2: 0.990305
Validation Loss: 0.37916678, Validation R2: 0.840081

Epoch 100/1000
Training Loss: 0.06692988, Training R2: 0.990338
Validation Loss: 0.37650046, Validation R2: 0.836517

Epoch 101/1000
Training Loss: 0.07048462, Training R2: 0.989686
Validation Loss: 0.39841209, Validation R2: 0.829609

Epoch 102/1000
Training Loss: 0.09108214, Training R2: 0.987515
Validation Loss: 0.38143638, Validation R2: 0.836250

Epoch 103/1000
Training Loss: 0.12823206, Training R2: 0.982272
Validation Loss: 0.39272791, Validation R2: 0.834410

Epoch 104/1000
Training Loss: 0.08695796, Training R2: 0.987653
Validation Loss: 0.38504462, Validation R2: 0.836814

Epoch 105/1000
Training Loss: 0.07825911, Training R2: 0.989222
Validation Loss: 0.39665997, Validation R2: 0.833420

Epoch 106/1000
Training Loss: 0.11146092, Training R2: 0.984920
Validation Loss: 0.39509832, Validation R2: 0.833597

Epoch 107/1000
Training Loss: 0.08221964, Training R2: 0.988802
Validation Loss: 0.38465358, Validation R2: 0.837675

Epoch 108/1000
Training Loss: 0.10475231, Training R2: 0.986181
Validation Loss: 0.38139240, Validation R2: 0.842407

Epoch 109/1000
Training Loss: 0.07245747, Training R2: 0.989679
Validation Loss: 0.38812822, Validation R2: 0.834767

Epoch 110/1000
Training Loss: 0.07282555, Training R2: 0.990029
Validation Loss: 0.38236204, Validation R2: 0.838488

Epoch 111/1000
Training Loss: 0.06645036, Training R2: 0.990305
Validation Loss: 0.37825193, Validation R2: 0.839371

Epoch 112/1000
Training Loss: 0.06530458, Training R2: 0.990677
Validation Loss: 0.37995351, Validation R2: 0.836689

Epoch 113/1000
Training Loss: 0.05802202, Training R2: 0.991274
Validation Loss: 0.38180287, Validation R2: 0.837750

Epoch 114/1000
Epoch 00114: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.06586368, Training R2: 0.990038
Validation Loss: 0.38781078, Validation R2: 0.834600

Epoch 115/1000
学习率已减少 1 次
Training Loss: 0.06011640, Training R2: 0.991144
Validation Loss: 0.37915345, Validation R2: 0.839687

Epoch 116/1000
Training Loss: 0.04179888, Training R2: 0.992596
Validation Loss: 0.37755555, Validation R2: 0.839153

Epoch 117/1000
Training Loss: 0.03686987, Training R2: 0.992733
Validation Loss: 0.37651380, Validation R2: 0.839865

Epoch 118/1000
Training Loss: 0.03841386, Training R2: 0.992850
Validation Loss: 0.37811255, Validation R2: 0.839164

Epoch 119/1000
Training Loss: 0.04126552, Training R2: 0.992737
Validation Loss: 0.37787873, Validation R2: 0.837516

Epoch 120/1000
Training Loss: 0.04162945, Training R2: 0.992934
Validation Loss: 0.37797536, Validation R2: 0.838384

Epoch 121/1000
Training Loss: 0.03648994, Training R2: 0.992973
Validation Loss: 0.37955398, Validation R2: 0.837408

Epoch 122/1000
Training Loss: 0.03987095, Training R2: 0.993040
Validation Loss: 0.37970952, Validation R2: 0.836904

Epoch 123/1000
Training Loss: 0.03793962, Training R2: 0.992972
Validation Loss: 0.37823753, Validation R2: 0.837572

Epoch 124/1000
Training Loss: 0.05362999, Training R2: 0.992381
Validation Loss: 0.37542320, Validation R2: 0.839320

Epoch 125/1000
Training Loss: 0.03615728, Training R2: 0.993449
Validation Loss: 0.37409653, Validation R2: 0.840199

Epoch 126/1000
Training Loss: 0.03232086, Training R2: 0.993568
Validation Loss: 0.37854380, Validation R2: 0.838954

Epoch 127/1000
Training Loss: 0.03677423, Training R2: 0.993472
Validation Loss: 0.37719819, Validation R2: 0.837646

Epoch 128/1000
Training Loss: 0.03448831, Training R2: 0.993506
Validation Loss: 0.38009910, Validation R2: 0.836527

Epoch 129/1000
Training Loss: 0.03533736, Training R2: 0.993692
Validation Loss: 0.37896481, Validation R2: 0.837857

Epoch 130/1000
Training Loss: 0.03170162, Training R2: 0.993714
Validation Loss: 0.37618546, Validation R2: 0.839148

Epoch 131/1000
Training Loss: 0.03687273, Training R2: 0.993516
Validation Loss: 0.38075417, Validation R2: 0.838725

Epoch 132/1000
Training Loss: 0.03719758, Training R2: 0.993591
Validation Loss: 0.37562753, Validation R2: 0.841257

Epoch 133/1000
Training Loss: 0.03535017, Training R2: 0.993975
Validation Loss: 0.37840334, Validation R2: 0.839267

Epoch 134/1000
Training Loss: 0.03620943, Training R2: 0.993694
Validation Loss: 0.37850319, Validation R2: 0.838283

Epoch 135/1000
Epoch 00135: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03166437, Training R2: 0.994082
Validation Loss: 0.37540698, Validation R2: 0.841372

Epoch 136/1000
学习率已减少 2 次
Training Loss: 0.02638842, Training R2: 0.994355
Validation Loss: 0.37643587, Validation R2: 0.840141

Epoch 137/1000
Training Loss: 0.02297607, Training R2: 0.994699
Validation Loss: 0.37554571, Validation R2: 0.840387

Epoch 138/1000
Training Loss: 0.02174549, Training R2: 0.994743
Validation Loss: 0.37718025, Validation R2: 0.838975

Epoch 139/1000
Training Loss: 0.02045654, Training R2: 0.994799
Validation Loss: 0.37611971, Validation R2: 0.840108

Epoch 140/1000
Training Loss: 0.02150877, Training R2: 0.994828
Validation Loss: 0.37658001, Validation R2: 0.839443

Epoch 141/1000
Training Loss: 0.02186603, Training R2: 0.994832
Validation Loss: 0.37674858, Validation R2: 0.839018

Epoch 142/1000
Training Loss: 0.02135547, Training R2: 0.994985
Validation Loss: 0.37601193, Validation R2: 0.839292

Epoch 143/1000
Training Loss: 0.02031964, Training R2: 0.994946
Validation Loss: 0.37636526, Validation R2: 0.839521

Epoch 144/1000
Training Loss: 0.01724501, Training R2: 0.995092
Validation Loss: 0.37634334, Validation R2: 0.838924

Epoch 145/1000
Training Loss: 0.01761738, Training R2: 0.995174
Validation Loss: 0.37684444, Validation R2: 0.839654

Epoch 146/1000
Training Loss: 0.02196226, Training R2: 0.995147
Validation Loss: 0.37580149, Validation R2: 0.839934

Epoch 147/1000
Training Loss: 0.02093482, Training R2: 0.995245
Validation Loss: 0.37571979, Validation R2: 0.840214

Epoch 148/1000
Training Loss: 0.01941630, Training R2: 0.995224
Validation Loss: 0.37583276, Validation R2: 0.839862

Epoch 149/1000
Training Loss: 0.01776816, Training R2: 0.995358
Validation Loss: 0.37677895, Validation R2: 0.840161

Epoch 150/1000
Training Loss: 0.01672538, Training R2: 0.995383
Validation Loss: 0.37598366, Validation R2: 0.840712

Epoch 151/1000
Training Loss: 0.01745043, Training R2: 0.995432
Validation Loss: 0.37633872, Validation R2: 0.839852

Epoch 152/1000
Training Loss: 0.02043119, Training R2: 0.995452
Validation Loss: 0.37592238, Validation R2: 0.839354

Epoch 153/1000
Training Loss: 0.01750081, Training R2: 0.995588
Validation Loss: 0.37624522, Validation R2: 0.839643

Epoch 154/1000
Training Loss: 0.01867303, Training R2: 0.995400
Validation Loss: 0.37706862, Validation R2: 0.837627

Epoch 155/1000
Training Loss: 0.01911648, Training R2: 0.995648
Validation Loss: 0.37736770, Validation R2: 0.838671

Epoch 156/1000
Epoch 00156: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.01586678, Training R2: 0.995722
Validation Loss: 0.37671391, Validation R2: 0.838460

Epoch 157/1000
学习率已减少 3 次
Training Loss: 0.01515819, Training R2: 0.995765
Validation Loss: 0.37640174, Validation R2: 0.838817

Epoch 158/1000
Training Loss: 0.01220633, Training R2: 0.995894
Validation Loss: 0.37671533, Validation R2: 0.838885

Epoch 159/1000
Training Loss: 0.01089335, Training R2: 0.995960
Validation Loss: 0.37629160, Validation R2: 0.839051

Epoch 160/1000
Training Loss: 0.01163741, Training R2: 0.996006
Validation Loss: 0.37637726, Validation R2: 0.839212

Epoch 161/1000
Training Loss: 0.01070262, Training R2: 0.996024
Validation Loss: 0.37686382, Validation R2: 0.838459

Epoch 162/1000
Training Loss: 0.01080001, Training R2: 0.996062
Validation Loss: 0.37541720, Validation R2: 0.839430

Epoch 163/1000
Training Loss: 0.01064329, Training R2: 0.996083
Validation Loss: 0.37619843, Validation R2: 0.839187

Epoch 164/1000
Training Loss: 0.01133952, Training R2: 0.996157
Validation Loss: 0.37630653, Validation R2: 0.839442

Epoch 165/1000
Training Loss: 0.01666732, Training R2: 0.996061
Validation Loss: 0.37624527, Validation R2: 0.839204

Epoch 166/1000
Training Loss: 0.01619568, Training R2: 0.996081
Validation Loss: 0.37682002, Validation R2: 0.839157

Epoch 167/1000
Training Loss: 0.01364962, Training R2: 0.996206
Validation Loss: 0.37591868, Validation R2: 0.839069

Epoch 168/1000
Training Loss: 0.01121121, Training R2: 0.996347
Validation Loss: 0.37642473, Validation R2: 0.838511

Epoch 169/1000
Training Loss: 0.01049156, Training R2: 0.996342
Validation Loss: 0.37638292, Validation R2: 0.838832

Epoch 170/1000
Training Loss: 0.01329853, Training R2: 0.996369
Validation Loss: 0.37608683, Validation R2: 0.839146

Epoch 171/1000
Training Loss: 0.01276434, Training R2: 0.996347
Validation Loss: 0.37608919, Validation R2: 0.838972

Epoch 172/1000
Training Loss: 0.01150944, Training R2: 0.996417
Validation Loss: 0.37651217, Validation R2: 0.839145

Epoch 173/1000
Training Loss: 0.01064241, Training R2: 0.996437
Validation Loss: 0.37675405, Validation R2: 0.839287

Epoch 174/1000
Training Loss: 0.01129656, Training R2: 0.996489
Validation Loss: 0.37637877, Validation R2: 0.838891

Epoch 175/1000
Training Loss: 0.01122629, Training R2: 0.996519
Validation Loss: 0.37655479, Validation R2: 0.838695

Epoch 176/1000
Training Loss: 0.01034605, Training R2: 0.996578
Validation Loss: 0.37700107, Validation R2: 0.838631

Epoch 177/1000
Epoch 00177: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.01063822, Training R2: 0.996582
Validation Loss: 0.37689203, Validation R2: 0.838530

Epoch 178/1000
学习率已减少 4 次
Training Loss: 0.01027220, Training R2: 0.996601
Validation Loss: 0.37650023, Validation R2: 0.838665

Epoch 179/1000
Training Loss: 0.00835435, Training R2: 0.996651
Validation Loss: 0.37636450, Validation R2: 0.838982

Epoch 180/1000
Training Loss: 0.00731827, Training R2: 0.996701
Validation Loss: 0.37645505, Validation R2: 0.839120

Epoch 181/1000
Training Loss: 0.00716289, Training R2: 0.996709
Validation Loss: 0.37667287, Validation R2: 0.838989

Epoch 182/1000
Training Loss: 0.00731858, Training R2: 0.996723
Validation Loss: 0.37630399, Validation R2: 0.839158

Epoch 183/1000
Training Loss: 0.00714187, Training R2: 0.996730
Validation Loss: 0.37660508, Validation R2: 0.839167

Epoch 184/1000
Training Loss: 0.00688020, Training R2: 0.996723
Validation Loss: 0.37650517, Validation R2: 0.839017

Epoch 185/1000
Training Loss: 0.00691044, Training R2: 0.996762
Validation Loss: 0.37654905, Validation R2: 0.838997

Epoch 186/1000
Training Loss: 0.00940398, Training R2: 0.996755
Validation Loss: 0.37653779, Validation R2: 0.838953

Epoch 187/1000
Training Loss: 0.00901425, Training R2: 0.996771
Validation Loss: 0.37599744, Validation R2: 0.839279

Epoch 188/1000
Training Loss: 0.00850807, Training R2: 0.996782
Validation Loss: 0.37635947, Validation R2: 0.839022

Epoch 189/1000
Training Loss: 0.00745056, Training R2: 0.996825
Validation Loss: 0.37660251, Validation R2: 0.839083

Epoch 190/1000
Training Loss: 0.00921559, Training R2: 0.996816
Validation Loss: 0.37662101, Validation R2: 0.838846

Epoch 191/1000
Training Loss: 0.00813473, Training R2: 0.996838
Validation Loss: 0.37611202, Validation R2: 0.838837

Epoch 192/1000
Training Loss: 0.00701082, Training R2: 0.996877
Validation Loss: 0.37653471, Validation R2: 0.838855

Epoch 193/1000
Training Loss: 0.00772943, Training R2: 0.996881
Validation Loss: 0.37638974, Validation R2: 0.838821

Epoch 194/1000
Training Loss: 0.00633635, Training R2: 0.996918
Validation Loss: 0.37656468, Validation R2: 0.838673

Epoch 195/1000
Training Loss: 0.00675122, Training R2: 0.996907
Validation Loss: 0.37654717, Validation R2: 0.838803

Epoch 196/1000
Training Loss: 0.00697360, Training R2: 0.996935
Validation Loss: 0.37639762, Validation R2: 0.838875

Epoch 197/1000
Training Loss: 0.00677540, Training R2: 0.996941
Validation Loss: 0.37659278, Validation R2: 0.838820

Epoch 198/1000
Epoch 00198: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00657896, Training R2: 0.996945
Validation Loss: 0.37667092, Validation R2: 0.838791

Epoch 199/1000
学习率已减少 5 次
Training Loss: 0.00580136, Training R2: 0.996973
Validation Loss: 0.37640557, Validation R2: 0.838886

Epoch 200/1000
Training Loss: 0.00491618, Training R2: 0.996989
Validation Loss: 0.37633345, Validation R2: 0.838852

Epoch 201/1000
Training Loss: 0.00556284, Training R2: 0.996985
Validation Loss: 0.37627110, Validation R2: 0.838966

Epoch 202/1000
Training Loss: 0.00498486, Training R2: 0.996998
Validation Loss: 0.37638252, Validation R2: 0.838899

Epoch 203/1000
Training Loss: 0.00451074, Training R2: 0.997019
Validation Loss: 0.37629852, Validation R2: 0.838980

Epoch 204/1000
Training Loss: 0.00438376, Training R2: 0.997023
Validation Loss: 0.37652716, Validation R2: 0.838887

Epoch 205/1000
Training Loss: 0.00423140, Training R2: 0.997034
Validation Loss: 0.37655499, Validation R2: 0.838800

Epoch 206/1000
Training Loss: 0.00463360, Training R2: 0.997032
Validation Loss: 0.37640820, Validation R2: 0.838901

Epoch 207/1000
Training Loss: 0.00474200, Training R2: 0.997044
Validation Loss: 0.37655078, Validation R2: 0.838648

Epoch 208/1000
Training Loss: 0.00512943, Training R2: 0.997054
Validation Loss: 0.37667357, Validation R2: 0.838850

Epoch 209/1000
Training Loss: 0.00513359, Training R2: 0.997060
Validation Loss: 0.37626890, Validation R2: 0.838926

Epoch 210/1000
Training Loss: 0.00480196, Training R2: 0.997080
Validation Loss: 0.37660687, Validation R2: 0.838724

Epoch 211/1000
Training Loss: 0.00442056, Training R2: 0.997083
Validation Loss: 0.37651520, Validation R2: 0.838804

Epoch 212/1000
Training Loss: 0.00487957, Training R2: 0.997082
Validation Loss: 0.37643382, Validation R2: 0.838834

Epoch 213/1000
Training Loss: 0.00451146, Training R2: 0.997103
Validation Loss: 0.37665323, Validation R2: 0.838812

Epoch 214/1000
Training Loss: 0.00503669, Training R2: 0.997106
Validation Loss: 0.37645905, Validation R2: 0.838887

Epoch 215/1000
Training Loss: 0.00440242, Training R2: 0.997111
Validation Loss: 0.37645159, Validation R2: 0.838808

Epoch 216/1000
Training Loss: 0.00473916, Training R2: 0.997117
Validation Loss: 0.37670135, Validation R2: 0.838718

Epoch 217/1000
Training Loss: 0.00459912, Training R2: 0.997132
Validation Loss: 0.37633557, Validation R2: 0.838714

Epoch 218/1000
Training Loss: 0.00425116, Training R2: 0.997139
Validation Loss: 0.37639991, Validation R2: 0.838833

Epoch 219/1000
Epoch 00219: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00429306, Training R2: 0.997148
Validation Loss: 0.37655331, Validation R2: 0.838839

Epoch 220/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
