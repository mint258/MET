Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4275843

Epoch 1/1000
Training Loss: 1.23780154, Training R2: -0.111230
Validation Loss: 1.18743393, Validation R2: -0.053320
Saved best model with validation R2 -0.053320 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.08418914, Training R2: 0.103415
Validation Loss: 1.02278973, Validation R2: 0.225864
Saved best model with validation R2 0.225864 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.91356902, Training R2: 0.329380
Validation Loss: 0.87488103, Validation R2: 0.405174
Saved best model with validation R2 0.405174 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.78920096, Training R2: 0.457994
Validation Loss: 0.80697612, Validation R2: 0.472616
Saved best model with validation R2 0.472616 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.72746509, Training R2: 0.526365
Validation Loss: 0.77855219, Validation R2: 0.506481
Saved best model with validation R2 0.506481 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.65556372, Training R2: 0.595648
Validation Loss: 0.70577230, Validation R2: 0.570633
Saved best model with validation R2 0.570633 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.59226578, Training R2: 0.654878
Validation Loss: 0.66553876, Validation R2: 0.604761
Saved best model with validation R2 0.604761 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.53622187, Training R2: 0.710357
Validation Loss: 0.71316728, Validation R2: 0.570653

Epoch 9/1000
Training Loss: 0.50652009, Training R2: 0.744200
Validation Loss: 0.72767884, Validation R2: 0.566978

Epoch 10/1000
Training Loss: 0.47736436, Training R2: 0.771793
Validation Loss: 0.66079688, Validation R2: 0.609801
Saved best model with validation R2 0.609801 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.43655398, Training R2: 0.807280
Validation Loss: 0.60499362, Validation R2: 0.669728
Saved best model with validation R2 0.669728 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.36775742, Training R2: 0.852216
Validation Loss: 0.57191289, Validation R2: 0.703546
Saved best model with validation R2 0.703546 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.33721682, Training R2: 0.873564
Validation Loss: 0.57890735, Validation R2: 0.699975

Epoch 14/1000
Training Loss: 0.34556446, Training R2: 0.872567
Validation Loss: 0.55579838, Validation R2: 0.717449
Saved best model with validation R2 0.717449 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.28835704, Training R2: 0.898270
Validation Loss: 0.55596795, Validation R2: 0.724956
Saved best model with validation R2 0.724956 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.28627396, Training R2: 0.905142
Validation Loss: 0.55151047, Validation R2: 0.716882

Epoch 17/1000
Training Loss: 0.26939026, Training R2: 0.915713
Validation Loss: 0.54702528, Validation R2: 0.728562
Saved best model with validation R2 0.728562 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.25880734, Training R2: 0.922098
Validation Loss: 0.53446427, Validation R2: 0.726205

Epoch 19/1000
Training Loss: 0.24927436, Training R2: 0.927283
Validation Loss: 0.52722733, Validation R2: 0.744466
Saved best model with validation R2 0.744466 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.23183307, Training R2: 0.934421
Validation Loss: 0.53476384, Validation R2: 0.740226

Epoch 21/1000
Training Loss: 0.29286787, Training R2: 0.918092
Validation Loss: 0.57365932, Validation R2: 0.702469

Epoch 22/1000
Training Loss: 0.23463222, Training R2: 0.934912
Validation Loss: 0.54593702, Validation R2: 0.723536

Epoch 23/1000
Training Loss: 0.22117645, Training R2: 0.939692
Validation Loss: 0.52454937, Validation R2: 0.746875
Saved best model with validation R2 0.746875 to best_finetuned_model.pth

Epoch 24/1000
Training Loss: 0.20243202, Training R2: 0.948501
Validation Loss: 0.52220935, Validation R2: 0.753263
Saved best model with validation R2 0.753263 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.17906749, Training R2: 0.953782
Validation Loss: 0.50627724, Validation R2: 0.758736
Saved best model with validation R2 0.758736 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.15258720, Training R2: 0.960994
Validation Loss: 0.50929461, Validation R2: 0.760919
Saved best model with validation R2 0.760919 to best_finetuned_model.pth

Epoch 27/1000
Training Loss: 0.16655199, Training R2: 0.959702
Validation Loss: 0.53704831, Validation R2: 0.737386

Epoch 28/1000
Training Loss: 0.19055100, Training R2: 0.953935
Validation Loss: 0.52743482, Validation R2: 0.743875

Epoch 29/1000
Training Loss: 0.16720059, Training R2: 0.959660
Validation Loss: 0.51362286, Validation R2: 0.749991

Epoch 30/1000
Training Loss: 0.16598937, Training R2: 0.960973
Validation Loss: 0.50994704, Validation R2: 0.757305

Epoch 31/1000
Training Loss: 0.14557787, Training R2: 0.966368
Validation Loss: 0.51375517, Validation R2: 0.756397

Epoch 32/1000
Training Loss: 0.16034882, Training R2: 0.963431
Validation Loss: 0.51408426, Validation R2: 0.754972

Epoch 33/1000
Training Loss: 0.17419630, Training R2: 0.961824
Validation Loss: 0.53083455, Validation R2: 0.753458

Epoch 34/1000
Training Loss: 0.20333995, Training R2: 0.954643
Validation Loss: 0.51539805, Validation R2: 0.755763

Epoch 35/1000
Training Loss: 0.15918609, Training R2: 0.965962
Validation Loss: 0.50622563, Validation R2: 0.762058
Saved best model with validation R2 0.762058 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.12697083, Training R2: 0.973876
Validation Loss: 0.49227864, Validation R2: 0.766297
Saved best model with validation R2 0.766297 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.11918194, Training R2: 0.976417
Validation Loss: 0.49688468, Validation R2: 0.764470

Epoch 38/1000
Training Loss: 0.14397886, Training R2: 0.971531
Validation Loss: 0.50909310, Validation R2: 0.757947

Epoch 39/1000
Training Loss: 0.14419182, Training R2: 0.973517
Validation Loss: 0.49445852, Validation R2: 0.772251
Saved best model with validation R2 0.772251 to best_finetuned_model.pth

Epoch 40/1000
Training Loss: 0.15937459, Training R2: 0.969356
Validation Loss: 0.52787471, Validation R2: 0.752228

Epoch 41/1000
Training Loss: 0.14571356, Training R2: 0.973233
Validation Loss: 0.50223380, Validation R2: 0.763102

Epoch 42/1000
Training Loss: 0.12993250, Training R2: 0.975820
Validation Loss: 0.49925465, Validation R2: 0.765704

Epoch 43/1000
Training Loss: 0.11431218, Training R2: 0.979505
Validation Loss: 0.49067490, Validation R2: 0.772466
Saved best model with validation R2 0.772466 to best_finetuned_model.pth

Epoch 44/1000
Training Loss: 0.10804479, Training R2: 0.981031
Validation Loss: 0.49750380, Validation R2: 0.764569

Epoch 45/1000
Training Loss: 0.11903206, Training R2: 0.979462
Validation Loss: 0.49058212, Validation R2: 0.772885
Saved best model with validation R2 0.772885 to best_finetuned_model.pth

Epoch 46/1000
Training Loss: 0.11157868, Training R2: 0.981749
Validation Loss: 0.48890516, Validation R2: 0.768604

Epoch 47/1000
Training Loss: 0.10151564, Training R2: 0.982090
Validation Loss: 0.49131462, Validation R2: 0.771269

Epoch 48/1000
Training Loss: 0.09934754, Training R2: 0.983902
Validation Loss: 0.49194949, Validation R2: 0.773527
Saved best model with validation R2 0.773527 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.11198655, Training R2: 0.981988
Validation Loss: 0.48246287, Validation R2: 0.772755

Epoch 50/1000
Training Loss: 0.10661760, Training R2: 0.983145
Validation Loss: 0.47728139, Validation R2: 0.779177
Saved best model with validation R2 0.779177 to best_finetuned_model.pth

Epoch 51/1000
Training Loss: 0.11124408, Training R2: 0.982062
Validation Loss: 0.49038137, Validation R2: 0.772548

Epoch 52/1000
Training Loss: 0.10756047, Training R2: 0.983314
Validation Loss: 0.49104621, Validation R2: 0.771198

Epoch 53/1000
Training Loss: 0.18101044, Training R2: 0.969350
Validation Loss: 0.50562993, Validation R2: 0.770968

Epoch 54/1000
Training Loss: 0.15077413, Training R2: 0.976317
Validation Loss: 0.49853486, Validation R2: 0.770275

Epoch 55/1000
Training Loss: 0.12367303, Training R2: 0.980835
Validation Loss: 0.49335221, Validation R2: 0.765878

Epoch 56/1000
Training Loss: 0.10989018, Training R2: 0.983695
Validation Loss: 0.48793317, Validation R2: 0.773490

Epoch 57/1000
Training Loss: 0.10011232, Training R2: 0.985188
Validation Loss: 0.49497816, Validation R2: 0.767984

Epoch 58/1000
Training Loss: 0.09754275, Training R2: 0.985562
Validation Loss: 0.48889992, Validation R2: 0.773452

Epoch 59/1000
Training Loss: 0.09564363, Training R2: 0.986482
Validation Loss: 0.48994175, Validation R2: 0.775019

Epoch 60/1000
Training Loss: 0.11839837, Training R2: 0.983145
Validation Loss: 0.51296895, Validation R2: 0.759515

Epoch 61/1000
Training Loss: 0.11640168, Training R2: 0.983152
Validation Loss: 0.48214020, Validation R2: 0.776430

Epoch 62/1000
Training Loss: 0.08899606, Training R2: 0.987344
Validation Loss: 0.48003259, Validation R2: 0.779966
Saved best model with validation R2 0.779966 to best_finetuned_model.pth

Epoch 63/1000
Training Loss: 0.08110770, Training R2: 0.988745
Validation Loss: 0.48462676, Validation R2: 0.776537

Epoch 64/1000
Training Loss: 0.08184351, Training R2: 0.988858
Validation Loss: 0.48547279, Validation R2: 0.779671

Epoch 65/1000
Training Loss: 0.07956394, Training R2: 0.989288
Validation Loss: 0.48464181, Validation R2: 0.779638

Epoch 66/1000
Training Loss: 0.08110211, Training R2: 0.989425
Validation Loss: 0.47901610, Validation R2: 0.779684

Epoch 67/1000
Training Loss: 0.08373770, Training R2: 0.989081
Validation Loss: 0.51348908, Validation R2: 0.756008

Epoch 68/1000
Training Loss: 0.14775100, Training R2: 0.978788
Validation Loss: 0.48664922, Validation R2: 0.772776

Epoch 69/1000
Training Loss: 0.10039293, Training R2: 0.987186
Validation Loss: 0.48320379, Validation R2: 0.775167

Epoch 70/1000
Training Loss: 0.08241836, Training R2: 0.989787
Validation Loss: 0.48113630, Validation R2: 0.773848

Epoch 71/1000
Training Loss: 0.07803959, Training R2: 0.989421
Validation Loss: 0.48436216, Validation R2: 0.779170

Epoch 72/1000
Training Loss: 0.08457566, Training R2: 0.989880
Validation Loss: 0.48298600, Validation R2: 0.779833

Epoch 73/1000
Training Loss: 0.07501465, Training R2: 0.991189
Validation Loss: 0.47924342, Validation R2: 0.774961

Epoch 74/1000
Training Loss: 0.08756612, Training R2: 0.989635
Validation Loss: 0.47415498, Validation R2: 0.786291
Saved best model with validation R2 0.786291 to best_finetuned_model.pth

Epoch 75/1000
Training Loss: 0.08176560, Training R2: 0.990222
Validation Loss: 0.47732743, Validation R2: 0.777986

Epoch 76/1000
Training Loss: 0.08253790, Training R2: 0.990647
Validation Loss: 0.49414094, Validation R2: 0.770940

Epoch 77/1000
Training Loss: 0.07602809, Training R2: 0.991577
Validation Loss: 0.47889801, Validation R2: 0.780146

Epoch 78/1000
Training Loss: 0.08666701, Training R2: 0.990612
Validation Loss: 0.48226432, Validation R2: 0.776619

Epoch 79/1000
Training Loss: 0.08812543, Training R2: 0.990232
Validation Loss: 0.48435073, Validation R2: 0.776015

Epoch 80/1000
Training Loss: 0.10176111, Training R2: 0.988715
Validation Loss: 0.47710953, Validation R2: 0.780038

Epoch 81/1000
Training Loss: 0.09382338, Training R2: 0.990411
Validation Loss: 0.48132398, Validation R2: 0.778062

Epoch 82/1000
Training Loss: 0.07395232, Training R2: 0.993042
Validation Loss: 0.47560663, Validation R2: 0.780521

Epoch 83/1000
Training Loss: 0.07318100, Training R2: 0.993050
Validation Loss: 0.48105617, Validation R2: 0.776563

Epoch 84/1000
Training Loss: 0.07710820, Training R2: 0.993369
Validation Loss: 0.49647637, Validation R2: 0.774471

Epoch 85/1000
Training Loss: 0.09330261, Training R2: 0.991621
Validation Loss: 0.48296917, Validation R2: 0.779009

Epoch 86/1000
Training Loss: 0.08980485, Training R2: 0.992246
Validation Loss: 0.47261540, Validation R2: 0.787161
Saved best model with validation R2 0.787161 to best_finetuned_model.pth

Epoch 87/1000
Training Loss: 0.07999882, Training R2: 0.993737
Validation Loss: 0.48375952, Validation R2: 0.776812

Epoch 88/1000
Training Loss: 0.07307122, Training R2: 0.994686
Validation Loss: 0.47952050, Validation R2: 0.775848

Epoch 89/1000
Training Loss: 0.08138782, Training R2: 0.993604
Validation Loss: 0.47311865, Validation R2: 0.783724

Epoch 90/1000
Training Loss: 0.07661825, Training R2: 0.994520
Validation Loss: 0.47188898, Validation R2: 0.784405

Epoch 91/1000
Training Loss: 0.08340428, Training R2: 0.993841
Validation Loss: 0.47255984, Validation R2: 0.784551

Epoch 92/1000
Training Loss: 0.07721413, Training R2: 0.994728
Validation Loss: 0.48708583, Validation R2: 0.773920

Epoch 93/1000
Training Loss: 0.06819616, Training R2: 0.995810
Validation Loss: 0.47879981, Validation R2: 0.782025

Epoch 94/1000
Training Loss: 0.06913198, Training R2: 0.995894
Validation Loss: 0.47591488, Validation R2: 0.781848

Epoch 95/1000
Training Loss: 0.06716856, Training R2: 0.996175
Validation Loss: 0.47391222, Validation R2: 0.782804

Epoch 96/1000
Training Loss: 0.06892293, Training R2: 0.995908
Validation Loss: 0.47543639, Validation R2: 0.785871

Epoch 97/1000
Training Loss: 0.07308927, Training R2: 0.995673
Validation Loss: 0.47875669, Validation R2: 0.787592
Saved best model with validation R2 0.787592 to best_finetuned_model.pth

Epoch 98/1000
Training Loss: 0.07338748, Training R2: 0.995612
Validation Loss: 0.46223473, Validation R2: 0.793062
Saved best model with validation R2 0.793062 to best_finetuned_model.pth

Epoch 99/1000
Training Loss: 0.07560289, Training R2: 0.995549
Validation Loss: 0.47534090, Validation R2: 0.779432

Epoch 100/1000
Training Loss: 0.07508757, Training R2: 0.995517
Validation Loss: 0.47372379, Validation R2: 0.783000

Epoch 101/1000
Training Loss: 0.06863609, Training R2: 0.996285
Validation Loss: 0.46925942, Validation R2: 0.786699

Epoch 102/1000
Training Loss: 0.08171751, Training R2: 0.994638
Validation Loss: 0.47337958, Validation R2: 0.787581

Epoch 103/1000
Training Loss: 0.07414317, Training R2: 0.995228
Validation Loss: 0.48121152, Validation R2: 0.779828

Epoch 104/1000
Training Loss: 0.07683350, Training R2: 0.995180
Validation Loss: 0.47442640, Validation R2: 0.787300

Epoch 105/1000
Training Loss: 0.07772995, Training R2: 0.995215
Validation Loss: 0.46519911, Validation R2: 0.792193

Epoch 106/1000
Training Loss: 0.06892093, Training R2: 0.996060
Validation Loss: 0.47066711, Validation R2: 0.787500

Epoch 107/1000
Training Loss: 0.07207033, Training R2: 0.995761
Validation Loss: 0.47771497, Validation R2: 0.783116

Epoch 108/1000
Training Loss: 0.07613552, Training R2: 0.995504
Validation Loss: 0.47128302, Validation R2: 0.784765

Epoch 109/1000
Training Loss: 0.06320219, Training R2: 0.996561
Validation Loss: 0.47195479, Validation R2: 0.784408

Epoch 110/1000
Training Loss: 0.06093734, Training R2: 0.996990
Validation Loss: 0.47293106, Validation R2: 0.785647

Epoch 111/1000
Training Loss: 0.06150829, Training R2: 0.996870
Validation Loss: 0.46557489, Validation R2: 0.792788

Epoch 112/1000
Training Loss: 0.06276929, Training R2: 0.996854
Validation Loss: 0.46156590, Validation R2: 0.789979

Epoch 113/1000
Training Loss: 0.05804820, Training R2: 0.997253
Validation Loss: 0.47405601, Validation R2: 0.784289

Epoch 114/1000
Training Loss: 0.06147841, Training R2: 0.996700
Validation Loss: 0.48366012, Validation R2: 0.780378

Epoch 115/1000
Training Loss: 0.06752639, Training R2: 0.996100
Validation Loss: 0.46800058, Validation R2: 0.788214

Epoch 116/1000
Training Loss: 0.05858966, Training R2: 0.997125
Validation Loss: 0.47436809, Validation R2: 0.788549

Epoch 117/1000
Training Loss: 0.06847380, Training R2: 0.996167
Validation Loss: 0.47308427, Validation R2: 0.789130

Epoch 118/1000
Training Loss: 0.07493934, Training R2: 0.995620
Validation Loss: 0.47025250, Validation R2: 0.796195
Saved best model with validation R2 0.796195 to best_finetuned_model.pth

Epoch 119/1000
Training Loss: 0.07835574, Training R2: 0.995179
Validation Loss: 0.47151160, Validation R2: 0.785051

Epoch 120/1000
Training Loss: 0.06810557, Training R2: 0.996157
Validation Loss: 0.47143807, Validation R2: 0.783842

Epoch 121/1000
Training Loss: 0.06272303, Training R2: 0.996680
Validation Loss: 0.46990727, Validation R2: 0.787612

Epoch 122/1000
Training Loss: 0.05909318, Training R2: 0.997022
Validation Loss: 0.46799385, Validation R2: 0.785457

Epoch 123/1000
Training Loss: 0.06824374, Training R2: 0.996329
Validation Loss: 0.46290773, Validation R2: 0.797678
Saved best model with validation R2 0.797678 to best_finetuned_model.pth

Epoch 124/1000
Training Loss: 0.07292951, Training R2: 0.995776
Validation Loss: 0.46536439, Validation R2: 0.786592

Epoch 125/1000
Training Loss: 0.06581934, Training R2: 0.996518
Validation Loss: 0.46668406, Validation R2: 0.791126

Epoch 126/1000
Training Loss: 0.06918964, Training R2: 0.996267
Validation Loss: 0.46797828, Validation R2: 0.790105

Epoch 127/1000
Training Loss: 0.06155088, Training R2: 0.996668
Validation Loss: 0.46641772, Validation R2: 0.786179

Epoch 128/1000
Training Loss: 0.06641845, Training R2: 0.996606
Validation Loss: 0.46405464, Validation R2: 0.791691

Epoch 129/1000
Training Loss: 0.06905439, Training R2: 0.996345
Validation Loss: 0.45850250, Validation R2: 0.794158

Epoch 130/1000
Training Loss: 0.06553059, Training R2: 0.996604
Validation Loss: 0.46421965, Validation R2: 0.791556

Epoch 131/1000
Training Loss: 0.05988004, Training R2: 0.997175
Validation Loss: 0.46342197, Validation R2: 0.792054

Epoch 132/1000
Training Loss: 0.06090421, Training R2: 0.997032
Validation Loss: 0.47519106, Validation R2: 0.789187

Epoch 133/1000
Training Loss: 0.06882688, Training R2: 0.996200
Validation Loss: 0.47612921, Validation R2: 0.787728

Epoch 134/1000
Training Loss: 0.08259003, Training R2: 0.994630
Validation Loss: 0.48819332, Validation R2: 0.777584

Epoch 135/1000
Training Loss: 0.10732136, Training R2: 0.990876
Validation Loss: 0.47881438, Validation R2: 0.782514

Epoch 136/1000
Training Loss: 0.10407605, Training R2: 0.991778
Validation Loss: 0.47964295, Validation R2: 0.785034

Epoch 137/1000
Training Loss: 0.07035130, Training R2: 0.995967
Validation Loss: 0.46921967, Validation R2: 0.787042

Epoch 138/1000
Training Loss: 0.06045488, Training R2: 0.996974
Validation Loss: 0.47231116, Validation R2: 0.788000

Epoch 139/1000
Training Loss: 0.05975827, Training R2: 0.997148
Validation Loss: 0.46739813, Validation R2: 0.792251

Epoch 140/1000
Training Loss: 0.06479244, Training R2: 0.996668
Validation Loss: 0.46300021, Validation R2: 0.790167

Epoch 141/1000
Training Loss: 0.09006580, Training R2: 0.993998
Validation Loss: 0.48465883, Validation R2: 0.774459

Epoch 142/1000
Training Loss: 0.08457750, Training R2: 0.994451
Validation Loss: 0.46613457, Validation R2: 0.793773

Epoch 143/1000
Training Loss: 0.06288428, Training R2: 0.996764
Validation Loss: 0.46846352, Validation R2: 0.785689

Epoch 144/1000
Epoch 00144: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.05416606, Training R2: 0.997672
Validation Loss: 0.46698024, Validation R2: 0.790170

Epoch 145/1000
学习率已减少 1 次
Training Loss: 0.04993447, Training R2: 0.997988
Validation Loss: 0.46159203, Validation R2: 0.792050

Epoch 146/1000
Training Loss: 0.03844261, Training R2: 0.998812
Validation Loss: 0.47105542, Validation R2: 0.789378

Epoch 147/1000
Training Loss: 0.03551298, Training R2: 0.998996
Validation Loss: 0.46665264, Validation R2: 0.790743

Epoch 148/1000
Training Loss: 0.03841983, Training R2: 0.998868
Validation Loss: 0.46078828, Validation R2: 0.793742

Epoch 149/1000
Training Loss: 0.03013121, Training R2: 0.999280
Validation Loss: 0.46338507, Validation R2: 0.792559

Epoch 150/1000
Training Loss: 0.02721277, Training R2: 0.999361
Validation Loss: 0.46342443, Validation R2: 0.792029

Epoch 151/1000
Training Loss: 0.02647165, Training R2: 0.999429
Validation Loss: 0.46889141, Validation R2: 0.790015

Epoch 152/1000
Training Loss: 0.03126998, Training R2: 0.999238
Validation Loss: 0.46673057, Validation R2: 0.790253

Epoch 153/1000
Training Loss: 0.03219576, Training R2: 0.999147
Validation Loss: 0.46394278, Validation R2: 0.789739

Epoch 154/1000
Training Loss: 0.02678985, Training R2: 0.999410
Validation Loss: 0.46302869, Validation R2: 0.791535

Epoch 155/1000
Training Loss: 0.02731457, Training R2: 0.999398
Validation Loss: 0.46299383, Validation R2: 0.790740

Epoch 156/1000
Training Loss: 0.03003628, Training R2: 0.999273
Validation Loss: 0.46215475, Validation R2: 0.791079

Epoch 157/1000
Training Loss: 0.03046631, Training R2: 0.999268
Validation Loss: 0.46376001, Validation R2: 0.792267

Epoch 158/1000
Training Loss: 0.02770225, Training R2: 0.999385
Validation Loss: 0.46323362, Validation R2: 0.792139

Epoch 159/1000
Training Loss: 0.02577650, Training R2: 0.999463
Validation Loss: 0.46084485, Validation R2: 0.793178

Epoch 160/1000
Training Loss: 0.03037212, Training R2: 0.999282
Validation Loss: 0.46204353, Validation R2: 0.794584

Epoch 161/1000
Training Loss: 0.03391243, Training R2: 0.999112
Validation Loss: 0.46243235, Validation R2: 0.793230

Epoch 162/1000
Training Loss: 0.03216850, Training R2: 0.999170
Validation Loss: 0.46250902, Validation R2: 0.792959

Epoch 163/1000
Training Loss: 0.03046813, Training R2: 0.999252
Validation Loss: 0.46167651, Validation R2: 0.792525

Epoch 164/1000
Training Loss: 0.02756140, Training R2: 0.999392
Validation Loss: 0.46073976, Validation R2: 0.793866

Epoch 165/1000
Epoch 00165: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.02705009, Training R2: 0.999415
Validation Loss: 0.46411758, Validation R2: 0.791333

Epoch 166/1000
学习率已减少 2 次
Training Loss: 0.02364309, Training R2: 0.999537
Validation Loss: 0.46129402, Validation R2: 0.792824

Epoch 167/1000
Training Loss: 0.01819563, Training R2: 0.999733
Validation Loss: 0.46325923, Validation R2: 0.792514

Epoch 168/1000
Training Loss: 0.01536003, Training R2: 0.999806
Validation Loss: 0.46465758, Validation R2: 0.791888

Epoch 169/1000
Training Loss: 0.01413779, Training R2: 0.999839
Validation Loss: 0.46409800, Validation R2: 0.791075

Epoch 170/1000
Training Loss: 0.01585349, Training R2: 0.999799
Validation Loss: 0.46296699, Validation R2: 0.793022

Epoch 171/1000
Training Loss: 0.01642941, Training R2: 0.999786
Validation Loss: 0.46408548, Validation R2: 0.790809

Epoch 172/1000
Training Loss: 0.01494192, Training R2: 0.999823
Validation Loss: 0.46482264, Validation R2: 0.792294

Epoch 173/1000
Training Loss: 0.01832183, Training R2: 0.999745
Validation Loss: 0.46243212, Validation R2: 0.791285

Epoch 174/1000
Training Loss: 0.01605915, Training R2: 0.999797
Validation Loss: 0.46322609, Validation R2: 0.792291

Epoch 175/1000
Training Loss: 0.01632799, Training R2: 0.999794
Validation Loss: 0.46518825, Validation R2: 0.791601

Epoch 176/1000
Training Loss: 0.01694135, Training R2: 0.999766
Validation Loss: 0.46212747, Validation R2: 0.793597

Epoch 177/1000
Training Loss: 0.01462792, Training R2: 0.999825
Validation Loss: 0.46118552, Validation R2: 0.793874

Epoch 178/1000
Training Loss: 0.01331593, Training R2: 0.999846
Validation Loss: 0.46193717, Validation R2: 0.792592

Epoch 179/1000
Training Loss: 0.01413917, Training R2: 0.999844
Validation Loss: 0.46183759, Validation R2: 0.792119

Epoch 180/1000
Training Loss: 0.01724311, Training R2: 0.999767
Validation Loss: 0.46099995, Validation R2: 0.791608

Epoch 181/1000
Training Loss: 0.02532715, Training R2: 0.999545
Validation Loss: 0.46298666, Validation R2: 0.790824

Epoch 182/1000
Training Loss: 0.02606844, Training R2: 0.999512
Validation Loss: 0.46073077, Validation R2: 0.793175

Epoch 183/1000
Training Loss: 0.01772904, Training R2: 0.999751
Validation Loss: 0.46025574, Validation R2: 0.794329

Epoch 184/1000
Training Loss: 0.01439088, Training R2: 0.999833
Validation Loss: 0.46177736, Validation R2: 0.792002

Epoch 185/1000
Training Loss: 0.01649855, Training R2: 0.999785
Validation Loss: 0.46067646, Validation R2: 0.792324

Epoch 186/1000
Epoch 00186: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.02365363, Training R2: 0.999587
Validation Loss: 0.46065556, Validation R2: 0.792918

Epoch 187/1000
学习率已减少 3 次
Training Loss: 0.01510101, Training R2: 0.999812
Validation Loss: 0.46087686, Validation R2: 0.793232

Epoch 188/1000
Training Loss: 0.01096070, Training R2: 0.999904
Validation Loss: 0.46146430, Validation R2: 0.792308

Epoch 189/1000
Training Loss: 0.01008875, Training R2: 0.999921
Validation Loss: 0.46307834, Validation R2: 0.791878

Epoch 190/1000
Training Loss: 0.00877451, Training R2: 0.999938
Validation Loss: 0.46231278, Validation R2: 0.792270

Epoch 191/1000
Training Loss: 0.00802533, Training R2: 0.999947
Validation Loss: 0.46231016, Validation R2: 0.791790

Epoch 192/1000
Training Loss: 0.00691110, Training R2: 0.999960
Validation Loss: 0.46123760, Validation R2: 0.793276

Epoch 193/1000
Training Loss: 0.00772391, Training R2: 0.999950
Validation Loss: 0.46110114, Validation R2: 0.792905

Epoch 194/1000
Training Loss: 0.00777279, Training R2: 0.999950
Validation Loss: 0.46205444, Validation R2: 0.792523

Epoch 195/1000
Training Loss: 0.00833179, Training R2: 0.999947
Validation Loss: 0.46101272, Validation R2: 0.792773

Epoch 196/1000
Training Loss: 0.01093317, Training R2: 0.999910
Validation Loss: 0.46227311, Validation R2: 0.791926

Epoch 197/1000
Training Loss: 0.01320660, Training R2: 0.999869
Validation Loss: 0.46199168, Validation R2: 0.792548

Epoch 198/1000
Training Loss: 0.01038752, Training R2: 0.999916
Validation Loss: 0.46044371, Validation R2: 0.793121

Epoch 199/1000
Training Loss: 0.00842153, Training R2: 0.999944
Validation Loss: 0.46183879, Validation R2: 0.792739

Epoch 200/1000
Training Loss: 0.00812266, Training R2: 0.999946
Validation Loss: 0.46260581, Validation R2: 0.791897

Epoch 201/1000
Training Loss: 0.00840926, Training R2: 0.999945
Validation Loss: 0.46232458, Validation R2: 0.793172

Epoch 202/1000
Training Loss: 0.00753108, Training R2: 0.999954
Validation Loss: 0.46153103, Validation R2: 0.792947

Epoch 203/1000
Training Loss: 0.00761923, Training R2: 0.999954
Validation Loss: 0.46228164, Validation R2: 0.792760

Epoch 204/1000
Training Loss: 0.00716729, Training R2: 0.999957
Validation Loss: 0.46120109, Validation R2: 0.792943

Epoch 205/1000
Training Loss: 0.00779344, Training R2: 0.999952
Validation Loss: 0.46125150, Validation R2: 0.792921

Epoch 206/1000
Training Loss: 0.00962220, Training R2: 0.999928
Validation Loss: 0.46221577, Validation R2: 0.792805

Epoch 207/1000
Epoch 00207: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00857084, Training R2: 0.999942
Validation Loss: 0.46195926, Validation R2: 0.792991

Epoch 208/1000
学习率已减少 4 次
Training Loss: 0.00652425, Training R2: 0.999965
Validation Loss: 0.46158228, Validation R2: 0.793002

Epoch 209/1000
Training Loss: 0.00532254, Training R2: 0.999977
Validation Loss: 0.46177606, Validation R2: 0.792856

Epoch 210/1000
Training Loss: 0.00428915, Training R2: 0.999983
Validation Loss: 0.46231482, Validation R2: 0.792488

Epoch 211/1000
Training Loss: 0.00463257, Training R2: 0.999982
Validation Loss: 0.46118997, Validation R2: 0.793189

Epoch 212/1000
Training Loss: 0.00438623, Training R2: 0.999984
Validation Loss: 0.46148770, Validation R2: 0.792992

Epoch 213/1000
Training Loss: 0.00456146, Training R2: 0.999984
Validation Loss: 0.46127849, Validation R2: 0.793314

Epoch 214/1000
Training Loss: 0.00459548, Training R2: 0.999983
Validation Loss: 0.46164476, Validation R2: 0.792735

Epoch 215/1000
Training Loss: 0.00405438, Training R2: 0.999986
Validation Loss: 0.46219084, Validation R2: 0.792643

Epoch 216/1000
Training Loss: 0.00410235, Training R2: 0.999986
Validation Loss: 0.46203429, Validation R2: 0.792504

Epoch 217/1000
Training Loss: 0.00384236, Training R2: 0.999987
Validation Loss: 0.46150781, Validation R2: 0.793003

Epoch 218/1000
Training Loss: 0.00426703, Training R2: 0.999985
Validation Loss: 0.46153911, Validation R2: 0.792774

Epoch 219/1000
Training Loss: 0.00424198, Training R2: 0.999986
Validation Loss: 0.46174213, Validation R2: 0.792891

Epoch 220/1000
Training Loss: 0.00433735, Training R2: 0.999984
Validation Loss: 0.46154096, Validation R2: 0.793149

Epoch 221/1000
Training Loss: 0.00454643, Training R2: 0.999983
Validation Loss: 0.46210216, Validation R2: 0.792501

Epoch 222/1000
Training Loss: 0.00464499, Training R2: 0.999982
Validation Loss: 0.46147978, Validation R2: 0.792715

Epoch 223/1000
Training Loss: 0.00392979, Training R2: 0.999986
Validation Loss: 0.46190272, Validation R2: 0.792723

Epoch 224/1000
Training Loss: 0.00441143, Training R2: 0.999982
Validation Loss: 0.46210898, Validation R2: 0.792632

Epoch 225/1000
Training Loss: 0.00407193, Training R2: 0.999983
Validation Loss: 0.46196265, Validation R2: 0.792870

Epoch 226/1000
Training Loss: 0.00386011, Training R2: 0.999987
Validation Loss: 0.46171423, Validation R2: 0.792836

Epoch 227/1000
Training Loss: 0.00350896, Training R2: 0.999989
Validation Loss: 0.46138925, Validation R2: 0.793020

Epoch 228/1000
Epoch 00228: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00377227, Training R2: 0.999987
Validation Loss: 0.46152770, Validation R2: 0.793057

Epoch 229/1000
学习率已减少 5 次
Training Loss: 0.00320455, Training R2: 0.999991
Validation Loss: 0.46172347, Validation R2: 0.793023

Epoch 230/1000
Training Loss: 0.00285946, Training R2: 0.999993
Validation Loss: 0.46186720, Validation R2: 0.792671

Epoch 231/1000
Training Loss: 0.00246142, Training R2: 0.999992
Validation Loss: 0.46148753, Validation R2: 0.792942

Epoch 232/1000
Training Loss: 0.00217662, Training R2: 0.999995
Validation Loss: 0.46168186, Validation R2: 0.792715

Epoch 233/1000
Training Loss: 0.00215575, Training R2: 0.999995
Validation Loss: 0.46137752, Validation R2: 0.792964

Epoch 234/1000
Training Loss: 0.00210855, Training R2: 0.999995
Validation Loss: 0.46168843, Validation R2: 0.792835

Epoch 235/1000
Training Loss: 0.00221608, Training R2: 0.999994
Validation Loss: 0.46170159, Validation R2: 0.792928

Epoch 236/1000
Training Loss: 0.00207862, Training R2: 0.999995
Validation Loss: 0.46144024, Validation R2: 0.792765

Epoch 237/1000
Training Loss: 0.00204799, Training R2: 0.999996
Validation Loss: 0.46124518, Validation R2: 0.792986

Epoch 238/1000
Training Loss: 0.00208397, Training R2: 0.999995
Validation Loss: 0.46142067, Validation R2: 0.793152

Epoch 239/1000
Training Loss: 0.00229719, Training R2: 0.999995
Validation Loss: 0.46138258, Validation R2: 0.792730

Epoch 240/1000
Training Loss: 0.00275244, Training R2: 0.999993
Validation Loss: 0.46161531, Validation R2: 0.792796

Epoch 241/1000
Training Loss: 0.00233606, Training R2: 0.999994
Validation Loss: 0.46166076, Validation R2: 0.792831

Epoch 242/1000
Training Loss: 0.00205041, Training R2: 0.999996
Validation Loss: 0.46205650, Validation R2: 0.792505

Epoch 243/1000
Training Loss: 0.00215999, Training R2: 0.999996
Validation Loss: 0.46202605, Validation R2: 0.792662

Epoch 244/1000
Training Loss: 0.00230820, Training R2: 0.999995
Validation Loss: 0.46177883, Validation R2: 0.792757

Epoch 245/1000
Training Loss: 0.00218243, Training R2: 0.999995
Validation Loss: 0.46193497, Validation R2: 0.792610

Epoch 246/1000
Training Loss: 0.00232659, Training R2: 0.999992
Validation Loss: 0.46170131, Validation R2: 0.792721

Epoch 247/1000
Training Loss: 0.00243796, Training R2: 0.999993
Validation Loss: 0.46114478, Validation R2: 0.793018

Epoch 248/1000
Training Loss: 0.00225035, Training R2: 0.999995
Validation Loss: 0.46142683, Validation R2: 0.792759

Epoch 249/1000
Epoch 00249: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00208149, Training R2: 0.999995
Validation Loss: 0.46119222, Validation R2: 0.792926

Epoch 250/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
