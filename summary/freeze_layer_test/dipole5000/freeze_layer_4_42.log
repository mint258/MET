Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3258499

Epoch 1/1000
Training Loss: 1.47814047, Training R2: -0.698274
Validation Loss: 1.17691269, Validation R2: 0.038739
Saved best model with validation R2 0.038739 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.15669372, Training R2: 0.032810
Validation Loss: 1.05434427, Validation R2: 0.121582
Saved best model with validation R2 0.121582 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.01988791, Training R2: 0.202438
Validation Loss: 0.94619031, Validation R2: 0.256835
Saved best model with validation R2 0.256835 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.89455042, Training R2: 0.361102
Validation Loss: 0.82898509, Validation R2: 0.414644
Saved best model with validation R2 0.414644 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.78625066, Training R2: 0.483932
Validation Loss: 0.76354946, Validation R2: 0.500278
Saved best model with validation R2 0.500278 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.71502094, Training R2: 0.550318
Validation Loss: 0.71429987, Validation R2: 0.540369
Saved best model with validation R2 0.540369 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.66090272, Training R2: 0.607467
Validation Loss: 0.76415850, Validation R2: 0.507090

Epoch 8/1000
Training Loss: 0.64731775, Training R2: 0.628185
Validation Loss: 0.67981516, Validation R2: 0.570325
Saved best model with validation R2 0.570325 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.60558619, Training R2: 0.667526
Validation Loss: 0.73054062, Validation R2: 0.548718

Epoch 10/1000
Training Loss: 0.56061980, Training R2: 0.704378
Validation Loss: 0.59773013, Validation R2: 0.655375
Saved best model with validation R2 0.655375 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.51725445, Training R2: 0.737688
Validation Loss: 0.60204683, Validation R2: 0.654916

Epoch 12/1000
Training Loss: 0.45665786, Training R2: 0.782750
Validation Loss: 0.57995427, Validation R2: 0.672844
Saved best model with validation R2 0.672844 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.41062696, Training R2: 0.813863
Validation Loss: 0.57471309, Validation R2: 0.683629
Saved best model with validation R2 0.683629 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.38790414, Training R2: 0.832847
Validation Loss: 0.58804126, Validation R2: 0.681905

Epoch 15/1000
Training Loss: 0.35647625, Training R2: 0.851574
Validation Loss: 0.63961681, Validation R2: 0.643125

Epoch 16/1000
Training Loss: 0.40069299, Training R2: 0.837274
Validation Loss: 0.56460303, Validation R2: 0.694695
Saved best model with validation R2 0.694695 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.33517907, Training R2: 0.871853
Validation Loss: 0.56384579, Validation R2: 0.702264
Saved best model with validation R2 0.702264 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.32778270, Training R2: 0.878229
Validation Loss: 0.55831202, Validation R2: 0.706315
Saved best model with validation R2 0.706315 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.31386155, Training R2: 0.886413
Validation Loss: 0.54615170, Validation R2: 0.712762
Saved best model with validation R2 0.712762 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.28988989, Training R2: 0.899551
Validation Loss: 0.53768412, Validation R2: 0.727998
Saved best model with validation R2 0.727998 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.26628125, Training R2: 0.909509
Validation Loss: 0.53799412, Validation R2: 0.727983

Epoch 22/1000
Training Loss: 0.24635944, Training R2: 0.919455
Validation Loss: 0.53073656, Validation R2: 0.724099

Epoch 23/1000
Training Loss: 0.22777119, Training R2: 0.926170
Validation Loss: 0.52448612, Validation R2: 0.737364
Saved best model with validation R2 0.737364 to best_finetuned_model.pth

Epoch 24/1000
Training Loss: 0.23750622, Training R2: 0.924766
Validation Loss: 0.53354280, Validation R2: 0.733845

Epoch 25/1000
Training Loss: 0.23151538, Training R2: 0.928705
Validation Loss: 0.58854775, Validation R2: 0.675786

Epoch 26/1000
Training Loss: 0.23327901, Training R2: 0.928814
Validation Loss: 0.53754228, Validation R2: 0.727961

Epoch 27/1000
Training Loss: 0.19503765, Training R2: 0.941456
Validation Loss: 0.52325384, Validation R2: 0.741694
Saved best model with validation R2 0.741694 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.19179686, Training R2: 0.941458
Validation Loss: 0.54529244, Validation R2: 0.725526

Epoch 29/1000
Training Loss: 0.19644157, Training R2: 0.942561
Validation Loss: 0.53880248, Validation R2: 0.719733

Epoch 30/1000
Training Loss: 0.17414461, Training R2: 0.948994
Validation Loss: 0.52017247, Validation R2: 0.741922
Saved best model with validation R2 0.741922 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.17654639, Training R2: 0.951439
Validation Loss: 0.55995910, Validation R2: 0.716233

Epoch 32/1000
Training Loss: 0.18112263, Training R2: 0.950648
Validation Loss: 0.52876544, Validation R2: 0.736123

Epoch 33/1000
Training Loss: 0.17058591, Training R2: 0.954283
Validation Loss: 0.51659060, Validation R2: 0.747073
Saved best model with validation R2 0.747073 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.15145797, Training R2: 0.958538
Validation Loss: 0.52748591, Validation R2: 0.734664

Epoch 35/1000
Training Loss: 0.16021576, Training R2: 0.958596
Validation Loss: 0.51898021, Validation R2: 0.743065

Epoch 36/1000
Training Loss: 0.14100662, Training R2: 0.963071
Validation Loss: 0.51813390, Validation R2: 0.744139

Epoch 37/1000
Training Loss: 0.14879752, Training R2: 0.962212
Validation Loss: 0.52514170, Validation R2: 0.738386

Epoch 38/1000
Training Loss: 0.15263586, Training R2: 0.963031
Validation Loss: 0.53044324, Validation R2: 0.734853

Epoch 39/1000
Training Loss: 0.14226596, Training R2: 0.964628
Validation Loss: 0.53326553, Validation R2: 0.736895

Epoch 40/1000
Training Loss: 0.13276741, Training R2: 0.966835
Validation Loss: 0.51736558, Validation R2: 0.745872

Epoch 41/1000
Training Loss: 0.15622141, Training R2: 0.964317
Validation Loss: 0.54727054, Validation R2: 0.729190

Epoch 42/1000
Training Loss: 0.14861932, Training R2: 0.964633
Validation Loss: 0.52967948, Validation R2: 0.737652

Epoch 43/1000
Training Loss: 0.14992697, Training R2: 0.964960
Validation Loss: 0.54494412, Validation R2: 0.723801

Epoch 44/1000
Training Loss: 0.14027951, Training R2: 0.967390
Validation Loss: 0.52138148, Validation R2: 0.741550

Epoch 45/1000
Training Loss: 0.12245302, Training R2: 0.971133
Validation Loss: 0.53085789, Validation R2: 0.739660

Epoch 46/1000
Training Loss: 0.13926595, Training R2: 0.968850
Validation Loss: 0.52051022, Validation R2: 0.745583

Epoch 47/1000
Training Loss: 0.10858330, Training R2: 0.974777
Validation Loss: 0.51747618, Validation R2: 0.745861

Epoch 48/1000
Training Loss: 0.11317972, Training R2: 0.974931
Validation Loss: 0.52543415, Validation R2: 0.739391

Epoch 49/1000
Training Loss: 0.12676886, Training R2: 0.973057
Validation Loss: 0.52743183, Validation R2: 0.737227

Epoch 50/1000
Training Loss: 0.15648435, Training R2: 0.966824
Validation Loss: 0.53409937, Validation R2: 0.733339

Epoch 51/1000
Training Loss: 0.12108348, Training R2: 0.972742
Validation Loss: 0.52148496, Validation R2: 0.746778

Epoch 52/1000
Training Loss: 0.11541515, Training R2: 0.975409
Validation Loss: 0.53423780, Validation R2: 0.734983

Epoch 53/1000
Training Loss: 0.10513778, Training R2: 0.977029
Validation Loss: 0.51833299, Validation R2: 0.745751

Epoch 54/1000
Epoch 00054: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.11006226, Training R2: 0.977423
Validation Loss: 0.51877546, Validation R2: 0.745252

Epoch 55/1000
学习率已减少 1 次
Training Loss: 0.08549775, Training R2: 0.981040
Validation Loss: 0.51335959, Validation R2: 0.749333
Saved best model with validation R2 0.749333 to best_finetuned_model.pth

Epoch 56/1000
Training Loss: 0.07008025, Training R2: 0.983013
Validation Loss: 0.51252582, Validation R2: 0.750896
Saved best model with validation R2 0.750896 to best_finetuned_model.pth

Epoch 57/1000
Training Loss: 0.06250393, Training R2: 0.983963
Validation Loss: 0.51042801, Validation R2: 0.753834
Saved best model with validation R2 0.753834 to best_finetuned_model.pth

Epoch 58/1000
Training Loss: 0.05625078, Training R2: 0.984950
Validation Loss: 0.51508848, Validation R2: 0.751330

Epoch 59/1000
Training Loss: 0.06170783, Training R2: 0.984917
Validation Loss: 0.50974036, Validation R2: 0.754085
Saved best model with validation R2 0.754085 to best_finetuned_model.pth

Epoch 60/1000
Training Loss: 0.05334399, Training R2: 0.985021
Validation Loss: 0.51102499, Validation R2: 0.752654

Epoch 61/1000
Training Loss: 0.05264647, Training R2: 0.985500
Validation Loss: 0.50958670, Validation R2: 0.753108

Epoch 62/1000
Training Loss: 0.05626888, Training R2: 0.985452
Validation Loss: 0.51113444, Validation R2: 0.753431

Epoch 63/1000
Training Loss: 0.05665573, Training R2: 0.985629
Validation Loss: 0.51157164, Validation R2: 0.752156

Epoch 64/1000
Training Loss: 0.06345719, Training R2: 0.985184
Validation Loss: 0.51116129, Validation R2: 0.751509

Epoch 65/1000
Training Loss: 0.05811807, Training R2: 0.985580
Validation Loss: 0.50996426, Validation R2: 0.752863

Epoch 66/1000
Training Loss: 0.06052973, Training R2: 0.985131
Validation Loss: 0.51012566, Validation R2: 0.753727

Epoch 67/1000
Training Loss: 0.05575314, Training R2: 0.985749
Validation Loss: 0.51000755, Validation R2: 0.752202

Epoch 68/1000
Training Loss: 0.05131088, Training R2: 0.986368
Validation Loss: 0.51214343, Validation R2: 0.751683

Epoch 69/1000
Training Loss: 0.05256728, Training R2: 0.986284
Validation Loss: 0.51349646, Validation R2: 0.751267

Epoch 70/1000
Training Loss: 0.06171708, Training R2: 0.986133
Validation Loss: 0.51528367, Validation R2: 0.749487

Epoch 71/1000
Training Loss: 0.05281313, Training R2: 0.986490
Validation Loss: 0.51023779, Validation R2: 0.753353

Epoch 72/1000
Training Loss: 0.05648981, Training R2: 0.986584
Validation Loss: 0.51169632, Validation R2: 0.753952

Epoch 73/1000
Training Loss: 0.05580376, Training R2: 0.986595
Validation Loss: 0.51222978, Validation R2: 0.751668

Epoch 74/1000
Training Loss: 0.04602165, Training R2: 0.987310
Validation Loss: 0.51082589, Validation R2: 0.753513

Epoch 75/1000
Training Loss: 0.04949337, Training R2: 0.986954
Validation Loss: 0.50830938, Validation R2: 0.755414
Saved best model with validation R2 0.755414 to best_finetuned_model.pth

Epoch 76/1000
Training Loss: 0.04743375, Training R2: 0.987044
Validation Loss: 0.51165265, Validation R2: 0.752558

Epoch 77/1000
Training Loss: 0.05096836, Training R2: 0.987257
Validation Loss: 0.50946929, Validation R2: 0.753949

Epoch 78/1000
Training Loss: 0.04887174, Training R2: 0.987512
Validation Loss: 0.51168280, Validation R2: 0.753594

Epoch 79/1000
Training Loss: 0.08823668, Training R2: 0.984486
Validation Loss: 0.51354344, Validation R2: 0.752411

Epoch 80/1000
Training Loss: 0.09279222, Training R2: 0.983766
Validation Loss: 0.51240066, Validation R2: 0.752385

Epoch 81/1000
Training Loss: 0.07085431, Training R2: 0.985645
Validation Loss: 0.51197908, Validation R2: 0.752698

Epoch 82/1000
Training Loss: 0.06231932, Training R2: 0.986708
Validation Loss: 0.51672777, Validation R2: 0.750180

Epoch 83/1000
Training Loss: 0.06113425, Training R2: 0.986933
Validation Loss: 0.51023761, Validation R2: 0.755254

Epoch 84/1000
Training Loss: 0.05047570, Training R2: 0.987558
Validation Loss: 0.51006553, Validation R2: 0.753086

Epoch 85/1000
Training Loss: 0.04957539, Training R2: 0.987597
Validation Loss: 0.50530705, Validation R2: 0.756645
Saved best model with validation R2 0.756645 to best_finetuned_model.pth

Epoch 86/1000
Training Loss: 0.04566843, Training R2: 0.987924
Validation Loss: 0.50935830, Validation R2: 0.753894

Epoch 87/1000
Training Loss: 0.06735492, Training R2: 0.986667
Validation Loss: 0.51797174, Validation R2: 0.748438

Epoch 88/1000
Training Loss: 0.08514505, Training R2: 0.985094
Validation Loss: 0.51393702, Validation R2: 0.749665

Epoch 89/1000
Training Loss: 0.05867117, Training R2: 0.987028
Validation Loss: 0.50721273, Validation R2: 0.753990

Epoch 90/1000
Training Loss: 0.05470847, Training R2: 0.987492
Validation Loss: 0.50504674, Validation R2: 0.756461

Epoch 91/1000
Training Loss: 0.04629007, Training R2: 0.987833
Validation Loss: 0.50937399, Validation R2: 0.754123

Epoch 92/1000
Training Loss: 0.05327649, Training R2: 0.987640
Validation Loss: 0.51132943, Validation R2: 0.751273

Epoch 93/1000
Training Loss: 0.05176113, Training R2: 0.987833
Validation Loss: 0.50766511, Validation R2: 0.755087

Epoch 94/1000
Training Loss: 0.04117727, Training R2: 0.988627
Validation Loss: 0.50834051, Validation R2: 0.753403

Epoch 95/1000
Training Loss: 0.04248722, Training R2: 0.988713
Validation Loss: 0.50830755, Validation R2: 0.755629

Epoch 96/1000
Training Loss: 0.04480841, Training R2: 0.988359
Validation Loss: 0.50849180, Validation R2: 0.755916

Epoch 97/1000
Training Loss: 0.04432792, Training R2: 0.988388
Validation Loss: 0.50426880, Validation R2: 0.757535
Saved best model with validation R2 0.757535 to best_finetuned_model.pth

Epoch 98/1000
Training Loss: 0.05374855, Training R2: 0.987907
Validation Loss: 0.50974822, Validation R2: 0.754510

Epoch 99/1000
Training Loss: 0.05101949, Training R2: 0.988018
Validation Loss: 0.50690902, Validation R2: 0.753607

Epoch 100/1000
Training Loss: 0.05108553, Training R2: 0.987787
Validation Loss: 0.50620755, Validation R2: 0.755388

Epoch 101/1000
Training Loss: 0.04591373, Training R2: 0.988381
Validation Loss: 0.50555821, Validation R2: 0.755473

Epoch 102/1000
Training Loss: 0.05246632, Training R2: 0.987928
Validation Loss: 0.50648736, Validation R2: 0.755551

Epoch 103/1000
Training Loss: 0.04890356, Training R2: 0.988423
Validation Loss: 0.50701813, Validation R2: 0.756376

Epoch 104/1000
Training Loss: 0.04259128, Training R2: 0.988919
Validation Loss: 0.50813552, Validation R2: 0.754893

Epoch 105/1000
Training Loss: 0.04352465, Training R2: 0.988830
Validation Loss: 0.50407832, Validation R2: 0.758042
Saved best model with validation R2 0.758042 to best_finetuned_model.pth

Epoch 106/1000
Training Loss: 0.04386419, Training R2: 0.988784
Validation Loss: 0.50575078, Validation R2: 0.756431

Epoch 107/1000
Training Loss: 0.04153146, Training R2: 0.989071
Validation Loss: 0.50780207, Validation R2: 0.753286

Epoch 108/1000
Training Loss: 0.04500975, Training R2: 0.988877
Validation Loss: 0.50631575, Validation R2: 0.754399

Epoch 109/1000
Training Loss: 0.04255933, Training R2: 0.988816
Validation Loss: 0.50480035, Validation R2: 0.757389

Epoch 110/1000
Training Loss: 0.03876268, Training R2: 0.989207
Validation Loss: 0.50552182, Validation R2: 0.755725

Epoch 111/1000
Training Loss: 0.04626329, Training R2: 0.988694
Validation Loss: 0.50555248, Validation R2: 0.756125

Epoch 112/1000
Training Loss: 0.04372240, Training R2: 0.988895
Validation Loss: 0.50767480, Validation R2: 0.755032

Epoch 113/1000
Training Loss: 0.04602127, Training R2: 0.989071
Validation Loss: 0.50656741, Validation R2: 0.756945

Epoch 114/1000
Training Loss: 0.05503031, Training R2: 0.988455
Validation Loss: 0.50419128, Validation R2: 0.756662

Epoch 115/1000
Training Loss: 0.04885765, Training R2: 0.988678
Validation Loss: 0.50904150, Validation R2: 0.753754

Epoch 116/1000
Training Loss: 0.05795142, Training R2: 0.988272
Validation Loss: 0.50523290, Validation R2: 0.758550
Saved best model with validation R2 0.758550 to best_finetuned_model.pth

Epoch 117/1000
Training Loss: 0.04985764, Training R2: 0.988822
Validation Loss: 0.50713031, Validation R2: 0.754489

Epoch 118/1000
Training Loss: 0.04419006, Training R2: 0.989317
Validation Loss: 0.50428073, Validation R2: 0.756352

Epoch 119/1000
Training Loss: 0.04417072, Training R2: 0.989391
Validation Loss: 0.50920328, Validation R2: 0.753621

Epoch 120/1000
Training Loss: 0.04218153, Training R2: 0.989636
Validation Loss: 0.50866175, Validation R2: 0.753467

Epoch 121/1000
Training Loss: 0.04710152, Training R2: 0.989263
Validation Loss: 0.50542819, Validation R2: 0.756650

Epoch 122/1000
Training Loss: 0.03964645, Training R2: 0.989741
Validation Loss: 0.50722595, Validation R2: 0.754810

Epoch 123/1000
Training Loss: 0.04180515, Training R2: 0.989642
Validation Loss: 0.50629052, Validation R2: 0.757573

Epoch 124/1000
Training Loss: 0.04586506, Training R2: 0.989240
Validation Loss: 0.50586933, Validation R2: 0.755304

Epoch 125/1000
Training Loss: 0.04629403, Training R2: 0.989422
Validation Loss: 0.50423038, Validation R2: 0.756697

Epoch 126/1000
Training Loss: 0.04774620, Training R2: 0.989440
Validation Loss: 0.50521160, Validation R2: 0.757066

Epoch 127/1000
Training Loss: 0.04366549, Training R2: 0.989795
Validation Loss: 0.50732361, Validation R2: 0.756052

Epoch 128/1000
Training Loss: 0.04471322, Training R2: 0.989799
Validation Loss: 0.50314778, Validation R2: 0.757677

Epoch 129/1000
Training Loss: 0.04170254, Training R2: 0.989793
Validation Loss: 0.50436797, Validation R2: 0.755512

Epoch 130/1000
Training Loss: 0.04932501, Training R2: 0.989675
Validation Loss: 0.50618957, Validation R2: 0.755453

Epoch 131/1000
Training Loss: 0.06013410, Training R2: 0.988766
Validation Loss: 0.50760308, Validation R2: 0.755418

Epoch 132/1000
Training Loss: 0.05954142, Training R2: 0.988732
Validation Loss: 0.50604810, Validation R2: 0.755982

Epoch 133/1000
Training Loss: 0.05706905, Training R2: 0.988756
Validation Loss: 0.50589511, Validation R2: 0.755929

Epoch 134/1000
Training Loss: 0.05251229, Training R2: 0.989140
Validation Loss: 0.50392744, Validation R2: 0.757084

Epoch 135/1000
Training Loss: 0.04896523, Training R2: 0.990025
Validation Loss: 0.50501905, Validation R2: 0.755169

Epoch 136/1000
Training Loss: 0.04775644, Training R2: 0.989707
Validation Loss: 0.50689422, Validation R2: 0.755611

Epoch 137/1000
Epoch 00137: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.04936365, Training R2: 0.989679
Validation Loss: 0.50416310, Validation R2: 0.755320

Epoch 138/1000
学习率已减少 2 次
Training Loss: 0.04257008, Training R2: 0.990289
Validation Loss: 0.50421636, Validation R2: 0.756188

Epoch 139/1000
Training Loss: 0.03180383, Training R2: 0.990950
Validation Loss: 0.50396318, Validation R2: 0.757670

Epoch 140/1000
Training Loss: 0.02580229, Training R2: 0.990954
Validation Loss: 0.50380531, Validation R2: 0.757503

Epoch 141/1000
Training Loss: 0.02443425, Training R2: 0.991087
Validation Loss: 0.50406295, Validation R2: 0.756728

Epoch 142/1000
Training Loss: 0.02269777, Training R2: 0.991195
Validation Loss: 0.50309349, Validation R2: 0.757495

Epoch 143/1000
Training Loss: 0.02925292, Training R2: 0.991091
Validation Loss: 0.50221036, Validation R2: 0.757553

Epoch 144/1000
Training Loss: 0.02349934, Training R2: 0.991204
Validation Loss: 0.50287137, Validation R2: 0.757982

Epoch 145/1000
Training Loss: 0.02478478, Training R2: 0.991297
Validation Loss: 0.50255192, Validation R2: 0.757311

Epoch 146/1000
Training Loss: 0.02536149, Training R2: 0.991194
Validation Loss: 0.50096319, Validation R2: 0.758733
Saved best model with validation R2 0.758733 to best_finetuned_model.pth

Epoch 147/1000
Training Loss: 0.02546604, Training R2: 0.991371
Validation Loss: 0.50294885, Validation R2: 0.757611

Epoch 148/1000
Training Loss: 0.02854738, Training R2: 0.991186
Validation Loss: 0.50287048, Validation R2: 0.757865

Epoch 149/1000
Training Loss: 0.02250851, Training R2: 0.991435
Validation Loss: 0.50280706, Validation R2: 0.758112

Epoch 150/1000
Training Loss: 0.02093111, Training R2: 0.991482
Validation Loss: 0.50362359, Validation R2: 0.757502

Epoch 151/1000
Training Loss: 0.02433127, Training R2: 0.991471
Validation Loss: 0.50453642, Validation R2: 0.756834

Epoch 152/1000
Training Loss: 0.02934249, Training R2: 0.991229
Validation Loss: 0.50328990, Validation R2: 0.756822

Epoch 153/1000
Training Loss: 0.03033173, Training R2: 0.991288
Validation Loss: 0.50513842, Validation R2: 0.755582

Epoch 154/1000
Training Loss: 0.04157097, Training R2: 0.990952
Validation Loss: 0.50501008, Validation R2: 0.755907

Epoch 155/1000
Training Loss: 0.03870435, Training R2: 0.990993
Validation Loss: 0.50419628, Validation R2: 0.756238

Epoch 156/1000
Training Loss: 0.03776660, Training R2: 0.991377
Validation Loss: 0.50527741, Validation R2: 0.756159

Epoch 157/1000
Training Loss: 0.03452145, Training R2: 0.991476
Validation Loss: 0.50369643, Validation R2: 0.756782

Epoch 158/1000
Training Loss: 0.02501565, Training R2: 0.991833
Validation Loss: 0.50351668, Validation R2: 0.757247

Epoch 159/1000
Training Loss: 0.02344726, Training R2: 0.991726
Validation Loss: 0.50234164, Validation R2: 0.757608

Epoch 160/1000
Training Loss: 0.02586010, Training R2: 0.991759
Validation Loss: 0.50340299, Validation R2: 0.756554

Epoch 161/1000
Training Loss: 0.02291948, Training R2: 0.991906
Validation Loss: 0.50331987, Validation R2: 0.757546

Epoch 162/1000
Training Loss: 0.02858056, Training R2: 0.991599
Validation Loss: 0.50342620, Validation R2: 0.757942

Epoch 163/1000
Training Loss: 0.02606091, Training R2: 0.991895
Validation Loss: 0.50482125, Validation R2: 0.756586

Epoch 164/1000
Training Loss: 0.02331173, Training R2: 0.991968
Validation Loss: 0.50380949, Validation R2: 0.757820

Epoch 165/1000
Training Loss: 0.02182739, Training R2: 0.992118
Validation Loss: 0.50432672, Validation R2: 0.757233

Epoch 166/1000
Training Loss: 0.02270705, Training R2: 0.992060
Validation Loss: 0.50390739, Validation R2: 0.757849

Epoch 167/1000
Epoch 00167: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.02915492, Training R2: 0.991942
Validation Loss: 0.50299610, Validation R2: 0.758153

Epoch 168/1000
学习率已减少 3 次
Training Loss: 0.02297164, Training R2: 0.992087
Validation Loss: 0.50307048, Validation R2: 0.757766

Epoch 169/1000
Training Loss: 0.01983415, Training R2: 0.992234
Validation Loss: 0.50250048, Validation R2: 0.758430

Epoch 170/1000
Training Loss: 0.01655214, Training R2: 0.992371
Validation Loss: 0.50282080, Validation R2: 0.757936

Epoch 171/1000
Training Loss: 0.01483469, Training R2: 0.992421
Validation Loss: 0.50317310, Validation R2: 0.757702

Epoch 172/1000
Training Loss: 0.01573213, Training R2: 0.992442
Validation Loss: 0.50260792, Validation R2: 0.757892

Epoch 173/1000
Training Loss: 0.01353949, Training R2: 0.992508
Validation Loss: 0.50268975, Validation R2: 0.757816

Epoch 174/1000
Training Loss: 0.01299344, Training R2: 0.992500
Validation Loss: 0.50214329, Validation R2: 0.758200

Epoch 175/1000
Training Loss: 0.01454728, Training R2: 0.992519
Validation Loss: 0.50293693, Validation R2: 0.757571

Epoch 176/1000
Training Loss: 0.01434887, Training R2: 0.992498
Validation Loss: 0.50329540, Validation R2: 0.757514

Epoch 177/1000
Training Loss: 0.01349734, Training R2: 0.992526
Validation Loss: 0.50235746, Validation R2: 0.758146

Epoch 178/1000
Training Loss: 0.01301345, Training R2: 0.992594
Validation Loss: 0.50298816, Validation R2: 0.757616

Epoch 179/1000
Training Loss: 0.01484657, Training R2: 0.992631
Validation Loss: 0.50365549, Validation R2: 0.757306

Epoch 180/1000
Training Loss: 0.01709210, Training R2: 0.992666
Validation Loss: 0.50274392, Validation R2: 0.757698

Epoch 181/1000
Training Loss: 0.01377897, Training R2: 0.992689
Validation Loss: 0.50302919, Validation R2: 0.757368

Epoch 182/1000
Training Loss: 0.01298595, Training R2: 0.992671
Validation Loss: 0.50260016, Validation R2: 0.757845

Epoch 183/1000
Training Loss: 0.01369837, Training R2: 0.992741
Validation Loss: 0.50276839, Validation R2: 0.757873

Epoch 184/1000
Training Loss: 0.01362141, Training R2: 0.992741
Validation Loss: 0.50284571, Validation R2: 0.757778

Epoch 185/1000
Training Loss: 0.01562252, Training R2: 0.992722
Validation Loss: 0.50268119, Validation R2: 0.757419

Epoch 186/1000
Training Loss: 0.01535474, Training R2: 0.992788
Validation Loss: 0.50333149, Validation R2: 0.757627

Epoch 187/1000
Training Loss: 0.01484500, Training R2: 0.992788
Validation Loss: 0.50210211, Validation R2: 0.758232

Epoch 188/1000
Epoch 00188: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.01368336, Training R2: 0.992817
Validation Loss: 0.50235393, Validation R2: 0.758012

Epoch 189/1000
学习率已减少 4 次
Training Loss: 0.01190534, Training R2: 0.992877
Validation Loss: 0.50329720, Validation R2: 0.757369

Epoch 190/1000
Training Loss: 0.01010141, Training R2: 0.992928
Validation Loss: 0.50260255, Validation R2: 0.757818

Epoch 191/1000
Training Loss: 0.00885330, Training R2: 0.992943
Validation Loss: 0.50307900, Validation R2: 0.757704

Epoch 192/1000
Training Loss: 0.00926563, Training R2: 0.992950
Validation Loss: 0.50275823, Validation R2: 0.757720

Epoch 193/1000
Training Loss: 0.00915412, Training R2: 0.992956
Validation Loss: 0.50303006, Validation R2: 0.757471

Epoch 194/1000
Training Loss: 0.00919137, Training R2: 0.992978
Validation Loss: 0.50265208, Validation R2: 0.757575

Epoch 195/1000
Training Loss: 0.00908610, Training R2: 0.992960
Validation Loss: 0.50260981, Validation R2: 0.757938

Epoch 196/1000
Training Loss: 0.00840839, Training R2: 0.992994
Validation Loss: 0.50283085, Validation R2: 0.757516

Epoch 197/1000
Training Loss: 0.00882415, Training R2: 0.993000
Validation Loss: 0.50304947, Validation R2: 0.757568

Epoch 198/1000
Training Loss: 0.00964143, Training R2: 0.993029
Validation Loss: 0.50289319, Validation R2: 0.757753

Epoch 199/1000
Training Loss: 0.00921206, Training R2: 0.993014
Validation Loss: 0.50261566, Validation R2: 0.757909

Epoch 200/1000
Training Loss: 0.00867566, Training R2: 0.993076
Validation Loss: 0.50243452, Validation R2: 0.757931

Epoch 201/1000
Training Loss: 0.00893116, Training R2: 0.993034
Validation Loss: 0.50315149, Validation R2: 0.757670

Epoch 202/1000
Training Loss: 0.00912623, Training R2: 0.993063
Validation Loss: 0.50285764, Validation R2: 0.757657

Epoch 203/1000
Training Loss: 0.00987433, Training R2: 0.993064
Validation Loss: 0.50281232, Validation R2: 0.757711

Epoch 204/1000
Training Loss: 0.01281889, Training R2: 0.993083
Validation Loss: 0.50299851, Validation R2: 0.757594

Epoch 205/1000
Training Loss: 0.01019243, Training R2: 0.993102
Validation Loss: 0.50270392, Validation R2: 0.757820

Epoch 206/1000
Training Loss: 0.00938332, Training R2: 0.993172
Validation Loss: 0.50315272, Validation R2: 0.757738

Epoch 207/1000
Training Loss: 0.01050157, Training R2: 0.993135
Validation Loss: 0.50318046, Validation R2: 0.757391

Epoch 208/1000
Training Loss: 0.01289514, Training R2: 0.993102
Validation Loss: 0.50347825, Validation R2: 0.757407

Epoch 209/1000
Epoch 00209: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.01137562, Training R2: 0.993136
Validation Loss: 0.50244749, Validation R2: 0.757903

Epoch 210/1000
学习率已减少 5 次
Training Loss: 0.00837635, Training R2: 0.993156
Validation Loss: 0.50258974, Validation R2: 0.758044

Epoch 211/1000
Training Loss: 0.00730720, Training R2: 0.993182
Validation Loss: 0.50280071, Validation R2: 0.757740

Epoch 212/1000
Training Loss: 0.00663712, Training R2: 0.993199
Validation Loss: 0.50264728, Validation R2: 0.757684

Epoch 213/1000
Training Loss: 0.00684226, Training R2: 0.993192
Validation Loss: 0.50250448, Validation R2: 0.757871

Epoch 214/1000
Training Loss: 0.00636422, Training R2: 0.993211
Validation Loss: 0.50295050, Validation R2: 0.757671

Epoch 215/1000
Training Loss: 0.00641879, Training R2: 0.993104
Validation Loss: 0.50285135, Validation R2: 0.757717

Epoch 216/1000
Training Loss: 0.00623077, Training R2: 0.993253
Validation Loss: 0.50261637, Validation R2: 0.757750

Epoch 217/1000
Training Loss: 0.00647274, Training R2: 0.993247
Validation Loss: 0.50244929, Validation R2: 0.757888

Epoch 218/1000
Training Loss: 0.00627920, Training R2: 0.993240
Validation Loss: 0.50256133, Validation R2: 0.757838

Epoch 219/1000
Training Loss: 0.00642200, Training R2: 0.993257
Validation Loss: 0.50295190, Validation R2: 0.757795

Epoch 220/1000
Training Loss: 0.00688322, Training R2: 0.993254
Validation Loss: 0.50263878, Validation R2: 0.757882

Epoch 221/1000
Training Loss: 0.00666038, Training R2: 0.993270
Validation Loss: 0.50254736, Validation R2: 0.757779

Epoch 222/1000
Training Loss: 0.00622140, Training R2: 0.993293
Validation Loss: 0.50345227, Validation R2: 0.757445

Epoch 223/1000
Training Loss: 0.00634707, Training R2: 0.993281
Validation Loss: 0.50260447, Validation R2: 0.757866

Epoch 224/1000
Training Loss: 0.00649179, Training R2: 0.993303
Validation Loss: 0.50252850, Validation R2: 0.757843

Epoch 225/1000
Training Loss: 0.00698198, Training R2: 0.993308
Validation Loss: 0.50273516, Validation R2: 0.757601

Epoch 226/1000
Training Loss: 0.00671197, Training R2: 0.993304
Validation Loss: 0.50291455, Validation R2: 0.757653

Epoch 227/1000
Training Loss: 0.00664035, Training R2: 0.993332
Validation Loss: 0.50273919, Validation R2: 0.757722

Epoch 228/1000
Training Loss: 0.00654346, Training R2: 0.993321
Validation Loss: 0.50287030, Validation R2: 0.757704

Epoch 229/1000
Training Loss: 0.00719241, Training R2: 0.993326
Validation Loss: 0.50312233, Validation R2: 0.757666

Epoch 230/1000
Epoch 00230: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00690534, Training R2: 0.993337
Validation Loss: 0.50308139, Validation R2: 0.757617

Epoch 231/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
