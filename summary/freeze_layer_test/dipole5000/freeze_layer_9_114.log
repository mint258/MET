Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)
冻结层 6: interaction_blocks.3 (SimpleInteractionBlock)
冻结层 7: lins.0 (Linear)
冻结层 8: lins.1 (Linear)
冻结层 9: lins.2 (Linear)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Frozen
interaction_blocks.3.conv1.lin_rel.bias: Frozen
interaction_blocks.3.conv1.lin_root.weight: Frozen
interaction_blocks.3.conv2.lin_rel.weight: Frozen
interaction_blocks.3.conv2.lin_rel.bias: Frozen
interaction_blocks.3.conv2.lin_root.weight: Frozen
interaction_blocks.3.lin1.weight: Frozen
interaction_blocks.3.lin1.bias: Frozen
interaction_blocks.3.lin2.weight: Frozen
interaction_blocks.3.lin2.bias: Frozen
interaction_blocks.3.lin_cat.weight: Frozen
interaction_blocks.3.lin_cat.bias: Frozen
interaction_blocks.3.norm.weight: Frozen
interaction_blocks.3.norm.bias: Frozen
interaction_blocks.3.norm.mean_scale: Frozen
interaction_blocks.3.lin_feature1.lin1.weight: Frozen
interaction_blocks.3.lin_feature1.lin2.weight: Frozen
interaction_blocks.3.lin_feature2.lin1.weight: Frozen
interaction_blocks.3.lin_feature2.lin2.weight: Frozen
interaction_blocks.3.lin.weight: Frozen
interaction_blocks.3.lin.bias: Frozen
interaction_blocks.3.lins.0.weight: Frozen
interaction_blocks.3.lins.0.bias: Frozen
interaction_blocks.3.lins.1.weight: Frozen
interaction_blocks.3.lins.1.bias: Frozen
interaction_blocks.3.lins.2.weight: Frozen
interaction_blocks.3.lins.2.bias: Frozen
interaction_blocks.3.lins.3.weight: Frozen
interaction_blocks.3.lins.3.bias: Frozen
interaction_blocks.3.final.weight: Frozen
interaction_blocks.3.final.bias: Frozen
lins.0.weight: Frozen
lins.0.bias: Frozen
lins.1.weight: Frozen
lins.1.bias: Frozen
lins.2.weight: Frozen
lins.2.bias: Frozen
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 1026435

Epoch 1/1000
Training Loss: 1.25099162, Training R2: -0.125324
Validation Loss: 1.19951210, Validation R2: -0.015620
Saved best model with validation R2 -0.015620 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.17311760, Training R2: -0.009692
Validation Loss: 1.18374087, Validation R2: 0.007104
Saved best model with validation R2 0.007104 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.15239829, Training R2: 0.005645
Validation Loss: 1.16108846, Validation R2: 0.055153
Saved best model with validation R2 0.055153 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 1.12161264, Training R2: 0.071925
Validation Loss: 1.14133283, Validation R2: 0.086409
Saved best model with validation R2 0.086409 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.10691015, Training R2: 0.087018
Validation Loss: 1.12657617, Validation R2: 0.086233

Epoch 6/1000
Training Loss: 1.09246140, Training R2: 0.094233
Validation Loss: 1.12547348, Validation R2: 0.069391

Epoch 7/1000
Training Loss: 1.07299314, Training R2: 0.124634
Validation Loss: 1.15664296, Validation R2: 0.097934
Saved best model with validation R2 0.097934 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 1.07711925, Training R2: 0.126947
Validation Loss: 1.15340423, Validation R2: -0.013923

Epoch 9/1000
Training Loss: 1.08149504, Training R2: 0.111070
Validation Loss: 1.11767367, Validation R2: 0.092821

Epoch 10/1000
Training Loss: 1.05794019, Training R2: 0.144902
Validation Loss: 1.10509118, Validation R2: 0.123437
Saved best model with validation R2 0.123437 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 1.04555045, Training R2: 0.160662
Validation Loss: 1.09941071, Validation R2: 0.125792
Saved best model with validation R2 0.125792 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 1.05433486, Training R2: 0.148038
Validation Loss: 1.10388054, Validation R2: 0.129225
Saved best model with validation R2 0.129225 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 1.03650840, Training R2: 0.179355
Validation Loss: 1.09573639, Validation R2: 0.137777
Saved best model with validation R2 0.137777 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 1.04094761, Training R2: 0.171520
Validation Loss: 1.08857680, Validation R2: 0.144679
Saved best model with validation R2 0.144679 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 1.02040670, Training R2: 0.196974
Validation Loss: 1.06922101, Validation R2: 0.159069
Saved best model with validation R2 0.159069 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 1.04160761, Training R2: 0.166302
Validation Loss: 1.11475866, Validation R2: 0.137732

Epoch 17/1000
Training Loss: 1.02021047, Training R2: 0.190317
Validation Loss: 1.07078865, Validation R2: 0.159611
Saved best model with validation R2 0.159611 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 1.01137210, Training R2: 0.207541
Validation Loss: 1.08810611, Validation R2: 0.123594

Epoch 19/1000
Training Loss: 1.02429909, Training R2: 0.196513
Validation Loss: 1.06986835, Validation R2: 0.162366
Saved best model with validation R2 0.162366 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 1.02160907, Training R2: 0.191723
Validation Loss: 1.06617701, Validation R2: 0.146569

Epoch 21/1000
Training Loss: 0.98233019, Training R2: 0.240521
Validation Loss: 1.05107929, Validation R2: 0.169211
Saved best model with validation R2 0.169211 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.99558104, Training R2: 0.223558
Validation Loss: 1.04265944, Validation R2: 0.185275
Saved best model with validation R2 0.185275 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.98692616, Training R2: 0.231444
Validation Loss: 1.07448076, Validation R2: 0.091582

Epoch 24/1000
Training Loss: 1.00253210, Training R2: 0.219381
Validation Loss: 1.05347660, Validation R2: 0.138933

Epoch 25/1000
Training Loss: 0.97476753, Training R2: 0.246083
Validation Loss: 1.03155817, Validation R2: 0.187209
Saved best model with validation R2 0.187209 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.97174073, Training R2: 0.240914
Validation Loss: 1.06309680, Validation R2: 0.114891

Epoch 27/1000
Training Loss: 0.97430201, Training R2: 0.247655
Validation Loss: 1.01263356, Validation R2: 0.207476
Saved best model with validation R2 0.207476 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.95086221, Training R2: 0.266510
Validation Loss: 1.00669904, Validation R2: 0.233935
Saved best model with validation R2 0.233935 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.94194672, Training R2: 0.278746
Validation Loss: 1.00663296, Validation R2: 0.214929

Epoch 30/1000
Training Loss: 0.98893064, Training R2: 0.216127
Validation Loss: 1.02235645, Validation R2: 0.185944

Epoch 31/1000
Training Loss: 0.96991432, Training R2: 0.241475
Validation Loss: 1.01868168, Validation R2: 0.186595

Epoch 32/1000
Training Loss: 0.95976961, Training R2: 0.258948
Validation Loss: 0.99955188, Validation R2: 0.220041

Epoch 33/1000
Training Loss: 0.93507300, Training R2: 0.287914
Validation Loss: 1.00162426, Validation R2: 0.216113

Epoch 34/1000
Training Loss: 0.94376476, Training R2: 0.274304
Validation Loss: 0.98665749, Validation R2: 0.237182
Saved best model with validation R2 0.237182 to best_finetuned_model.pth

Epoch 35/1000
Training Loss: 0.93964564, Training R2: 0.279615
Validation Loss: 1.03386143, Validation R2: 0.134605

Epoch 36/1000
Training Loss: 0.95911876, Training R2: 0.241363
Validation Loss: 1.03022320, Validation R2: 0.217861

Epoch 37/1000
Training Loss: 0.93927674, Training R2: 0.285619
Validation Loss: 1.00095736, Validation R2: 0.240091
Saved best model with validation R2 0.240091 to best_finetuned_model.pth

Epoch 38/1000
Training Loss: 0.94181782, Training R2: 0.273382
Validation Loss: 0.98493070, Validation R2: 0.254406
Saved best model with validation R2 0.254406 to best_finetuned_model.pth

Epoch 39/1000
Training Loss: 0.92860592, Training R2: 0.297579
Validation Loss: 0.96280524, Validation R2: 0.260848
Saved best model with validation R2 0.260848 to best_finetuned_model.pth

Epoch 40/1000
Training Loss: 0.91675824, Training R2: 0.300237
Validation Loss: 1.00786014, Validation R2: 0.217925

Epoch 41/1000
Training Loss: 0.92689401, Training R2: 0.294168
Validation Loss: 1.03083253, Validation R2: 0.141147

Epoch 42/1000
Training Loss: 0.93151414, Training R2: 0.287437
Validation Loss: 0.97539028, Validation R2: 0.260536

Epoch 43/1000
Training Loss: 0.89647782, Training R2: 0.330732
Validation Loss: 0.98423844, Validation R2: 0.215646

Epoch 44/1000
Training Loss: 0.93371999, Training R2: 0.292327
Validation Loss: 0.96893953, Validation R2: 0.264978
Saved best model with validation R2 0.264978 to best_finetuned_model.pth

Epoch 45/1000
Training Loss: 0.90650284, Training R2: 0.310652
Validation Loss: 0.99830412, Validation R2: 0.252558

Epoch 46/1000
Training Loss: 0.89725199, Training R2: 0.325811
Validation Loss: 0.97617184, Validation R2: 0.262112

Epoch 47/1000
Training Loss: 0.90496989, Training R2: 0.313399
Validation Loss: 0.97605606, Validation R2: 0.238021

Epoch 48/1000
Training Loss: 0.91670625, Training R2: 0.304313
Validation Loss: 0.97322182, Validation R2: 0.267869
Saved best model with validation R2 0.267869 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.88259904, Training R2: 0.337615
Validation Loss: 0.95954815, Validation R2: 0.246325

Epoch 50/1000
Training Loss: 0.87777177, Training R2: 0.349418
Validation Loss: 0.97384459, Validation R2: 0.246126

Epoch 51/1000
Training Loss: 0.88681173, Training R2: 0.341100
Validation Loss: 0.95575101, Validation R2: 0.264890

Epoch 52/1000
Training Loss: 0.87531569, Training R2: 0.350807
Validation Loss: 0.97019292, Validation R2: 0.239713

Epoch 53/1000
Training Loss: 0.86157550, Training R2: 0.356110
Validation Loss: 0.98921026, Validation R2: 0.212081

Epoch 54/1000
Training Loss: 0.86861972, Training R2: 0.349470
Validation Loss: 0.95894927, Validation R2: 0.272061
Saved best model with validation R2 0.272061 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.85363037, Training R2: 0.366325
Validation Loss: 0.96878587, Validation R2: 0.279807
Saved best model with validation R2 0.279807 to best_finetuned_model.pth

Epoch 56/1000
Training Loss: 0.89377785, Training R2: 0.317537
Validation Loss: 1.09641695, Validation R2: 0.049383

Epoch 57/1000
Training Loss: 0.92792556, Training R2: 0.283691
Validation Loss: 0.98862255, Validation R2: 0.203045

Epoch 58/1000
Training Loss: 0.88014600, Training R2: 0.349849
Validation Loss: 0.95264226, Validation R2: 0.270643

Epoch 59/1000
Training Loss: 0.84849650, Training R2: 0.367839
Validation Loss: 0.99517754, Validation R2: 0.242036

Epoch 60/1000
Training Loss: 0.83468514, Training R2: 0.387674
Validation Loss: 0.97177889, Validation R2: 0.259160

Epoch 61/1000
Training Loss: 0.85535262, Training R2: 0.359165
Validation Loss: 0.96352041, Validation R2: 0.262098

Epoch 62/1000
Training Loss: 0.83680183, Training R2: 0.387859
Validation Loss: 0.94813767, Validation R2: 0.272590

Epoch 63/1000
Training Loss: 0.82021570, Training R2: 0.401242
Validation Loss: 0.97432343, Validation R2: 0.248790

Epoch 64/1000
Training Loss: 0.86326063, Training R2: 0.363366
Validation Loss: 0.97931993, Validation R2: 0.216895

Epoch 65/1000
Training Loss: 0.83325987, Training R2: 0.393617
Validation Loss: 0.95654507, Validation R2: 0.257514

Epoch 66/1000
Training Loss: 0.81885393, Training R2: 0.399890
Validation Loss: 0.94360193, Validation R2: 0.273831

Epoch 67/1000
Training Loss: 0.82055158, Training R2: 0.405537
Validation Loss: 0.98073824, Validation R2: 0.195128

Epoch 68/1000
Training Loss: 0.84086496, Training R2: 0.383774
Validation Loss: 0.99047696, Validation R2: 0.227883

Epoch 69/1000
Training Loss: 0.83755577, Training R2: 0.385380
Validation Loss: 0.95952927, Validation R2: 0.251569

Epoch 70/1000
Training Loss: 0.80623201, Training R2: 0.418905
Validation Loss: 0.97984199, Validation R2: 0.254902

Epoch 71/1000
Training Loss: 0.83793780, Training R2: 0.387754
Validation Loss: 0.97613096, Validation R2: 0.233686

Epoch 72/1000
Training Loss: 0.81056836, Training R2: 0.415022
Validation Loss: 0.94627494, Validation R2: 0.270054

Epoch 73/1000
Training Loss: 0.78147163, Training R2: 0.437126
Validation Loss: 0.96382668, Validation R2: 0.260749

Epoch 74/1000
Training Loss: 0.77647642, Training R2: 0.445608
Validation Loss: 0.96968754, Validation R2: 0.249585

Epoch 75/1000
Training Loss: 0.79451956, Training R2: 0.426640
Validation Loss: 1.00655547, Validation R2: 0.228500

Epoch 76/1000
Epoch 00076: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.81984991, Training R2: 0.404124
Validation Loss: 0.95982807, Validation R2: 0.244244

Epoch 77/1000
学习率已减少 1 次
Training Loss: 0.78599077, Training R2: 0.440834
Validation Loss: 0.96349151, Validation R2: 0.237756

Epoch 78/1000
Training Loss: 0.75237852, Training R2: 0.469356
Validation Loss: 0.95510061, Validation R2: 0.244979

Epoch 79/1000
Training Loss: 0.75500869, Training R2: 0.469435
Validation Loss: 0.94697560, Validation R2: 0.248046

Epoch 80/1000
Training Loss: 0.72791335, Training R2: 0.493739
Validation Loss: 0.96088734, Validation R2: 0.243628

Epoch 81/1000
Training Loss: 0.71617331, Training R2: 0.504957
Validation Loss: 0.95789792, Validation R2: 0.243891

Epoch 82/1000
Training Loss: 0.71351332, Training R2: 0.504298
Validation Loss: 0.96704705, Validation R2: 0.232427

Epoch 83/1000
Training Loss: 0.71858371, Training R2: 0.504075
Validation Loss: 0.96970112, Validation R2: 0.239001

Epoch 84/1000
Training Loss: 0.70792951, Training R2: 0.513667
Validation Loss: 0.96504551, Validation R2: 0.228664

Epoch 85/1000
Training Loss: 0.70068655, Training R2: 0.519920
Validation Loss: 0.95976359, Validation R2: 0.234530

Epoch 86/1000
Training Loss: 0.69776188, Training R2: 0.523946
Validation Loss: 0.96269852, Validation R2: 0.238036

Epoch 87/1000
Training Loss: 0.68763093, Training R2: 0.532843
Validation Loss: 0.96476335, Validation R2: 0.242091

Epoch 88/1000
Training Loss: 0.67836790, Training R2: 0.541877
Validation Loss: 0.97475118, Validation R2: 0.213704

Epoch 89/1000
Training Loss: 0.67939379, Training R2: 0.536870
Validation Loss: 0.98261754, Validation R2: 0.230187

Epoch 90/1000
Training Loss: 0.67529245, Training R2: 0.543476
Validation Loss: 0.96462024, Validation R2: 0.222189

Epoch 91/1000
Training Loss: 0.65982224, Training R2: 0.559797
Validation Loss: 0.97838464, Validation R2: 0.233455

Epoch 92/1000
Training Loss: 0.67703658, Training R2: 0.543220
Validation Loss: 0.96559875, Validation R2: 0.234315

Epoch 93/1000
Training Loss: 0.66320473, Training R2: 0.556804
Validation Loss: 0.96323200, Validation R2: 0.234322

Epoch 94/1000
Training Loss: 0.67371697, Training R2: 0.549855
Validation Loss: 0.97250338, Validation R2: 0.216288

Epoch 95/1000
Training Loss: 0.65894262, Training R2: 0.561337
Validation Loss: 0.98248551, Validation R2: 0.217971

Epoch 96/1000
Training Loss: 0.67373362, Training R2: 0.551868
Validation Loss: 0.97897972, Validation R2: 0.216135

Epoch 97/1000
Epoch 00097: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.69371049, Training R2: 0.535488
Validation Loss: 1.01766334, Validation R2: 0.188828

Epoch 98/1000
学习率已减少 2 次
Training Loss: 0.64612220, Training R2: 0.577726
Validation Loss: 0.97593019, Validation R2: 0.224481

Epoch 99/1000
Training Loss: 0.61722512, Training R2: 0.596580
Validation Loss: 0.97723582, Validation R2: 0.216886

Epoch 100/1000
Training Loss: 0.60791231, Training R2: 0.604780
Validation Loss: 0.97563949, Validation R2: 0.216442

Epoch 101/1000
Training Loss: 0.60532253, Training R2: 0.605712
Validation Loss: 0.97145050, Validation R2: 0.216537

Epoch 102/1000
Training Loss: 0.59800753, Training R2: 0.613158
Validation Loss: 0.97665985, Validation R2: 0.214621

Epoch 103/1000
Training Loss: 0.59344500, Training R2: 0.614287
Validation Loss: 0.98762602, Validation R2: 0.192698

Epoch 104/1000
Training Loss: 0.59648453, Training R2: 0.616789
Validation Loss: 0.98268400, Validation R2: 0.206070

Epoch 105/1000
Training Loss: 0.59501682, Training R2: 0.618379
Validation Loss: 0.98526480, Validation R2: 0.207927

Epoch 106/1000
Training Loss: 0.58334351, Training R2: 0.621996
Validation Loss: 0.97271911, Validation R2: 0.225441

Epoch 107/1000
Training Loss: 0.57557733, Training R2: 0.629932
Validation Loss: 0.98010949, Validation R2: 0.215138

Epoch 108/1000
Training Loss: 0.57685909, Training R2: 0.627128
Validation Loss: 0.98201366, Validation R2: 0.203983

Epoch 109/1000
Training Loss: 0.56899929, Training R2: 0.637688
Validation Loss: 0.98568331, Validation R2: 0.196757

Epoch 110/1000
Training Loss: 0.57884330, Training R2: 0.630718
Validation Loss: 0.98024219, Validation R2: 0.208837

Epoch 111/1000
Training Loss: 0.57377918, Training R2: 0.636534
Validation Loss: 0.98074677, Validation R2: 0.202489

Epoch 112/1000
Training Loss: 0.57434574, Training R2: 0.640609
Validation Loss: 0.99374925, Validation R2: 0.179192

Epoch 113/1000
Training Loss: 0.57712609, Training R2: 0.637381
Validation Loss: 0.99520413, Validation R2: 0.184072

Epoch 114/1000
Training Loss: 0.56708429, Training R2: 0.645790
Validation Loss: 0.99077880, Validation R2: 0.195995

Epoch 115/1000
Training Loss: 0.56569628, Training R2: 0.645657
Validation Loss: 1.00284778, Validation R2: 0.187353

Epoch 116/1000
Training Loss: 0.55582595, Training R2: 0.651868
Validation Loss: 0.99102031, Validation R2: 0.197262

Epoch 117/1000
Training Loss: 0.54024619, Training R2: 0.660716
Validation Loss: 0.99157887, Validation R2: 0.190765

Epoch 118/1000
Epoch 00118: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.55014443, Training R2: 0.655072
Validation Loss: 0.98231806, Validation R2: 0.205438

Epoch 119/1000
学习率已减少 3 次
Training Loss: 0.53777739, Training R2: 0.663792
Validation Loss: 1.00002271, Validation R2: 0.190362

Epoch 120/1000
Training Loss: 0.53116054, Training R2: 0.668781
Validation Loss: 0.99267319, Validation R2: 0.184361

Epoch 121/1000
Training Loss: 0.52433261, Training R2: 0.672085
Validation Loss: 0.99147988, Validation R2: 0.192224

Epoch 122/1000
Training Loss: 0.51574583, Training R2: 0.677952
Validation Loss: 0.98962546, Validation R2: 0.192961

Epoch 123/1000
Training Loss: 0.51907266, Training R2: 0.676530
Validation Loss: 0.99379856, Validation R2: 0.184968

Epoch 124/1000
Training Loss: 0.51272626, Training R2: 0.680038
Validation Loss: 0.99277470, Validation R2: 0.182076

Epoch 125/1000
Training Loss: 0.51149347, Training R2: 0.681383
Validation Loss: 0.99208983, Validation R2: 0.187414

Epoch 126/1000
Training Loss: 0.51137652, Training R2: 0.679989
Validation Loss: 0.99571088, Validation R2: 0.181417

Epoch 127/1000
Training Loss: 0.50764934, Training R2: 0.685451
Validation Loss: 0.99448105, Validation R2: 0.187793

Epoch 128/1000
Training Loss: 0.50239962, Training R2: 0.689601
Validation Loss: 0.99612731, Validation R2: 0.186194

Epoch 129/1000
Training Loss: 0.50152822, Training R2: 0.689058
Validation Loss: 0.99206219, Validation R2: 0.193170

Epoch 130/1000
Training Loss: 0.49977790, Training R2: 0.689984
Validation Loss: 0.99925326, Validation R2: 0.184468

Epoch 131/1000
Training Loss: 0.49874833, Training R2: 0.692002
Validation Loss: 1.00070708, Validation R2: 0.186250

Epoch 132/1000
Training Loss: 0.49857307, Training R2: 0.691201
Validation Loss: 0.99966932, Validation R2: 0.180444

Epoch 133/1000
Training Loss: 0.49397974, Training R2: 0.696289
Validation Loss: 0.99879602, Validation R2: 0.181897

Epoch 134/1000
Training Loss: 0.49440717, Training R2: 0.695369
Validation Loss: 0.99996546, Validation R2: 0.188121

Epoch 135/1000
Training Loss: 0.48681169, Training R2: 0.698807
Validation Loss: 1.00028255, Validation R2: 0.179158

Epoch 136/1000
Training Loss: 0.48546138, Training R2: 0.700733
Validation Loss: 0.99910830, Validation R2: 0.182173

Epoch 137/1000
Training Loss: 0.48552387, Training R2: 0.700033
Validation Loss: 0.99959157, Validation R2: 0.181374

Epoch 138/1000
Training Loss: 0.47970419, Training R2: 0.705055
Validation Loss: 0.99615040, Validation R2: 0.187218

Epoch 139/1000
Epoch 00139: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.48032177, Training R2: 0.704236
Validation Loss: 1.00447115, Validation R2: 0.177519

Epoch 140/1000
学习率已减少 4 次
Training Loss: 0.47694627, Training R2: 0.705602
Validation Loss: 0.99815166, Validation R2: 0.176008

Epoch 141/1000
Training Loss: 0.47511097, Training R2: 0.706569
Validation Loss: 1.00378134, Validation R2: 0.180076

Epoch 142/1000
Training Loss: 0.46775423, Training R2: 0.710522
Validation Loss: 1.00473892, Validation R2: 0.174961

Epoch 143/1000
Training Loss: 0.46703359, Training R2: 0.710612
Validation Loss: 1.00250214, Validation R2: 0.177198

Epoch 144/1000
Training Loss: 0.46490055, Training R2: 0.710037
Validation Loss: 1.00284175, Validation R2: 0.182070

Epoch 145/1000
Training Loss: 0.46402642, Training R2: 0.713129
Validation Loss: 1.00805539, Validation R2: 0.173210

Epoch 146/1000
Training Loss: 0.46503227, Training R2: 0.710617
Validation Loss: 0.99973778, Validation R2: 0.178446

Epoch 147/1000
Training Loss: 0.46291138, Training R2: 0.713291
Validation Loss: 1.00591045, Validation R2: 0.172982

Epoch 148/1000
Training Loss: 0.46050958, Training R2: 0.714355
Validation Loss: 1.00240621, Validation R2: 0.179035

Epoch 149/1000
Training Loss: 0.46180713, Training R2: 0.714846
Validation Loss: 1.00912027, Validation R2: 0.175295

Epoch 150/1000
Training Loss: 0.45855929, Training R2: 0.716546
Validation Loss: 1.00946537, Validation R2: 0.175501

Epoch 151/1000
Training Loss: 0.45760775, Training R2: 0.717005
Validation Loss: 1.00835403, Validation R2: 0.174675

Epoch 152/1000
Training Loss: 0.45544434, Training R2: 0.717094
Validation Loss: 1.00203375, Validation R2: 0.179741

Epoch 153/1000
Training Loss: 0.45999141, Training R2: 0.715517
Validation Loss: 1.00524191, Validation R2: 0.174123

Epoch 154/1000
Training Loss: 0.45686322, Training R2: 0.718781
Validation Loss: 1.00670155, Validation R2: 0.175734

Epoch 155/1000
Training Loss: 0.45183094, Training R2: 0.720987
Validation Loss: 1.00718673, Validation R2: 0.175147

Epoch 156/1000
Training Loss: 0.45225574, Training R2: 0.720053
Validation Loss: 1.00663187, Validation R2: 0.175980

Epoch 157/1000
Training Loss: 0.44933691, Training R2: 0.722200
Validation Loss: 1.00753854, Validation R2: 0.172789

Epoch 158/1000
Training Loss: 0.45142896, Training R2: 0.718817
Validation Loss: 1.01037342, Validation R2: 0.169126

Epoch 159/1000
Training Loss: 0.45251630, Training R2: 0.721500
Validation Loss: 1.00655969, Validation R2: 0.177339

Epoch 160/1000
Epoch 00160: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.45272216, Training R2: 0.719389
Validation Loss: 1.00727401, Validation R2: 0.174072

Epoch 161/1000
学习率已减少 5 次
Training Loss: 0.44637845, Training R2: 0.723512
Validation Loss: 1.00737970, Validation R2: 0.175367

Epoch 162/1000
Training Loss: 0.44317888, Training R2: 0.725181
Validation Loss: 1.00879396, Validation R2: 0.172180

Epoch 163/1000
Training Loss: 0.43987643, Training R2: 0.726556
Validation Loss: 1.00791433, Validation R2: 0.171645

Epoch 164/1000
Training Loss: 0.44107309, Training R2: 0.724821
Validation Loss: 1.01120430, Validation R2: 0.169141

Epoch 165/1000
Training Loss: 0.44061649, Training R2: 0.726064
Validation Loss: 1.00821109, Validation R2: 0.172901

Epoch 166/1000
Training Loss: 0.44158960, Training R2: 0.725086
Validation Loss: 1.00693410, Validation R2: 0.174912

Epoch 167/1000
Training Loss: 0.43991460, Training R2: 0.725169
Validation Loss: 1.00652079, Validation R2: 0.175321

Epoch 168/1000
Training Loss: 0.43795402, Training R2: 0.725696
Validation Loss: 1.00546921, Validation R2: 0.176033

Epoch 169/1000
Training Loss: 0.43614883, Training R2: 0.727008
Validation Loss: 1.00863031, Validation R2: 0.173474

Epoch 170/1000
Training Loss: 0.43485725, Training R2: 0.728524
Validation Loss: 1.00749602, Validation R2: 0.173842

Epoch 171/1000
Training Loss: 0.43567478, Training R2: 0.728114
Validation Loss: 1.00752202, Validation R2: 0.173478

Epoch 172/1000
Training Loss: 0.43700533, Training R2: 0.726934
Validation Loss: 1.00845450, Validation R2: 0.172480

Epoch 173/1000
Training Loss: 0.43570653, Training R2: 0.726930
Validation Loss: 1.00979318, Validation R2: 0.172382

Epoch 174/1000
Training Loss: 0.43401019, Training R2: 0.729654
Validation Loss: 1.00777431, Validation R2: 0.173929

Epoch 175/1000
Training Loss: 0.43451996, Training R2: 0.729647
Validation Loss: 1.00902102, Validation R2: 0.171747

Epoch 176/1000
Training Loss: 0.43364399, Training R2: 0.729427
Validation Loss: 1.00827441, Validation R2: 0.175121

Epoch 177/1000
Training Loss: 0.43465353, Training R2: 0.728688
Validation Loss: 1.00937661, Validation R2: 0.171492

Epoch 178/1000
Training Loss: 0.43333277, Training R2: 0.729850
Validation Loss: 1.00874747, Validation R2: 0.171394

Epoch 179/1000
Training Loss: 0.43183260, Training R2: 0.730228
Validation Loss: 1.00815064, Validation R2: 0.171967

Epoch 180/1000
Training Loss: 0.43146498, Training R2: 0.730934
Validation Loss: 1.00768564, Validation R2: 0.173072

Epoch 181/1000
Epoch 00181: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.43077600, Training R2: 0.730960
Validation Loss: 1.00872249, Validation R2: 0.171771

Epoch 182/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
