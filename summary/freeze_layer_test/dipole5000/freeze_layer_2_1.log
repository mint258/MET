Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5293187

Epoch 1/1000
Training Loss: 1.38058815, Training R2: -0.408786
Validation Loss: 1.10451589, Validation R2: 0.131471
Saved best model with validation R2 0.131471 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.03175235, Training R2: 0.213282
Validation Loss: 0.90026967, Validation R2: 0.361812
Saved best model with validation R2 0.361812 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.88222672, Training R2: 0.380070
Validation Loss: 0.82653333, Validation R2: 0.447114
Saved best model with validation R2 0.447114 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.79125557, Training R2: 0.473841
Validation Loss: 0.76079890, Validation R2: 0.528293
Saved best model with validation R2 0.528293 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.71771323, Training R2: 0.547043
Validation Loss: 0.70584752, Validation R2: 0.563238
Saved best model with validation R2 0.563238 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.65964655, Training R2: 0.601970
Validation Loss: 0.69478707, Validation R2: 0.577645
Saved best model with validation R2 0.577645 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.62373925, Training R2: 0.638457
Validation Loss: 0.64374512, Validation R2: 0.619033
Saved best model with validation R2 0.619033 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.54917335, Training R2: 0.706998
Validation Loss: 0.60635701, Validation R2: 0.656842
Saved best model with validation R2 0.656842 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.49141304, Training R2: 0.756369
Validation Loss: 0.58698529, Validation R2: 0.675580
Saved best model with validation R2 0.675580 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.46966091, Training R2: 0.778550
Validation Loss: 0.57542000, Validation R2: 0.695379
Saved best model with validation R2 0.695379 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.42889784, Training R2: 0.811897
Validation Loss: 0.56425123, Validation R2: 0.728554
Saved best model with validation R2 0.728554 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.42463819, Training R2: 0.819739
Validation Loss: 0.58329722, Validation R2: 0.707533

Epoch 13/1000
Training Loss: 0.37291946, Training R2: 0.855146
Validation Loss: 0.51857972, Validation R2: 0.750387
Saved best model with validation R2 0.750387 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.31852147, Training R2: 0.883893
Validation Loss: 0.50279029, Validation R2: 0.767564
Saved best model with validation R2 0.767564 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.29344671, Training R2: 0.898316
Validation Loss: 0.48167057, Validation R2: 0.785648
Saved best model with validation R2 0.785648 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.27789094, Training R2: 0.906674
Validation Loss: 0.49201933, Validation R2: 0.772328

Epoch 17/1000
Training Loss: 0.27692004, Training R2: 0.911570
Validation Loss: 0.51505872, Validation R2: 0.747030

Epoch 18/1000
Training Loss: 0.27429816, Training R2: 0.915015
Validation Loss: 0.48562966, Validation R2: 0.781119

Epoch 19/1000
Training Loss: 0.25528543, Training R2: 0.924267
Validation Loss: 0.47887529, Validation R2: 0.793702
Saved best model with validation R2 0.793702 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.21869183, Training R2: 0.936145
Validation Loss: 0.46225185, Validation R2: 0.794682
Saved best model with validation R2 0.794682 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.23231297, Training R2: 0.937251
Validation Loss: 0.48273067, Validation R2: 0.777976

Epoch 22/1000
Training Loss: 0.20423525, Training R2: 0.946924
Validation Loss: 0.48245263, Validation R2: 0.788860

Epoch 23/1000
Training Loss: 0.20173181, Training R2: 0.947420
Validation Loss: 0.45554131, Validation R2: 0.808374
Saved best model with validation R2 0.808374 to best_finetuned_model.pth

Epoch 24/1000
Training Loss: 0.20589637, Training R2: 0.947705
Validation Loss: 0.49901956, Validation R2: 0.778335

Epoch 25/1000
Training Loss: 0.19563445, Training R2: 0.950575
Validation Loss: 0.45259385, Validation R2: 0.811999
Saved best model with validation R2 0.811999 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.17644069, Training R2: 0.956012
Validation Loss: 0.46165482, Validation R2: 0.806470

Epoch 27/1000
Training Loss: 0.17285335, Training R2: 0.959360
Validation Loss: 0.44755476, Validation R2: 0.802644

Epoch 28/1000
Training Loss: 0.17716828, Training R2: 0.958095
Validation Loss: 0.45328906, Validation R2: 0.799897

Epoch 29/1000
Training Loss: 0.16709736, Training R2: 0.960827
Validation Loss: 0.45357010, Validation R2: 0.812577
Saved best model with validation R2 0.812577 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.16036327, Training R2: 0.964016
Validation Loss: 0.44741622, Validation R2: 0.804709

Epoch 31/1000
Training Loss: 0.16364709, Training R2: 0.965188
Validation Loss: 0.46540370, Validation R2: 0.800142

Epoch 32/1000
Training Loss: 0.17319774, Training R2: 0.962813
Validation Loss: 0.45812696, Validation R2: 0.803674

Epoch 33/1000
Training Loss: 0.17334674, Training R2: 0.964641
Validation Loss: 0.44758632, Validation R2: 0.807588

Epoch 34/1000
Training Loss: 0.17038079, Training R2: 0.965824
Validation Loss: 0.43485070, Validation R2: 0.817075
Saved best model with validation R2 0.817075 to best_finetuned_model.pth

Epoch 35/1000
Training Loss: 0.14371683, Training R2: 0.970663
Validation Loss: 0.44243627, Validation R2: 0.814600

Epoch 36/1000
Training Loss: 0.13651080, Training R2: 0.974147
Validation Loss: 0.43389771, Validation R2: 0.826469
Saved best model with validation R2 0.826469 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.13422345, Training R2: 0.974731
Validation Loss: 0.44719164, Validation R2: 0.811771

Epoch 38/1000
Training Loss: 0.13540844, Training R2: 0.975864
Validation Loss: 0.43506240, Validation R2: 0.821560

Epoch 39/1000
Training Loss: 0.12612038, Training R2: 0.977109
Validation Loss: 0.42902793, Validation R2: 0.824474

Epoch 40/1000
Training Loss: 0.12421238, Training R2: 0.977693
Validation Loss: 0.44264200, Validation R2: 0.814627

Epoch 41/1000
Training Loss: 0.12947358, Training R2: 0.977344
Validation Loss: 0.44778723, Validation R2: 0.801973

Epoch 42/1000
Training Loss: 0.12493502, Training R2: 0.978551
Validation Loss: 0.44239136, Validation R2: 0.815105

Epoch 43/1000
Training Loss: 0.11221802, Training R2: 0.980753
Validation Loss: 0.43886612, Validation R2: 0.814825

Epoch 44/1000
Training Loss: 0.11509723, Training R2: 0.980719
Validation Loss: 0.44006651, Validation R2: 0.812257

Epoch 45/1000
Training Loss: 0.12215402, Training R2: 0.979043
Validation Loss: 0.43254560, Validation R2: 0.820048

Epoch 46/1000
Training Loss: 0.10873804, Training R2: 0.982527
Validation Loss: 0.43570188, Validation R2: 0.821747

Epoch 47/1000
Training Loss: 0.12268673, Training R2: 0.981304
Validation Loss: 0.43255862, Validation R2: 0.817760

Epoch 48/1000
Training Loss: 0.11773232, Training R2: 0.981423
Validation Loss: 0.45724329, Validation R2: 0.809893

Epoch 49/1000
Training Loss: 0.13747632, Training R2: 0.977635
Validation Loss: 0.42546074, Validation R2: 0.821835

Epoch 50/1000
Training Loss: 0.10300873, Training R2: 0.984440
Validation Loss: 0.44031975, Validation R2: 0.809161

Epoch 51/1000
Training Loss: 0.10197060, Training R2: 0.984539
Validation Loss: 0.42947762, Validation R2: 0.817763

Epoch 52/1000
Training Loss: 0.11447600, Training R2: 0.983108
Validation Loss: 0.42161834, Validation R2: 0.825866

Epoch 53/1000
Training Loss: 0.11362726, Training R2: 0.982931
Validation Loss: 0.42513727, Validation R2: 0.825020

Epoch 54/1000
Training Loss: 0.10771636, Training R2: 0.983646
Validation Loss: 0.43511967, Validation R2: 0.821776

Epoch 55/1000
Training Loss: 0.13590234, Training R2: 0.979704
Validation Loss: 0.43206786, Validation R2: 0.819606

Epoch 56/1000
Training Loss: 0.10801902, Training R2: 0.984338
Validation Loss: 0.42744892, Validation R2: 0.819293

Epoch 57/1000
Epoch 00057: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.10089369, Training R2: 0.985220
Validation Loss: 0.41958272, Validation R2: 0.823471

Epoch 58/1000
学习率已减少 1 次
Training Loss: 0.08669322, Training R2: 0.987085
Validation Loss: 0.41023164, Validation R2: 0.835638
Saved best model with validation R2 0.835638 to best_finetuned_model.pth

Epoch 59/1000
Training Loss: 0.06845821, Training R2: 0.989134
Validation Loss: 0.40891517, Validation R2: 0.834268

Epoch 60/1000
Training Loss: 0.05404133, Training R2: 0.990743
Validation Loss: 0.40982785, Validation R2: 0.839283
Saved best model with validation R2 0.839283 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.04939332, Training R2: 0.990818
Validation Loss: 0.40880210, Validation R2: 0.836780

Epoch 62/1000
Training Loss: 0.05483955, Training R2: 0.991025
Validation Loss: 0.40747014, Validation R2: 0.838424

Epoch 63/1000
Training Loss: 0.05317343, Training R2: 0.990846
Validation Loss: 0.40991582, Validation R2: 0.837681

Epoch 64/1000
Training Loss: 0.04998940, Training R2: 0.991377
Validation Loss: 0.41161665, Validation R2: 0.829648

Epoch 65/1000
Training Loss: 0.04806776, Training R2: 0.991319
Validation Loss: 0.41520815, Validation R2: 0.829335

Epoch 66/1000
Training Loss: 0.04372088, Training R2: 0.991744
Validation Loss: 0.41307384, Validation R2: 0.829736

Epoch 67/1000
Training Loss: 0.05457190, Training R2: 0.991294
Validation Loss: 0.41827520, Validation R2: 0.829154

Epoch 68/1000
Training Loss: 0.05481719, Training R2: 0.991309
Validation Loss: 0.41025099, Validation R2: 0.832638

Epoch 69/1000
Training Loss: 0.04750886, Training R2: 0.992149
Validation Loss: 0.41940354, Validation R2: 0.832353

Epoch 70/1000
Training Loss: 0.04827617, Training R2: 0.991931
Validation Loss: 0.42121857, Validation R2: 0.831030

Epoch 71/1000
Training Loss: 0.05292441, Training R2: 0.991850
Validation Loss: 0.41048221, Validation R2: 0.828945

Epoch 72/1000
Training Loss: 0.04731334, Training R2: 0.992168
Validation Loss: 0.41457673, Validation R2: 0.828929

Epoch 73/1000
Training Loss: 0.04636530, Training R2: 0.992386
Validation Loss: 0.41499256, Validation R2: 0.827562

Epoch 74/1000
Training Loss: 0.04970910, Training R2: 0.991939
Validation Loss: 0.41229815, Validation R2: 0.831298

Epoch 75/1000
Training Loss: 0.04621004, Training R2: 0.992334
Validation Loss: 0.41461878, Validation R2: 0.832774

Epoch 76/1000
Training Loss: 0.04588355, Training R2: 0.992437
Validation Loss: 0.41878824, Validation R2: 0.830602

Epoch 77/1000
Training Loss: 0.04619157, Training R2: 0.992474
Validation Loss: 0.41215484, Validation R2: 0.833158

Epoch 78/1000
Training Loss: 0.05135278, Training R2: 0.992195
Validation Loss: 0.41360217, Validation R2: 0.829316

Epoch 79/1000
Training Loss: 0.05083260, Training R2: 0.992195
Validation Loss: 0.41355665, Validation R2: 0.828612

Epoch 80/1000
Training Loss: 0.05163434, Training R2: 0.992429
Validation Loss: 0.41704697, Validation R2: 0.833645

Epoch 81/1000
Epoch 00081: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.05474736, Training R2: 0.992449
Validation Loss: 0.41526291, Validation R2: 0.826366

Epoch 82/1000
学习率已减少 2 次
Training Loss: 0.04247867, Training R2: 0.993196
Validation Loss: 0.41243999, Validation R2: 0.831581

Epoch 83/1000
Training Loss: 0.03244715, Training R2: 0.993623
Validation Loss: 0.41299227, Validation R2: 0.832675

Epoch 84/1000
Training Loss: 0.02798975, Training R2: 0.994036
Validation Loss: 0.41029839, Validation R2: 0.831465

Epoch 85/1000
Training Loss: 0.02675024, Training R2: 0.994147
Validation Loss: 0.40997458, Validation R2: 0.833061

Epoch 86/1000
Training Loss: 0.03048123, Training R2: 0.994061
Validation Loss: 0.40963635, Validation R2: 0.831550

Epoch 87/1000
Training Loss: 0.02954548, Training R2: 0.994085
Validation Loss: 0.41222921, Validation R2: 0.832091

Epoch 88/1000
Training Loss: 0.02441822, Training R2: 0.994349
Validation Loss: 0.41096565, Validation R2: 0.832191

Epoch 89/1000
Training Loss: 0.02533552, Training R2: 0.994392
Validation Loss: 0.40813335, Validation R2: 0.833513

Epoch 90/1000
Training Loss: 0.02772944, Training R2: 0.994379
Validation Loss: 0.41247646, Validation R2: 0.831939

Epoch 91/1000
Training Loss: 0.03003180, Training R2: 0.994414
Validation Loss: 0.41230517, Validation R2: 0.831421

Epoch 92/1000
Training Loss: 0.04453882, Training R2: 0.993631
Validation Loss: 0.41199632, Validation R2: 0.831632

Epoch 93/1000
Training Loss: 0.03801989, Training R2: 0.994028
Validation Loss: 0.40847639, Validation R2: 0.832998

Epoch 94/1000
Training Loss: 0.03044390, Training R2: 0.994617
Validation Loss: 0.41274445, Validation R2: 0.831831

Epoch 95/1000
Training Loss: 0.02900691, Training R2: 0.994631
Validation Loss: 0.40985312, Validation R2: 0.829963

Epoch 96/1000
Training Loss: 0.02958093, Training R2: 0.994682
Validation Loss: 0.41221616, Validation R2: 0.831502

Epoch 97/1000
Training Loss: 0.02874830, Training R2: 0.994710
Validation Loss: 0.41172637, Validation R2: 0.830526

Epoch 98/1000
Training Loss: 0.02446550, Training R2: 0.994957
Validation Loss: 0.41123091, Validation R2: 0.830903

Epoch 99/1000
Training Loss: 0.02432988, Training R2: 0.994979
Validation Loss: 0.41170518, Validation R2: 0.829742

Epoch 100/1000
Training Loss: 0.02248077, Training R2: 0.995068
Validation Loss: 0.41021168, Validation R2: 0.832193

Epoch 101/1000
Training Loss: 0.03004542, Training R2: 0.994941
Validation Loss: 0.40887706, Validation R2: 0.830177

Epoch 102/1000
Epoch 00102: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.03411625, Training R2: 0.994852
Validation Loss: 0.41270938, Validation R2: 0.832132

Epoch 103/1000
学习率已减少 3 次
Training Loss: 0.02288100, Training R2: 0.995200
Validation Loss: 0.41008418, Validation R2: 0.832158

Epoch 104/1000
Training Loss: 0.01937641, Training R2: 0.995364
Validation Loss: 0.41052653, Validation R2: 0.831380

Epoch 105/1000
Training Loss: 0.01751745, Training R2: 0.995470
Validation Loss: 0.41182908, Validation R2: 0.832013

Epoch 106/1000
Training Loss: 0.02244881, Training R2: 0.995435
Validation Loss: 0.41074320, Validation R2: 0.833362

Epoch 107/1000
Training Loss: 0.02412059, Training R2: 0.995418
Validation Loss: 0.40999953, Validation R2: 0.831529

Epoch 108/1000
Training Loss: 0.02303461, Training R2: 0.995450
Validation Loss: 0.41142690, Validation R2: 0.831575

Epoch 109/1000
Training Loss: 0.01808001, Training R2: 0.995596
Validation Loss: 0.41021355, Validation R2: 0.831595

Epoch 110/1000
Training Loss: 0.01388448, Training R2: 0.995705
Validation Loss: 0.40964407, Validation R2: 0.833330

Epoch 111/1000
Training Loss: 0.01376969, Training R2: 0.995730
Validation Loss: 0.41107604, Validation R2: 0.831863

Epoch 112/1000
Training Loss: 0.01468980, Training R2: 0.995756
Validation Loss: 0.40921754, Validation R2: 0.832174

Epoch 113/1000
Training Loss: 0.01437950, Training R2: 0.995778
Validation Loss: 0.41002491, Validation R2: 0.831805

Epoch 114/1000
Training Loss: 0.01539323, Training R2: 0.995826
Validation Loss: 0.40954467, Validation R2: 0.833220

Epoch 115/1000
Training Loss: 0.01476310, Training R2: 0.995866
Validation Loss: 0.41038632, Validation R2: 0.831775

Epoch 116/1000
Training Loss: 0.01454738, Training R2: 0.995861
Validation Loss: 0.40917045, Validation R2: 0.833073

Epoch 117/1000
Training Loss: 0.01293698, Training R2: 0.995947
Validation Loss: 0.41154384, Validation R2: 0.832101

Epoch 118/1000
Training Loss: 0.01355875, Training R2: 0.995969
Validation Loss: 0.41098553, Validation R2: 0.832213

Epoch 119/1000
Training Loss: 0.01213716, Training R2: 0.996062
Validation Loss: 0.41040583, Validation R2: 0.831889

Epoch 120/1000
Training Loss: 0.01283634, Training R2: 0.996066
Validation Loss: 0.40831188, Validation R2: 0.832510

Epoch 121/1000
Training Loss: 0.01713946, Training R2: 0.995915
Validation Loss: 0.40979863, Validation R2: 0.833873

Epoch 122/1000
Training Loss: 0.01399542, Training R2: 0.996057
Validation Loss: 0.40904786, Validation R2: 0.833126

Epoch 123/1000
Epoch 00123: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.01360285, Training R2: 0.996145
Validation Loss: 0.41081456, Validation R2: 0.832958

Epoch 124/1000
学习率已减少 4 次
Training Loss: 0.01276102, Training R2: 0.996206
Validation Loss: 0.40946341, Validation R2: 0.833498

Epoch 125/1000
Training Loss: 0.01049005, Training R2: 0.996186
Validation Loss: 0.40962362, Validation R2: 0.833595

Epoch 126/1000
Training Loss: 0.00888927, Training R2: 0.996281
Validation Loss: 0.40997880, Validation R2: 0.832593

Epoch 127/1000
Training Loss: 0.00830147, Training R2: 0.996275
Validation Loss: 0.40974351, Validation R2: 0.833246

Epoch 128/1000
Training Loss: 0.00836824, Training R2: 0.996309
Validation Loss: 0.40951370, Validation R2: 0.833352

Epoch 129/1000
Training Loss: 0.00845829, Training R2: 0.996309
Validation Loss: 0.40974588, Validation R2: 0.832521

Epoch 130/1000
Training Loss: 0.00872394, Training R2: 0.996349
Validation Loss: 0.40997714, Validation R2: 0.833016

Epoch 131/1000
Training Loss: 0.00878833, Training R2: 0.996343
Validation Loss: 0.41010509, Validation R2: 0.832928

Epoch 132/1000
Training Loss: 0.00872827, Training R2: 0.996397
Validation Loss: 0.41022419, Validation R2: 0.832364

Epoch 133/1000
Training Loss: 0.00861314, Training R2: 0.996395
Validation Loss: 0.40957023, Validation R2: 0.832497

Epoch 134/1000
Training Loss: 0.00820690, Training R2: 0.996417
Validation Loss: 0.40997119, Validation R2: 0.832437

Epoch 135/1000
Training Loss: 0.00818897, Training R2: 0.996465
Validation Loss: 0.41037089, Validation R2: 0.832787

Epoch 136/1000
Training Loss: 0.00836001, Training R2: 0.996505
Validation Loss: 0.40975972, Validation R2: 0.832615

Epoch 137/1000
Training Loss: 0.00838882, Training R2: 0.996493
Validation Loss: 0.40988671, Validation R2: 0.831646

Epoch 138/1000
Training Loss: 0.00905865, Training R2: 0.996521
Validation Loss: 0.40989829, Validation R2: 0.832737

Epoch 139/1000
Training Loss: 0.00851415, Training R2: 0.996495
Validation Loss: 0.41043937, Validation R2: 0.832837

Epoch 140/1000
Training Loss: 0.00774026, Training R2: 0.996547
Validation Loss: 0.40964458, Validation R2: 0.832688

Epoch 141/1000
Training Loss: 0.00752061, Training R2: 0.996574
Validation Loss: 0.40975113, Validation R2: 0.832990

Epoch 142/1000
Training Loss: 0.00912448, Training R2: 0.996595
Validation Loss: 0.41010728, Validation R2: 0.832212

Epoch 143/1000
Training Loss: 0.00880299, Training R2: 0.996625
Validation Loss: 0.41024733, Validation R2: 0.832551

Epoch 144/1000
Epoch 00144: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00832337, Training R2: 0.996655
Validation Loss: 0.41031464, Validation R2: 0.832932

Epoch 145/1000
学习率已减少 5 次
Training Loss: 0.00753917, Training R2: 0.996676
Validation Loss: 0.41020666, Validation R2: 0.832920

Epoch 146/1000
Training Loss: 0.00616093, Training R2: 0.996690
Validation Loss: 0.40959593, Validation R2: 0.833043

Epoch 147/1000
Training Loss: 0.00574597, Training R2: 0.996700
Validation Loss: 0.40969275, Validation R2: 0.833173

Epoch 148/1000
Training Loss: 0.00551646, Training R2: 0.996703
Validation Loss: 0.40993992, Validation R2: 0.832973

Epoch 149/1000
Training Loss: 0.00561887, Training R2: 0.996720
Validation Loss: 0.40995587, Validation R2: 0.832494

Epoch 150/1000
Training Loss: 0.00532924, Training R2: 0.996735
Validation Loss: 0.41012007, Validation R2: 0.833084

Epoch 151/1000
Training Loss: 0.00523358, Training R2: 0.996756
Validation Loss: 0.40986819, Validation R2: 0.833066

Epoch 152/1000
Training Loss: 0.00518094, Training R2: 0.996750
Validation Loss: 0.40995778, Validation R2: 0.832450

Epoch 153/1000
Training Loss: 0.00539716, Training R2: 0.996767
Validation Loss: 0.41009655, Validation R2: 0.832213

Epoch 154/1000
Training Loss: 0.00544621, Training R2: 0.996780
Validation Loss: 0.40970280, Validation R2: 0.832970

Epoch 155/1000
Training Loss: 0.00546156, Training R2: 0.996793
Validation Loss: 0.41003685, Validation R2: 0.833032

Epoch 156/1000
Training Loss: 0.00543120, Training R2: 0.996813
Validation Loss: 0.40977975, Validation R2: 0.833077

Epoch 157/1000
Training Loss: 0.00562134, Training R2: 0.996825
Validation Loss: 0.40970884, Validation R2: 0.833258

Epoch 158/1000
Training Loss: 0.00578891, Training R2: 0.996827
Validation Loss: 0.40983832, Validation R2: 0.833257

Epoch 159/1000
Training Loss: 0.00525517, Training R2: 0.996834
Validation Loss: 0.41016825, Validation R2: 0.833269

Epoch 160/1000
Training Loss: 0.00534703, Training R2: 0.996850
Validation Loss: 0.40998237, Validation R2: 0.833023

Epoch 161/1000
Training Loss: 0.00503597, Training R2: 0.996860
Validation Loss: 0.40966435, Validation R2: 0.833204

Epoch 162/1000
Training Loss: 0.00515047, Training R2: 0.996865
Validation Loss: 0.41027508, Validation R2: 0.832791

Epoch 163/1000
Training Loss: 0.00551086, Training R2: 0.996872
Validation Loss: 0.40984530, Validation R2: 0.833250

Epoch 164/1000
Training Loss: 0.00720257, Training R2: 0.996876
Validation Loss: 0.41028405, Validation R2: 0.833396

Epoch 165/1000
Epoch 00165: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00770816, Training R2: 0.996901
Validation Loss: 0.41055887, Validation R2: 0.832197

Epoch 166/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
99673
Validation Loss: 0.38076842, Validation R2: 0.846933

Epoch 165/1000
Training Loss: 0.02003952, Training R2: 0.999695
Validation Loss: 0.38035434, Validation R2: 0.847460

Epoch 166/1000
Training Loss: 0.01849793, Training R2: 0.999739
Validation Loss: 0.38341785, Validation R2: 0.847156

Epoch 167/1000
Training Loss: 0.01974834, Training R2: 0.999700
Validation Loss: 0.38275874, Validation R2: 0.846756

Epoch 168/1000
Training Loss: 0.01758204, Training R2: 0.999741
Validation Loss: 0.38048883, Validation R2: 0.846102

Epoch 169/1000
Training Loss: 0.01748863, Training R2: 0.999761
Validation Loss: 0.38031026, Validation R2: 0.847353

Epoch 170/1000
Training Loss: 0.01702357, Training R2: 0.999767
Validation Loss: 0.38153821, Validation R2: 0.847000

Epoch 171/1000
Training Loss: 0.01819943, Training R2: 0.999724
Validation Loss: 0.38206115, Validation R2: 0.847342

Epoch 172/1000
Training Loss: 0.02205795, Training R2: 0.999639
Validation Loss: 0.38218347, Validation R2: 0.846957

Epoch 173/1000
Training Loss: 0.02596562, Training R2: 0.999509
Validation Loss: 0.37777279, Validation R2: 0.847108

Epoch 174/1000
Training Loss: 0.02103814, Training R2: 0.999665
Validation Loss: 0.38025451, Validation R2: 0.847444

Epoch 175/1000
Training Loss: 0.02216920, Training R2: 0.999637
Validation Loss: 0.38052040, Validation R2: 0.845347

Epoch 176/1000
Epoch 00176: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.02575061, Training R2: 0.999509
Validation Loss: 0.37971934, Validation R2: 0.848093

Epoch 177/1000
学习率已减少 3 次
Training Loss: 0.01715969, Training R2: 0.999777
Validation Loss: 0.37891296, Validation R2: 0.847817

Epoch 178/1000
Training Loss: 0.01284133, Training R2: 0.999871
Validation Loss: 0.37940657, Validation R2: 0.847656

Epoch 179/1000
Training Loss: 0.01041401, Training R2: 0.999915
Validation Loss: 0.37968077, Validation R2: 0.847481

Epoch 180/1000
Training Loss: 0.00989897, Training R2: 0.999920
Validation Loss: 0.38089224, Validation R2: 0.847407

Epoch 181/1000
Training Loss: 0.00993613, Training R2: 0.999922
Validation Loss: 0.38011550, Validation R2: 0.847534

Epoch 182/1000
Training Loss: 0.00868755, Training R2: 0.999941
Validation Loss: 0.38174980, Validation R2: 0.847301

Epoch 183/1000
Training Loss: 0.00989527, Training R2: 0.999923
Validation Loss: 0.37984172, Validation R2: 0.847858

Epoch 184/1000
Training Loss: 0.01588814, Training R2: 0.999823
Validation Loss: 0.38123496, Validation R2: 0.847309

Epoch 185/1000
Training Loss: 0.01103859, Training R2: 0.999903
Validation Loss: 0.37968288, Validation R2: 0.847775

Epoch 186/1000
Training Loss: 0.01004010, Training R2: 0.999919
Validation Loss: 0.38059790, Validation R2: 0.847371

Epoch 187/1000
Training Loss: 0.00999076, Training R2: 0.999923
Validation Loss: 0.37987790, Validation R2: 0.847270

Epoch 188/1000
Training Loss: 0.01085969, Training R2: 0.999912
Validation Loss: 0.37815382, Validation R2: 0.848075

Epoch 189/1000
Training Loss: 0.01157155, Training R2: 0.999898
Validation Loss: 0.38045343, Validation R2: 0.847362

Epoch 190/1000
Training Loss: 0.01014827, Training R2: 0.999922
Validation Loss: 0.38009072, Validation R2: 0.847416

Epoch 191/1000
Training Loss: 0.00955540, Training R2: 0.999930
Validation Loss: 0.38005409, Validation R2: 0.847334

Epoch 192/1000
Training Loss: 0.00954216, Training R2: 0.999928
Validation Loss: 0.37996824, Validation R2: 0.847652

Epoch 193/1000
Training Loss: 0.01127031, Training R2: 0.999904
Validation Loss: 0.38064734, Validation R2: 0.846732

Epoch 194/1000
Training Loss: 0.00944912, Training R2: 0.999930
Validation Loss: 0.38087919, Validation R2: 0.846663

Epoch 195/1000
Training Loss: 0.00808935, Training R2: 0.999949
Validation Loss: 0.38092430, Validation R2: 0.847322

Epoch 196/1000
Training Loss: 0.00876703, Training R2: 0.999941
Validation Loss: 0.37967829, Validation R2: 0.848095

Epoch 197/1000
Epoch 00197: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00803043, Training R2: 0.999949
Validation Loss: 0.37975534, Validation R2: 0.847408

Epoch 198/1000
学习率已减少 4 次
Training Loss: 0.00701553, Training R2: 0.999953
Validation Loss: 0.38007442, Validation R2: 0.847594

Epoch 199/1000
Training Loss: 0.00552367, Training R2: 0.999974
Validation Loss: 0.37938678, Validation R2: 0.847539

Epoch 200/1000
Training Loss: 0.00517946, Training R2: 0.999978
Validation Loss: 0.37993793, Validation R2: 0.847840

Epoch 201/1000
Training Loss: 0.00494009, Training R2: 0.999979
Validation Loss: 0.37972879, Validation R2: 0.847583

Epoch 202/1000
Training Loss: 0.00506060, Training R2: 0.999980
Validation Loss: 0.38016973, Validation R2: 0.847550

Epoch 203/1000
Training Loss: 0.00522218, Training R2: 0.999978
Validation Loss: 0.38018704, Validation R2: 0.847225

Epoch 204/1000
Training Loss: 0.00491270, Training R2: 0.999980
Validation Loss: 0.37969825, Validation R2: 0.847528

Epoch 205/1000
Training Loss: 0.00463005, Training R2: 0.999976
Validation Loss: 0.37997997, Validation R2: 0.847636

Epoch 206/1000
Training Loss: 0.00518735, Training R2: 0.999975
Validation Loss: 0.38028585, Validation R2: 0.847370

Epoch 207/1000
Training Loss: 0.00454955, Training R2: 0.999983
Validation Loss: 0.37991783, Validation R2: 0.847530

Epoch 208/1000
Training Loss: 0.00516716, Training R2: 0.999979
Validation Loss: 0.37961399, Validation R2: 0.847630

Epoch 209/1000
Training Loss: 0.00540851, Training R2: 0.999975
Validation Loss: 0.38080109, Validation R2: 0.847314

Epoch 210/1000
Training Loss: 0.00844239, Training R2: 0.999952
Validation Loss: 0.38034871, Validation R2: 0.847353

Epoch 211/1000
Training Loss: 0.00627485, Training R2: 0.999966
Validation Loss: 0.38000767, Validation R2: 0.847494

Epoch 212/1000
Training Loss: 0.00557811, Training R2: 0.999974
Validation Loss: 0.37986665, Validation R2: 0.847356

Epoch 213/1000
Training Loss: 0.00566182, Training R2: 0.999974
Validation Loss: 0.37969026, Validation R2: 0.847350

Epoch 214/1000
Training Loss: 0.00543356, Training R2: 0.999976
Validation Loss: 0.38027916, Validation R2: 0.847144

Epoch 215/1000
Training Loss: 0.00496567, Training R2: 0.999979
Validation Loss: 0.38025178, Validation R2: 0.847260

Epoch 216/1000
Training Loss: 0.00477045, Training R2: 0.999982
Validation Loss: 0.38019424, Validation R2: 0.847399

Epoch 217/1000
Training Loss: 0.00466705, Training R2: 0.999981
Validation Loss: 0.38060390, Validation R2: 0.847261

Epoch 218/1000
Epoch 00218: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00540513, Training R2: 0.999970
Validation Loss: 0.38071083, Validation R2: 0.847476

Epoch 219/1000
学习率已减少 5 次
Training Loss: 0.00414953, Training R2: 0.999985
Validation Loss: 0.37973452, Validation R2: 0.847686

Epoch 220/1000
Training Loss: 0.00329452, Training R2: 0.999991
Validation Loss: 0.38007058, Validation R2: 0.847460

Epoch 221/1000
Training Loss: 0.00282743, Training R2: 0.999993
Validation Loss: 0.37981306, Validation R2: 0.847546

Epoch 222/1000
Training Loss: 0.00250862, Training R2: 0.999994
Validation Loss: 0.38032976, Validation R2: 0.847255

Epoch 223/1000
Training Loss: 0.00254249, Training R2: 0.999988
Validation Loss: 0.38021554, Validation R2: 0.847352

Epoch 224/1000
Training Loss: 0.00249202, Training R2: 0.999993
Validation Loss: 0.37967228, Validation R2: 0.847733

Epoch 225/1000
Training Loss: 0.00266806, Training R2: 0.999992
Validation Loss: 0.37985598, Validation R2: 0.847457

Epoch 226/1000
Training Loss: 0.00250347, Training R2: 0.999994
Validation Loss: 0.38009636, Validation R2: 0.847558

Epoch 227/1000
Training Loss: 0.00348018, Training R2: 0.999990
Validation Loss: 0.37943097, Validation R2: 0.847367

Epoch 228/1000
Training Loss: 0.00416393, Training R2: 0.999985
Validation Loss: 0.37943698, Validation R2: 0.847709

Epoch 229/1000
Training Loss: 0.00288791, Training R2: 0.999993
Validation Loss: 0.37981516, Validation R2: 0.847665

Epoch 230/1000
Training Loss: 0.00275974, Training R2: 0.999993
Validation Loss: 0.37997091, Validation R2: 0.847553

Epoch 231/1000
Training Loss: 0.00321135, Training R2: 0.999991
Validation Loss: 0.38008709, Validation R2: 0.847484

Epoch 232/1000
Training Loss: 0.00310233, Training R2: 0.999991
Validation Loss: 0.38037059, Validation R2: 0.847218

Epoch 233/1000
Training Loss: 0.00263071, Training R2: 0.999993
Validation Loss: 0.38042968, Validation R2: 0.847539

Epoch 234/1000
Training Loss: 0.00265356, Training R2: 0.999992
Validation Loss: 0.37987877, Validation R2: 0.847507

Epoch 235/1000
Training Loss: 0.00266181, Training R2: 0.999993
Validation Loss: 0.37954545, Validation R2: 0.847617

Epoch 236/1000
Training Loss: 0.00272563, Training R2: 0.999992
Validation Loss: 0.37947294, Validation R2: 0.847683

Epoch 237/1000
Training Loss: 0.00251307, Training R2: 0.999994
Validation Loss: 0.38001502, Validation R2: 0.847620

Epoch 238/1000
Training Loss: 0.00254312, Training R2: 0.999994
Validation Loss: 0.38027153, Validation R2: 0.847160

Epoch 239/1000
Epoch 00239: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00261553, Training R2: 0.999993
Validation Loss: 0.38005281, Validation R2: 0.847572

Epoch 240/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
