Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 5000, Training: 4000, Validation: 1000
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5293187

Epoch 1/1000
Training Loss: 1.19967302, Training R2: -0.055595
Validation Loss: 1.02520212, Validation R2: 0.188804
Saved best model with validation R2 0.188804 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.85467260, Training R2: 0.394694
Validation Loss: 0.81840854, Validation R2: 0.471335
Saved best model with validation R2 0.471335 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.74694462, Training R2: 0.520769
Validation Loss: 0.71620465, Validation R2: 0.570354
Saved best model with validation R2 0.570354 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.67283021, Training R2: 0.599407
Validation Loss: 0.74273351, Validation R2: 0.557179

Epoch 5/1000
Training Loss: 0.64589417, Training R2: 0.629923
Validation Loss: 0.64379931, Validation R2: 0.644959
Saved best model with validation R2 0.644959 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.56135883, Training R2: 0.701191
Validation Loss: 0.63839505, Validation R2: 0.656734
Saved best model with validation R2 0.656734 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.51505385, Training R2: 0.736698
Validation Loss: 0.57457945, Validation R2: 0.709509
Saved best model with validation R2 0.709509 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.45876171, Training R2: 0.784421
Validation Loss: 0.53914952, Validation R2: 0.732665
Saved best model with validation R2 0.732665 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.44063586, Training R2: 0.802863
Validation Loss: 0.58700533, Validation R2: 0.692650

Epoch 10/1000
Training Loss: 0.42149841, Training R2: 0.817885
Validation Loss: 0.58048957, Validation R2: 0.714314

Epoch 11/1000
Training Loss: 0.39365315, Training R2: 0.832294
Validation Loss: 0.50888816, Validation R2: 0.759966
Saved best model with validation R2 0.759966 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.34918019, Training R2: 0.865097
Validation Loss: 0.49620997, Validation R2: 0.774535
Saved best model with validation R2 0.774535 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.32654992, Training R2: 0.878453
Validation Loss: 0.48085626, Validation R2: 0.787921
Saved best model with validation R2 0.787921 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.31118916, Training R2: 0.892656
Validation Loss: 0.48030032, Validation R2: 0.786283

Epoch 15/1000
Training Loss: 0.29421502, Training R2: 0.899024
Validation Loss: 0.47530003, Validation R2: 0.792665
Saved best model with validation R2 0.792665 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.27770790, Training R2: 0.909398
Validation Loss: 0.45106342, Validation R2: 0.809143
Saved best model with validation R2 0.809143 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.25099391, Training R2: 0.919156
Validation Loss: 0.44582153, Validation R2: 0.819268
Saved best model with validation R2 0.819268 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.24472451, Training R2: 0.922917
Validation Loss: 0.46740271, Validation R2: 0.813017

Epoch 19/1000
Training Loss: 0.24492246, Training R2: 0.928035
Validation Loss: 0.42623681, Validation R2: 0.832023
Saved best model with validation R2 0.832023 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.22902983, Training R2: 0.932465
Validation Loss: 0.44501600, Validation R2: 0.813040

Epoch 21/1000
Training Loss: 0.21160910, Training R2: 0.940484
Validation Loss: 0.44290496, Validation R2: 0.816156

Epoch 22/1000
Training Loss: 0.20996369, Training R2: 0.940822
Validation Loss: 0.44728956, Validation R2: 0.806398

Epoch 23/1000
Training Loss: 0.26656207, Training R2: 0.926825
Validation Loss: 0.43990980, Validation R2: 0.816937

Epoch 24/1000
Training Loss: 0.22847554, Training R2: 0.937162
Validation Loss: 0.43605900, Validation R2: 0.818292

Epoch 25/1000
Training Loss: 0.20174859, Training R2: 0.947512
Validation Loss: 0.43917727, Validation R2: 0.829069

Epoch 26/1000
Training Loss: 0.17920161, Training R2: 0.952245
Validation Loss: 0.42752504, Validation R2: 0.829277

Epoch 27/1000
Training Loss: 0.16854624, Training R2: 0.956171
Validation Loss: 0.42469870, Validation R2: 0.836955
Saved best model with validation R2 0.836955 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.15542966, Training R2: 0.960881
Validation Loss: 0.42482351, Validation R2: 0.831029

Epoch 29/1000
Training Loss: 0.17208816, Training R2: 0.957065
Validation Loss: 0.44096843, Validation R2: 0.824962

Epoch 30/1000
Training Loss: 0.16868787, Training R2: 0.957254
Validation Loss: 0.43274380, Validation R2: 0.826616

Epoch 31/1000
Training Loss: 0.16553564, Training R2: 0.961762
Validation Loss: 0.42914694, Validation R2: 0.838670
Saved best model with validation R2 0.838670 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 0.15641162, Training R2: 0.964387
Validation Loss: 0.42021408, Validation R2: 0.838704
Saved best model with validation R2 0.838704 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.15121511, Training R2: 0.965680
Validation Loss: 0.42005154, Validation R2: 0.841636
Saved best model with validation R2 0.841636 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.13587911, Training R2: 0.968718
Validation Loss: 0.40634278, Validation R2: 0.843927
Saved best model with validation R2 0.843927 to best_finetuned_model.pth

Epoch 35/1000
Training Loss: 0.13043339, Training R2: 0.970622
Validation Loss: 0.40531090, Validation R2: 0.848959
Saved best model with validation R2 0.848959 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.13698257, Training R2: 0.970380
Validation Loss: 0.40494055, Validation R2: 0.842504

Epoch 37/1000
Training Loss: 0.14621164, Training R2: 0.969596
Validation Loss: 0.40928308, Validation R2: 0.847399

Epoch 38/1000
Training Loss: 0.13488393, Training R2: 0.972065
Validation Loss: 0.39729448, Validation R2: 0.852330
Saved best model with validation R2 0.852330 to best_finetuned_model.pth

Epoch 39/1000
Training Loss: 0.12928616, Training R2: 0.973688
Validation Loss: 0.39811966, Validation R2: 0.850300

Epoch 40/1000
Training Loss: 0.12777681, Training R2: 0.974165
Validation Loss: 0.40525787, Validation R2: 0.844606

Epoch 41/1000
Training Loss: 0.11400040, Training R2: 0.978252
Validation Loss: 0.39646511, Validation R2: 0.853277
Saved best model with validation R2 0.853277 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.13211530, Training R2: 0.974386
Validation Loss: 0.41175264, Validation R2: 0.847565

Epoch 43/1000
Training Loss: 0.12768941, Training R2: 0.976436
Validation Loss: 0.42369214, Validation R2: 0.838933

Epoch 44/1000
Training Loss: 0.12242522, Training R2: 0.977342
Validation Loss: 0.39953021, Validation R2: 0.856182
Saved best model with validation R2 0.856182 to best_finetuned_model.pth

Epoch 45/1000
Training Loss: 0.13108238, Training R2: 0.977499
Validation Loss: 0.40637142, Validation R2: 0.847501

Epoch 46/1000
Training Loss: 0.11728669, Training R2: 0.979419
Validation Loss: 0.39376657, Validation R2: 0.855985

Epoch 47/1000
Training Loss: 0.10007361, Training R2: 0.982377
Validation Loss: 0.39564488, Validation R2: 0.852710

Epoch 48/1000
Training Loss: 0.11105625, Training R2: 0.980931
Validation Loss: 0.39639795, Validation R2: 0.852402

Epoch 49/1000
Training Loss: 0.12371243, Training R2: 0.978357
Validation Loss: 0.40977245, Validation R2: 0.846949

Epoch 50/1000
Training Loss: 0.11447526, Training R2: 0.981279
Validation Loss: 0.39871938, Validation R2: 0.856716
Saved best model with validation R2 0.856716 to best_finetuned_model.pth

Epoch 51/1000
Training Loss: 0.10290758, Training R2: 0.982717
Validation Loss: 0.39194864, Validation R2: 0.857767
Saved best model with validation R2 0.857767 to best_finetuned_model.pth

Epoch 52/1000
Training Loss: 0.11513279, Training R2: 0.980128
Validation Loss: 0.44643399, Validation R2: 0.822328

Epoch 53/1000
Training Loss: 0.17608147, Training R2: 0.969856
Validation Loss: 0.42814212, Validation R2: 0.850027

Epoch 54/1000
Training Loss: 0.16444664, Training R2: 0.973049
Validation Loss: 0.41925604, Validation R2: 0.839724

Epoch 55/1000
Training Loss: 0.13470374, Training R2: 0.977929
Validation Loss: 0.38999428, Validation R2: 0.854985

Epoch 56/1000
Training Loss: 0.11541574, Training R2: 0.980894
Validation Loss: 0.40151497, Validation R2: 0.848995

Epoch 57/1000
Training Loss: 0.10854118, Training R2: 0.982814
Validation Loss: 0.39718052, Validation R2: 0.853206

Epoch 58/1000
Training Loss: 0.10348482, Training R2: 0.983914
Validation Loss: 0.41335883, Validation R2: 0.850816

Epoch 59/1000
Training Loss: 0.09969206, Training R2: 0.984555
Validation Loss: 0.38342547, Validation R2: 0.858804
Saved best model with validation R2 0.858804 to best_finetuned_model.pth

Epoch 60/1000
Training Loss: 0.09664322, Training R2: 0.985042
Validation Loss: 0.38687631, Validation R2: 0.861729
Saved best model with validation R2 0.861729 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.08997368, Training R2: 0.985881
Validation Loss: 0.39235304, Validation R2: 0.858735

Epoch 62/1000
Training Loss: 0.09963627, Training R2: 0.985550
Validation Loss: 0.38991216, Validation R2: 0.857960

Epoch 63/1000
Training Loss: 0.08813814, Training R2: 0.986388
Validation Loss: 0.39069113, Validation R2: 0.855815

Epoch 64/1000
Training Loss: 0.08921045, Training R2: 0.986730
Validation Loss: 0.39614577, Validation R2: 0.853541

Epoch 65/1000
Training Loss: 0.09927220, Training R2: 0.985486
Validation Loss: 0.39442091, Validation R2: 0.854104

Epoch 66/1000
Training Loss: 0.09118888, Training R2: 0.986488
Validation Loss: 0.39728951, Validation R2: 0.853106

Epoch 67/1000
Training Loss: 0.08525558, Training R2: 0.987082
Validation Loss: 0.38504914, Validation R2: 0.861344

Epoch 68/1000
Training Loss: 0.08763358, Training R2: 0.987484
Validation Loss: 0.39825613, Validation R2: 0.855825

Epoch 69/1000
Training Loss: 0.09253608, Training R2: 0.987020
Validation Loss: 0.38918873, Validation R2: 0.859683

Epoch 70/1000
Training Loss: 0.08327115, Training R2: 0.988219
Validation Loss: 0.38876161, Validation R2: 0.860232

Epoch 71/1000
Training Loss: 0.07726669, Training R2: 0.989459
Validation Loss: 0.38715596, Validation R2: 0.856561

Epoch 72/1000
Training Loss: 0.08196498, Training R2: 0.988699
Validation Loss: 0.39056975, Validation R2: 0.855996

Epoch 73/1000
Training Loss: 0.07566226, Training R2: 0.989655
Validation Loss: 0.38580997, Validation R2: 0.856898

Epoch 74/1000
Training Loss: 0.07357616, Training R2: 0.990135
Validation Loss: 0.39398754, Validation R2: 0.858306

Epoch 75/1000
Training Loss: 0.09603811, Training R2: 0.987625
Validation Loss: 0.40655519, Validation R2: 0.846630

Epoch 76/1000
Training Loss: 0.10361052, Training R2: 0.986872
Validation Loss: 0.39964121, Validation R2: 0.851165

Epoch 77/1000
Training Loss: 0.09317088, Training R2: 0.987874
Validation Loss: 0.39756086, Validation R2: 0.852946

Epoch 78/1000
Training Loss: 0.07805976, Training R2: 0.989986
Validation Loss: 0.38279257, Validation R2: 0.861854
Saved best model with validation R2 0.861854 to best_finetuned_model.pth

Epoch 79/1000
Training Loss: 0.07092219, Training R2: 0.991199
Validation Loss: 0.39451171, Validation R2: 0.852940

Epoch 80/1000
Training Loss: 0.07883226, Training R2: 0.990627
Validation Loss: 0.38918555, Validation R2: 0.854639

Epoch 81/1000
Training Loss: 0.07790352, Training R2: 0.991185
Validation Loss: 0.39078203, Validation R2: 0.856630

Epoch 82/1000
Training Loss: 0.07658652, Training R2: 0.991479
Validation Loss: 0.38548205, Validation R2: 0.857584

Epoch 83/1000
Training Loss: 0.09075666, Training R2: 0.989914
Validation Loss: 0.38343738, Validation R2: 0.862712
Saved best model with validation R2 0.862712 to best_finetuned_model.pth

Epoch 84/1000
Training Loss: 0.07121172, Training R2: 0.992365
Validation Loss: 0.38609816, Validation R2: 0.859282

Epoch 85/1000
Training Loss: 0.06667777, Training R2: 0.993207
Validation Loss: 0.38578666, Validation R2: 0.858844

Epoch 86/1000
Training Loss: 0.07262674, Training R2: 0.992806
Validation Loss: 0.38653209, Validation R2: 0.858538

Epoch 87/1000
Training Loss: 0.06389083, Training R2: 0.993899
Validation Loss: 0.38579661, Validation R2: 0.860544

Epoch 88/1000
Training Loss: 0.06984031, Training R2: 0.994006
Validation Loss: 0.38518735, Validation R2: 0.860309

Epoch 89/1000
Training Loss: 0.06792542, Training R2: 0.993974
Validation Loss: 0.38056553, Validation R2: 0.864099
Saved best model with validation R2 0.864099 to best_finetuned_model.pth

Epoch 90/1000
Training Loss: 0.07265641, Training R2: 0.993582
Validation Loss: 0.39425993, Validation R2: 0.857511

Epoch 91/1000
Training Loss: 0.07186852, Training R2: 0.994139
Validation Loss: 0.39074757, Validation R2: 0.855953

Epoch 92/1000
Training Loss: 0.08611339, Training R2: 0.992078
Validation Loss: 0.39031576, Validation R2: 0.860609

Epoch 93/1000
Training Loss: 0.07880509, Training R2: 0.993114
Validation Loss: 0.38494530, Validation R2: 0.861595

Epoch 94/1000
Training Loss: 0.08693266, Training R2: 0.993383
Validation Loss: 0.38952604, Validation R2: 0.860506

Epoch 95/1000
Training Loss: 0.08283035, Training R2: 0.993051
Validation Loss: 0.40269928, Validation R2: 0.850970

Epoch 96/1000
Training Loss: 0.07841787, Training R2: 0.994157
Validation Loss: 0.39041001, Validation R2: 0.856851

Epoch 97/1000
Training Loss: 0.08699693, Training R2: 0.992914
Validation Loss: 0.39282792, Validation R2: 0.856506

Epoch 98/1000
Training Loss: 0.07976415, Training R2: 0.994250
Validation Loss: 0.38527007, Validation R2: 0.858708

Epoch 99/1000
Training Loss: 0.07463070, Training R2: 0.994775
Validation Loss: 0.38904469, Validation R2: 0.857801

Epoch 100/1000
Training Loss: 0.07122279, Training R2: 0.995458
Validation Loss: 0.38876021, Validation R2: 0.857196

Epoch 101/1000
Training Loss: 0.08371573, Training R2: 0.994032
Validation Loss: 0.39160717, Validation R2: 0.857261

Epoch 102/1000
Training Loss: 0.06851193, Training R2: 0.995834
Validation Loss: 0.38690545, Validation R2: 0.858702

Epoch 103/1000
Training Loss: 0.06020997, Training R2: 0.996885
Validation Loss: 0.37879492, Validation R2: 0.862377

Epoch 104/1000
Training Loss: 0.06667088, Training R2: 0.995723
Validation Loss: 0.37887578, Validation R2: 0.864484
Saved best model with validation R2 0.864484 to best_finetuned_model.pth

Epoch 105/1000
Training Loss: 0.07608812, Training R2: 0.995192
Validation Loss: 0.38325219, Validation R2: 0.860662

Epoch 106/1000
Training Loss: 0.07884813, Training R2: 0.994986
Validation Loss: 0.38481864, Validation R2: 0.862604

Epoch 107/1000
Training Loss: 0.07146103, Training R2: 0.995659
Validation Loss: 0.39374449, Validation R2: 0.852243

Epoch 108/1000
Training Loss: 0.08487698, Training R2: 0.994227
Validation Loss: 0.39219392, Validation R2: 0.856271

Epoch 109/1000
Training Loss: 0.07765112, Training R2: 0.994960
Validation Loss: 0.38747605, Validation R2: 0.856730

Epoch 110/1000
Training Loss: 0.06112978, Training R2: 0.996784
Validation Loss: 0.37436439, Validation R2: 0.865683
Saved best model with validation R2 0.865683 to best_finetuned_model.pth

Epoch 111/1000
Training Loss: 0.06364695, Training R2: 0.996717
Validation Loss: 0.38344306, Validation R2: 0.859505

Epoch 112/1000
Training Loss: 0.05873363, Training R2: 0.997140
Validation Loss: 0.38294173, Validation R2: 0.859557

Epoch 113/1000
Training Loss: 0.05768189, Training R2: 0.997113
Validation Loss: 0.37872939, Validation R2: 0.860944

Epoch 114/1000
Training Loss: 0.06971784, Training R2: 0.996108
Validation Loss: 0.38620048, Validation R2: 0.861846

Epoch 115/1000
Training Loss: 0.06733177, Training R2: 0.996450
Validation Loss: 0.40310841, Validation R2: 0.848256

Epoch 116/1000
Training Loss: 0.07882269, Training R2: 0.995369
Validation Loss: 0.38475373, Validation R2: 0.860297

Epoch 117/1000
Training Loss: 0.06795758, Training R2: 0.996251
Validation Loss: 0.38697469, Validation R2: 0.857457

Epoch 118/1000
Training Loss: 0.07391706, Training R2: 0.995698
Validation Loss: 0.38478956, Validation R2: 0.859937

Epoch 119/1000
Training Loss: 0.07184233, Training R2: 0.995694
Validation Loss: 0.38433217, Validation R2: 0.860798

Epoch 120/1000
Training Loss: 0.06194794, Training R2: 0.996836
Validation Loss: 0.38193559, Validation R2: 0.858798

Epoch 121/1000
Training Loss: 0.05645686, Training R2: 0.997332
Validation Loss: 0.38151666, Validation R2: 0.859780

Epoch 122/1000
Training Loss: 0.06215528, Training R2: 0.996867
Validation Loss: 0.37854500, Validation R2: 0.862436

Epoch 123/1000
Training Loss: 0.05816492, Training R2: 0.997373
Validation Loss: 0.38146083, Validation R2: 0.857594

Epoch 124/1000
Training Loss: 0.05772422, Training R2: 0.997441
Validation Loss: 0.38000075, Validation R2: 0.860585

Epoch 125/1000
Training Loss: 0.07544136, Training R2: 0.995896
Validation Loss: 0.37797501, Validation R2: 0.858269

Epoch 126/1000
Training Loss: 0.06757140, Training R2: 0.996269
Validation Loss: 0.38434489, Validation R2: 0.857288

Epoch 127/1000
Training Loss: 0.06607074, Training R2: 0.996484
Validation Loss: 0.38911321, Validation R2: 0.854641

Epoch 128/1000
Training Loss: 0.07269385, Training R2: 0.995768
Validation Loss: 0.39472703, Validation R2: 0.849782

Epoch 129/1000
Training Loss: 0.08530950, Training R2: 0.994433
Validation Loss: 0.38603759, Validation R2: 0.856413

Epoch 130/1000
Training Loss: 0.08252815, Training R2: 0.994788
Validation Loss: 0.40594035, Validation R2: 0.841335

Epoch 131/1000
Epoch 00131: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.08568317, Training R2: 0.994617
Validation Loss: 0.38756484, Validation R2: 0.854815

Epoch 132/1000
学习率已减少 1 次
Training Loss: 0.06006957, Training R2: 0.997014
Validation Loss: 0.37632195, Validation R2: 0.860571

Epoch 133/1000
Training Loss: 0.05274172, Training R2: 0.997861
Validation Loss: 0.38171207, Validation R2: 0.859232

Epoch 134/1000
Training Loss: 0.03758066, Training R2: 0.998826
Validation Loss: 0.38363184, Validation R2: 0.857184

Epoch 135/1000
Training Loss: 0.03502820, Training R2: 0.999038
Validation Loss: 0.37891093, Validation R2: 0.860150

Epoch 136/1000
Training Loss: 0.02997986, Training R2: 0.999262
Validation Loss: 0.37479922, Validation R2: 0.861956

Epoch 137/1000
Training Loss: 0.02804722, Training R2: 0.999364
Validation Loss: 0.37942033, Validation R2: 0.861241

Epoch 138/1000
Training Loss: 0.02855620, Training R2: 0.999318
Validation Loss: 0.38090313, Validation R2: 0.858859

Epoch 139/1000
Training Loss: 0.03211795, Training R2: 0.999164
Validation Loss: 0.37678088, Validation R2: 0.862148

Epoch 140/1000
Training Loss: 0.03221122, Training R2: 0.999176
Validation Loss: 0.37825043, Validation R2: 0.860523

Epoch 141/1000
Training Loss: 0.02970418, Training R2: 0.999251
Validation Loss: 0.37800588, Validation R2: 0.860741

Epoch 142/1000
Training Loss: 0.02648773, Training R2: 0.999430
Validation Loss: 0.37741874, Validation R2: 0.860974

Epoch 143/1000
Training Loss: 0.02710916, Training R2: 0.999420
Validation Loss: 0.37966322, Validation R2: 0.859753

Epoch 144/1000
Training Loss: 0.02717888, Training R2: 0.999397
Validation Loss: 0.37929667, Validation R2: 0.860560

Epoch 145/1000
Training Loss: 0.02722987, Training R2: 0.999392
Validation Loss: 0.38476621, Validation R2: 0.858386

Epoch 146/1000
Training Loss: 0.03486793, Training R2: 0.999042
Validation Loss: 0.39256477, Validation R2: 0.853592

Epoch 147/1000
Training Loss: 0.03649589, Training R2: 0.998956
Validation Loss: 0.37737311, Validation R2: 0.863877

Epoch 148/1000
Training Loss: 0.03009004, Training R2: 0.999283
Validation Loss: 0.37939546, Validation R2: 0.861231

Epoch 149/1000
Training Loss: 0.03049630, Training R2: 0.999273
Validation Loss: 0.37632771, Validation R2: 0.861364

Epoch 150/1000
Training Loss: 0.02886810, Training R2: 0.999280
Validation Loss: 0.38056357, Validation R2: 0.859345

Epoch 151/1000
Training Loss: 0.02756711, Training R2: 0.999395
Validation Loss: 0.38239985, Validation R2: 0.858660

Epoch 152/1000
Epoch 00152: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.04031683, Training R2: 0.998769
Validation Loss: 0.37963187, Validation R2: 0.862948

Epoch 153/1000
学习率已减少 2 次
Training Loss: 0.02707626, Training R2: 0.999387
Validation Loss: 0.37644114, Validation R2: 0.863276

Epoch 154/1000
Training Loss: 0.02066153, Training R2: 0.999654
Validation Loss: 0.37736614, Validation R2: 0.862244

Epoch 155/1000
Training Loss: 0.01726808, Training R2: 0.999758
Validation Loss: 0.37804577, Validation R2: 0.861976

Epoch 156/1000
Training Loss: 0.02254410, Training R2: 0.999639
Validation Loss: 0.37663502, Validation R2: 0.862437

Epoch 157/1000
Training Loss: 0.01929004, Training R2: 0.999722
Validation Loss: 0.37619723, Validation R2: 0.862505

Epoch 158/1000
Training Loss: 0.02279617, Training R2: 0.999635
Validation Loss: 0.37891109, Validation R2: 0.860911

Epoch 159/1000
Training Loss: 0.01922241, Training R2: 0.999705
Validation Loss: 0.37730911, Validation R2: 0.862154

Epoch 160/1000
Training Loss: 0.01501005, Training R2: 0.999816
Validation Loss: 0.37728467, Validation R2: 0.861880

Epoch 161/1000
Training Loss: 0.01372136, Training R2: 0.999847
Validation Loss: 0.37602416, Validation R2: 0.863124

Epoch 162/1000
Training Loss: 0.01393468, Training R2: 0.999845
Validation Loss: 0.37616850, Validation R2: 0.862816

Epoch 163/1000
Training Loss: 0.01292268, Training R2: 0.999863
Validation Loss: 0.37719270, Validation R2: 0.862412

Epoch 164/1000
Training Loss: 0.01371317, Training R2: 0.999854
Validation Loss: 0.37730567, Validation R2: 0.862124

Epoch 165/1000
Training Loss: 0.01697790, Training R2: 0.999764
Validation Loss: 0.37865084, Validation R2: 0.861658

Epoch 166/1000
Training Loss: 0.01649967, Training R2: 0.999791
Validation Loss: 0.37768872, Validation R2: 0.861891

Epoch 167/1000
Training Loss: 0.01576165, Training R2: 0.999806
Validation Loss: 0.37682143, Validation R2: 0.862121

Epoch 168/1000
Training Loss: 0.01779398, Training R2: 0.999758
Validation Loss: 0.38015180, Validation R2: 0.859938

Epoch 169/1000
Training Loss: 0.02781124, Training R2: 0.999470
Validation Loss: 0.37911007, Validation R2: 0.862122

Epoch 170/1000
Training Loss: 0.01735140, Training R2: 0.999761
Validation Loss: 0.37728027, Validation R2: 0.861831

Epoch 171/1000
Training Loss: 0.01537296, Training R2: 0.999817
Validation Loss: 0.37720480, Validation R2: 0.862679

Epoch 172/1000
Training Loss: 0.01839083, Training R2: 0.999751
Validation Loss: 0.37801709, Validation R2: 0.861707

Epoch 173/1000
Epoch 00173: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.02410114, Training R2: 0.999587
Validation Loss: 0.37919034, Validation R2: 0.861060

Epoch 174/1000
学习率已减少 3 次
Training Loss: 0.01482514, Training R2: 0.999822
Validation Loss: 0.37801188, Validation R2: 0.862044

Epoch 175/1000
Training Loss: 0.01081812, Training R2: 0.999906
Validation Loss: 0.37683356, Validation R2: 0.862492

Epoch 176/1000
Training Loss: 0.00890310, Training R2: 0.999936
Validation Loss: 0.37633657, Validation R2: 0.862676

Epoch 177/1000
Training Loss: 0.00852523, Training R2: 0.999942
Validation Loss: 0.37769367, Validation R2: 0.861856

Epoch 178/1000
Training Loss: 0.00774203, Training R2: 0.999949
Validation Loss: 0.37690285, Validation R2: 0.862405

Epoch 179/1000
Training Loss: 0.00866540, Training R2: 0.999942
Validation Loss: 0.37703077, Validation R2: 0.862268

Epoch 180/1000
Training Loss: 0.00827594, Training R2: 0.999946
Validation Loss: 0.37866457, Validation R2: 0.861537

Epoch 181/1000
Training Loss: 0.00832469, Training R2: 0.999943
Validation Loss: 0.37663839, Validation R2: 0.862627

Epoch 182/1000
Training Loss: 0.00736530, Training R2: 0.999956
Validation Loss: 0.37726029, Validation R2: 0.862181

Epoch 183/1000
Training Loss: 0.00733402, Training R2: 0.999956
Validation Loss: 0.37747554, Validation R2: 0.862406

Epoch 184/1000
Training Loss: 0.00811743, Training R2: 0.999946
Validation Loss: 0.37737128, Validation R2: 0.862120

Epoch 185/1000
Training Loss: 0.00721165, Training R2: 0.999955
Validation Loss: 0.37671043, Validation R2: 0.862292

Epoch 186/1000
Training Loss: 0.00748583, Training R2: 0.999955
Validation Loss: 0.37722007, Validation R2: 0.862470

Epoch 187/1000
Training Loss: 0.00842473, Training R2: 0.999945
Validation Loss: 0.37701686, Validation R2: 0.862410

Epoch 188/1000
Training Loss: 0.00790580, Training R2: 0.999947
Validation Loss: 0.37650577, Validation R2: 0.862694

Epoch 189/1000
Training Loss: 0.00747918, Training R2: 0.999953
Validation Loss: 0.37698522, Validation R2: 0.862688

Epoch 190/1000
Training Loss: 0.00696340, Training R2: 0.999962
Validation Loss: 0.37771934, Validation R2: 0.862002

Epoch 191/1000
Training Loss: 0.00699602, Training R2: 0.999960
Validation Loss: 0.37698994, Validation R2: 0.862343

Epoch 192/1000
Training Loss: 0.00743821, Training R2: 0.999957
Validation Loss: 0.37726547, Validation R2: 0.862346

Epoch 193/1000
Training Loss: 0.00836843, Training R2: 0.999946
Validation Loss: 0.37797721, Validation R2: 0.862147

Epoch 194/1000
Epoch 00194: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00942961, Training R2: 0.999931
Validation Loss: 0.37702674, Validation R2: 0.862575

Epoch 195/1000
学习率已减少 4 次
Training Loss: 0.00721340, Training R2: 0.999958
Validation Loss: 0.37717416, Validation R2: 0.862461

Epoch 196/1000
Training Loss: 0.00563483, Training R2: 0.999973
Validation Loss: 0.37716454, Validation R2: 0.862650

Epoch 197/1000
Training Loss: 0.00436701, Training R2: 0.999983
Validation Loss: 0.37770631, Validation R2: 0.861992

Epoch 198/1000
Training Loss: 0.00418598, Training R2: 0.999983
Validation Loss: 0.37729410, Validation R2: 0.862315

Epoch 199/1000
Training Loss: 0.00418830, Training R2: 0.999985
Validation Loss: 0.37698668, Validation R2: 0.862452

Epoch 200/1000
Training Loss: 0.00416849, Training R2: 0.999984
Validation Loss: 0.37727205, Validation R2: 0.862185

Epoch 201/1000
Training Loss: 0.00378780, Training R2: 0.999987
Validation Loss: 0.37732095, Validation R2: 0.862143

Epoch 202/1000
Training Loss: 0.00416074, Training R2: 0.999985
Validation Loss: 0.37677925, Validation R2: 0.862351

Epoch 203/1000
Training Loss: 0.00366707, Training R2: 0.999987
Validation Loss: 0.37788672, Validation R2: 0.861987

Epoch 204/1000
Training Loss: 0.00415745, Training R2: 0.999984
Validation Loss: 0.37635457, Validation R2: 0.862671

Epoch 205/1000
Training Loss: 0.00431866, Training R2: 0.999984
Validation Loss: 0.37698549, Validation R2: 0.862596

Epoch 206/1000
Training Loss: 0.00433325, Training R2: 0.999983
Validation Loss: 0.37724569, Validation R2: 0.862076

Epoch 207/1000
Training Loss: 0.00472153, Training R2: 0.999981
Validation Loss: 0.37750115, Validation R2: 0.862328

Epoch 208/1000
Training Loss: 0.00442569, Training R2: 0.999983
Validation Loss: 0.37703263, Validation R2: 0.862550

Epoch 209/1000
Training Loss: 0.00419713, Training R2: 0.999984
Validation Loss: 0.37684856, Validation R2: 0.862385

Epoch 210/1000
Training Loss: 0.00403842, Training R2: 0.999985
Validation Loss: 0.37689859, Validation R2: 0.862612

Epoch 211/1000
Training Loss: 0.00471648, Training R2: 0.999981
Validation Loss: 0.37718653, Validation R2: 0.862443

Epoch 212/1000
Training Loss: 0.00439380, Training R2: 0.999983
Validation Loss: 0.37774373, Validation R2: 0.862208

Epoch 213/1000
Training Loss: 0.00400398, Training R2: 0.999985
Validation Loss: 0.37714868, Validation R2: 0.862376

Epoch 214/1000
Training Loss: 0.00456609, Training R2: 0.999983
Validation Loss: 0.37743898, Validation R2: 0.862233

Epoch 215/1000
Epoch 00215: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00425179, Training R2: 0.999984
Validation Loss: 0.37765239, Validation R2: 0.862026

Epoch 216/1000
学习率已减少 5 次
Training Loss: 0.00340549, Training R2: 0.999989
Validation Loss: 0.37763763, Validation R2: 0.862018

Epoch 217/1000
Training Loss: 0.00310616, Training R2: 0.999990
Validation Loss: 0.37719940, Validation R2: 0.862351

Epoch 218/1000
Training Loss: 0.00278467, Training R2: 0.999992
Validation Loss: 0.37748854, Validation R2: 0.862147

Epoch 219/1000
Training Loss: 0.00333267, Training R2: 0.999991
Validation Loss: 0.37703596, Validation R2: 0.862347

Epoch 220/1000
Training Loss: 0.00284576, Training R2: 0.999992
Validation Loss: 0.37699389, Validation R2: 0.862497

Epoch 221/1000
Training Loss: 0.00260161, Training R2: 0.999992
Validation Loss: 0.37699717, Validation R2: 0.862423

Epoch 222/1000
Training Loss: 0.00258589, Training R2: 0.999993
Validation Loss: 0.37689373, Validation R2: 0.862303

Epoch 223/1000
Training Loss: 0.00257070, Training R2: 0.999992
Validation Loss: 0.37714356, Validation R2: 0.862414

Epoch 224/1000
Training Loss: 0.00239827, Training R2: 0.999993
Validation Loss: 0.37670493, Validation R2: 0.862532

Epoch 225/1000
Training Loss: 0.00213681, Training R2: 0.999994
Validation Loss: 0.37744442, Validation R2: 0.862250

Epoch 226/1000
Training Loss: 0.00212261, Training R2: 0.999994
Validation Loss: 0.37734561, Validation R2: 0.862236

Epoch 227/1000
Training Loss: 0.00212998, Training R2: 0.999994
Validation Loss: 0.37705511, Validation R2: 0.862419

Epoch 228/1000
Training Loss: 0.00214866, Training R2: 0.999994
Validation Loss: 0.37705755, Validation R2: 0.862207

Epoch 229/1000
Training Loss: 0.00219337, Training R2: 0.999994
Validation Loss: 0.37687904, Validation R2: 0.862483

Epoch 230/1000
Training Loss: 0.00222749, Training R2: 0.999993
Validation Loss: 0.37717635, Validation R2: 0.862322

Epoch 231/1000
Training Loss: 0.00236158, Training R2: 0.999993
Validation Loss: 0.37707563, Validation R2: 0.862355

Epoch 232/1000
Training Loss: 0.00281964, Training R2: 0.999993
Validation Loss: 0.37704439, Validation R2: 0.862358

Epoch 233/1000
Training Loss: 0.00271302, Training R2: 0.999992
Validation Loss: 0.37713491, Validation R2: 0.862349

Epoch 234/1000
Training Loss: 0.00332823, Training R2: 0.999990
Validation Loss: 0.37710924, Validation R2: 0.862429

Epoch 235/1000
Training Loss: 0.00249536, Training R2: 0.999993
Validation Loss: 0.37704920, Validation R2: 0.862363

Epoch 236/1000
Epoch 00236: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00243285, Training R2: 0.999992
Validation Loss: 0.37702733, Validation R2: 0.862496

Epoch 237/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
