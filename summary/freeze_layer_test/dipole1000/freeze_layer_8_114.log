Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)
冻结层 6: interaction_blocks.3 (SimpleInteractionBlock)
冻结层 7: lins.0 (Linear)
冻结层 8: lins.1 (Linear)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Frozen
interaction_blocks.3.conv1.lin_rel.bias: Frozen
interaction_blocks.3.conv1.lin_root.weight: Frozen
interaction_blocks.3.conv2.lin_rel.weight: Frozen
interaction_blocks.3.conv2.lin_rel.bias: Frozen
interaction_blocks.3.conv2.lin_root.weight: Frozen
interaction_blocks.3.lin1.weight: Frozen
interaction_blocks.3.lin1.bias: Frozen
interaction_blocks.3.lin2.weight: Frozen
interaction_blocks.3.lin2.bias: Frozen
interaction_blocks.3.lin_cat.weight: Frozen
interaction_blocks.3.lin_cat.bias: Frozen
interaction_blocks.3.norm.weight: Frozen
interaction_blocks.3.norm.bias: Frozen
interaction_blocks.3.norm.mean_scale: Frozen
interaction_blocks.3.lin_feature1.lin1.weight: Frozen
interaction_blocks.3.lin_feature1.lin2.weight: Frozen
interaction_blocks.3.lin_feature2.lin1.weight: Frozen
interaction_blocks.3.lin_feature2.lin2.weight: Frozen
interaction_blocks.3.lin.weight: Frozen
interaction_blocks.3.lin.bias: Frozen
interaction_blocks.3.lins.0.weight: Frozen
interaction_blocks.3.lins.0.bias: Frozen
interaction_blocks.3.lins.1.weight: Frozen
interaction_blocks.3.lins.1.bias: Frozen
interaction_blocks.3.lins.2.weight: Frozen
interaction_blocks.3.lins.2.bias: Frozen
interaction_blocks.3.lins.3.weight: Frozen
interaction_blocks.3.lins.3.bias: Frozen
interaction_blocks.3.final.weight: Frozen
interaction_blocks.3.final.bias: Frozen
lins.0.weight: Frozen
lins.0.bias: Frozen
lins.1.weight: Frozen
lins.1.bias: Frozen
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 1092227

Epoch 1/1000
Training Loss: 1.27514027, Training R2: -0.179125
Validation Loss: 1.06348908, Validation R2: -0.075587
Saved best model with validation R2 -0.075587 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.14874102, Training R2: -0.004861
Validation Loss: 1.11388254, Validation R2: -0.036052
Saved best model with validation R2 -0.036052 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.17662077, Training R2: 0.012213
Validation Loss: 1.09304214, Validation R2: -0.110942

Epoch 4/1000
Training Loss: 1.20177783, Training R2: -0.200461
Validation Loss: 1.04267299, Validation R2: 0.020771
Saved best model with validation R2 0.020771 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.14231950, Training R2: 0.025815
Validation Loss: 1.07509577, Validation R2: 0.037555
Saved best model with validation R2 0.037555 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 1.15298706, Training R2: 0.037447
Validation Loss: 1.04187453, Validation R2: 0.020126

Epoch 7/1000
Training Loss: 1.13003156, Training R2: -0.048684
Validation Loss: 1.10643435, Validation R2: -0.160851

Epoch 8/1000
Training Loss: 1.15555601, Training R2: -0.123879
Validation Loss: 1.03165925, Validation R2: 0.036857

Epoch 9/1000
Training Loss: 1.12379526, Training R2: 0.029943
Validation Loss: 1.02610278, Validation R2: 0.082106
Saved best model with validation R2 0.082106 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 1.11802325, Training R2: 0.044455
Validation Loss: 1.02525032, Validation R2: 0.027775

Epoch 11/1000
Training Loss: 1.11146376, Training R2: 0.010518
Validation Loss: 1.02226937, Validation R2: 0.061791

Epoch 12/1000
Training Loss: 1.11623219, Training R2: 0.036083
Validation Loss: 1.01954973, Validation R2: 0.062235

Epoch 13/1000
Training Loss: 1.11685306, Training R2: 0.012137
Validation Loss: 1.02147639, Validation R2: 0.021713

Epoch 14/1000
Training Loss: 1.11073825, Training R2: 0.041441
Validation Loss: 1.02545011, Validation R2: 0.096799
Saved best model with validation R2 0.096799 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 1.10913047, Training R2: 0.072868
Validation Loss: 1.01875556, Validation R2: 0.041773

Epoch 16/1000
Training Loss: 1.12531074, Training R2: -0.020467
Validation Loss: 1.01799417, Validation R2: 0.061334

Epoch 17/1000
Training Loss: 1.12333591, Training R2: 0.054175
Validation Loss: 1.05488670, Validation R2: 0.056750

Epoch 18/1000
Training Loss: 1.14930685, Training R2: 0.052129
Validation Loss: 1.02487516, Validation R2: 0.062740

Epoch 19/1000
Training Loss: 1.12605206, Training R2: -0.018841
Validation Loss: 1.07380557, Validation R2: -0.091765

Epoch 20/1000
Training Loss: 1.12890189, Training R2: -0.046835
Validation Loss: 1.02277601, Validation R2: 0.080433

Epoch 21/1000
Training Loss: 1.10776047, Training R2: 0.056030
Validation Loss: 1.01522195, Validation R2: 0.077569

Epoch 22/1000
Training Loss: 1.09884908, Training R2: 0.040682
Validation Loss: 1.02021646, Validation R2: 0.046621

Epoch 23/1000
Training Loss: 1.10215949, Training R2: 0.028379
Validation Loss: 1.01208019, Validation R2: 0.077666

Epoch 24/1000
Training Loss: 1.09472457, Training R2: 0.042791
Validation Loss: 1.01419079, Validation R2: 0.084265

Epoch 25/1000
Training Loss: 1.09537277, Training R2: 0.065345
Validation Loss: 1.01059353, Validation R2: 0.110052
Saved best model with validation R2 0.110052 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 1.09752739, Training R2: 0.075777
Validation Loss: 1.00724316, Validation R2: 0.063263

Epoch 27/1000
Training Loss: 1.10212864, Training R2: 0.008341
Validation Loss: 1.00970125, Validation R2: 0.053864

Epoch 28/1000
Training Loss: 1.08781214, Training R2: 0.052980
Validation Loss: 1.00808632, Validation R2: 0.113535
Saved best model with validation R2 0.113535 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 1.08868849, Training R2: 0.080289
Validation Loss: 1.00133359, Validation R2: 0.070083

Epoch 30/1000
Training Loss: 1.08498642, Training R2: 0.037133
Validation Loss: 0.99120915, Validation R2: 0.118860
Saved best model with validation R2 0.118860 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 1.08804007, Training R2: 0.080921
Validation Loss: 0.98526627, Validation R2: 0.124186
Saved best model with validation R2 0.124186 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 1.08561761, Training R2: 0.054032
Validation Loss: 0.99261612, Validation R2: 0.078306

Epoch 33/1000
Training Loss: 1.08244266, Training R2: 0.054305
Validation Loss: 0.98112744, Validation R2: 0.131039
Saved best model with validation R2 0.131039 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 1.07925725, Training R2: 0.063023
Validation Loss: 0.98309577, Validation R2: 0.110699

Epoch 35/1000
Training Loss: 1.07047501, Training R2: 0.090451
Validation Loss: 0.96704310, Validation R2: 0.142875
Saved best model with validation R2 0.142875 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 1.06253229, Training R2: 0.094971
Validation Loss: 0.96780163, Validation R2: 0.126147

Epoch 37/1000
Training Loss: 1.06581043, Training R2: 0.068241
Validation Loss: 0.99183303, Validation R2: 0.066239

Epoch 38/1000
Training Loss: 1.08952086, Training R2: 0.005007
Validation Loss: 0.98409659, Validation R2: 0.126024

Epoch 39/1000
Training Loss: 1.07484729, Training R2: 0.099219
Validation Loss: 0.97122914, Validation R2: 0.135636

Epoch 40/1000
Training Loss: 1.06897855, Training R2: 0.098460
Validation Loss: 0.98552585, Validation R2: 0.137892

Epoch 41/1000
Training Loss: 1.11315378, Training R2: 0.097178
Validation Loss: 0.96591920, Validation R2: 0.157109
Saved best model with validation R2 0.157109 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 1.05826044, Training R2: 0.108890
Validation Loss: 0.97656220, Validation R2: 0.111722

Epoch 43/1000
Training Loss: 1.05457756, Training R2: 0.101857
Validation Loss: 0.97135490, Validation R2: 0.148413

Epoch 44/1000
Training Loss: 1.05799347, Training R2: 0.122137
Validation Loss: 0.97446370, Validation R2: 0.105994

Epoch 45/1000
Training Loss: 1.04507202, Training R2: 0.100055
Validation Loss: 0.96444809, Validation R2: 0.149874

Epoch 46/1000
Training Loss: 1.05340566, Training R2: 0.105178
Validation Loss: 0.93365324, Validation R2: 0.184546
Saved best model with validation R2 0.184546 to best_finetuned_model.pth

Epoch 47/1000
Training Loss: 1.05139992, Training R2: 0.134080
Validation Loss: 0.95477122, Validation R2: 0.134903

Epoch 48/1000
Training Loss: 1.03390413, Training R2: 0.092916
Validation Loss: 0.97148013, Validation R2: 0.148203

Epoch 49/1000
Training Loss: 1.04694832, Training R2: 0.141329
Validation Loss: 1.01120400, Validation R2: 0.012189

Epoch 50/1000
Training Loss: 1.06452281, Training R2: 0.049831
Validation Loss: 0.94429410, Validation R2: 0.158642

Epoch 51/1000
Training Loss: 1.05007644, Training R2: 0.048775
Validation Loss: 1.00437129, Validation R2: 0.118367

Epoch 52/1000
Training Loss: 1.13014675, Training R2: 0.082371
Validation Loss: 1.01440012, Validation R2: 0.095024

Epoch 53/1000
Training Loss: 1.04619999, Training R2: 0.146909
Validation Loss: 0.99778205, Validation R2: 0.070536

Epoch 54/1000
Training Loss: 1.04812844, Training R2: 0.102403
Validation Loss: 0.97630942, Validation R2: 0.142046

Epoch 55/1000
Training Loss: 1.04284474, Training R2: 0.153022
Validation Loss: 1.03391802, Validation R2: 0.007744

Epoch 56/1000
Training Loss: 1.07059485, Training R2: 0.046660
Validation Loss: 0.97354549, Validation R2: 0.134468

Epoch 57/1000
Training Loss: 1.04211896, Training R2: 0.138612
Validation Loss: 0.96587074, Validation R2: 0.131684

Epoch 58/1000
Training Loss: 1.02451860, Training R2: 0.095311
Validation Loss: 0.97850627, Validation R2: 0.139666

Epoch 59/1000
Training Loss: 1.05624804, Training R2: 0.141963
Validation Loss: 1.04164779, Validation R2: -0.008688

Epoch 60/1000
Training Loss: 1.10677665, Training R2: -0.031455
Validation Loss: 0.98662961, Validation R2: 0.139186

Epoch 61/1000
Training Loss: 1.08538942, Training R2: 0.124871
Validation Loss: 0.98630202, Validation R2: 0.134259

Epoch 62/1000
Training Loss: 1.06504343, Training R2: 0.073136
Validation Loss: 0.99195266, Validation R2: 0.067288

Epoch 63/1000
Training Loss: 1.01909740, Training R2: 0.127976
Validation Loss: 0.98835552, Validation R2: 0.116796

Epoch 64/1000
Training Loss: 1.02949088, Training R2: 0.159487
Validation Loss: 0.97674596, Validation R2: 0.104546

Epoch 65/1000
Training Loss: 1.01170479, Training R2: 0.118196
Validation Loss: 0.95560485, Validation R2: 0.161158

Epoch 66/1000
Training Loss: 1.00657479, Training R2: 0.172211
Validation Loss: 0.92862880, Validation R2: 0.169176

Epoch 67/1000
Epoch 00067: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.96747663, Training R2: 0.197926
Validation Loss: 0.95196223, Validation R2: 0.151407

Epoch 68/1000
学习率已减少 1 次
Training Loss: 0.98681530, Training R2: 0.202651
Validation Loss: 0.93408155, Validation R2: 0.180363

Epoch 69/1000
Training Loss: 0.96536052, Training R2: 0.197557
Validation Loss: 0.93734527, Validation R2: 0.170041

Epoch 70/1000
Training Loss: 0.95713051, Training R2: 0.226440
Validation Loss: 0.94119680, Validation R2: 0.152946

Epoch 71/1000
Training Loss: 0.96293051, Training R2: 0.204202
Validation Loss: 0.94066846, Validation R2: 0.162853

Epoch 72/1000
Training Loss: 0.94653208, Training R2: 0.217208
Validation Loss: 0.95269543, Validation R2: 0.140735

Epoch 73/1000
Training Loss: 0.94259546, Training R2: 0.239826
Validation Loss: 0.93800610, Validation R2: 0.165420

Epoch 74/1000
Training Loss: 0.93777421, Training R2: 0.222793
Validation Loss: 0.93690765, Validation R2: 0.186458
Saved best model with validation R2 0.186458 to best_finetuned_model.pth

Epoch 75/1000
Training Loss: 0.93679223, Training R2: 0.223812
Validation Loss: 0.91272330, Validation R2: 0.219799
Saved best model with validation R2 0.219799 to best_finetuned_model.pth

Epoch 76/1000
Training Loss: 0.93017728, Training R2: 0.252112
Validation Loss: 0.92222321, Validation R2: 0.198509

Epoch 77/1000
Training Loss: 0.92491002, Training R2: 0.244390
Validation Loss: 0.92841583, Validation R2: 0.174362

Epoch 78/1000
Training Loss: 0.90928765, Training R2: 0.269552
Validation Loss: 0.92313826, Validation R2: 0.189095

Epoch 79/1000
Training Loss: 0.90549847, Training R2: 0.269178
Validation Loss: 0.96245724, Validation R2: 0.139681

Epoch 80/1000
Training Loss: 0.89578075, Training R2: 0.271126
Validation Loss: 0.95727736, Validation R2: 0.122011

Epoch 81/1000
Training Loss: 0.90195580, Training R2: 0.277816
Validation Loss: 0.89821464, Validation R2: 0.195663

Epoch 82/1000
Training Loss: 0.89343646, Training R2: 0.273873
Validation Loss: 0.87935382, Validation R2: 0.233138
Saved best model with validation R2 0.233138 to best_finetuned_model.pth

Epoch 83/1000
Training Loss: 0.88601481, Training R2: 0.283627
Validation Loss: 0.91531688, Validation R2: 0.199994

Epoch 84/1000
Training Loss: 0.86705826, Training R2: 0.305945
Validation Loss: 0.90254819, Validation R2: 0.196862

Epoch 85/1000
Training Loss: 0.89325202, Training R2: 0.268504
Validation Loss: 0.90861595, Validation R2: 0.207263

Epoch 86/1000
Training Loss: 0.87172285, Training R2: 0.291185
Validation Loss: 0.90586698, Validation R2: 0.204451

Epoch 87/1000
Training Loss: 0.85321648, Training R2: 0.316373
Validation Loss: 0.89873344, Validation R2: 0.216494

Epoch 88/1000
Training Loss: 0.85689901, Training R2: 0.323164
Validation Loss: 0.90800643, Validation R2: 0.192404

Epoch 89/1000
Training Loss: 0.85872304, Training R2: 0.305435
Validation Loss: 0.94476819, Validation R2: 0.159059

Epoch 90/1000
Training Loss: 0.85377625, Training R2: 0.314034
Validation Loss: 1.03737795, Validation R2: -0.011699

Epoch 91/1000
Training Loss: 0.92075292, Training R2: 0.244661
Validation Loss: 1.03075194, Validation R2: -0.000087

Epoch 92/1000
Training Loss: 0.99387425, Training R2: 0.119038
Validation Loss: 0.90473020, Validation R2: 0.234170
Saved best model with validation R2 0.234170 to best_finetuned_model.pth

Epoch 93/1000
Training Loss: 0.86205507, Training R2: 0.313039
Validation Loss: 0.90093201, Validation R2: 0.224774

Epoch 94/1000
Training Loss: 0.83642276, Training R2: 0.340379
Validation Loss: 0.94082808, Validation R2: 0.157741

Epoch 95/1000
Training Loss: 0.82526906, Training R2: 0.350686
Validation Loss: 0.94292694, Validation R2: 0.136399

Epoch 96/1000
Training Loss: 0.83933267, Training R2: 0.334189
Validation Loss: 0.91931510, Validation R2: 0.176223

Epoch 97/1000
Training Loss: 0.81280840, Training R2: 0.349985
Validation Loss: 0.91488796, Validation R2: 0.183038

Epoch 98/1000
Training Loss: 0.82477803, Training R2: 0.358365
Validation Loss: 0.93793088, Validation R2: 0.145830

Epoch 99/1000
Training Loss: 0.87949070, Training R2: 0.267077
Validation Loss: 0.97598892, Validation R2: 0.110524

Epoch 100/1000
Training Loss: 0.87729300, Training R2: 0.310745
Validation Loss: 0.93936354, Validation R2: 0.134383

Epoch 101/1000
Training Loss: 0.84494339, Training R2: 0.318339
Validation Loss: 0.92023283, Validation R2: 0.185135

Epoch 102/1000
Training Loss: 0.83131552, Training R2: 0.337928
Validation Loss: 0.88408875, Validation R2: 0.231197

Epoch 103/1000
Training Loss: 0.82918311, Training R2: 0.338761
Validation Loss: 0.90146726, Validation R2: 0.223052

Epoch 104/1000
Training Loss: 0.80515486, Training R2: 0.384133
Validation Loss: 0.89659852, Validation R2: 0.220158

Epoch 105/1000
Training Loss: 0.79965647, Training R2: 0.385825
Validation Loss: 0.90811902, Validation R2: 0.219229

Epoch 106/1000
Training Loss: 0.77666975, Training R2: 0.397746
Validation Loss: 0.92489010, Validation R2: 0.180644

Epoch 107/1000
Training Loss: 0.78400804, Training R2: 0.393580
Validation Loss: 0.92660493, Validation R2: 0.172445

Epoch 108/1000
Training Loss: 0.85583052, Training R2: 0.294480
Validation Loss: 0.96269894, Validation R2: 0.106720

Epoch 109/1000
Training Loss: 0.81298645, Training R2: 0.368506
Validation Loss: 0.91262370, Validation R2: 0.208200

Epoch 110/1000
Training Loss: 0.81512794, Training R2: 0.367684
Validation Loss: 0.90627533, Validation R2: 0.216532

Epoch 111/1000
Training Loss: 0.76972914, Training R2: 0.400425
Validation Loss: 0.89620948, Validation R2: 0.216058

Epoch 112/1000
Training Loss: 0.78341236, Training R2: 0.388727
Validation Loss: 0.90726298, Validation R2: 0.205803

Epoch 113/1000
Epoch 00113: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.78886554, Training R2: 0.392747
Validation Loss: 0.92605865, Validation R2: 0.165748

Epoch 114/1000
学习率已减少 2 次
Training Loss: 0.76889991, Training R2: 0.408777
Validation Loss: 0.91686362, Validation R2: 0.169814

Epoch 115/1000
Training Loss: 0.76598629, Training R2: 0.420090
Validation Loss: 0.91235512, Validation R2: 0.197638

Epoch 116/1000
Training Loss: 0.77093306, Training R2: 0.400147
Validation Loss: 0.90549642, Validation R2: 0.213286

Epoch 117/1000
Training Loss: 0.75896286, Training R2: 0.419383
Validation Loss: 0.90937847, Validation R2: 0.208168

Epoch 118/1000
Training Loss: 0.75990900, Training R2: 0.414200
Validation Loss: 0.91120696, Validation R2: 0.197839

Epoch 119/1000
Training Loss: 0.75518232, Training R2: 0.414972
Validation Loss: 0.90434408, Validation R2: 0.192328

Epoch 120/1000
Training Loss: 0.74798544, Training R2: 0.422194
Validation Loss: 0.91076732, Validation R2: 0.200660

Epoch 121/1000
Training Loss: 0.75635894, Training R2: 0.413213
Validation Loss: 0.92239910, Validation R2: 0.176549

Epoch 122/1000
Training Loss: 0.73199292, Training R2: 0.443723
Validation Loss: 0.90640509, Validation R2: 0.217487

Epoch 123/1000
Training Loss: 0.72134842, Training R2: 0.452196
Validation Loss: 0.89878273, Validation R2: 0.236909
Saved best model with validation R2 0.236909 to best_finetuned_model.pth

Epoch 124/1000
Training Loss: 0.72661255, Training R2: 0.446847
Validation Loss: 0.90228164, Validation R2: 0.225759

Epoch 125/1000
Training Loss: 0.70985295, Training R2: 0.457811
Validation Loss: 0.93415374, Validation R2: 0.160935

Epoch 126/1000
Training Loss: 0.71199621, Training R2: 0.458415
Validation Loss: 0.94725716, Validation R2: 0.129611

Epoch 127/1000
Training Loss: 0.71824827, Training R2: 0.453149
Validation Loss: 0.94205892, Validation R2: 0.155063

Epoch 128/1000
Training Loss: 0.70338444, Training R2: 0.463572
Validation Loss: 0.90194684, Validation R2: 0.205501

Epoch 129/1000
Training Loss: 0.71950427, Training R2: 0.449654
Validation Loss: 0.91086853, Validation R2: 0.178776

Epoch 130/1000
Training Loss: 0.70762074, Training R2: 0.460349
Validation Loss: 0.94228321, Validation R2: 0.135561

Epoch 131/1000
Training Loss: 0.69840320, Training R2: 0.470212
Validation Loss: 0.91874343, Validation R2: 0.165094

Epoch 132/1000
Training Loss: 0.69575689, Training R2: 0.474712
Validation Loss: 0.91822350, Validation R2: 0.183974

Epoch 133/1000
Training Loss: 0.70090720, Training R2: 0.472318
Validation Loss: 0.92416042, Validation R2: 0.176070

Epoch 134/1000
Training Loss: 0.69579472, Training R2: 0.476941
Validation Loss: 0.93043607, Validation R2: 0.174806

Epoch 135/1000
Training Loss: 0.69524988, Training R2: 0.481588
Validation Loss: 0.93794346, Validation R2: 0.157361

Epoch 136/1000
Training Loss: 0.69881158, Training R2: 0.475790
Validation Loss: 0.92701119, Validation R2: 0.171100

Epoch 137/1000
Training Loss: 0.69864777, Training R2: 0.479195
Validation Loss: 0.93162400, Validation R2: 0.149072

Epoch 138/1000
Training Loss: 0.68082252, Training R2: 0.494017
Validation Loss: 0.94616973, Validation R2: 0.135046

Epoch 139/1000
Training Loss: 0.69377894, Training R2: 0.482078
Validation Loss: 0.94327831, Validation R2: 0.137667

Epoch 140/1000
Training Loss: 0.68681112, Training R2: 0.487643
Validation Loss: 0.94490933, Validation R2: 0.150459

Epoch 141/1000
Training Loss: 0.67865478, Training R2: 0.488201
Validation Loss: 0.95259827, Validation R2: 0.143736

Epoch 142/1000
Training Loss: 0.67364299, Training R2: 0.492750
Validation Loss: 0.95759571, Validation R2: 0.130329

Epoch 143/1000
Training Loss: 0.66707673, Training R2: 0.502210
Validation Loss: 0.92132705, Validation R2: 0.181356

Epoch 144/1000
Epoch 00144: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.67789212, Training R2: 0.504030
Validation Loss: 0.93413031, Validation R2: 0.162219

Epoch 145/1000
学习率已减少 3 次
Training Loss: 0.67270721, Training R2: 0.504724
Validation Loss: 0.96158355, Validation R2: 0.107912

Epoch 146/1000
Training Loss: 0.66806823, Training R2: 0.506909
Validation Loss: 0.97556424, Validation R2: 0.085376

Epoch 147/1000
Training Loss: 0.66101167, Training R2: 0.513567
Validation Loss: 0.93338603, Validation R2: 0.159237

Epoch 148/1000
Training Loss: 0.66231185, Training R2: 0.514132
Validation Loss: 0.93372697, Validation R2: 0.170274

Epoch 149/1000
Training Loss: 0.66022554, Training R2: 0.510909
Validation Loss: 0.93647015, Validation R2: 0.163791

Epoch 150/1000
Training Loss: 0.65317117, Training R2: 0.520845
Validation Loss: 0.96664619, Validation R2: 0.111158

Epoch 151/1000
Training Loss: 0.66671715, Training R2: 0.511601
Validation Loss: 0.97302693, Validation R2: 0.093797

Epoch 152/1000
Training Loss: 0.65194704, Training R2: 0.520343
Validation Loss: 0.94287056, Validation R2: 0.134271

Epoch 153/1000
Training Loss: 0.65577961, Training R2: 0.519535
Validation Loss: 0.92968303, Validation R2: 0.161875

Epoch 154/1000
Training Loss: 0.65353580, Training R2: 0.523927
Validation Loss: 0.94432592, Validation R2: 0.137916

Epoch 155/1000
Training Loss: 0.65491394, Training R2: 0.521677
Validation Loss: 0.96538198, Validation R2: 0.097842

Epoch 156/1000
Training Loss: 0.68594697, Training R2: 0.495764
Validation Loss: 0.96735656, Validation R2: 0.093279

Epoch 157/1000
Training Loss: 0.66476105, Training R2: 0.513056
Validation Loss: 0.95919132, Validation R2: 0.108912

Epoch 158/1000
Training Loss: 0.65639283, Training R2: 0.523477
Validation Loss: 0.95640171, Validation R2: 0.123141

Epoch 159/1000
Training Loss: 0.65923122, Training R2: 0.521476
Validation Loss: 0.94401199, Validation R2: 0.128598

Epoch 160/1000
Training Loss: 0.65800714, Training R2: 0.520136
Validation Loss: 0.96733260, Validation R2: 0.093977

Epoch 161/1000
Training Loss: 0.65042981, Training R2: 0.523809
Validation Loss: 0.96365047, Validation R2: 0.094993

Epoch 162/1000
Training Loss: 0.64005095, Training R2: 0.531734
Validation Loss: 0.93961990, Validation R2: 0.141320

Epoch 163/1000
Training Loss: 0.64070953, Training R2: 0.526766
Validation Loss: 0.93063629, Validation R2: 0.168593

Epoch 164/1000
Training Loss: 0.63593568, Training R2: 0.532150
Validation Loss: 0.94387299, Validation R2: 0.139823

Epoch 165/1000
Epoch 00165: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.62901460, Training R2: 0.536921
Validation Loss: 0.96595210, Validation R2: 0.090052

Epoch 166/1000
学习率已减少 4 次
Training Loss: 0.63084743, Training R2: 0.535487
Validation Loss: 0.96900982, Validation R2: 0.083944

Epoch 167/1000
Training Loss: 0.63321311, Training R2: 0.532774
Validation Loss: 0.95742261, Validation R2: 0.113931

Epoch 168/1000
Training Loss: 0.62590955, Training R2: 0.534694
Validation Loss: 0.94655347, Validation R2: 0.137292

Epoch 169/1000
Training Loss: 0.62687161, Training R2: 0.538066
Validation Loss: 0.94567519, Validation R2: 0.136622

Epoch 170/1000
Training Loss: 0.62482459, Training R2: 0.538044
Validation Loss: 0.96489966, Validation R2: 0.077649

Epoch 171/1000
Training Loss: 0.62139459, Training R2: 0.542026
Validation Loss: 0.95533019, Validation R2: 0.112710

Epoch 172/1000
Training Loss: 0.62162899, Training R2: 0.541658
Validation Loss: 0.95532227, Validation R2: 0.105691

Epoch 173/1000
Training Loss: 0.62244268, Training R2: 0.541312
Validation Loss: 0.95952851, Validation R2: 0.096469

Epoch 174/1000
Training Loss: 0.62095029, Training R2: 0.539945
Validation Loss: 0.96410316, Validation R2: 0.101018

Epoch 175/1000
Training Loss: 0.61901330, Training R2: 0.543107
Validation Loss: 0.96000397, Validation R2: 0.116588

Epoch 176/1000
Training Loss: 0.61722373, Training R2: 0.544829
Validation Loss: 0.95024502, Validation R2: 0.136069

Epoch 177/1000
Training Loss: 0.61646240, Training R2: 0.545719
Validation Loss: 0.94694883, Validation R2: 0.131657

Epoch 178/1000
Training Loss: 0.61742697, Training R2: 0.546628
Validation Loss: 0.95290548, Validation R2: 0.115155

Epoch 179/1000
Training Loss: 0.61612280, Training R2: 0.545996
Validation Loss: 0.96093845, Validation R2: 0.110503

Epoch 180/1000
Training Loss: 0.61424447, Training R2: 0.545070
Validation Loss: 0.96297306, Validation R2: 0.113954

Epoch 181/1000
Training Loss: 0.61583592, Training R2: 0.545756
Validation Loss: 0.96450531, Validation R2: 0.103830

Epoch 182/1000
Training Loss: 0.61198911, Training R2: 0.545424
Validation Loss: 0.97191036, Validation R2: 0.089776

Epoch 183/1000
Training Loss: 0.61151007, Training R2: 0.546096
Validation Loss: 0.96687084, Validation R2: 0.097724

Epoch 184/1000
Training Loss: 0.61144942, Training R2: 0.546695
Validation Loss: 0.96307248, Validation R2: 0.102105

Epoch 185/1000
Training Loss: 0.61676889, Training R2: 0.545454
Validation Loss: 0.95758390, Validation R2: 0.113425

Epoch 186/1000
Epoch 00186: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.61107735, Training R2: 0.545851
Validation Loss: 0.96095318, Validation R2: 0.108442

Epoch 187/1000
学习率已减少 5 次
Training Loss: 0.61223505, Training R2: 0.547271
Validation Loss: 0.96308720, Validation R2: 0.100023

Epoch 188/1000
Training Loss: 0.60807853, Training R2: 0.549143
Validation Loss: 0.96965277, Validation R2: 0.096821

Epoch 189/1000
Training Loss: 0.60591584, Training R2: 0.550437
Validation Loss: 0.96262258, Validation R2: 0.110136

Epoch 190/1000
Training Loss: 0.60721501, Training R2: 0.549652
Validation Loss: 0.97218937, Validation R2: 0.098183

Epoch 191/1000
Training Loss: 0.60551036, Training R2: 0.550068
Validation Loss: 0.96942502, Validation R2: 0.094575

Epoch 192/1000
Training Loss: 0.60736758, Training R2: 0.546134
Validation Loss: 0.97244841, Validation R2: 0.085641

Epoch 193/1000
Training Loss: 0.60584129, Training R2: 0.550284
Validation Loss: 0.96877408, Validation R2: 0.092743

Epoch 194/1000
Training Loss: 0.60696493, Training R2: 0.550126
Validation Loss: 0.96734226, Validation R2: 0.097604

Epoch 195/1000
Training Loss: 0.60569800, Training R2: 0.551288
Validation Loss: 0.96341962, Validation R2: 0.099090

Epoch 196/1000
Training Loss: 0.60220162, Training R2: 0.554262
Validation Loss: 0.95961577, Validation R2: 0.106753

Epoch 197/1000
Training Loss: 0.60304467, Training R2: 0.553714
Validation Loss: 0.95986623, Validation R2: 0.105117

Epoch 198/1000
Training Loss: 0.60148162, Training R2: 0.555415
Validation Loss: 0.96778691, Validation R2: 0.095683

Epoch 199/1000
Training Loss: 0.60122426, Training R2: 0.554467
Validation Loss: 0.96671003, Validation R2: 0.091570

Epoch 200/1000
Training Loss: 0.60023603, Training R2: 0.554753
Validation Loss: 0.97184712, Validation R2: 0.082708

Epoch 201/1000
Training Loss: 0.60162673, Training R2: 0.552282
Validation Loss: 0.97426718, Validation R2: 0.082186

Epoch 202/1000
Training Loss: 0.60125689, Training R2: 0.552705
Validation Loss: 0.97571498, Validation R2: 0.081599

Epoch 203/1000
Training Loss: 0.59975746, Training R2: 0.553042
Validation Loss: 0.96817607, Validation R2: 0.095659

Epoch 204/1000
Training Loss: 0.60217415, Training R2: 0.550566
Validation Loss: 0.96174085, Validation R2: 0.106032

Epoch 205/1000
Training Loss: 0.60216376, Training R2: 0.552319
Validation Loss: 0.96227401, Validation R2: 0.103647

Epoch 206/1000
Training Loss: 0.59973957, Training R2: 0.552502
Validation Loss: 0.96561962, Validation R2: 0.104264

Epoch 207/1000
Epoch 00207: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.60104288, Training R2: 0.555699
Validation Loss: 0.96098655, Validation R2: 0.107714

Epoch 208/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
