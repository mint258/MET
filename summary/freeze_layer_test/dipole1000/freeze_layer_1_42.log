Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)

Frozen layers status:
emb_z.emb.weight: Trainable
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5317507

Epoch 1/1000
Training Loss: 1.98531115, Training R2: -1.801327
Validation Loss: 1.19593918, Validation R2: -0.104430
Saved best model with validation R2 -0.104430 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.19691965, Training R2: -0.035640
Validation Loss: 1.11416709, Validation R2: -0.188910

Epoch 3/1000
Training Loss: 1.11514288, Training R2: -0.019077
Validation Loss: 1.05159867, Validation R2: 0.093281
Saved best model with validation R2 0.093281 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 1.13036786, Training R2: 0.072217
Validation Loss: 1.01477695, Validation R2: 0.103644
Saved best model with validation R2 0.103644 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.05895743, Training R2: 0.089066
Validation Loss: 1.02515221, Validation R2: -0.006869

Epoch 6/1000
Training Loss: 1.00857928, Training R2: 0.126854
Validation Loss: 0.93578106, Validation R2: 0.232500
Saved best model with validation R2 0.232500 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.96411535, Training R2: 0.257541
Validation Loss: 0.91449499, Validation R2: 0.209627

Epoch 8/1000
Training Loss: 0.89661207, Training R2: 0.306103
Validation Loss: 0.81440669, Validation R2: 0.363014
Saved best model with validation R2 0.363014 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.82900762, Training R2: 0.377758
Validation Loss: 0.85138196, Validation R2: 0.337135

Epoch 10/1000
Training Loss: 0.75810847, Training R2: 0.430386
Validation Loss: 0.84701347, Validation R2: 0.335468

Epoch 11/1000
Training Loss: 0.71816743, Training R2: 0.478534
Validation Loss: 0.78209960, Validation R2: 0.427779
Saved best model with validation R2 0.427779 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.65534595, Training R2: 0.542172
Validation Loss: 0.82973325, Validation R2: 0.336930

Epoch 13/1000
Training Loss: 0.68737453, Training R2: 0.510199
Validation Loss: 0.75032026, Validation R2: 0.442655
Saved best model with validation R2 0.442655 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.62413464, Training R2: 0.579684
Validation Loss: 0.93185741, Validation R2: 0.262267

Epoch 15/1000
Training Loss: 0.70827457, Training R2: 0.519662
Validation Loss: 0.75177032, Validation R2: 0.464000
Saved best model with validation R2 0.464000 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.63418910, Training R2: 0.566852
Validation Loss: 0.76367158, Validation R2: 0.434407

Epoch 17/1000
Training Loss: 0.61268594, Training R2: 0.586937
Validation Loss: 0.78358239, Validation R2: 0.442044

Epoch 18/1000
Training Loss: 0.59959622, Training R2: 0.601096
Validation Loss: 0.74021775, Validation R2: 0.469804
Saved best model with validation R2 0.469804 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.57144022, Training R2: 0.636948
Validation Loss: 0.76837188, Validation R2: 0.393001

Epoch 20/1000
Training Loss: 0.54108437, Training R2: 0.654066
Validation Loss: 0.71074814, Validation R2: 0.495366
Saved best model with validation R2 0.495366 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.54810576, Training R2: 0.636464
Validation Loss: 0.71481973, Validation R2: 0.509148
Saved best model with validation R2 0.509148 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.50408694, Training R2: 0.663362
Validation Loss: 0.71746659, Validation R2: 0.477036

Epoch 23/1000
Training Loss: 0.50379310, Training R2: 0.669931
Validation Loss: 0.76816183, Validation R2: 0.438001

Epoch 24/1000
Training Loss: 0.47666312, Training R2: 0.689207
Validation Loss: 0.77138525, Validation R2: 0.435358

Epoch 25/1000
Training Loss: 0.46237287, Training R2: 0.715786
Validation Loss: 0.72007465, Validation R2: 0.519484
Saved best model with validation R2 0.519484 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.45093191, Training R2: 0.719429
Validation Loss: 0.70864946, Validation R2: 0.531823
Saved best model with validation R2 0.531823 to best_finetuned_model.pth

Epoch 27/1000
Training Loss: 0.45392227, Training R2: 0.728059
Validation Loss: 0.69978333, Validation R2: 0.528501

Epoch 28/1000
Training Loss: 0.41012873, Training R2: 0.743586
Validation Loss: 0.70279694, Validation R2: 0.529371

Epoch 29/1000
Training Loss: 0.39511705, Training R2: 0.753742
Validation Loss: 0.70138311, Validation R2: 0.539082
Saved best model with validation R2 0.539082 to best_finetuned_model.pth

Epoch 30/1000
Training Loss: 0.38770245, Training R2: 0.772303
Validation Loss: 0.72581786, Validation R2: 0.490296

Epoch 31/1000
Training Loss: 0.39830486, Training R2: 0.774069
Validation Loss: 0.70361161, Validation R2: 0.512134

Epoch 32/1000
Training Loss: 0.36396155, Training R2: 0.785117
Validation Loss: 0.68103349, Validation R2: 0.563679
Saved best model with validation R2 0.563679 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.36865029, Training R2: 0.785020
Validation Loss: 0.68920624, Validation R2: 0.539554

Epoch 34/1000
Training Loss: 0.35731999, Training R2: 0.807048
Validation Loss: 0.70394498, Validation R2: 0.524624

Epoch 35/1000
Training Loss: 0.36593961, Training R2: 0.804193
Validation Loss: 0.70891416, Validation R2: 0.543542

Epoch 36/1000
Training Loss: 0.38206162, Training R2: 0.804720
Validation Loss: 0.73335862, Validation R2: 0.511662

Epoch 37/1000
Training Loss: 0.40088536, Training R2: 0.794217
Validation Loss: 0.68595558, Validation R2: 0.562214

Epoch 38/1000
Training Loss: 0.35270255, Training R2: 0.809695
Validation Loss: 0.67832655, Validation R2: 0.546962

Epoch 39/1000
Training Loss: 0.34031024, Training R2: 0.815124
Validation Loss: 0.66693801, Validation R2: 0.548756

Epoch 40/1000
Training Loss: 0.29326713, Training R2: 0.838530
Validation Loss: 0.69124275, Validation R2: 0.522388

Epoch 41/1000
Training Loss: 0.30079854, Training R2: 0.836709
Validation Loss: 0.69111395, Validation R2: 0.522310

Epoch 42/1000
Training Loss: 0.29307407, Training R2: 0.841273
Validation Loss: 0.67246801, Validation R2: 0.543381

Epoch 43/1000
Training Loss: 0.29858409, Training R2: 0.839902
Validation Loss: 0.67534894, Validation R2: 0.542505

Epoch 44/1000
Training Loss: 0.27623911, Training R2: 0.847355
Validation Loss: 0.72021133, Validation R2: 0.489735

Epoch 45/1000
Training Loss: 0.30041571, Training R2: 0.846010
Validation Loss: 0.67520034, Validation R2: 0.548336

Epoch 46/1000
Training Loss: 0.27679495, Training R2: 0.853834
Validation Loss: 0.65280133, Validation R2: 0.575040
Saved best model with validation R2 0.575040 to best_finetuned_model.pth

Epoch 47/1000
Training Loss: 0.27371762, Training R2: 0.861720
Validation Loss: 0.72180897, Validation R2: 0.521841

Epoch 48/1000
Training Loss: 0.43526018, Training R2: 0.802628
Validation Loss: 0.69968748, Validation R2: 0.508533

Epoch 49/1000
Training Loss: 0.38036937, Training R2: 0.818753
Validation Loss: 0.76605988, Validation R2: 0.456553

Epoch 50/1000
Training Loss: 0.35768793, Training R2: 0.835493
Validation Loss: 0.66818166, Validation R2: 0.547496

Epoch 51/1000
Training Loss: 0.30397947, Training R2: 0.860864
Validation Loss: 0.64767575, Validation R2: 0.602812
Saved best model with validation R2 0.602812 to best_finetuned_model.pth

Epoch 52/1000
Training Loss: 0.31922003, Training R2: 0.834830
Validation Loss: 0.70632935, Validation R2: 0.533848

Epoch 53/1000
Training Loss: 0.38493232, Training R2: 0.815893
Validation Loss: 0.66494942, Validation R2: 0.540807

Epoch 54/1000
Training Loss: 0.33283239, Training R2: 0.827573
Validation Loss: 0.71856266, Validation R2: 0.508403

Epoch 55/1000
Training Loss: 0.33111245, Training R2: 0.829009
Validation Loss: 0.62835234, Validation R2: 0.595238

Epoch 56/1000
Training Loss: 0.31273109, Training R2: 0.829717
Validation Loss: 0.68344361, Validation R2: 0.589596

Epoch 57/1000
Training Loss: 0.34232444, Training R2: 0.839611
Validation Loss: 0.64864957, Validation R2: 0.584432

Epoch 58/1000
Training Loss: 0.33783375, Training R2: 0.847575
Validation Loss: 0.66692024, Validation R2: 0.566867

Epoch 59/1000
Training Loss: 0.27076609, Training R2: 0.861267
Validation Loss: 0.64038450, Validation R2: 0.593481

Epoch 60/1000
Training Loss: 0.24310848, Training R2: 0.877010
Validation Loss: 0.63703752, Validation R2: 0.606786
Saved best model with validation R2 0.606786 to best_finetuned_model.pth

Epoch 61/1000
Training Loss: 0.26015360, Training R2: 0.867278
Validation Loss: 0.64080739, Validation R2: 0.603233

Epoch 62/1000
Training Loss: 0.22095788, Training R2: 0.878554
Validation Loss: 0.64041930, Validation R2: 0.606059

Epoch 63/1000
Training Loss: 0.24062886, Training R2: 0.876101
Validation Loss: 0.63780308, Validation R2: 0.605485

Epoch 64/1000
Training Loss: 0.26363475, Training R2: 0.875560
Validation Loss: 0.65159780, Validation R2: 0.586056

Epoch 65/1000
Training Loss: 0.25851144, Training R2: 0.875664
Validation Loss: 0.65305436, Validation R2: 0.581952

Epoch 66/1000
Training Loss: 0.24192724, Training R2: 0.880811
Validation Loss: 0.63859504, Validation R2: 0.598081

Epoch 67/1000
Training Loss: 0.22187082, Training R2: 0.889194
Validation Loss: 0.64932144, Validation R2: 0.576880

Epoch 68/1000
Training Loss: 0.20308203, Training R2: 0.891783
Validation Loss: 0.65090847, Validation R2: 0.584134

Epoch 69/1000
Training Loss: 0.20767331, Training R2: 0.899414
Validation Loss: 0.63425004, Validation R2: 0.603422

Epoch 70/1000
Training Loss: 0.18752806, Training R2: 0.899962
Validation Loss: 0.65040570, Validation R2: 0.581072

Epoch 71/1000
Training Loss: 0.19198976, Training R2: 0.900425
Validation Loss: 0.65802169, Validation R2: 0.567452

Epoch 72/1000
Training Loss: 0.18291038, Training R2: 0.901321
Validation Loss: 0.64520979, Validation R2: 0.595181

Epoch 73/1000
Training Loss: 0.20637740, Training R2: 0.899178
Validation Loss: 0.66032147, Validation R2: 0.582172

Epoch 74/1000
Training Loss: 0.17834237, Training R2: 0.908537
Validation Loss: 0.67904824, Validation R2: 0.532453

Epoch 75/1000
Training Loss: 0.18540560, Training R2: 0.905884
Validation Loss: 0.69572502, Validation R2: 0.508146

Epoch 76/1000
Training Loss: 0.19293649, Training R2: 0.910830
Validation Loss: 0.68696254, Validation R2: 0.523522

Epoch 77/1000
Training Loss: 0.24874908, Training R2: 0.892325
Validation Loss: 0.62871075, Validation R2: 0.606851
Saved best model with validation R2 0.606851 to best_finetuned_model.pth

Epoch 78/1000
Training Loss: 0.19704851, Training R2: 0.910610
Validation Loss: 0.64383650, Validation R2: 0.610505
Saved best model with validation R2 0.610505 to best_finetuned_model.pth

Epoch 79/1000
Training Loss: 0.24044256, Training R2: 0.889337
Validation Loss: 0.62349087, Validation R2: 0.613587
Saved best model with validation R2 0.613587 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.18522653, Training R2: 0.907912
Validation Loss: 0.62386918, Validation R2: 0.597219

Epoch 81/1000
Training Loss: 0.17074834, Training R2: 0.909345
Validation Loss: 0.63871366, Validation R2: 0.584451

Epoch 82/1000
Training Loss: 0.17534790, Training R2: 0.913086
Validation Loss: 0.63094348, Validation R2: 0.577200

Epoch 83/1000
Training Loss: 0.19117949, Training R2: 0.908756
Validation Loss: 0.62135953, Validation R2: 0.596323

Epoch 84/1000
Training Loss: 0.20839667, Training R2: 0.902476
Validation Loss: 0.59650177, Validation R2: 0.653394
Saved best model with validation R2 0.653394 to best_finetuned_model.pth

Epoch 85/1000
Training Loss: 0.19005928, Training R2: 0.893663
Validation Loss: 0.59183478, Validation R2: 0.652719

Epoch 86/1000
Training Loss: 0.18472157, Training R2: 0.905542
Validation Loss: 0.61909288, Validation R2: 0.608383

Epoch 87/1000
Training Loss: 0.22842212, Training R2: 0.888974
Validation Loss: 0.60681117, Validation R2: 0.619086

Epoch 88/1000
Training Loss: 0.23275530, Training R2: 0.897695
Validation Loss: 0.60678786, Validation R2: 0.631663

Epoch 89/1000
Training Loss: 0.23874461, Training R2: 0.892820
Validation Loss: 0.63150364, Validation R2: 0.602188

Epoch 90/1000
Training Loss: 0.19318997, Training R2: 0.910146
Validation Loss: 0.65753323, Validation R2: 0.556925

Epoch 91/1000
Training Loss: 0.19761772, Training R2: 0.909653
Validation Loss: 0.63883817, Validation R2: 0.574319

Epoch 92/1000
Training Loss: 0.17086087, Training R2: 0.912796
Validation Loss: 0.61681503, Validation R2: 0.617928

Epoch 93/1000
Training Loss: 0.17392670, Training R2: 0.909112
Validation Loss: 0.62471426, Validation R2: 0.616968

Epoch 94/1000
Training Loss: 0.22010650, Training R2: 0.904003
Validation Loss: 0.61867177, Validation R2: 0.607712

Epoch 95/1000
Training Loss: 0.17660403, Training R2: 0.913543
Validation Loss: 0.61697692, Validation R2: 0.608622

Epoch 96/1000
Training Loss: 0.16646502, Training R2: 0.919165
Validation Loss: 0.62161875, Validation R2: 0.609727

Epoch 97/1000
Training Loss: 0.17191231, Training R2: 0.919178
Validation Loss: 0.62313735, Validation R2: 0.602314

Epoch 98/1000
Training Loss: 0.14907696, Training R2: 0.926975
Validation Loss: 0.62191910, Validation R2: 0.608763

Epoch 99/1000
Training Loss: 0.14434855, Training R2: 0.926119
Validation Loss: 0.62505531, Validation R2: 0.596008

Epoch 100/1000
Training Loss: 0.15898485, Training R2: 0.927358
Validation Loss: 0.63650167, Validation R2: 0.599008

Epoch 101/1000
Training Loss: 0.14680704, Training R2: 0.924884
Validation Loss: 0.63085920, Validation R2: 0.590710

Epoch 102/1000
Training Loss: 0.15072876, Training R2: 0.926306
Validation Loss: 0.62048411, Validation R2: 0.602926

Epoch 103/1000
Training Loss: 0.14836910, Training R2: 0.923710
Validation Loss: 0.63532764, Validation R2: 0.584623

Epoch 104/1000
Training Loss: 0.15273526, Training R2: 0.924744
Validation Loss: 0.62368345, Validation R2: 0.598194

Epoch 105/1000
Epoch 00105: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.17467890, Training R2: 0.920105
Validation Loss: 0.64287412, Validation R2: 0.578284

Epoch 106/1000
学习率已减少 1 次
Training Loss: 0.14753709, Training R2: 0.922935
Validation Loss: 0.63113707, Validation R2: 0.594318

Epoch 107/1000
Training Loss: 0.12819525, Training R2: 0.928177
Validation Loss: 0.62285012, Validation R2: 0.597222

Epoch 108/1000
Training Loss: 0.11838171, Training R2: 0.930200
Validation Loss: 0.62069929, Validation R2: 0.600386

Epoch 109/1000
Training Loss: 0.10681150, Training R2: 0.934057
Validation Loss: 0.62693554, Validation R2: 0.595125

Epoch 110/1000
Training Loss: 0.11410847, Training R2: 0.933848
Validation Loss: 0.62462175, Validation R2: 0.595399

Epoch 111/1000
Training Loss: 0.11626664, Training R2: 0.934019
Validation Loss: 0.63206428, Validation R2: 0.590074

Epoch 112/1000
Training Loss: 0.10608284, Training R2: 0.934904
Validation Loss: 0.64209348, Validation R2: 0.577009

Epoch 113/1000
Training Loss: 0.12057423, Training R2: 0.932483
Validation Loss: 0.63181794, Validation R2: 0.584262

Epoch 114/1000
Training Loss: 0.09901449, Training R2: 0.936450
Validation Loss: 0.62006325, Validation R2: 0.606693

Epoch 115/1000
Training Loss: 0.10226294, Training R2: 0.936014
Validation Loss: 0.63337058, Validation R2: 0.600560

Epoch 116/1000
Training Loss: 0.11749733, Training R2: 0.933590
Validation Loss: 0.62761891, Validation R2: 0.604828

Epoch 117/1000
Training Loss: 0.10241747, Training R2: 0.937500
Validation Loss: 0.62088865, Validation R2: 0.606945

Epoch 118/1000
Training Loss: 0.09956875, Training R2: 0.937229
Validation Loss: 0.62425691, Validation R2: 0.601452

Epoch 119/1000
Training Loss: 0.08945678, Training R2: 0.939789
Validation Loss: 0.63012797, Validation R2: 0.597315

Epoch 120/1000
Training Loss: 0.08806388, Training R2: 0.940382
Validation Loss: 0.62601185, Validation R2: 0.591816

Epoch 121/1000
Training Loss: 0.07894765, Training R2: 0.942488
Validation Loss: 0.63150811, Validation R2: 0.590725

Epoch 122/1000
Training Loss: 0.08903251, Training R2: 0.940955
Validation Loss: 0.63183236, Validation R2: 0.594371

Epoch 123/1000
Training Loss: 0.09160725, Training R2: 0.941718
Validation Loss: 0.62528360, Validation R2: 0.597123

Epoch 124/1000
Training Loss: 0.08147393, Training R2: 0.940993
Validation Loss: 0.62400293, Validation R2: 0.586565

Epoch 125/1000
Training Loss: 0.09089374, Training R2: 0.940957
Validation Loss: 0.62580872, Validation R2: 0.594621

Epoch 126/1000
Epoch 00126: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.08305605, Training R2: 0.942915
Validation Loss: 0.62971181, Validation R2: 0.599872

Epoch 127/1000
学习率已减少 2 次
Training Loss: 0.07344566, Training R2: 0.942625
Validation Loss: 0.62770498, Validation R2: 0.599091

Epoch 128/1000
Training Loss: 0.06707087, Training R2: 0.943577
Validation Loss: 0.62616926, Validation R2: 0.593582

Epoch 129/1000
Training Loss: 0.06869893, Training R2: 0.943202
Validation Loss: 0.62304533, Validation R2: 0.597035

Epoch 130/1000
Training Loss: 0.06231314, Training R2: 0.944513
Validation Loss: 0.62319499, Validation R2: 0.600512

Epoch 131/1000
Training Loss: 0.05875998, Training R2: 0.944474
Validation Loss: 0.62227529, Validation R2: 0.603550

Epoch 132/1000
Training Loss: 0.05656961, Training R2: 0.946230
Validation Loss: 0.62039500, Validation R2: 0.603786

Epoch 133/1000
Training Loss: 0.05763960, Training R2: 0.945974
Validation Loss: 0.61948419, Validation R2: 0.607031

Epoch 134/1000
Training Loss: 0.05445100, Training R2: 0.944960
Validation Loss: 0.62643027, Validation R2: 0.600817

Epoch 135/1000
Training Loss: 0.05331538, Training R2: 0.945194
Validation Loss: 0.62449539, Validation R2: 0.598270

Epoch 136/1000
Training Loss: 0.05272397, Training R2: 0.945831
Validation Loss: 0.62241524, Validation R2: 0.597621

Epoch 137/1000
Training Loss: 0.05441724, Training R2: 0.945673
Validation Loss: 0.62040430, Validation R2: 0.603609

Epoch 138/1000
Training Loss: 0.05197713, Training R2: 0.945031
Validation Loss: 0.62377918, Validation R2: 0.603415

Epoch 139/1000
Training Loss: 0.04994876, Training R2: 0.946566
Validation Loss: 0.62319392, Validation R2: 0.601860

Epoch 140/1000
Training Loss: 0.05030773, Training R2: 0.946120
Validation Loss: 0.62535906, Validation R2: 0.596481

Epoch 141/1000
Training Loss: 0.04818121, Training R2: 0.946203
Validation Loss: 0.62615132, Validation R2: 0.600376

Epoch 142/1000
Training Loss: 0.05158749, Training R2: 0.946325
Validation Loss: 0.62548727, Validation R2: 0.603668

Epoch 143/1000
Training Loss: 0.04811763, Training R2: 0.945987
Validation Loss: 0.62505835, Validation R2: 0.600558

Epoch 144/1000
Training Loss: 0.04891134, Training R2: 0.946299
Validation Loss: 0.62572086, Validation R2: 0.597082

Epoch 145/1000
Training Loss: 0.04661076, Training R2: 0.946677
Validation Loss: 0.62386519, Validation R2: 0.601776

Epoch 146/1000
Training Loss: 0.05183615, Training R2: 0.946788
Validation Loss: 0.62062490, Validation R2: 0.601820

Epoch 147/1000
Epoch 00147: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.06139452, Training R2: 0.940721
Validation Loss: 0.61953598, Validation R2: 0.602846

Epoch 148/1000
学习率已减少 3 次
Training Loss: 0.04751612, Training R2: 0.946973
Validation Loss: 0.62271482, Validation R2: 0.600056

Epoch 149/1000
Training Loss: 0.04497560, Training R2: 0.947943
Validation Loss: 0.62248170, Validation R2: 0.604509

Epoch 150/1000
Training Loss: 0.04539093, Training R2: 0.946840
Validation Loss: 0.62259382, Validation R2: 0.603297

Epoch 151/1000
Training Loss: 0.04325922, Training R2: 0.948277
Validation Loss: 0.62217689, Validation R2: 0.601090

Epoch 152/1000
Training Loss: 0.04065965, Training R2: 0.948280
Validation Loss: 0.62458003, Validation R2: 0.600339

Epoch 153/1000
Training Loss: 0.03945119, Training R2: 0.948522
Validation Loss: 0.62745488, Validation R2: 0.597767

Epoch 154/1000
Training Loss: 0.03884914, Training R2: 0.948586
Validation Loss: 0.62393177, Validation R2: 0.602532

Epoch 155/1000
Training Loss: 0.03728953, Training R2: 0.948666
Validation Loss: 0.62261522, Validation R2: 0.601479

Epoch 156/1000
Training Loss: 0.03615209, Training R2: 0.948812
Validation Loss: 0.62293530, Validation R2: 0.602384

Epoch 157/1000
Training Loss: 0.03614432, Training R2: 0.948822
Validation Loss: 0.62281460, Validation R2: 0.602323

Epoch 158/1000
Training Loss: 0.03674705, Training R2: 0.949137
Validation Loss: 0.62205476, Validation R2: 0.602034

Epoch 159/1000
Training Loss: 0.03795023, Training R2: 0.948879
Validation Loss: 0.62099957, Validation R2: 0.602780

Epoch 160/1000
Training Loss: 0.03563171, Training R2: 0.948733
Validation Loss: 0.62103200, Validation R2: 0.603760

Epoch 161/1000
Training Loss: 0.03666264, Training R2: 0.948902
Validation Loss: 0.61890149, Validation R2: 0.607498

Epoch 162/1000
Training Loss: 0.03587184, Training R2: 0.949213
Validation Loss: 0.61980820, Validation R2: 0.605529

Epoch 163/1000
Training Loss: 0.03742856, Training R2: 0.948973
Validation Loss: 0.61845785, Validation R2: 0.603471

Epoch 164/1000
Training Loss: 0.03681323, Training R2: 0.949575
Validation Loss: 0.62945729, Validation R2: 0.589983

Epoch 165/1000
Training Loss: 0.04029999, Training R2: 0.949117
Validation Loss: 0.63126194, Validation R2: 0.588512

Epoch 166/1000
Training Loss: 0.04201052, Training R2: 0.950015
Validation Loss: 0.62962031, Validation R2: 0.591466

Epoch 167/1000
Training Loss: 0.04001522, Training R2: 0.949719
Validation Loss: 0.63046348, Validation R2: 0.589892

Epoch 168/1000
Epoch 00168: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.04466314, Training R2: 0.949936
Validation Loss: 0.63234717, Validation R2: 0.587542

Epoch 169/1000
学习率已减少 4 次
Training Loss: 0.04089690, Training R2: 0.949494
Validation Loss: 0.63285023, Validation R2: 0.588981

Epoch 170/1000
Training Loss: 0.03841421, Training R2: 0.950036
Validation Loss: 0.63478065, Validation R2: 0.585364

Epoch 171/1000
Training Loss: 0.03696982, Training R2: 0.950042
Validation Loss: 0.63427633, Validation R2: 0.584380

Epoch 172/1000
Training Loss: 0.03809582, Training R2: 0.949775
Validation Loss: 0.63169491, Validation R2: 0.587469

Epoch 173/1000
Training Loss: 0.03780667, Training R2: 0.950307
Validation Loss: 0.63339657, Validation R2: 0.586390

Epoch 174/1000
Training Loss: 0.03535859, Training R2: 0.950360
Validation Loss: 0.63230813, Validation R2: 0.588849

Epoch 175/1000
Training Loss: 0.03491281, Training R2: 0.949791
Validation Loss: 0.63017786, Validation R2: 0.591845

Epoch 176/1000
Training Loss: 0.03321629, Training R2: 0.949981
Validation Loss: 0.63056862, Validation R2: 0.590509

Epoch 177/1000
Training Loss: 0.03380396, Training R2: 0.950395
Validation Loss: 0.63030744, Validation R2: 0.590225

Epoch 178/1000
Training Loss: 0.03244650, Training R2: 0.950170
Validation Loss: 0.63064003, Validation R2: 0.589559

Epoch 179/1000
Training Loss: 0.02928497, Training R2: 0.950429
Validation Loss: 0.63051617, Validation R2: 0.589161

Epoch 180/1000
Training Loss: 0.02903251, Training R2: 0.950179
Validation Loss: 0.63074690, Validation R2: 0.588361

Epoch 181/1000
Training Loss: 0.02896738, Training R2: 0.950700
Validation Loss: 0.63063061, Validation R2: 0.589449

Epoch 182/1000
Training Loss: 0.02733661, Training R2: 0.950561
Validation Loss: 0.63135475, Validation R2: 0.588335

Epoch 183/1000
Training Loss: 0.02718371, Training R2: 0.950946
Validation Loss: 0.63116711, Validation R2: 0.589794

Epoch 184/1000
Training Loss: 0.02708318, Training R2: 0.950733
Validation Loss: 0.63173103, Validation R2: 0.589591

Epoch 185/1000
Training Loss: 0.02671013, Training R2: 0.950810
Validation Loss: 0.63049686, Validation R2: 0.591044

Epoch 186/1000
Training Loss: 0.02758367, Training R2: 0.950726
Validation Loss: 0.62992209, Validation R2: 0.589660

Epoch 187/1000
Training Loss: 0.02606425, Training R2: 0.951109
Validation Loss: 0.63064611, Validation R2: 0.589865

Epoch 188/1000
Training Loss: 0.02714198, Training R2: 0.951019
Validation Loss: 0.63184959, Validation R2: 0.588038

Epoch 189/1000
Epoch 00189: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.02652928, Training R2: 0.950824
Validation Loss: 0.63158631, Validation R2: 0.588228

Epoch 190/1000
学习率已减少 5 次
Training Loss: 0.02702435, Training R2: 0.950941
Validation Loss: 0.63224691, Validation R2: 0.586849

Epoch 191/1000
Training Loss: 0.02522067, Training R2: 0.951069
Validation Loss: 0.63171947, Validation R2: 0.587687

Epoch 192/1000
Training Loss: 0.02445511, Training R2: 0.951294
Validation Loss: 0.63182586, Validation R2: 0.588445

Epoch 193/1000
Training Loss: 0.02484483, Training R2: 0.951210
Validation Loss: 0.63127857, Validation R2: 0.588701

Epoch 194/1000
Training Loss: 0.02408971, Training R2: 0.951292
Validation Loss: 0.63150257, Validation R2: 0.588976

Epoch 195/1000
Training Loss: 0.02400757, Training R2: 0.951407
Validation Loss: 0.63102072, Validation R2: 0.589709

Epoch 196/1000
Training Loss: 0.02347549, Training R2: 0.951344
Validation Loss: 0.63185608, Validation R2: 0.588284

Epoch 197/1000
Training Loss: 0.02272850, Training R2: 0.951440
Validation Loss: 0.63149279, Validation R2: 0.588089

Epoch 198/1000
Training Loss: 0.02208384, Training R2: 0.951410
Validation Loss: 0.63223255, Validation R2: 0.587199

Epoch 199/1000
Training Loss: 0.02221758, Training R2: 0.951503
Validation Loss: 0.63213760, Validation R2: 0.587271

Epoch 200/1000
Training Loss: 0.02212405, Training R2: 0.951500
Validation Loss: 0.63237643, Validation R2: 0.587228

Epoch 201/1000
Training Loss: 0.02201684, Training R2: 0.951679
Validation Loss: 0.63240021, Validation R2: 0.587287

Epoch 202/1000
Training Loss: 0.02257411, Training R2: 0.951694
Validation Loss: 0.63275385, Validation R2: 0.586621

Epoch 203/1000
Training Loss: 0.02340220, Training R2: 0.951541
Validation Loss: 0.63272715, Validation R2: 0.586415

Epoch 204/1000
Training Loss: 0.02429693, Training R2: 0.951724
Validation Loss: 0.63228470, Validation R2: 0.586888

Epoch 205/1000
Training Loss: 0.02413545, Training R2: 0.951594
Validation Loss: 0.63280135, Validation R2: 0.585913

Epoch 206/1000
Training Loss: 0.02369881, Training R2: 0.951759
Validation Loss: 0.63281113, Validation R2: 0.586090

Epoch 207/1000
Training Loss: 0.02286571, Training R2: 0.951911
Validation Loss: 0.63156319, Validation R2: 0.587986

Epoch 208/1000
Training Loss: 0.02392848, Training R2: 0.951830
Validation Loss: 0.63152063, Validation R2: 0.588284

Epoch 209/1000
Training Loss: 0.02387248, Training R2: 0.952069
Validation Loss: 0.63184547, Validation R2: 0.587945

Epoch 210/1000
Epoch 00210: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.02306568, Training R2: 0.951961
Validation Loss: 0.63200009, Validation R2: 0.587649

Epoch 211/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
