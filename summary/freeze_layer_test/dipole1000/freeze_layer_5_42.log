Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 2241155

Epoch 1/1000
Training Loss: 1.98867959, Training R2: -1.806353
Validation Loss: 1.22786772, Validation R2: -0.169175
Saved best model with validation R2 -0.169175 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.21342523, Training R2: -0.051141
Validation Loss: 1.14210963, Validation R2: -0.248074

Epoch 3/1000
Training Loss: 1.12665693, Training R2: -0.050528
Validation Loss: 1.07508743, Validation R2: 0.060900
Saved best model with validation R2 0.060900 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 1.15309515, Training R2: 0.044154
Validation Loss: 1.05507421, Validation R2: 0.051188

Epoch 5/1000
Training Loss: 1.09350781, Training R2: 0.039165
Validation Loss: 1.07350802, Validation R2: -0.083296

Epoch 6/1000
Training Loss: 1.06833606, Training R2: 0.043613
Validation Loss: 1.01401663, Validation R2: 0.143938
Saved best model with validation R2 0.143938 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 1.07298361, Training R2: 0.130401
Validation Loss: 0.98914641, Validation R2: 0.146442
Saved best model with validation R2 0.146442 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 1.01563825, Training R2: 0.140578
Validation Loss: 0.96386927, Validation R2: 0.210665
Saved best model with validation R2 0.210665 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 1.00061437, Training R2: 0.199462
Validation Loss: 0.97492856, Validation R2: 0.186726

Epoch 10/1000
Training Loss: 0.97024765, Training R2: 0.203016
Validation Loss: 0.93754613, Validation R2: 0.227194
Saved best model with validation R2 0.227194 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.92919501, Training R2: 0.261191
Validation Loss: 0.91372311, Validation R2: 0.255232
Saved best model with validation R2 0.255232 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.90678122, Training R2: 0.281856
Validation Loss: 0.93276566, Validation R2: 0.193663

Epoch 13/1000
Training Loss: 0.88781924, Training R2: 0.290729
Validation Loss: 0.89341962, Validation R2: 0.300912
Saved best model with validation R2 0.300912 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.85557379, Training R2: 0.328661
Validation Loss: 0.96506178, Validation R2: 0.242873

Epoch 15/1000
Training Loss: 0.85847765, Training R2: 0.338179
Validation Loss: 0.90388721, Validation R2: 0.238528

Epoch 16/1000
Training Loss: 0.80825178, Training R2: 0.369431
Validation Loss: 0.85163695, Validation R2: 0.328303
Saved best model with validation R2 0.328303 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.77326581, Training R2: 0.411627
Validation Loss: 0.81867963, Validation R2: 0.394757
Saved best model with validation R2 0.394757 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.73430873, Training R2: 0.448496
Validation Loss: 0.82602340, Validation R2: 0.362797

Epoch 19/1000
Training Loss: 0.69228044, Training R2: 0.488501
Validation Loss: 0.80288899, Validation R2: 0.394609

Epoch 20/1000
Training Loss: 0.65954149, Training R2: 0.520775
Validation Loss: 0.79134232, Validation R2: 0.418033
Saved best model with validation R2 0.418033 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.65779092, Training R2: 0.520436
Validation Loss: 0.80150968, Validation R2: 0.418349
Saved best model with validation R2 0.418349 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.67618682, Training R2: 0.507483
Validation Loss: 0.83840603, Validation R2: 0.389397

Epoch 23/1000
Training Loss: 0.66512101, Training R2: 0.520653
Validation Loss: 0.80914348, Validation R2: 0.396534

Epoch 24/1000
Training Loss: 0.66795736, Training R2: 0.521618
Validation Loss: 0.79407990, Validation R2: 0.414961

Epoch 25/1000
Training Loss: 0.69838717, Training R2: 0.505011
Validation Loss: 0.79087132, Validation R2: 0.452351
Saved best model with validation R2 0.452351 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.63346549, Training R2: 0.570228
Validation Loss: 0.84016949, Validation R2: 0.389430

Epoch 27/1000
Training Loss: 0.65120066, Training R2: 0.551648
Validation Loss: 0.78001332, Validation R2: 0.441448

Epoch 28/1000
Training Loss: 0.61124499, Training R2: 0.566748
Validation Loss: 0.75314802, Validation R2: 0.453079
Saved best model with validation R2 0.453079 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.58280479, Training R2: 0.599489
Validation Loss: 0.87172705, Validation R2: 0.377245

Epoch 30/1000
Training Loss: 0.60918152, Training R2: 0.602353
Validation Loss: 0.74173141, Validation R2: 0.489313
Saved best model with validation R2 0.489313 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.57818244, Training R2: 0.617486
Validation Loss: 0.76454145, Validation R2: 0.464610

Epoch 32/1000
Training Loss: 0.53689316, Training R2: 0.642996
Validation Loss: 0.76824784, Validation R2: 0.465803

Epoch 33/1000
Training Loss: 0.49698749, Training R2: 0.677036
Validation Loss: 0.75394773, Validation R2: 0.490788
Saved best model with validation R2 0.490788 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.47659605, Training R2: 0.687707
Validation Loss: 0.75814193, Validation R2: 0.473841

Epoch 35/1000
Training Loss: 0.46504157, Training R2: 0.691353
Validation Loss: 0.78309721, Validation R2: 0.454799

Epoch 36/1000
Training Loss: 0.44378741, Training R2: 0.710352
Validation Loss: 0.74141353, Validation R2: 0.495549
Saved best model with validation R2 0.495549 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.41499210, Training R2: 0.727863
Validation Loss: 0.75109053, Validation R2: 0.483335

Epoch 38/1000
Training Loss: 0.40931644, Training R2: 0.731962
Validation Loss: 0.74628890, Validation R2: 0.484664

Epoch 39/1000
Training Loss: 0.39532821, Training R2: 0.736486
Validation Loss: 0.75888371, Validation R2: 0.492848

Epoch 40/1000
Training Loss: 0.39213968, Training R2: 0.746549
Validation Loss: 0.80369514, Validation R2: 0.447722

Epoch 41/1000
Training Loss: 0.43505684, Training R2: 0.741374
Validation Loss: 0.73464900, Validation R2: 0.505824
Saved best model with validation R2 0.505824 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.39069158, Training R2: 0.749351
Validation Loss: 0.73397487, Validation R2: 0.496753

Epoch 43/1000
Training Loss: 0.38945397, Training R2: 0.752010
Validation Loss: 0.73246914, Validation R2: 0.488040

Epoch 44/1000
Training Loss: 0.39667413, Training R2: 0.759044
Validation Loss: 0.71496779, Validation R2: 0.504609

Epoch 45/1000
Training Loss: 0.39641458, Training R2: 0.766254
Validation Loss: 0.70819950, Validation R2: 0.505536

Epoch 46/1000
Training Loss: 0.38212768, Training R2: 0.763554
Validation Loss: 0.71825379, Validation R2: 0.492830

Epoch 47/1000
Training Loss: 0.36457294, Training R2: 0.769732
Validation Loss: 0.73744595, Validation R2: 0.481793

Epoch 48/1000
Training Loss: 0.35403301, Training R2: 0.787121
Validation Loss: 0.73021698, Validation R2: 0.512946
Saved best model with validation R2 0.512946 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.35356746, Training R2: 0.785964
Validation Loss: 0.73194802, Validation R2: 0.508136

Epoch 50/1000
Training Loss: 0.35982634, Training R2: 0.788719
Validation Loss: 0.75369984, Validation R2: 0.472561

Epoch 51/1000
Training Loss: 0.31823272, Training R2: 0.803799
Validation Loss: 0.74380606, Validation R2: 0.476405

Epoch 52/1000
Training Loss: 0.38254523, Training R2: 0.783118
Validation Loss: 0.75062650, Validation R2: 0.457666

Epoch 53/1000
Training Loss: 0.40124024, Training R2: 0.785994
Validation Loss: 0.77640682, Validation R2: 0.432085

Epoch 54/1000
Training Loss: 0.41167011, Training R2: 0.776529
Validation Loss: 0.73015988, Validation R2: 0.482117

Epoch 55/1000
Training Loss: 0.33915080, Training R2: 0.807273
Validation Loss: 0.75107712, Validation R2: 0.455255

Epoch 56/1000
Training Loss: 0.37492957, Training R2: 0.789734
Validation Loss: 0.74294150, Validation R2: 0.485568

Epoch 57/1000
Training Loss: 0.34821162, Training R2: 0.803381
Validation Loss: 0.74133110, Validation R2: 0.484051

Epoch 58/1000
Training Loss: 0.32574615, Training R2: 0.800971
Validation Loss: 0.74867374, Validation R2: 0.478274

Epoch 59/1000
Training Loss: 0.30655885, Training R2: 0.815757
Validation Loss: 0.75162947, Validation R2: 0.482237

Epoch 60/1000
Training Loss: 0.34621606, Training R2: 0.785930
Validation Loss: 0.74542606, Validation R2: 0.482569

Epoch 61/1000
Training Loss: 0.34605877, Training R2: 0.801395
Validation Loss: 0.78659683, Validation R2: 0.443188

Epoch 62/1000
Training Loss: 0.38895562, Training R2: 0.787573
Validation Loss: 0.76847190, Validation R2: 0.448757

Epoch 63/1000
Training Loss: 0.33508318, Training R2: 0.815736
Validation Loss: 0.75134522, Validation R2: 0.480305

Epoch 64/1000
Training Loss: 0.31724532, Training R2: 0.813299
Validation Loss: 0.72877729, Validation R2: 0.487597

Epoch 65/1000
Training Loss: 0.29786139, Training R2: 0.824022
Validation Loss: 0.73600715, Validation R2: 0.487922

Epoch 66/1000
Training Loss: 0.28627210, Training R2: 0.834273
Validation Loss: 0.74380630, Validation R2: 0.460705

Epoch 67/1000
Training Loss: 0.34593415, Training R2: 0.815529
Validation Loss: 0.72015882, Validation R2: 0.485553

Epoch 68/1000
Training Loss: 0.30263192, Training R2: 0.837404
Validation Loss: 0.74759716, Validation R2: 0.486923

Epoch 69/1000
Training Loss: 0.26591781, Training R2: 0.845763
Validation Loss: 0.71441251, Validation R2: 0.513923
Saved best model with validation R2 0.513923 to best_finetuned_model.pth

Epoch 70/1000
Training Loss: 0.23623502, Training R2: 0.860424
Validation Loss: 0.72955066, Validation R2: 0.468438

Epoch 71/1000
Training Loss: 0.23652359, Training R2: 0.858664
Validation Loss: 0.73194629, Validation R2: 0.490782

Epoch 72/1000
Training Loss: 0.22776938, Training R2: 0.865927
Validation Loss: 0.73013008, Validation R2: 0.500640

Epoch 73/1000
Training Loss: 0.23018638, Training R2: 0.869179
Validation Loss: 0.71739089, Validation R2: 0.481932

Epoch 74/1000
Training Loss: 0.25353183, Training R2: 0.864751
Validation Loss: 0.72760433, Validation R2: 0.475852

Epoch 75/1000
Training Loss: 0.23691969, Training R2: 0.867630
Validation Loss: 0.72927642, Validation R2: 0.486835

Epoch 76/1000
Training Loss: 0.26982419, Training R2: 0.860281
Validation Loss: 0.73287731, Validation R2: 0.488982

Epoch 77/1000
Training Loss: 0.23348391, Training R2: 0.868205
Validation Loss: 0.77942276, Validation R2: 0.436302

Epoch 78/1000
Training Loss: 0.32663871, Training R2: 0.843785
Validation Loss: 0.72598034, Validation R2: 0.471566

Epoch 79/1000
Training Loss: 0.25486419, Training R2: 0.868885
Validation Loss: 0.74494869, Validation R2: 0.461674

Epoch 80/1000
Training Loss: 0.24896558, Training R2: 0.868014
Validation Loss: 0.74843746, Validation R2: 0.469630

Epoch 81/1000
Training Loss: 0.26943177, Training R2: 0.864793
Validation Loss: 0.79271245, Validation R2: 0.427974

Epoch 82/1000
Training Loss: 0.32680297, Training R2: 0.856458
Validation Loss: 0.80275327, Validation R2: 0.414086

Epoch 83/1000
Training Loss: 0.32717160, Training R2: 0.851209
Validation Loss: 0.74476135, Validation R2: 0.470274

Epoch 84/1000
Training Loss: 0.31257972, Training R2: 0.848620
Validation Loss: 0.76467848, Validation R2: 0.431870

Epoch 85/1000
Training Loss: 0.28281440, Training R2: 0.865058
Validation Loss: 0.75163794, Validation R2: 0.448967

Epoch 86/1000
Training Loss: 0.26495344, Training R2: 0.875804
Validation Loss: 0.72648418, Validation R2: 0.493988

Epoch 87/1000
Training Loss: 0.23376868, Training R2: 0.879601
Validation Loss: 0.72939146, Validation R2: 0.488413

Epoch 88/1000
Training Loss: 0.22335005, Training R2: 0.880585
Validation Loss: 0.72625774, Validation R2: 0.484919

Epoch 89/1000
Training Loss: 0.21860485, Training R2: 0.883465
Validation Loss: 0.74061900, Validation R2: 0.479931

Epoch 90/1000
Epoch 00090: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.23199770, Training R2: 0.882322
Validation Loss: 0.72158056, Validation R2: 0.500738

Epoch 91/1000
学习率已减少 1 次
Training Loss: 0.19784063, Training R2: 0.889876
Validation Loss: 0.72169125, Validation R2: 0.506324

Epoch 92/1000
Training Loss: 0.18873421, Training R2: 0.895255
Validation Loss: 0.72586834, Validation R2: 0.493735

Epoch 93/1000
Training Loss: 0.17789352, Training R2: 0.899790
Validation Loss: 0.71496892, Validation R2: 0.494775

Epoch 94/1000
Training Loss: 0.17235287, Training R2: 0.900126
Validation Loss: 0.71422821, Validation R2: 0.507372

Epoch 95/1000
Training Loss: 0.15261603, Training R2: 0.902570
Validation Loss: 0.71280819, Validation R2: 0.511922

Epoch 96/1000
Training Loss: 0.14077071, Training R2: 0.904712
Validation Loss: 0.71326894, Validation R2: 0.514277
Saved best model with validation R2 0.514277 to best_finetuned_model.pth

Epoch 97/1000
Training Loss: 0.13597667, Training R2: 0.907257
Validation Loss: 0.71746153, Validation R2: 0.509756

Epoch 98/1000
Training Loss: 0.14689880, Training R2: 0.907565
Validation Loss: 0.71266156, Validation R2: 0.512516

Epoch 99/1000
Training Loss: 0.13752423, Training R2: 0.905935
Validation Loss: 0.71743369, Validation R2: 0.509035

Epoch 100/1000
Training Loss: 0.12633683, Training R2: 0.910970
Validation Loss: 0.71227181, Validation R2: 0.514882
Saved best model with validation R2 0.514882 to best_finetuned_model.pth

Epoch 101/1000
Training Loss: 0.13812312, Training R2: 0.909860
Validation Loss: 0.71287113, Validation R2: 0.511805

Epoch 102/1000
Training Loss: 0.12459919, Training R2: 0.913426
Validation Loss: 0.70991188, Validation R2: 0.518866
Saved best model with validation R2 0.518866 to best_finetuned_model.pth

Epoch 103/1000
Training Loss: 0.12831858, Training R2: 0.912874
Validation Loss: 0.71829641, Validation R2: 0.511717

Epoch 104/1000
Training Loss: 0.13914908, Training R2: 0.909998
Validation Loss: 0.72841156, Validation R2: 0.501716

Epoch 105/1000
Training Loss: 0.15375907, Training R2: 0.907684
Validation Loss: 0.73180479, Validation R2: 0.502865

Epoch 106/1000
Training Loss: 0.17576532, Training R2: 0.903277
Validation Loss: 0.73062217, Validation R2: 0.504567

Epoch 107/1000
Training Loss: 0.14844936, Training R2: 0.912962
Validation Loss: 0.71778792, Validation R2: 0.514206

Epoch 108/1000
Training Loss: 0.14910521, Training R2: 0.908197
Validation Loss: 0.70801848, Validation R2: 0.523675
Saved best model with validation R2 0.523675 to best_finetuned_model.pth

Epoch 109/1000
Training Loss: 0.16055230, Training R2: 0.903448
Validation Loss: 0.70303792, Validation R2: 0.516385

Epoch 110/1000
Training Loss: 0.16365495, Training R2: 0.907189
Validation Loss: 0.71117049, Validation R2: 0.524359
Saved best model with validation R2 0.524359 to best_finetuned_model.pth

Epoch 111/1000
Training Loss: 0.13899376, Training R2: 0.907413
Validation Loss: 0.71941221, Validation R2: 0.516025

Epoch 112/1000
Training Loss: 0.12664786, Training R2: 0.912753
Validation Loss: 0.71859449, Validation R2: 0.509777

Epoch 113/1000
Training Loss: 0.12144924, Training R2: 0.914012
Validation Loss: 0.70988911, Validation R2: 0.514681

Epoch 114/1000
Training Loss: 0.12351453, Training R2: 0.914344
Validation Loss: 0.71635562, Validation R2: 0.514488

Epoch 115/1000
Training Loss: 0.11435477, Training R2: 0.914954
Validation Loss: 0.71415496, Validation R2: 0.512421

Epoch 116/1000
Training Loss: 0.12340917, Training R2: 0.914506
Validation Loss: 0.71202320, Validation R2: 0.507576

Epoch 117/1000
Training Loss: 0.13008980, Training R2: 0.912258
Validation Loss: 0.71354032, Validation R2: 0.513491

Epoch 118/1000
Training Loss: 0.11893905, Training R2: 0.915890
Validation Loss: 0.72861212, Validation R2: 0.504446

Epoch 119/1000
Training Loss: 0.12928601, Training R2: 0.915625
Validation Loss: 0.71526062, Validation R2: 0.516542

Epoch 120/1000
Training Loss: 0.10626360, Training R2: 0.918399
Validation Loss: 0.72351861, Validation R2: 0.511280

Epoch 121/1000
Training Loss: 0.11420624, Training R2: 0.917610
Validation Loss: 0.71401250, Validation R2: 0.517738

Epoch 122/1000
Training Loss: 0.10630135, Training R2: 0.916937
Validation Loss: 0.72509915, Validation R2: 0.507961

Epoch 123/1000
Training Loss: 0.10247380, Training R2: 0.920030
Validation Loss: 0.72790968, Validation R2: 0.504317

Epoch 124/1000
Training Loss: 0.11973062, Training R2: 0.920402
Validation Loss: 0.71436566, Validation R2: 0.512518

Epoch 125/1000
Training Loss: 0.11088492, Training R2: 0.919567
Validation Loss: 0.72077966, Validation R2: 0.504968

Epoch 126/1000
Training Loss: 0.12062544, Training R2: 0.920318
Validation Loss: 0.71142441, Validation R2: 0.510457

Epoch 127/1000
Training Loss: 0.11370398, Training R2: 0.921483
Validation Loss: 0.71642041, Validation R2: 0.508639

Epoch 128/1000
Training Loss: 0.10580737, Training R2: 0.919985
Validation Loss: 0.72644240, Validation R2: 0.506087

Epoch 129/1000
Training Loss: 0.10059838, Training R2: 0.922582
Validation Loss: 0.71737605, Validation R2: 0.511251

Epoch 130/1000
Training Loss: 0.09390400, Training R2: 0.922059
Validation Loss: 0.72325331, Validation R2: 0.504854

Epoch 131/1000
Epoch 00131: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.09065655, Training R2: 0.923755
Validation Loss: 0.72324401, Validation R2: 0.505204

Epoch 132/1000
学习率已减少 2 次
Training Loss: 0.08774215, Training R2: 0.924196
Validation Loss: 0.72127748, Validation R2: 0.504713

Epoch 133/1000
Training Loss: 0.09272861, Training R2: 0.924824
Validation Loss: 0.71860963, Validation R2: 0.508009

Epoch 134/1000
Training Loss: 0.08809325, Training R2: 0.924481
Validation Loss: 0.71454024, Validation R2: 0.509641

Epoch 135/1000
Training Loss: 0.08257742, Training R2: 0.925049
Validation Loss: 0.71981347, Validation R2: 0.506152

Epoch 136/1000
Training Loss: 0.08419166, Training R2: 0.925719
Validation Loss: 0.71925902, Validation R2: 0.511278

Epoch 137/1000
Training Loss: 0.07926023, Training R2: 0.925281
Validation Loss: 0.71628124, Validation R2: 0.510346

Epoch 138/1000
Training Loss: 0.08125854, Training R2: 0.926168
Validation Loss: 0.71174443, Validation R2: 0.512514

Epoch 139/1000
Training Loss: 0.08024982, Training R2: 0.926431
Validation Loss: 0.70988256, Validation R2: 0.514655

Epoch 140/1000
Training Loss: 0.08982667, Training R2: 0.925133
Validation Loss: 0.71712995, Validation R2: 0.508064

Epoch 141/1000
Training Loss: 0.08718332, Training R2: 0.926119
Validation Loss: 0.71718335, Validation R2: 0.508304

Epoch 142/1000
Training Loss: 0.07996475, Training R2: 0.927117
Validation Loss: 0.71566993, Validation R2: 0.510909

Epoch 143/1000
Training Loss: 0.08202477, Training R2: 0.927005
Validation Loss: 0.71567887, Validation R2: 0.508135

Epoch 144/1000
Training Loss: 0.07848742, Training R2: 0.926208
Validation Loss: 0.71692151, Validation R2: 0.510035

Epoch 145/1000
Training Loss: 0.08303056, Training R2: 0.924511
Validation Loss: 0.72017545, Validation R2: 0.505878

Epoch 146/1000
Training Loss: 0.08259039, Training R2: 0.927213
Validation Loss: 0.71367317, Validation R2: 0.511941

Epoch 147/1000
Training Loss: 0.08631664, Training R2: 0.925500
Validation Loss: 0.72638744, Validation R2: 0.503420

Epoch 148/1000
Training Loss: 0.08734012, Training R2: 0.927263
Validation Loss: 0.71929210, Validation R2: 0.509507

Epoch 149/1000
Training Loss: 0.08748238, Training R2: 0.925030
Validation Loss: 0.71439880, Validation R2: 0.510041

Epoch 150/1000
Training Loss: 0.08937334, Training R2: 0.926829
Validation Loss: 0.71782959, Validation R2: 0.502356

Epoch 151/1000
Training Loss: 0.08654551, Training R2: 0.928349
Validation Loss: 0.71688080, Validation R2: 0.508464

Epoch 152/1000
Epoch 00152: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.07703750, Training R2: 0.928224
Validation Loss: 0.71960104, Validation R2: 0.505337

Epoch 153/1000
学习率已减少 3 次
Training Loss: 0.07698203, Training R2: 0.928355
Validation Loss: 0.71562147, Validation R2: 0.508744

Epoch 154/1000
Training Loss: 0.07441482, Training R2: 0.928197
Validation Loss: 0.71596593, Validation R2: 0.508593

Epoch 155/1000
Training Loss: 0.06849218, Training R2: 0.929335
Validation Loss: 0.71670347, Validation R2: 0.506702

Epoch 156/1000
Training Loss: 0.07030048, Training R2: 0.930096
Validation Loss: 0.71452361, Validation R2: 0.510186

Epoch 157/1000
Training Loss: 0.07174948, Training R2: 0.929519
Validation Loss: 0.71812963, Validation R2: 0.509134

Epoch 158/1000
Training Loss: 0.06799255, Training R2: 0.929873
Validation Loss: 0.72210038, Validation R2: 0.504748

Epoch 159/1000
Training Loss: 0.07134830, Training R2: 0.929490
Validation Loss: 0.72217220, Validation R2: 0.505138

Epoch 160/1000
Training Loss: 0.06739013, Training R2: 0.929789
Validation Loss: 0.71881974, Validation R2: 0.507352

Epoch 161/1000
Training Loss: 0.06197741, Training R2: 0.930284
Validation Loss: 0.71614343, Validation R2: 0.509544

Epoch 162/1000
Training Loss: 0.06215112, Training R2: 0.930050
Validation Loss: 0.71810699, Validation R2: 0.509125

Epoch 163/1000
Training Loss: 0.05901477, Training R2: 0.930145
Validation Loss: 0.72155905, Validation R2: 0.507372

Epoch 164/1000
Training Loss: 0.06293756, Training R2: 0.930255
Validation Loss: 0.71831524, Validation R2: 0.510495

Epoch 165/1000
Training Loss: 0.06075857, Training R2: 0.930351
Validation Loss: 0.71606320, Validation R2: 0.512120

Epoch 166/1000
Training Loss: 0.05920592, Training R2: 0.930739
Validation Loss: 0.71788472, Validation R2: 0.510358

Epoch 167/1000
Training Loss: 0.05570613, Training R2: 0.930522
Validation Loss: 0.71705008, Validation R2: 0.509884

Epoch 168/1000
Training Loss: 0.05787956, Training R2: 0.930668
Validation Loss: 0.71675718, Validation R2: 0.509919

Epoch 169/1000
Training Loss: 0.05565135, Training R2: 0.930929
Validation Loss: 0.71536100, Validation R2: 0.508641

Epoch 170/1000
Training Loss: 0.06331386, Training R2: 0.930985
Validation Loss: 0.71808285, Validation R2: 0.508104

Epoch 171/1000
Training Loss: 0.06092052, Training R2: 0.931014
Validation Loss: 0.71909523, Validation R2: 0.507570

Epoch 172/1000
Training Loss: 0.06454649, Training R2: 0.931102
Validation Loss: 0.72031033, Validation R2: 0.506324

Epoch 173/1000
Epoch 00173: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.05638934, Training R2: 0.931718
Validation Loss: 0.71656066, Validation R2: 0.511637

Epoch 174/1000
学习率已减少 4 次
Training Loss: 0.05630550, Training R2: 0.931292
Validation Loss: 0.71868306, Validation R2: 0.508734

Epoch 175/1000
Training Loss: 0.05245481, Training R2: 0.931797
Validation Loss: 0.71920651, Validation R2: 0.509135

Epoch 176/1000
Training Loss: 0.05215030, Training R2: 0.931961
Validation Loss: 0.72014320, Validation R2: 0.507762

Epoch 177/1000
Training Loss: 0.05618808, Training R2: 0.928930
Validation Loss: 0.71847558, Validation R2: 0.509900

Epoch 178/1000
Training Loss: 0.05266802, Training R2: 0.931771
Validation Loss: 0.71846342, Validation R2: 0.508219

Epoch 179/1000
Training Loss: 0.05336887, Training R2: 0.931758
Validation Loss: 0.71864027, Validation R2: 0.507561

Epoch 180/1000
Training Loss: 0.05315477, Training R2: 0.931617
Validation Loss: 0.71737516, Validation R2: 0.509183

Epoch 181/1000
Training Loss: 0.05085084, Training R2: 0.932361
Validation Loss: 0.71976024, Validation R2: 0.508404

Epoch 182/1000
Training Loss: 0.05070868, Training R2: 0.932384
Validation Loss: 0.71898037, Validation R2: 0.509029

Epoch 183/1000
Training Loss: 0.05127186, Training R2: 0.932178
Validation Loss: 0.71896541, Validation R2: 0.508911

Epoch 184/1000
Training Loss: 0.05111489, Training R2: 0.932365
Validation Loss: 0.72147810, Validation R2: 0.506201

Epoch 185/1000
Training Loss: 0.05309025, Training R2: 0.932680
Validation Loss: 0.72075921, Validation R2: 0.507886

Epoch 186/1000
Training Loss: 0.05704544, Training R2: 0.931987
Validation Loss: 0.71807462, Validation R2: 0.509447

Epoch 187/1000
Training Loss: 0.05506333, Training R2: 0.932464
Validation Loss: 0.71935850, Validation R2: 0.507448

Epoch 188/1000
Training Loss: 0.05344208, Training R2: 0.932405
Validation Loss: 0.71980071, Validation R2: 0.506835

Epoch 189/1000
Training Loss: 0.05018539, Training R2: 0.932674
Validation Loss: 0.71912652, Validation R2: 0.508461

Epoch 190/1000
Training Loss: 0.05187696, Training R2: 0.932938
Validation Loss: 0.71826452, Validation R2: 0.508577

Epoch 191/1000
Training Loss: 0.05292515, Training R2: 0.933338
Validation Loss: 0.71972626, Validation R2: 0.506804

Epoch 192/1000
Training Loss: 0.04945680, Training R2: 0.933006
Validation Loss: 0.72044468, Validation R2: 0.507726

Epoch 193/1000
Training Loss: 0.04796078, Training R2: 0.932907
Validation Loss: 0.71845686, Validation R2: 0.508620

Epoch 194/1000
Epoch 00194: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.04854743, Training R2: 0.932799
Validation Loss: 0.72007126, Validation R2: 0.508090

Epoch 195/1000
学习率已减少 5 次
Training Loss: 0.04781506, Training R2: 0.932903
Validation Loss: 0.72108907, Validation R2: 0.507577

Epoch 196/1000
Training Loss: 0.04826501, Training R2: 0.932718
Validation Loss: 0.72136450, Validation R2: 0.506684

Epoch 197/1000
Training Loss: 0.04604786, Training R2: 0.932862
Validation Loss: 0.71987218, Validation R2: 0.508188

Epoch 198/1000
Training Loss: 0.04541464, Training R2: 0.933094
Validation Loss: 0.71897817, Validation R2: 0.508965

Epoch 199/1000
Training Loss: 0.04579991, Training R2: 0.933092
Validation Loss: 0.71951979, Validation R2: 0.508549

Epoch 200/1000
Training Loss: 0.04499462, Training R2: 0.933053
Validation Loss: 0.71954161, Validation R2: 0.508778

Epoch 201/1000
Training Loss: 0.04467141, Training R2: 0.933227
Validation Loss: 0.72012967, Validation R2: 0.507857

Epoch 202/1000
Training Loss: 0.04402994, Training R2: 0.933225
Validation Loss: 0.71893829, Validation R2: 0.509402

Epoch 203/1000
Training Loss: 0.04371162, Training R2: 0.933266
Validation Loss: 0.72061211, Validation R2: 0.507153

Epoch 204/1000
Training Loss: 0.04364128, Training R2: 0.933315
Validation Loss: 0.72029662, Validation R2: 0.508548

Epoch 205/1000
Training Loss: 0.04316462, Training R2: 0.933429
Validation Loss: 0.71928447, Validation R2: 0.508323

Epoch 206/1000
Training Loss: 0.04413640, Training R2: 0.933007
Validation Loss: 0.71983129, Validation R2: 0.508682

Epoch 207/1000
Training Loss: 0.04341265, Training R2: 0.933371
Validation Loss: 0.72002578, Validation R2: 0.508095

Epoch 208/1000
Training Loss: 0.04335438, Training R2: 0.933320
Validation Loss: 0.71899700, Validation R2: 0.509213

Epoch 209/1000
Training Loss: 0.04319662, Training R2: 0.933376
Validation Loss: 0.72106552, Validation R2: 0.507510

Epoch 210/1000
Training Loss: 0.04493600, Training R2: 0.932027
Validation Loss: 0.72099549, Validation R2: 0.507261

Epoch 211/1000
Training Loss: 0.04323120, Training R2: 0.933360
Validation Loss: 0.72126770, Validation R2: 0.508012

Epoch 212/1000
Training Loss: 0.04439548, Training R2: 0.933690
Validation Loss: 0.72086751, Validation R2: 0.508328

Epoch 213/1000
Training Loss: 0.04643142, Training R2: 0.933358
Validation Loss: 0.72071880, Validation R2: 0.507977

Epoch 214/1000
Training Loss: 0.04656959, Training R2: 0.933353
Validation Loss: 0.72094142, Validation R2: 0.508269

Epoch 215/1000
Epoch 00215: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.04563876, Training R2: 0.933425
Validation Loss: 0.72147793, Validation R2: 0.506813

Epoch 216/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
