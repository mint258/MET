Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4275843

Epoch 1/1000
Training Loss: 1.26408637, Training R2: -0.163926
Validation Loss: 1.04829311, Validation R2: 0.060601
Saved best model with validation R2 0.060601 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.18638149, Training R2: -0.003493
Validation Loss: 1.08662164, Validation R2: 0.011430

Epoch 3/1000
Training Loss: 1.15325506, Training R2: -0.007509
Validation Loss: 1.11484766, Validation R2: -0.140974

Epoch 4/1000
Training Loss: 1.16217658, Training R2: -0.129396
Validation Loss: 1.05543566, Validation R2: 0.051216

Epoch 5/1000
Training Loss: 1.17288707, Training R2: 0.020802
Validation Loss: 1.09211791, Validation R2: 0.003404

Epoch 6/1000
Training Loss: 1.14437706, Training R2: 0.039689
Validation Loss: 1.08313394, Validation R2: -0.083479

Epoch 7/1000
Training Loss: 1.12952896, Training R2: -0.069018
Validation Loss: 0.99539381, Validation R2: 0.123959
Saved best model with validation R2 0.123959 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 1.05055461, Training R2: 0.124304
Validation Loss: 0.96923035, Validation R2: 0.142096
Saved best model with validation R2 0.142096 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 1.02737176, Training R2: 0.108209
Validation Loss: 0.92203474, Validation R2: 0.242714
Saved best model with validation R2 0.242714 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.94257063, Training R2: 0.256241
Validation Loss: 0.89204133, Validation R2: 0.291089
Saved best model with validation R2 0.291089 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.86176726, Training R2: 0.340441
Validation Loss: 0.91822624, Validation R2: 0.216161

Epoch 12/1000
Training Loss: 0.83098910, Training R2: 0.380100
Validation Loss: 0.95069152, Validation R2: 0.157650

Epoch 13/1000
Training Loss: 0.86286912, Training R2: 0.358956
Validation Loss: 0.94860607, Validation R2: 0.147030

Epoch 14/1000
Training Loss: 0.83160676, Training R2: 0.385605
Validation Loss: 0.87523550, Validation R2: 0.294464
Saved best model with validation R2 0.294464 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.75243425, Training R2: 0.454220
Validation Loss: 0.83487409, Validation R2: 0.322107
Saved best model with validation R2 0.322107 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.70384241, Training R2: 0.523396
Validation Loss: 0.86709380, Validation R2: 0.271785

Epoch 17/1000
Training Loss: 0.63933022, Training R2: 0.579194
Validation Loss: 0.81658918, Validation R2: 0.350992
Saved best model with validation R2 0.350992 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.60853013, Training R2: 0.604717
Validation Loss: 0.81890327, Validation R2: 0.344530

Epoch 19/1000
Training Loss: 0.59776136, Training R2: 0.616728
Validation Loss: 0.87072206, Validation R2: 0.246865

Epoch 20/1000
Training Loss: 0.61192760, Training R2: 0.589083
Validation Loss: 0.78600669, Validation R2: 0.364844
Saved best model with validation R2 0.364844 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.56447240, Training R2: 0.643594
Validation Loss: 0.74692959, Validation R2: 0.441249
Saved best model with validation R2 0.441249 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.49866373, Training R2: 0.687414
Validation Loss: 0.73898834, Validation R2: 0.435308

Epoch 23/1000
Training Loss: 0.47135315, Training R2: 0.714579
Validation Loss: 0.80936593, Validation R2: 0.367987

Epoch 24/1000
Training Loss: 0.48176291, Training R2: 0.719147
Validation Loss: 0.91162491, Validation R2: 0.246148

Epoch 25/1000
Training Loss: 0.53709093, Training R2: 0.686876
Validation Loss: 0.74685508, Validation R2: 0.439002

Epoch 26/1000
Training Loss: 0.46416135, Training R2: 0.725808
Validation Loss: 0.75550872, Validation R2: 0.426644

Epoch 27/1000
Training Loss: 0.38947697, Training R2: 0.772124
Validation Loss: 0.81321990, Validation R2: 0.357734

Epoch 28/1000
Training Loss: 0.38126172, Training R2: 0.782067
Validation Loss: 0.79382229, Validation R2: 0.385706

Epoch 29/1000
Training Loss: 0.36718976, Training R2: 0.788371
Validation Loss: 0.77366853, Validation R2: 0.393461

Epoch 30/1000
Training Loss: 0.33786828, Training R2: 0.806087
Validation Loss: 0.75351208, Validation R2: 0.417570

Epoch 31/1000
Training Loss: 0.34096921, Training R2: 0.803348
Validation Loss: 0.73489797, Validation R2: 0.448153
Saved best model with validation R2 0.448153 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 0.33632225, Training R2: 0.814367
Validation Loss: 0.75346500, Validation R2: 0.430040

Epoch 33/1000
Training Loss: 0.32465731, Training R2: 0.822951
Validation Loss: 0.77163774, Validation R2: 0.418429

Epoch 34/1000
Training Loss: 0.29513568, Training R2: 0.840932
Validation Loss: 0.74115705, Validation R2: 0.444969

Epoch 35/1000
Training Loss: 0.29470710, Training R2: 0.845531
Validation Loss: 0.76678222, Validation R2: 0.425010

Epoch 36/1000
Training Loss: 0.27981032, Training R2: 0.850648
Validation Loss: 0.73612320, Validation R2: 0.454426
Saved best model with validation R2 0.454426 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.30679662, Training R2: 0.840196
Validation Loss: 0.73910910, Validation R2: 0.441273

Epoch 38/1000
Training Loss: 0.29597184, Training R2: 0.841632
Validation Loss: 0.72841614, Validation R2: 0.466183
Saved best model with validation R2 0.466183 to best_finetuned_model.pth

Epoch 39/1000
Training Loss: 0.31122198, Training R2: 0.831567
Validation Loss: 0.76813221, Validation R2: 0.408194

Epoch 40/1000
Training Loss: 0.34597567, Training R2: 0.827796
Validation Loss: 0.78129619, Validation R2: 0.398241

Epoch 41/1000
Training Loss: 0.31420990, Training R2: 0.842523
Validation Loss: 0.73557538, Validation R2: 0.430592

Epoch 42/1000
Training Loss: 0.31774650, Training R2: 0.840475
Validation Loss: 0.78317094, Validation R2: 0.368584

Epoch 43/1000
Training Loss: 0.30360076, Training R2: 0.850661
Validation Loss: 0.73854858, Validation R2: 0.443253

Epoch 44/1000
Training Loss: 0.25569865, Training R2: 0.865975
Validation Loss: 0.73574811, Validation R2: 0.456233

Epoch 45/1000
Training Loss: 0.24663076, Training R2: 0.872384
Validation Loss: 0.71522093, Validation R2: 0.454401

Epoch 46/1000
Training Loss: 0.25717963, Training R2: 0.874159
Validation Loss: 0.70321560, Validation R2: 0.487684
Saved best model with validation R2 0.487684 to best_finetuned_model.pth

Epoch 47/1000
Training Loss: 0.26568476, Training R2: 0.867172
Validation Loss: 0.71162063, Validation R2: 0.478924

Epoch 48/1000
Training Loss: 0.25889833, Training R2: 0.871471
Validation Loss: 0.71393323, Validation R2: 0.467781

Epoch 49/1000
Training Loss: 0.26646934, Training R2: 0.874510
Validation Loss: 0.71160674, Validation R2: 0.481230

Epoch 50/1000
Training Loss: 0.24381210, Training R2: 0.887725
Validation Loss: 0.71179414, Validation R2: 0.458482

Epoch 51/1000
Training Loss: 0.24898498, Training R2: 0.887691
Validation Loss: 0.70380670, Validation R2: 0.494616
Saved best model with validation R2 0.494616 to best_finetuned_model.pth

Epoch 52/1000
Training Loss: 0.24755895, Training R2: 0.883575
Validation Loss: 0.68581265, Validation R2: 0.497595
Saved best model with validation R2 0.497595 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.26559455, Training R2: 0.882622
Validation Loss: 0.69492841, Validation R2: 0.492887

Epoch 54/1000
Training Loss: 0.22310790, Training R2: 0.896645
Validation Loss: 0.68011081, Validation R2: 0.504624
Saved best model with validation R2 0.504624 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.21968023, Training R2: 0.899932
Validation Loss: 0.68724877, Validation R2: 0.503559

Epoch 56/1000
Training Loss: 0.22254584, Training R2: 0.890148
Validation Loss: 0.69882667, Validation R2: 0.485849

Epoch 57/1000
Training Loss: 0.19983658, Training R2: 0.906866
Validation Loss: 0.70924789, Validation R2: 0.479308

Epoch 58/1000
Training Loss: 0.20132344, Training R2: 0.908581
Validation Loss: 0.71858448, Validation R2: 0.477380

Epoch 59/1000
Training Loss: 0.20296051, Training R2: 0.907779
Validation Loss: 0.69047654, Validation R2: 0.506515
Saved best model with validation R2 0.506515 to best_finetuned_model.pth

Epoch 60/1000
Training Loss: 0.19308230, Training R2: 0.911946
Validation Loss: 0.69191933, Validation R2: 0.497890

Epoch 61/1000
Training Loss: 0.21115641, Training R2: 0.909926
Validation Loss: 0.67418402, Validation R2: 0.529662
Saved best model with validation R2 0.529662 to best_finetuned_model.pth

Epoch 62/1000
Training Loss: 0.23357085, Training R2: 0.903535
Validation Loss: 0.68577820, Validation R2: 0.504359

Epoch 63/1000
Training Loss: 0.23545153, Training R2: 0.901989
Validation Loss: 0.68885082, Validation R2: 0.503136

Epoch 64/1000
Training Loss: 0.21852175, Training R2: 0.905344
Validation Loss: 0.66734374, Validation R2: 0.531297
Saved best model with validation R2 0.531297 to best_finetuned_model.pth

Epoch 65/1000
Training Loss: 0.20238760, Training R2: 0.908509
Validation Loss: 0.67728674, Validation R2: 0.528355

Epoch 66/1000
Training Loss: 0.19788269, Training R2: 0.912535
Validation Loss: 0.74129683, Validation R2: 0.464284

Epoch 67/1000
Training Loss: 0.27314351, Training R2: 0.888485
Validation Loss: 0.72658962, Validation R2: 0.489462

Epoch 68/1000
Training Loss: 0.23695946, Training R2: 0.903117
Validation Loss: 0.74506652, Validation R2: 0.474585

Epoch 69/1000
Training Loss: 0.26811301, Training R2: 0.891806
Validation Loss: 0.67480302, Validation R2: 0.529264

Epoch 70/1000
Training Loss: 0.24919631, Training R2: 0.899489
Validation Loss: 0.73457760, Validation R2: 0.457376

Epoch 71/1000
Training Loss: 0.31609132, Training R2: 0.865309
Validation Loss: 0.68444985, Validation R2: 0.527632

Epoch 72/1000
Training Loss: 0.24324555, Training R2: 0.901976
Validation Loss: 0.68750823, Validation R2: 0.532911
Saved best model with validation R2 0.532911 to best_finetuned_model.pth

Epoch 73/1000
Training Loss: 0.20969183, Training R2: 0.910229
Validation Loss: 0.66810209, Validation R2: 0.541805
Saved best model with validation R2 0.541805 to best_finetuned_model.pth

Epoch 74/1000
Training Loss: 0.19297284, Training R2: 0.914850
Validation Loss: 0.68780088, Validation R2: 0.514401

Epoch 75/1000
Training Loss: 0.18473943, Training R2: 0.918900
Validation Loss: 0.66633421, Validation R2: 0.529733

Epoch 76/1000
Training Loss: 0.17489336, Training R2: 0.920096
Validation Loss: 0.67218751, Validation R2: 0.524355

Epoch 77/1000
Training Loss: 0.17654837, Training R2: 0.916381
Validation Loss: 0.65220559, Validation R2: 0.549585
Saved best model with validation R2 0.549585 to best_finetuned_model.pth

Epoch 78/1000
Training Loss: 0.15513942, Training R2: 0.924725
Validation Loss: 0.65558541, Validation R2: 0.527496

Epoch 79/1000
Training Loss: 0.15837052, Training R2: 0.926798
Validation Loss: 0.65163362, Validation R2: 0.553277
Saved best model with validation R2 0.553277 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.16542106, Training R2: 0.921719
Validation Loss: 0.70996499, Validation R2: 0.506399

Epoch 81/1000
Training Loss: 0.19379596, Training R2: 0.919779
Validation Loss: 0.69490278, Validation R2: 0.508252

Epoch 82/1000
Training Loss: 0.18401123, Training R2: 0.915874
Validation Loss: 0.69034845, Validation R2: 0.507288

Epoch 83/1000
Training Loss: 0.18436084, Training R2: 0.916747
Validation Loss: 0.69169462, Validation R2: 0.516549

Epoch 84/1000
Training Loss: 0.21398446, Training R2: 0.912306
Validation Loss: 0.70249981, Validation R2: 0.510578

Epoch 85/1000
Training Loss: 0.18487504, Training R2: 0.926251
Validation Loss: 0.70774883, Validation R2: 0.506000

Epoch 86/1000
Training Loss: 0.18957145, Training R2: 0.916997
Validation Loss: 0.71743619, Validation R2: 0.506031

Epoch 87/1000
Training Loss: 0.22587727, Training R2: 0.914109
Validation Loss: 0.67937553, Validation R2: 0.531873

Epoch 88/1000
Training Loss: 0.17722802, Training R2: 0.919786
Validation Loss: 0.67692763, Validation R2: 0.513525

Epoch 89/1000
Training Loss: 0.19325408, Training R2: 0.924005
Validation Loss: 0.68145865, Validation R2: 0.507020

Epoch 90/1000
Training Loss: 0.18370688, Training R2: 0.926310
Validation Loss: 0.65105253, Validation R2: 0.540778

Epoch 91/1000
Training Loss: 0.20063319, Training R2: 0.919661
Validation Loss: 0.63001341, Validation R2: 0.561175
Saved best model with validation R2 0.561175 to best_finetuned_model.pth

Epoch 92/1000
Training Loss: 0.17680393, Training R2: 0.928340
Validation Loss: 0.64154786, Validation R2: 0.555513

Epoch 93/1000
Training Loss: 0.17234816, Training R2: 0.928310
Validation Loss: 0.65554458, Validation R2: 0.544922

Epoch 94/1000
Training Loss: 0.15882915, Training R2: 0.929493
Validation Loss: 0.66644055, Validation R2: 0.529487

Epoch 95/1000
Training Loss: 0.13500314, Training R2: 0.933967
Validation Loss: 0.67062604, Validation R2: 0.526680

Epoch 96/1000
Training Loss: 0.13039374, Training R2: 0.938467
Validation Loss: 0.65524817, Validation R2: 0.533013

Epoch 97/1000
Training Loss: 0.13132183, Training R2: 0.936027
Validation Loss: 0.65797424, Validation R2: 0.541899

Epoch 98/1000
Training Loss: 0.11967087, Training R2: 0.936141
Validation Loss: 0.68077511, Validation R2: 0.527045

Epoch 99/1000
Training Loss: 0.12197383, Training R2: 0.938836
Validation Loss: 0.66825515, Validation R2: 0.535871

Epoch 100/1000
Training Loss: 0.12471343, Training R2: 0.941308
Validation Loss: 0.66721398, Validation R2: 0.535296

Epoch 101/1000
Training Loss: 0.16297197, Training R2: 0.927264
Validation Loss: 0.67988056, Validation R2: 0.518099

Epoch 102/1000
Training Loss: 0.16638991, Training R2: 0.933550
Validation Loss: 0.66977388, Validation R2: 0.532780

Epoch 103/1000
Training Loss: 0.15920621, Training R2: 0.933481
Validation Loss: 0.68560636, Validation R2: 0.528124

Epoch 104/1000
Training Loss: 0.13530274, Training R2: 0.936906
Validation Loss: 0.66498864, Validation R2: 0.538564

Epoch 105/1000
Training Loss: 0.14386920, Training R2: 0.934977
Validation Loss: 0.66343993, Validation R2: 0.544695

Epoch 106/1000
Training Loss: 0.18844763, Training R2: 0.921451
Validation Loss: 0.65763503, Validation R2: 0.549469

Epoch 107/1000
Training Loss: 0.18948953, Training R2: 0.926838
Validation Loss: 0.64579618, Validation R2: 0.559417

Epoch 108/1000
Training Loss: 0.15233080, Training R2: 0.938927
Validation Loss: 0.65517998, Validation R2: 0.556754

Epoch 109/1000
Training Loss: 0.12916293, Training R2: 0.938122
Validation Loss: 0.67261213, Validation R2: 0.545598

Epoch 110/1000
Training Loss: 0.14022202, Training R2: 0.936037
Validation Loss: 0.68655348, Validation R2: 0.535994

Epoch 111/1000
Training Loss: 0.16277753, Training R2: 0.938789
Validation Loss: 0.65842748, Validation R2: 0.560312

Epoch 112/1000
Epoch 00112: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.13829949, Training R2: 0.938959
Validation Loss: 0.66740417, Validation R2: 0.550525

Epoch 113/1000
学习率已减少 1 次
Training Loss: 0.12687371, Training R2: 0.946322
Validation Loss: 0.65278721, Validation R2: 0.568046
Saved best model with validation R2 0.568046 to best_finetuned_model.pth

Epoch 114/1000
Training Loss: 0.10294541, Training R2: 0.948801
Validation Loss: 0.65797955, Validation R2: 0.560866

Epoch 115/1000
Training Loss: 0.09581154, Training R2: 0.951448
Validation Loss: 0.66808343, Validation R2: 0.547609

Epoch 116/1000
Training Loss: 0.08749753, Training R2: 0.952443
Validation Loss: 0.67674267, Validation R2: 0.538820

Epoch 117/1000
Training Loss: 0.09460331, Training R2: 0.948563
Validation Loss: 0.67184478, Validation R2: 0.545693

Epoch 118/1000
Training Loss: 0.08574194, Training R2: 0.950968
Validation Loss: 0.66824323, Validation R2: 0.550970

Epoch 119/1000
Training Loss: 0.07894895, Training R2: 0.952553
Validation Loss: 0.68323666, Validation R2: 0.537010

Epoch 120/1000
Training Loss: 0.08190479, Training R2: 0.954676
Validation Loss: 0.67982072, Validation R2: 0.539812

Epoch 121/1000
Training Loss: 0.08487862, Training R2: 0.950520
Validation Loss: 0.68799973, Validation R2: 0.529406

Epoch 122/1000
Training Loss: 0.08773523, Training R2: 0.955930
Validation Loss: 0.66835660, Validation R2: 0.546869

Epoch 123/1000
Training Loss: 0.07917009, Training R2: 0.956813
Validation Loss: 0.67499679, Validation R2: 0.539769

Epoch 124/1000
Training Loss: 0.07626528, Training R2: 0.958455
Validation Loss: 0.67174673, Validation R2: 0.544413

Epoch 125/1000
Training Loss: 0.07287818, Training R2: 0.958134
Validation Loss: 0.67570907, Validation R2: 0.541159

Epoch 126/1000
Training Loss: 0.06778067, Training R2: 0.957721
Validation Loss: 0.66781205, Validation R2: 0.550850

Epoch 127/1000
Training Loss: 0.07260893, Training R2: 0.958476
Validation Loss: 0.66756004, Validation R2: 0.553781

Epoch 128/1000
Training Loss: 0.09268559, Training R2: 0.952116
Validation Loss: 0.66126609, Validation R2: 0.557184

Epoch 129/1000
Training Loss: 0.09623231, Training R2: 0.957614
Validation Loss: 0.66037118, Validation R2: 0.559871

Epoch 130/1000
Training Loss: 0.08119071, Training R2: 0.956913
Validation Loss: 0.66612113, Validation R2: 0.553437

Epoch 131/1000
Training Loss: 0.08196049, Training R2: 0.959560
Validation Loss: 0.66113168, Validation R2: 0.556849

Epoch 132/1000
Training Loss: 0.07049994, Training R2: 0.958730
Validation Loss: 0.66282654, Validation R2: 0.554717

Epoch 133/1000
Training Loss: 0.07295753, Training R2: 0.960246
Validation Loss: 0.66746682, Validation R2: 0.552930

Epoch 134/1000
Epoch 00134: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.07318939, Training R2: 0.957862
Validation Loss: 0.67130154, Validation R2: 0.550128

Epoch 135/1000
学习率已减少 2 次
Training Loss: 0.06553113, Training R2: 0.960135
Validation Loss: 0.66078079, Validation R2: 0.560633

Epoch 136/1000
Training Loss: 0.06101940, Training R2: 0.960469
Validation Loss: 0.65965199, Validation R2: 0.561974

Epoch 137/1000
Training Loss: 0.05302021, Training R2: 0.961638
Validation Loss: 0.66231185, Validation R2: 0.557321

Epoch 138/1000
Training Loss: 0.04827837, Training R2: 0.961796
Validation Loss: 0.66263759, Validation R2: 0.555302

Epoch 139/1000
Training Loss: 0.04543898, Training R2: 0.962708
Validation Loss: 0.66181427, Validation R2: 0.555792

Epoch 140/1000
Training Loss: 0.04710364, Training R2: 0.963030
Validation Loss: 0.66220397, Validation R2: 0.556451

Epoch 141/1000
Training Loss: 0.05801652, Training R2: 0.961703
Validation Loss: 0.66313213, Validation R2: 0.556379

Epoch 142/1000
Training Loss: 0.04844987, Training R2: 0.962701
Validation Loss: 0.66268843, Validation R2: 0.552488

Epoch 143/1000
Training Loss: 0.06142873, Training R2: 0.964179
Validation Loss: 0.66674000, Validation R2: 0.549047

Epoch 144/1000
Training Loss: 0.05297427, Training R2: 0.964015
Validation Loss: 0.66759580, Validation R2: 0.551222

Epoch 145/1000
Training Loss: 0.05411045, Training R2: 0.962562
Validation Loss: 0.67173660, Validation R2: 0.547030

Epoch 146/1000
Training Loss: 0.05522076, Training R2: 0.963541
Validation Loss: 0.66791928, Validation R2: 0.550038

Epoch 147/1000
Training Loss: 0.05572577, Training R2: 0.964095
Validation Loss: 0.66622496, Validation R2: 0.549883

Epoch 148/1000
Training Loss: 0.04791632, Training R2: 0.964759
Validation Loss: 0.66600579, Validation R2: 0.550439

Epoch 149/1000
Training Loss: 0.04415890, Training R2: 0.964662
Validation Loss: 0.66348898, Validation R2: 0.555731

Epoch 150/1000
Training Loss: 0.04011784, Training R2: 0.965398
Validation Loss: 0.66265333, Validation R2: 0.556554

Epoch 151/1000
Training Loss: 0.03926697, Training R2: 0.965512
Validation Loss: 0.66499931, Validation R2: 0.553988

Epoch 152/1000
Training Loss: 0.03846588, Training R2: 0.966491
Validation Loss: 0.66370177, Validation R2: 0.555389

Epoch 153/1000
Training Loss: 0.04066023, Training R2: 0.965110
Validation Loss: 0.67299885, Validation R2: 0.549300

Epoch 154/1000
Training Loss: 0.04416036, Training R2: 0.965788
Validation Loss: 0.66711456, Validation R2: 0.556208

Epoch 155/1000
Epoch 00155: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.03877814, Training R2: 0.966670
Validation Loss: 0.66718674, Validation R2: 0.555073

Epoch 156/1000
学习率已减少 3 次
Training Loss: 0.03442209, Training R2: 0.966657
Validation Loss: 0.66667968, Validation R2: 0.554713

Epoch 157/1000
Training Loss: 0.03258229, Training R2: 0.967227
Validation Loss: 0.66262555, Validation R2: 0.558020

Epoch 158/1000
Training Loss: 0.03047798, Training R2: 0.967279
Validation Loss: 0.66285384, Validation R2: 0.558676

Epoch 159/1000
Training Loss: 0.02962756, Training R2: 0.967065
Validation Loss: 0.66045135, Validation R2: 0.560902

Epoch 160/1000
Training Loss: 0.02830565, Training R2: 0.966764
Validation Loss: 0.66131425, Validation R2: 0.559550

Epoch 161/1000
Training Loss: 0.02707579, Training R2: 0.967106
Validation Loss: 0.66286236, Validation R2: 0.557526

Epoch 162/1000
Training Loss: 0.02733425, Training R2: 0.966661
Validation Loss: 0.66247320, Validation R2: 0.556970

Epoch 163/1000
Training Loss: 0.02691269, Training R2: 0.967007
Validation Loss: 0.66129196, Validation R2: 0.558742

Epoch 164/1000
Training Loss: 0.02738352, Training R2: 0.967046
Validation Loss: 0.66235715, Validation R2: 0.557508

Epoch 165/1000
Training Loss: 0.02553216, Training R2: 0.966869
Validation Loss: 0.66921329, Validation R2: 0.551314

Epoch 166/1000
Training Loss: 0.03680322, Training R2: 0.966271
Validation Loss: 0.66605633, Validation R2: 0.553743

Epoch 167/1000
Training Loss: 0.03291694, Training R2: 0.966862
Validation Loss: 0.66196388, Validation R2: 0.556586

Epoch 168/1000
Training Loss: 0.03809345, Training R2: 0.965852
Validation Loss: 0.66107786, Validation R2: 0.557850

Epoch 169/1000
Training Loss: 0.04090669, Training R2: 0.966351
Validation Loss: 0.66676283, Validation R2: 0.553098

Epoch 170/1000
Training Loss: 0.03790782, Training R2: 0.966528
Validation Loss: 0.66694653, Validation R2: 0.553376

Epoch 171/1000
Training Loss: 0.04080985, Training R2: 0.966716
Validation Loss: 0.65888470, Validation R2: 0.559145

Epoch 172/1000
Training Loss: 0.04040709, Training R2: 0.966467
Validation Loss: 0.65928161, Validation R2: 0.559855

Epoch 173/1000
Training Loss: 0.03544554, Training R2: 0.966059
Validation Loss: 0.66374910, Validation R2: 0.557349

Epoch 174/1000
Training Loss: 0.03398463, Training R2: 0.966374
Validation Loss: 0.66201180, Validation R2: 0.558406

Epoch 175/1000
Training Loss: 0.03018027, Training R2: 0.967348
Validation Loss: 0.66029477, Validation R2: 0.559892

Epoch 176/1000
Epoch 00176: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.03352323, Training R2: 0.966522
Validation Loss: 0.66380584, Validation R2: 0.556528

Epoch 177/1000
学习率已减少 4 次
Training Loss: 0.02831130, Training R2: 0.967434
Validation Loss: 0.66396970, Validation R2: 0.556493

Epoch 178/1000
Training Loss: 0.02727639, Training R2: 0.967654
Validation Loss: 0.66079831, Validation R2: 0.558998

Epoch 179/1000
Training Loss: 0.02641740, Training R2: 0.967437
Validation Loss: 0.66206557, Validation R2: 0.557089

Epoch 180/1000
Training Loss: 0.02547430, Training R2: 0.967875
Validation Loss: 0.66104412, Validation R2: 0.557569

Epoch 181/1000
Training Loss: 0.02323238, Training R2: 0.967905
Validation Loss: 0.65979308, Validation R2: 0.559939

Epoch 182/1000
Training Loss: 0.02262731, Training R2: 0.967613
Validation Loss: 0.66430104, Validation R2: 0.555463

Epoch 183/1000
Training Loss: 0.02284470, Training R2: 0.967705
Validation Loss: 0.66399163, Validation R2: 0.555348

Epoch 184/1000
Training Loss: 0.02256614, Training R2: 0.967696
Validation Loss: 0.66064435, Validation R2: 0.558919

Epoch 185/1000
Training Loss: 0.02284197, Training R2: 0.967602
Validation Loss: 0.65895325, Validation R2: 0.559929

Epoch 186/1000
Training Loss: 0.02437173, Training R2: 0.967674
Validation Loss: 0.66214097, Validation R2: 0.556735

Epoch 187/1000
Training Loss: 0.02176061, Training R2: 0.967847
Validation Loss: 0.66066670, Validation R2: 0.558619

Epoch 188/1000
Training Loss: 0.02156580, Training R2: 0.967918
Validation Loss: 0.66327107, Validation R2: 0.556441

Epoch 189/1000
Training Loss: 0.02274533, Training R2: 0.967777
Validation Loss: 0.66217762, Validation R2: 0.557297

Epoch 190/1000
Training Loss: 0.02086373, Training R2: 0.967814
Validation Loss: 0.66343170, Validation R2: 0.555491

Epoch 191/1000
Training Loss: 0.02185368, Training R2: 0.967664
Validation Loss: 0.66146010, Validation R2: 0.557515

Epoch 192/1000
Training Loss: 0.02054579, Training R2: 0.967895
Validation Loss: 0.66259795, Validation R2: 0.556264

Epoch 193/1000
Training Loss: 0.02047624, Training R2: 0.968000
Validation Loss: 0.66036499, Validation R2: 0.558490

Epoch 194/1000
Training Loss: 0.01902217, Training R2: 0.967942
Validation Loss: 0.66247940, Validation R2: 0.556412

Epoch 195/1000
Training Loss: 0.01886562, Training R2: 0.967819
Validation Loss: 0.66259307, Validation R2: 0.556726

Epoch 196/1000
Training Loss: 0.01807068, Training R2: 0.968004
Validation Loss: 0.66024947, Validation R2: 0.559633

Epoch 197/1000
Epoch 00197: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.01785835, Training R2: 0.967976
Validation Loss: 0.65995932, Validation R2: 0.559998

Epoch 198/1000
学习率已减少 5 次
Training Loss: 0.01772110, Training R2: 0.968215
Validation Loss: 0.66114759, Validation R2: 0.558124

Epoch 199/1000
Training Loss: 0.01706104, Training R2: 0.968209
Validation Loss: 0.66033661, Validation R2: 0.558704

Epoch 200/1000
Training Loss: 0.01654266, Training R2: 0.968330
Validation Loss: 0.66068971, Validation R2: 0.558615

Epoch 201/1000
Training Loss: 0.01691627, Training R2: 0.968123
Validation Loss: 0.66054213, Validation R2: 0.558279

Epoch 202/1000
Training Loss: 0.01568499, Training R2: 0.968193
Validation Loss: 0.66149986, Validation R2: 0.557986

Epoch 203/1000
Training Loss: 0.01572831, Training R2: 0.968199
Validation Loss: 0.66116577, Validation R2: 0.558191

Epoch 204/1000
Training Loss: 0.01528142, Training R2: 0.968118
Validation Loss: 0.66322678, Validation R2: 0.555574

Epoch 205/1000
Training Loss: 0.01535693, Training R2: 0.968208
Validation Loss: 0.66232860, Validation R2: 0.556588

Epoch 206/1000
Training Loss: 0.01493131, Training R2: 0.968281
Validation Loss: 0.66075051, Validation R2: 0.557969

Epoch 207/1000
Training Loss: 0.01492630, Training R2: 0.968356
Validation Loss: 0.66265547, Validation R2: 0.556103

Epoch 208/1000
Training Loss: 0.01537236, Training R2: 0.968311
Validation Loss: 0.66211778, Validation R2: 0.557156

Epoch 209/1000
Training Loss: 0.01509450, Training R2: 0.968451
Validation Loss: 0.66083771, Validation R2: 0.557557

Epoch 210/1000
Training Loss: 0.01708934, Training R2: 0.968249
Validation Loss: 0.65950215, Validation R2: 0.559248

Epoch 211/1000
Training Loss: 0.01574169, Training R2: 0.968435
Validation Loss: 0.65898168, Validation R2: 0.559994

Epoch 212/1000
Training Loss: 0.01567562, Training R2: 0.968297
Validation Loss: 0.65975815, Validation R2: 0.559527

Epoch 213/1000
Training Loss: 0.01589902, Training R2: 0.968485
Validation Loss: 0.66208494, Validation R2: 0.556382

Epoch 214/1000
Training Loss: 0.01553447, Training R2: 0.968360
Validation Loss: 0.66154546, Validation R2: 0.556770

Epoch 215/1000
Training Loss: 0.01638413, Training R2: 0.968519
Validation Loss: 0.66469175, Validation R2: 0.554752

Epoch 216/1000
Training Loss: 0.01580143, Training R2: 0.968463
Validation Loss: 0.66079801, Validation R2: 0.558729

Epoch 217/1000
Training Loss: 0.01541173, Training R2: 0.968475
Validation Loss: 0.66303420, Validation R2: 0.556181

Epoch 218/1000
Epoch 00218: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.01761158, Training R2: 0.968397
Validation Loss: 0.66173649, Validation R2: 0.557746

Epoch 219/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
