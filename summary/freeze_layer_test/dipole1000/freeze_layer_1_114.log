Using device: cuda
Selected target_properties: ['dipole']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)

Frozen layers status:
emb_z.emb.weight: Trainable
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5317507

Epoch 1/1000
Training Loss: 1.26844726, Training R2: -0.171213
Validation Loss: 1.12190521, Validation R2: -0.095517
Saved best model with validation R2 -0.095517 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 1.19429964, Training R2: -0.048414
Validation Loss: 1.10628200, Validation R2: -0.027415
Saved best model with validation R2 -0.027415 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 1.16725647, Training R2: -0.019451
Validation Loss: 1.11242604, Validation R2: -0.133525

Epoch 4/1000
Training Loss: 1.16969135, Training R2: -0.128050
Validation Loss: 1.08539748, Validation R2: 0.004456
Saved best model with validation R2 0.004456 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 1.19243265, Training R2: -0.008769
Validation Loss: 1.10122454, Validation R2: -0.018348

Epoch 6/1000
Training Loss: 1.16756043, Training R2: 0.001638
Validation Loss: 1.08749127, Validation R2: -0.072738

Epoch 7/1000
Training Loss: 1.16119903, Training R2: -0.102445
Validation Loss: 1.09001505, Validation R2: -0.083387

Epoch 8/1000
Training Loss: 1.15047760, Training R2: -0.063475
Validation Loss: 1.06639051, Validation R2: -0.007099

Epoch 9/1000
Training Loss: 1.14007693, Training R2: -0.020740
Validation Loss: 1.06724429, Validation R2: -0.025291

Epoch 10/1000
Training Loss: 1.13108289, Training R2: -0.029038
Validation Loss: 1.05168176, Validation R2: 0.036248
Saved best model with validation R2 0.036248 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 1.13066991, Training R2: 0.039107
Validation Loss: 1.04311979, Validation R2: 0.067696
Saved best model with validation R2 0.067696 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 1.10383220, Training R2: 0.073369
Validation Loss: 1.04561377, Validation R2: -0.003075

Epoch 13/1000
Training Loss: 1.08615218, Training R2: 0.027698
Validation Loss: 0.99711257, Validation R2: 0.130119
Saved best model with validation R2 0.130119 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 1.05210885, Training R2: 0.166642
Validation Loss: 0.97712070, Validation R2: 0.139522
Saved best model with validation R2 0.139522 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.99741953, Training R2: 0.188382
Validation Loss: 0.91838378, Validation R2: 0.243583
Saved best model with validation R2 0.243583 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.90325493, Training R2: 0.300654
Validation Loss: 1.05828774, Validation R2: 0.013559

Epoch 17/1000
Training Loss: 0.89928150, Training R2: 0.276487
Validation Loss: 0.93358409, Validation R2: 0.198866

Epoch 18/1000
Training Loss: 0.85045273, Training R2: 0.349692
Validation Loss: 0.94988823, Validation R2: 0.165047

Epoch 19/1000
Training Loss: 0.81752146, Training R2: 0.386709
Validation Loss: 0.95749313, Validation R2: 0.174622

Epoch 20/1000
Training Loss: 0.75758766, Training R2: 0.453667
Validation Loss: 1.01360214, Validation R2: 0.088107

Epoch 21/1000
Training Loss: 0.72176782, Training R2: 0.488275
Validation Loss: 0.95064694, Validation R2: 0.147397

Epoch 22/1000
Training Loss: 0.71499384, Training R2: 0.512647
Validation Loss: 0.88185227, Validation R2: 0.247068
Saved best model with validation R2 0.247068 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.72406088, Training R2: 0.504323
Validation Loss: 0.93050528, Validation R2: 0.163296

Epoch 24/1000
Training Loss: 0.71009281, Training R2: 0.509411
Validation Loss: 0.98438209, Validation R2: 0.082413

Epoch 25/1000
Training Loss: 0.68971693, Training R2: 0.523762
Validation Loss: 0.92071515, Validation R2: 0.161252

Epoch 26/1000
Training Loss: 0.66174627, Training R2: 0.564323
Validation Loss: 0.90120322, Validation R2: 0.215559

Epoch 27/1000
Training Loss: 0.68954883, Training R2: 0.533503
Validation Loss: 0.81832427, Validation R2: 0.323239
Saved best model with validation R2 0.323239 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.64368515, Training R2: 0.574118
Validation Loss: 0.83664864, Validation R2: 0.311368

Epoch 29/1000
Training Loss: 0.56251719, Training R2: 0.640343
Validation Loss: 0.83214062, Validation R2: 0.315853

Epoch 30/1000
Training Loss: 0.53370047, Training R2: 0.656697
Validation Loss: 0.82827955, Validation R2: 0.320103

Epoch 31/1000
Training Loss: 0.52350321, Training R2: 0.667649
Validation Loss: 0.79475784, Validation R2: 0.334179
Saved best model with validation R2 0.334179 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 0.50231766, Training R2: 0.689142
Validation Loss: 0.83310765, Validation R2: 0.280026

Epoch 33/1000
Training Loss: 0.46964746, Training R2: 0.716566
Validation Loss: 0.84305906, Validation R2: 0.268146

Epoch 34/1000
Training Loss: 0.45426252, Training R2: 0.729533
Validation Loss: 0.84351760, Validation R2: 0.292492

Epoch 35/1000
Training Loss: 0.49546274, Training R2: 0.704143
Validation Loss: 0.78485411, Validation R2: 0.358512
Saved best model with validation R2 0.358512 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.43158217, Training R2: 0.746931
Validation Loss: 0.82032710, Validation R2: 0.281914

Epoch 37/1000
Training Loss: 0.44719919, Training R2: 0.744261
Validation Loss: 0.78821456, Validation R2: 0.338093

Epoch 38/1000
Training Loss: 0.44622979, Training R2: 0.742262
Validation Loss: 0.80913174, Validation R2: 0.331414

Epoch 39/1000
Training Loss: 0.46861183, Training R2: 0.740800
Validation Loss: 0.80743706, Validation R2: 0.335222

Epoch 40/1000
Training Loss: 0.41702039, Training R2: 0.763534
Validation Loss: 0.86368299, Validation R2: 0.275874

Epoch 41/1000
Training Loss: 0.47273045, Training R2: 0.737787
Validation Loss: 0.87274104, Validation R2: 0.264119

Epoch 42/1000
Training Loss: 0.48780491, Training R2: 0.738106
Validation Loss: 0.80218422, Validation R2: 0.358539
Saved best model with validation R2 0.358539 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.49752317, Training R2: 0.712948
Validation Loss: 0.87107557, Validation R2: 0.245740

Epoch 44/1000
Training Loss: 0.46720636, Training R2: 0.757818
Validation Loss: 0.85205513, Validation R2: 0.278360

Epoch 45/1000
Training Loss: 0.40301347, Training R2: 0.785933
Validation Loss: 0.83029300, Validation R2: 0.301466

Epoch 46/1000
Training Loss: 0.39517711, Training R2: 0.784957
Validation Loss: 0.83066726, Validation R2: 0.298980

Epoch 47/1000
Training Loss: 0.38088484, Training R2: 0.797444
Validation Loss: 0.82023382, Validation R2: 0.320066

Epoch 48/1000
Training Loss: 0.36770726, Training R2: 0.790190
Validation Loss: 0.81698895, Validation R2: 0.303072

Epoch 49/1000
Training Loss: 0.35440829, Training R2: 0.810663
Validation Loss: 0.83599132, Validation R2: 0.266726

Epoch 50/1000
Training Loss: 0.33116502, Training R2: 0.823526
Validation Loss: 0.84747618, Validation R2: 0.274900

Epoch 51/1000
Training Loss: 0.34355726, Training R2: 0.823791
Validation Loss: 0.84877503, Validation R2: 0.282269

Epoch 52/1000
Training Loss: 0.35761947, Training R2: 0.822466
Validation Loss: 0.81870705, Validation R2: 0.307348

Epoch 53/1000
Training Loss: 0.35625157, Training R2: 0.817955
Validation Loss: 0.82998770, Validation R2: 0.305496

Epoch 54/1000
Training Loss: 0.33455310, Training R2: 0.840558
Validation Loss: 0.78791219, Validation R2: 0.370243
Saved best model with validation R2 0.370243 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.34225539, Training R2: 0.827462
Validation Loss: 0.83753830, Validation R2: 0.277796

Epoch 56/1000
Training Loss: 0.34366215, Training R2: 0.831910
Validation Loss: 0.87731671, Validation R2: 0.233425

Epoch 57/1000
Training Loss: 0.40540749, Training R2: 0.800417
Validation Loss: 0.77803558, Validation R2: 0.357526

Epoch 58/1000
Training Loss: 0.37973965, Training R2: 0.814836
Validation Loss: 0.83219260, Validation R2: 0.260881

Epoch 59/1000
Training Loss: 0.34472322, Training R2: 0.831307
Validation Loss: 0.76540309, Validation R2: 0.355982

Epoch 60/1000
Training Loss: 0.28573844, Training R2: 0.861026
Validation Loss: 0.79364914, Validation R2: 0.319609

Epoch 61/1000
Training Loss: 0.27972138, Training R2: 0.870444
Validation Loss: 0.80802166, Validation R2: 0.322509

Epoch 62/1000
Training Loss: 0.29466626, Training R2: 0.858957
Validation Loss: 0.81232703, Validation R2: 0.320435

Epoch 63/1000
Training Loss: 0.30709836, Training R2: 0.858235
Validation Loss: 0.77673203, Validation R2: 0.361695

Epoch 64/1000
Training Loss: 0.28958331, Training R2: 0.854304
Validation Loss: 0.76976866, Validation R2: 0.366404

Epoch 65/1000
Training Loss: 0.29183737, Training R2: 0.865787
Validation Loss: 0.73453808, Validation R2: 0.427650
Saved best model with validation R2 0.427650 to best_finetuned_model.pth

Epoch 66/1000
Training Loss: 0.28270865, Training R2: 0.868206
Validation Loss: 0.73370177, Validation R2: 0.427109

Epoch 67/1000
Training Loss: 0.25820720, Training R2: 0.876421
Validation Loss: 0.73800576, Validation R2: 0.415942

Epoch 68/1000
Training Loss: 0.24823363, Training R2: 0.881791
Validation Loss: 0.71815360, Validation R2: 0.444861
Saved best model with validation R2 0.444861 to best_finetuned_model.pth

Epoch 69/1000
Training Loss: 0.23584011, Training R2: 0.892688
Validation Loss: 0.74253571, Validation R2: 0.430785

Epoch 70/1000
Training Loss: 0.25319803, Training R2: 0.880568
Validation Loss: 0.77789295, Validation R2: 0.386119

Epoch 71/1000
Training Loss: 0.24554831, Training R2: 0.893479
Validation Loss: 0.75007427, Validation R2: 0.425030

Epoch 72/1000
Training Loss: 0.23027644, Training R2: 0.895748
Validation Loss: 0.75735891, Validation R2: 0.414172

Epoch 73/1000
Training Loss: 0.21788713, Training R2: 0.901938
Validation Loss: 0.72317398, Validation R2: 0.455121
Saved best model with validation R2 0.455121 to best_finetuned_model.pth

Epoch 74/1000
Training Loss: 0.19864255, Training R2: 0.906102
Validation Loss: 0.77007651, Validation R2: 0.396858

Epoch 75/1000
Training Loss: 0.20338621, Training R2: 0.901132
Validation Loss: 0.74830133, Validation R2: 0.421532

Epoch 76/1000
Training Loss: 0.20503770, Training R2: 0.902953
Validation Loss: 0.73321974, Validation R2: 0.422064

Epoch 77/1000
Training Loss: 0.19757708, Training R2: 0.903346
Validation Loss: 0.73645812, Validation R2: 0.410751

Epoch 78/1000
Training Loss: 0.19870911, Training R2: 0.907844
Validation Loss: 0.73102325, Validation R2: 0.430145

Epoch 79/1000
Training Loss: 0.19679823, Training R2: 0.907715
Validation Loss: 0.74522549, Validation R2: 0.408010

Epoch 80/1000
Training Loss: 0.18298327, Training R2: 0.912873
Validation Loss: 0.73551977, Validation R2: 0.421252

Epoch 81/1000
Training Loss: 0.18528507, Training R2: 0.912902
Validation Loss: 0.73115200, Validation R2: 0.421238

Epoch 82/1000
Training Loss: 0.17020507, Training R2: 0.918813
Validation Loss: 0.73059541, Validation R2: 0.438286

Epoch 83/1000
Training Loss: 0.18018968, Training R2: 0.918006
Validation Loss: 0.75902623, Validation R2: 0.384352

Epoch 84/1000
Training Loss: 0.19272158, Training R2: 0.912519
Validation Loss: 0.76608342, Validation R2: 0.401753

Epoch 85/1000
Training Loss: 0.22318344, Training R2: 0.913995
Validation Loss: 0.76046509, Validation R2: 0.406022

Epoch 86/1000
Training Loss: 0.21616327, Training R2: 0.908437
Validation Loss: 0.71862000, Validation R2: 0.444037

Epoch 87/1000
Training Loss: 0.17122065, Training R2: 0.921783
Validation Loss: 0.74125928, Validation R2: 0.400579

Epoch 88/1000
Training Loss: 0.19132703, Training R2: 0.920288
Validation Loss: 0.73542678, Validation R2: 0.406427

Epoch 89/1000
Training Loss: 0.19744230, Training R2: 0.923950
Validation Loss: 0.73971236, Validation R2: 0.408752

Epoch 90/1000
Training Loss: 0.16619815, Training R2: 0.923542
Validation Loss: 0.73916876, Validation R2: 0.420894

Epoch 91/1000
Training Loss: 0.15920982, Training R2: 0.922375
Validation Loss: 0.75906277, Validation R2: 0.415403

Epoch 92/1000
Training Loss: 0.18303970, Training R2: 0.923220
Validation Loss: 0.74492961, Validation R2: 0.426127

Epoch 93/1000
Training Loss: 0.17290615, Training R2: 0.922629
Validation Loss: 0.75189734, Validation R2: 0.410197

Epoch 94/1000
Epoch 00094: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.18987697, Training R2: 0.920115
Validation Loss: 0.74197567, Validation R2: 0.408019

Epoch 95/1000
学习率已减少 1 次
Training Loss: 0.15380413, Training R2: 0.933232
Validation Loss: 0.75636184, Validation R2: 0.406100

Epoch 96/1000
Training Loss: 0.19328356, Training R2: 0.921600
Validation Loss: 0.73320186, Validation R2: 0.418094

Epoch 97/1000
Training Loss: 0.19329664, Training R2: 0.922415
Validation Loss: 0.71914440, Validation R2: 0.439142

Epoch 98/1000
Training Loss: 0.15712619, Training R2: 0.931501
Validation Loss: 0.73507524, Validation R2: 0.427153

Epoch 99/1000
Training Loss: 0.15253150, Training R2: 0.930996
Validation Loss: 0.73685998, Validation R2: 0.416248

Epoch 100/1000
Training Loss: 0.13655125, Training R2: 0.938112
Validation Loss: 0.72683370, Validation R2: 0.426184

Epoch 101/1000
Training Loss: 0.13430221, Training R2: 0.941503
Validation Loss: 0.71837395, Validation R2: 0.443764

Epoch 102/1000
Training Loss: 0.11816347, Training R2: 0.944136
Validation Loss: 0.71332526, Validation R2: 0.458019
Saved best model with validation R2 0.458019 to best_finetuned_model.pth

Epoch 103/1000
Training Loss: 0.11465009, Training R2: 0.936742
Validation Loss: 0.72544926, Validation R2: 0.446568

Epoch 104/1000
Training Loss: 0.11821966, Training R2: 0.937216
Validation Loss: 0.72522628, Validation R2: 0.447969

Epoch 105/1000
Training Loss: 0.10685747, Training R2: 0.941087
Validation Loss: 0.72373253, Validation R2: 0.444710

Epoch 106/1000
Training Loss: 0.09663186, Training R2: 0.941759
Validation Loss: 0.71403348, Validation R2: 0.453408

Epoch 107/1000
Training Loss: 0.10273776, Training R2: 0.938738
Validation Loss: 0.72912854, Validation R2: 0.439374

Epoch 108/1000
Training Loss: 0.10296101, Training R2: 0.942899
Validation Loss: 0.73031616, Validation R2: 0.441459

Epoch 109/1000
Training Loss: 0.09902534, Training R2: 0.940938
Validation Loss: 0.73485970, Validation R2: 0.431657

Epoch 110/1000
Training Loss: 0.12025857, Training R2: 0.937947
Validation Loss: 0.72802079, Validation R2: 0.439126

Epoch 111/1000
Training Loss: 0.09973858, Training R2: 0.943884
Validation Loss: 0.72829360, Validation R2: 0.439619

Epoch 112/1000
Training Loss: 0.11700419, Training R2: 0.940108
Validation Loss: 0.72288209, Validation R2: 0.453782

Epoch 113/1000
Training Loss: 0.10616248, Training R2: 0.943763
Validation Loss: 0.72485894, Validation R2: 0.440969

Epoch 114/1000
Training Loss: 0.11281062, Training R2: 0.941259
Validation Loss: 0.71465582, Validation R2: 0.451682

Epoch 115/1000
Training Loss: 0.09985931, Training R2: 0.945952
Validation Loss: 0.71086973, Validation R2: 0.459887
Saved best model with validation R2 0.459887 to best_finetuned_model.pth

Epoch 116/1000
Training Loss: 0.09049142, Training R2: 0.947411
Validation Loss: 0.71072847, Validation R2: 0.458105

Epoch 117/1000
Training Loss: 0.09292996, Training R2: 0.944301
Validation Loss: 0.71103287, Validation R2: 0.457850

Epoch 118/1000
Training Loss: 0.08759710, Training R2: 0.945282
Validation Loss: 0.71778828, Validation R2: 0.455739

Epoch 119/1000
Training Loss: 0.09197459, Training R2: 0.947643
Validation Loss: 0.71615678, Validation R2: 0.453016

Epoch 120/1000
Training Loss: 0.09397877, Training R2: 0.952873
Validation Loss: 0.72901595, Validation R2: 0.435731

Epoch 121/1000
Training Loss: 0.11758508, Training R2: 0.950557
Validation Loss: 0.71514171, Validation R2: 0.450606

Epoch 122/1000
Training Loss: 0.09842632, Training R2: 0.949513
Validation Loss: 0.70771658, Validation R2: 0.457817

Epoch 123/1000
Training Loss: 0.09153129, Training R2: 0.953283
Validation Loss: 0.70317537, Validation R2: 0.465910
Saved best model with validation R2 0.465910 to best_finetuned_model.pth

Epoch 124/1000
Training Loss: 0.09885545, Training R2: 0.954416
Validation Loss: 0.70921403, Validation R2: 0.457916

Epoch 125/1000
Training Loss: 0.08674941, Training R2: 0.956556
Validation Loss: 0.70878738, Validation R2: 0.460495

Epoch 126/1000
Training Loss: 0.08698847, Training R2: 0.955477
Validation Loss: 0.71527481, Validation R2: 0.452589

Epoch 127/1000
Training Loss: 0.10019971, Training R2: 0.955617
Validation Loss: 0.70505309, Validation R2: 0.460849

Epoch 128/1000
Training Loss: 0.08740416, Training R2: 0.955975
Validation Loss: 0.70552754, Validation R2: 0.457999

Epoch 129/1000
Training Loss: 0.09954466, Training R2: 0.944113
Validation Loss: 0.72205704, Validation R2: 0.440870

Epoch 130/1000
Training Loss: 0.11425261, Training R2: 0.954235
Validation Loss: 0.70995957, Validation R2: 0.457067

Epoch 131/1000
Training Loss: 0.09482625, Training R2: 0.955144
Validation Loss: 0.72210389, Validation R2: 0.441210

Epoch 132/1000
Training Loss: 0.08688637, Training R2: 0.957717
Validation Loss: 0.71634400, Validation R2: 0.447803

Epoch 133/1000
Training Loss: 0.07629370, Training R2: 0.957888
Validation Loss: 0.71224898, Validation R2: 0.451227

Epoch 134/1000
Training Loss: 0.08008190, Training R2: 0.955914
Validation Loss: 0.69967473, Validation R2: 0.467109
Saved best model with validation R2 0.467109 to best_finetuned_model.pth

Epoch 135/1000
Training Loss: 0.07555763, Training R2: 0.957922
Validation Loss: 0.70744610, Validation R2: 0.461988

Epoch 136/1000
Training Loss: 0.07359266, Training R2: 0.959051
Validation Loss: 0.71692699, Validation R2: 0.449472

Epoch 137/1000
Training Loss: 0.06833801, Training R2: 0.959364
Validation Loss: 0.71687108, Validation R2: 0.445526

Epoch 138/1000
Training Loss: 0.07920181, Training R2: 0.958001
Validation Loss: 0.71002102, Validation R2: 0.452885

Epoch 139/1000
Training Loss: 0.07111828, Training R2: 0.959395
Validation Loss: 0.71257198, Validation R2: 0.451654

Epoch 140/1000
Training Loss: 0.08963861, Training R2: 0.959600
Validation Loss: 0.70631665, Validation R2: 0.464622

Epoch 141/1000
Training Loss: 0.07414383, Training R2: 0.961001
Validation Loss: 0.71273184, Validation R2: 0.454059

Epoch 142/1000
Training Loss: 0.07798149, Training R2: 0.961894
Validation Loss: 0.71428907, Validation R2: 0.448546

Epoch 143/1000
Training Loss: 0.07729512, Training R2: 0.962881
Validation Loss: 0.71260482, Validation R2: 0.446985

Epoch 144/1000
Training Loss: 0.07679841, Training R2: 0.964099
Validation Loss: 0.70803148, Validation R2: 0.458237

Epoch 145/1000
Training Loss: 0.07542964, Training R2: 0.964181
Validation Loss: 0.71141648, Validation R2: 0.450025

Epoch 146/1000
Training Loss: 0.07421597, Training R2: 0.964986
Validation Loss: 0.71013343, Validation R2: 0.456087

Epoch 147/1000
Training Loss: 0.07391591, Training R2: 0.965522
Validation Loss: 0.70298684, Validation R2: 0.471815
Saved best model with validation R2 0.471815 to best_finetuned_model.pth

Epoch 148/1000
Training Loss: 0.09251260, Training R2: 0.961615
Validation Loss: 0.71113014, Validation R2: 0.455886

Epoch 149/1000
Training Loss: 0.09908405, Training R2: 0.964095
Validation Loss: 0.70490980, Validation R2: 0.474000
Saved best model with validation R2 0.474000 to best_finetuned_model.pth

Epoch 150/1000
Training Loss: 0.09309116, Training R2: 0.962792
Validation Loss: 0.70722222, Validation R2: 0.456356

Epoch 151/1000
Training Loss: 0.08870523, Training R2: 0.964412
Validation Loss: 0.70473605, Validation R2: 0.464733

Epoch 152/1000
Training Loss: 0.08362231, Training R2: 0.964186
Validation Loss: 0.71385199, Validation R2: 0.455969

Epoch 153/1000
Training Loss: 0.09496642, Training R2: 0.950539
Validation Loss: 0.70814770, Validation R2: 0.463211

Epoch 154/1000
Training Loss: 0.09397942, Training R2: 0.951663
Validation Loss: 0.70752263, Validation R2: 0.456471

Epoch 155/1000
Training Loss: 0.08677009, Training R2: 0.948414
Validation Loss: 0.72171462, Validation R2: 0.450171

Epoch 156/1000
Training Loss: 0.11944499, Training R2: 0.948736
Validation Loss: 0.71632153, Validation R2: 0.443080

Epoch 157/1000
Training Loss: 0.09433465, Training R2: 0.951890
Validation Loss: 0.70778388, Validation R2: 0.452317

Epoch 158/1000
Training Loss: 0.08503944, Training R2: 0.954630
Validation Loss: 0.70977706, Validation R2: 0.456206

Epoch 159/1000
Training Loss: 0.08462172, Training R2: 0.953680
Validation Loss: 0.71136367, Validation R2: 0.448026

Epoch 160/1000
Training Loss: 0.07776929, Training R2: 0.957029
Validation Loss: 0.71462089, Validation R2: 0.446754

Epoch 161/1000
Training Loss: 0.08049474, Training R2: 0.957170
Validation Loss: 0.71032441, Validation R2: 0.458231

Epoch 162/1000
Training Loss: 0.07708453, Training R2: 0.957993
Validation Loss: 0.70976436, Validation R2: 0.456354

Epoch 163/1000
Training Loss: 0.08874297, Training R2: 0.957794
Validation Loss: 0.70785934, Validation R2: 0.459626

Epoch 164/1000
Training Loss: 0.07270204, Training R2: 0.959109
Validation Loss: 0.71405178, Validation R2: 0.455031

Epoch 165/1000
Training Loss: 0.08317204, Training R2: 0.960733
Validation Loss: 0.70914108, Validation R2: 0.461748

Epoch 166/1000
Training Loss: 0.08163264, Training R2: 0.960382
Validation Loss: 0.71149266, Validation R2: 0.459512

Epoch 167/1000
Training Loss: 0.08035675, Training R2: 0.958398
Validation Loss: 0.71058577, Validation R2: 0.458004

Epoch 168/1000
Training Loss: 0.08465366, Training R2: 0.959653
Validation Loss: 0.70943749, Validation R2: 0.462837

Epoch 169/1000
Training Loss: 0.08540922, Training R2: 0.957999
Validation Loss: 0.71375167, Validation R2: 0.457359

Epoch 170/1000
Epoch 00170: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.07919844, Training R2: 0.959417
Validation Loss: 0.72023535, Validation R2: 0.444640

Epoch 171/1000
学习率已减少 2 次
Training Loss: 0.09961487, Training R2: 0.956925
Validation Loss: 0.72162271, Validation R2: 0.442115

Epoch 172/1000
Training Loss: 0.08580992, Training R2: 0.959846
Validation Loss: 0.71822232, Validation R2: 0.443309

Epoch 173/1000
Training Loss: 0.08569128, Training R2: 0.960194
Validation Loss: 0.71730572, Validation R2: 0.448509

Epoch 174/1000
Training Loss: 0.08349458, Training R2: 0.960709
Validation Loss: 0.71041757, Validation R2: 0.456947

Epoch 175/1000
Training Loss: 0.07206527, Training R2: 0.961733
Validation Loss: 0.71749812, Validation R2: 0.452826

Epoch 176/1000
Training Loss: 0.07808727, Training R2: 0.960473
Validation Loss: 0.71586704, Validation R2: 0.451824

Epoch 177/1000
Training Loss: 0.06939588, Training R2: 0.960060
Validation Loss: 0.71168023, Validation R2: 0.452444

Epoch 178/1000
Training Loss: 0.06472572, Training R2: 0.961877
Validation Loss: 0.71280622, Validation R2: 0.448728

Epoch 179/1000
Training Loss: 0.06728302, Training R2: 0.963503
Validation Loss: 0.71463972, Validation R2: 0.453661

Epoch 180/1000
Training Loss: 0.07619506, Training R2: 0.960704
Validation Loss: 0.70681530, Validation R2: 0.462223

Epoch 181/1000
Training Loss: 0.06797209, Training R2: 0.962571
Validation Loss: 0.70784497, Validation R2: 0.460305

Epoch 182/1000
Training Loss: 0.06225277, Training R2: 0.963571
Validation Loss: 0.70602947, Validation R2: 0.462798

Epoch 183/1000
Training Loss: 0.05885985, Training R2: 0.961723
Validation Loss: 0.71226716, Validation R2: 0.455674

Epoch 184/1000
Training Loss: 0.05758220, Training R2: 0.963038
Validation Loss: 0.70725536, Validation R2: 0.464797

Epoch 185/1000
Training Loss: 0.05266207, Training R2: 0.962113
Validation Loss: 0.70984703, Validation R2: 0.460896

Epoch 186/1000
Training Loss: 0.05646817, Training R2: 0.962770
Validation Loss: 0.70643568, Validation R2: 0.467997

Epoch 187/1000
Training Loss: 0.04852504, Training R2: 0.962797
Validation Loss: 0.71165115, Validation R2: 0.458572

Epoch 188/1000
Training Loss: 0.04910106, Training R2: 0.964092
Validation Loss: 0.71097916, Validation R2: 0.456268

Epoch 189/1000
Training Loss: 0.04875242, Training R2: 0.963654
Validation Loss: 0.71366334, Validation R2: 0.453973

Epoch 190/1000
Training Loss: 0.04880841, Training R2: 0.963998
Validation Loss: 0.71296751, Validation R2: 0.461900

Epoch 191/1000
Epoch 00191: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.04377156, Training R2: 0.963868
Validation Loss: 0.70974946, Validation R2: 0.462520

Epoch 192/1000
学习率已减少 3 次
Training Loss: 0.04081637, Training R2: 0.964300
Validation Loss: 0.70779645, Validation R2: 0.466056

Epoch 193/1000
Training Loss: 0.03750142, Training R2: 0.964755
Validation Loss: 0.70749289, Validation R2: 0.465678

Epoch 194/1000
Training Loss: 0.03871254, Training R2: 0.964610
Validation Loss: 0.70800084, Validation R2: 0.464848

Epoch 195/1000
Training Loss: 0.03563741, Training R2: 0.964670
Validation Loss: 0.70730537, Validation R2: 0.465146

Epoch 196/1000
Training Loss: 0.03238381, Training R2: 0.964717
Validation Loss: 0.70801342, Validation R2: 0.463440

Epoch 197/1000
Training Loss: 0.03513448, Training R2: 0.965127
Validation Loss: 0.70779645, Validation R2: 0.461082

Epoch 198/1000
Training Loss: 0.03341197, Training R2: 0.965187
Validation Loss: 0.70857358, Validation R2: 0.459994

Epoch 199/1000
Training Loss: 0.03166934, Training R2: 0.965391
Validation Loss: 0.70652747, Validation R2: 0.464747

Epoch 200/1000
Training Loss: 0.03442320, Training R2: 0.964401
Validation Loss: 0.70586038, Validation R2: 0.465635

Epoch 201/1000
Training Loss: 0.03119259, Training R2: 0.965595
Validation Loss: 0.70436382, Validation R2: 0.467727

Epoch 202/1000
Training Loss: 0.02930446, Training R2: 0.965275
Validation Loss: 0.70752156, Validation R2: 0.465846

Epoch 203/1000
Training Loss: 0.03018523, Training R2: 0.965506
Validation Loss: 0.70957118, Validation R2: 0.464369

Epoch 204/1000
Training Loss: 0.02770182, Training R2: 0.965595
Validation Loss: 0.70829993, Validation R2: 0.463644

Epoch 205/1000
Training Loss: 0.03533764, Training R2: 0.965913
Validation Loss: 0.70855415, Validation R2: 0.465282

Epoch 206/1000
Training Loss: 0.03467595, Training R2: 0.965626
Validation Loss: 0.70749497, Validation R2: 0.465544

Epoch 207/1000
Training Loss: 0.03521738, Training R2: 0.965374
Validation Loss: 0.70834529, Validation R2: 0.465726

Epoch 208/1000
Training Loss: 0.03538531, Training R2: 0.966201
Validation Loss: 0.70982373, Validation R2: 0.463204

Epoch 209/1000
Training Loss: 0.03308459, Training R2: 0.966479
Validation Loss: 0.70963985, Validation R2: 0.463663

Epoch 210/1000
Training Loss: 0.03465837, Training R2: 0.965287
Validation Loss: 0.70960891, Validation R2: 0.460843

Epoch 211/1000
Training Loss: 0.03571213, Training R2: 0.965813
Validation Loss: 0.70744926, Validation R2: 0.463385

Epoch 212/1000
Epoch 00212: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.03249224, Training R2: 0.965809
Validation Loss: 0.70947510, Validation R2: 0.462173

Epoch 213/1000
学习率已减少 4 次
Training Loss: 0.03175221, Training R2: 0.967101
Validation Loss: 0.70823193, Validation R2: 0.462671

Epoch 214/1000
Training Loss: 0.02842880, Training R2: 0.966720
Validation Loss: 0.70881832, Validation R2: 0.463189

Epoch 215/1000
Training Loss: 0.02592749, Training R2: 0.966948
Validation Loss: 0.70800209, Validation R2: 0.462609

Epoch 216/1000
Training Loss: 0.02652423, Training R2: 0.967177
Validation Loss: 0.70741332, Validation R2: 0.464159

Epoch 217/1000
Training Loss: 0.02493022, Training R2: 0.966753
Validation Loss: 0.70821303, Validation R2: 0.463296

Epoch 218/1000
Training Loss: 0.03005220, Training R2: 0.966647
Validation Loss: 0.70743507, Validation R2: 0.464421

Epoch 219/1000
Training Loss: 0.02703285, Training R2: 0.966614
Validation Loss: 0.70772868, Validation R2: 0.465641

Epoch 220/1000
Training Loss: 0.02349283, Training R2: 0.967025
Validation Loss: 0.70652723, Validation R2: 0.465806

Epoch 221/1000
Training Loss: 0.02288869, Training R2: 0.967126
Validation Loss: 0.70826828, Validation R2: 0.465477

Epoch 222/1000
Training Loss: 0.02255431, Training R2: 0.966827
Validation Loss: 0.70649564, Validation R2: 0.465325

Epoch 223/1000
Training Loss: 0.02128805, Training R2: 0.966961
Validation Loss: 0.70683819, Validation R2: 0.464983

Epoch 224/1000
Training Loss: 0.02028812, Training R2: 0.967192
Validation Loss: 0.70899594, Validation R2: 0.462624

Epoch 225/1000
Training Loss: 0.02120843, Training R2: 0.967407
Validation Loss: 0.70610160, Validation R2: 0.465437

Epoch 226/1000
Training Loss: 0.02221356, Training R2: 0.967004
Validation Loss: 0.70629197, Validation R2: 0.465391

Epoch 227/1000
Training Loss: 0.02446906, Training R2: 0.967374
Validation Loss: 0.70697302, Validation R2: 0.464951

Epoch 228/1000
Training Loss: 0.02468924, Training R2: 0.967475
Validation Loss: 0.70581096, Validation R2: 0.465648

Epoch 229/1000
Training Loss: 0.02218846, Training R2: 0.967396
Validation Loss: 0.70616972, Validation R2: 0.465978

Epoch 230/1000
Training Loss: 0.02104239, Training R2: 0.967610
Validation Loss: 0.70717978, Validation R2: 0.465766

Epoch 231/1000
Training Loss: 0.02123198, Training R2: 0.967462
Validation Loss: 0.70681840, Validation R2: 0.464947

Epoch 232/1000
Training Loss: 0.02153537, Training R2: 0.968005
Validation Loss: 0.70720243, Validation R2: 0.464897

Epoch 233/1000
Epoch 00233: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.02094278, Training R2: 0.967792
Validation Loss: 0.70680618, Validation R2: 0.465823

Epoch 234/1000
学习率已减少 5 次
Training Loss: 0.01967581, Training R2: 0.967881
Validation Loss: 0.70684630, Validation R2: 0.465571

Epoch 235/1000
Training Loss: 0.01807324, Training R2: 0.967946
Validation Loss: 0.70728207, Validation R2: 0.464423

Epoch 236/1000
Training Loss: 0.01837169, Training R2: 0.967950
Validation Loss: 0.70809966, Validation R2: 0.464331

Epoch 237/1000
Training Loss: 0.01811095, Training R2: 0.967957
Validation Loss: 0.70785064, Validation R2: 0.464870

Epoch 238/1000
Training Loss: 0.01768079, Training R2: 0.967912
Validation Loss: 0.70659620, Validation R2: 0.465162

Epoch 239/1000
Training Loss: 0.01694738, Training R2: 0.968201
Validation Loss: 0.70806789, Validation R2: 0.464434

Epoch 240/1000
Training Loss: 0.01752219, Training R2: 0.968303
Validation Loss: 0.70695204, Validation R2: 0.464699

Epoch 241/1000
Training Loss: 0.01716206, Training R2: 0.968244
Validation Loss: 0.70853347, Validation R2: 0.464360

Epoch 242/1000
Training Loss: 0.01766357, Training R2: 0.967975
Validation Loss: 0.70851392, Validation R2: 0.464276

Epoch 243/1000
Training Loss: 0.01591137, Training R2: 0.968302
Validation Loss: 0.70681655, Validation R2: 0.465100

Epoch 244/1000
Training Loss: 0.01583393, Training R2: 0.968193
Validation Loss: 0.70625281, Validation R2: 0.465595

Epoch 245/1000
Training Loss: 0.01620329, Training R2: 0.968226
Validation Loss: 0.70697111, Validation R2: 0.465617

Epoch 246/1000
Training Loss: 0.01600835, Training R2: 0.968143
Validation Loss: 0.70602995, Validation R2: 0.464981

Epoch 247/1000
Training Loss: 0.01667968, Training R2: 0.968393
Validation Loss: 0.70667768, Validation R2: 0.464970

Epoch 248/1000
Training Loss: 0.01673743, Training R2: 0.968120
Validation Loss: 0.70692581, Validation R2: 0.464795

Epoch 249/1000
Training Loss: 0.01619250, Training R2: 0.968232
Validation Loss: 0.70706534, Validation R2: 0.465347

Epoch 250/1000
Training Loss: 0.01548002, Training R2: 0.968307
Validation Loss: 0.70618790, Validation R2: 0.465378

Epoch 251/1000
Training Loss: 0.01577472, Training R2: 0.968426
Validation Loss: 0.70548791, Validation R2: 0.466325

Epoch 252/1000
Training Loss: 0.01664369, Training R2: 0.968281
Validation Loss: 0.70703030, Validation R2: 0.465661

Epoch 253/1000
Training Loss: 0.01557908, Training R2: 0.968446
Validation Loss: 0.70745593, Validation R2: 0.465365

Epoch 254/1000
Epoch 00254: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.01629663, Training R2: 0.968509
Validation Loss: 0.70721161, Validation R2: 0.465133

Epoch 255/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_dipole.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_dipole.png
