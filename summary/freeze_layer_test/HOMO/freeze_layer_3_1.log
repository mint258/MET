Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4275843

Epoch 1/1000
Training Loss: 0.95277504, Training R2: -1037.876465
Validation Loss: 0.44722068, Validation R2: -145.686401
Saved best model with validation R2 -145.686401 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.41277327, Training R2: -177.453476
Validation Loss: 0.20253737, Validation R2: -30.688673
Saved best model with validation R2 -30.688673 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.14341089, Training R2: -24.495945
Validation Loss: 0.10016374, Validation R2: -7.638227
Saved best model with validation R2 -7.638227 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.12601771, Training R2: -17.108368
Validation Loss: 0.04997117, Validation R2: -1.600384
Saved best model with validation R2 -1.600384 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.06983917, Training R2: -5.346766
Validation Loss: 0.07469519, Validation R2: -3.962620

Epoch 6/1000
Training Loss: 0.05531173, Training R2: -3.227211
Validation Loss: 0.03512127, Validation R2: -0.496628
Saved best model with validation R2 -0.496628 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.04045718, Training R2: -1.390503
Validation Loss: 0.05330252, Validation R2: -1.831290

Epoch 8/1000
Training Loss: 0.04506111, Training R2: -1.859338
Validation Loss: 0.04454995, Validation R2: -1.086514

Epoch 9/1000
Training Loss: 0.04030784, Training R2: -1.358536
Validation Loss: 0.05112092, Validation R2: -1.491311

Epoch 10/1000
Training Loss: 0.03717221, Training R2: -1.032744
Validation Loss: 0.04570621, Validation R2: -1.076032

Epoch 11/1000
Training Loss: 0.03722962, Training R2: -0.915540
Validation Loss: 0.02697507, Validation R2: -0.036878
Saved best model with validation R2 -0.036878 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.02657389, Training R2: -0.178280
Validation Loss: 0.02610363, Validation R2: -0.005491
Saved best model with validation R2 -0.005491 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.02507090, Training R2: -0.087746
Validation Loss: 0.02614142, Validation R2: 0.016031
Saved best model with validation R2 0.016031 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.02430622, Training R2: -0.009346
Validation Loss: 0.02879169, Validation R2: -0.083749

Epoch 15/1000
Training Loss: 0.02377088, Training R2: 0.039360
Validation Loss: 0.04115313, Validation R2: -0.743311

Epoch 16/1000
Training Loss: 0.03226056, Training R2: -0.509313
Validation Loss: 0.03809882, Validation R2: -0.552147

Epoch 17/1000
Training Loss: 0.03090957, Training R2: -0.465402
Validation Loss: 0.03840651, Validation R2: -0.574811

Epoch 18/1000
Training Loss: 0.03395372, Training R2: -0.598341
Validation Loss: 0.02771716, Validation R2: -0.050210

Epoch 19/1000
Training Loss: 0.02528595, Training R2: -0.029753
Validation Loss: 0.02763946, Validation R2: -0.027861

Epoch 20/1000
Training Loss: 0.02243969, Training R2: 0.150084
Validation Loss: 0.02463580, Validation R2: 0.080698
Saved best model with validation R2 0.080698 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.02229127, Training R2: 0.155986
Validation Loss: 0.02888945, Validation R2: -0.089974

Epoch 22/1000
Training Loss: 0.02247935, Training R2: 0.157140
Validation Loss: 0.02549100, Validation R2: 0.063631

Epoch 23/1000
Training Loss: 0.02025133, Training R2: 0.262344
Validation Loss: 0.02922790, Validation R2: -0.113046

Epoch 24/1000
Training Loss: 0.02210653, Training R2: 0.177506
Validation Loss: 0.03305415, Validation R2: -0.329344

Epoch 25/1000
Training Loss: 0.02478585, Training R2: 0.024192
Validation Loss: 0.02507728, Validation R2: 0.101572
Saved best model with validation R2 0.101572 to best_finetuned_model.pth

Epoch 26/1000
Training Loss: 0.03369399, Training R2: -0.651425
Validation Loss: 0.05187247, Validation R2: -1.642425

Epoch 27/1000
Training Loss: 0.03909750, Training R2: -0.997979
Validation Loss: 0.02671292, Validation R2: 0.026462

Epoch 28/1000
Training Loss: 0.02895943, Training R2: -0.213762
Validation Loss: 0.03662445, Validation R2: -0.526834

Epoch 29/1000
Training Loss: 0.03659687, Training R2: -0.764589
Validation Loss: 0.02873175, Validation R2: -0.064565

Epoch 30/1000
Training Loss: 0.03358148, Training R2: -0.553809
Validation Loss: 0.03184875, Validation R2: -0.222421

Epoch 31/1000
Training Loss: 0.03364658, Training R2: -0.513113
Validation Loss: 0.04128022, Validation R2: -0.819617

Epoch 32/1000
Training Loss: 0.03359529, Training R2: -0.545003
Validation Loss: 0.02696626, Validation R2: 0.024457

Epoch 33/1000
Training Loss: 0.02767339, Training R2: -0.146848
Validation Loss: 0.02784902, Validation R2: -0.029065

Epoch 34/1000
Training Loss: 0.03520366, Training R2: -0.679815
Validation Loss: 0.03165789, Validation R2: -0.217162

Epoch 35/1000
Training Loss: 0.03586839, Training R2: -0.724405
Validation Loss: 0.03155531, Validation R2: -0.231896

Epoch 36/1000
Training Loss: 0.03054167, Training R2: -0.284558
Validation Loss: 0.02759811, Validation R2: -0.034892

Epoch 37/1000
Training Loss: 0.02931877, Training R2: -0.220955
Validation Loss: 0.03535896, Validation R2: -0.450802

Epoch 38/1000
Training Loss: 0.03244728, Training R2: -0.391281
Validation Loss: 0.03251770, Validation R2: -0.295915

Epoch 39/1000
Training Loss: 0.03064267, Training R2: -0.265661
Validation Loss: 0.02414482, Validation R2: 0.125796
Saved best model with validation R2 0.125796 to best_finetuned_model.pth

Epoch 40/1000
Training Loss: 0.02509617, Training R2: 0.067676
Validation Loss: 0.02630438, Validation R2: 0.038738

Epoch 41/1000
Training Loss: 0.03102484, Training R2: -0.307026
Validation Loss: 0.02909060, Validation R2: -0.146720

Epoch 42/1000
Training Loss: 0.03488528, Training R2: -0.605287
Validation Loss: 0.03245416, Validation R2: -0.318687

Epoch 43/1000
Training Loss: 0.03155854, Training R2: -0.336037
Validation Loss: 0.03925183, Validation R2: -0.711802

Epoch 44/1000
Training Loss: 0.03131080, Training R2: -0.318842
Validation Loss: 0.03027090, Validation R2: -0.160048

Epoch 45/1000
Training Loss: 0.02328069, Training R2: 0.222421
Validation Loss: 0.02645207, Validation R2: 0.089057

Epoch 46/1000
Training Loss: 0.02172655, Training R2: 0.309995
Validation Loss: 0.02613527, Validation R2: 0.177672
Saved best model with validation R2 0.177672 to best_finetuned_model.pth

Epoch 47/1000
Training Loss: 0.02067164, Training R2: 0.377253
Validation Loss: 0.03198257, Validation R2: -0.078342

Epoch 48/1000
Training Loss: 0.02108393, Training R2: 0.328117
Validation Loss: 0.02250434, Validation R2: 0.290546
Saved best model with validation R2 0.290546 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.01850779, Training R2: 0.458125
Validation Loss: 0.02522966, Validation R2: 0.110370

Epoch 50/1000
Training Loss: 0.01919670, Training R2: 0.434311
Validation Loss: 0.02185009, Validation R2: 0.335578
Saved best model with validation R2 0.335578 to best_finetuned_model.pth

Epoch 51/1000
Training Loss: 0.01684220, Training R2: 0.550420
Validation Loss: 0.02350206, Validation R2: 0.301211

Epoch 52/1000
Training Loss: 0.01471771, Training R2: 0.625077
Validation Loss: 0.02190839, Validation R2: 0.351171
Saved best model with validation R2 0.351171 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.01636913, Training R2: 0.579856
Validation Loss: 0.02059003, Validation R2: 0.378175
Saved best model with validation R2 0.378175 to best_finetuned_model.pth

Epoch 54/1000
Training Loss: 0.01343082, Training R2: 0.690933
Validation Loss: 0.02402931, Validation R2: 0.191591

Epoch 55/1000
Training Loss: 0.02064453, Training R2: 0.348270
Validation Loss: 0.02324925, Validation R2: 0.334460

Epoch 56/1000
Training Loss: 0.01494288, Training R2: 0.640190
Validation Loss: 0.02011917, Validation R2: 0.344867

Epoch 57/1000
Training Loss: 0.01386509, Training R2: 0.672207
Validation Loss: 0.02160876, Validation R2: 0.357743

Epoch 58/1000
Training Loss: 0.01818512, Training R2: 0.518009
Validation Loss: 0.02319796, Validation R2: 0.224490

Epoch 59/1000
Training Loss: 0.02060074, Training R2: 0.368744
Validation Loss: 0.03520336, Validation R2: -0.206521

Epoch 60/1000
Training Loss: 0.02864819, Training R2: -0.065540
Validation Loss: 0.05496720, Validation R2: -1.520992

Epoch 61/1000
Training Loss: 0.04399246, Training R2: -1.122082
Validation Loss: 0.03705619, Validation R2: -0.305807

Epoch 62/1000
Training Loss: 0.03232477, Training R2: -0.252213
Validation Loss: 0.04109005, Validation R2: -0.534527

Epoch 63/1000
Training Loss: 0.03657646, Training R2: -0.579871
Validation Loss: 0.03830380, Validation R2: -0.364415

Epoch 64/1000
Training Loss: 0.02993744, Training R2: -0.114743
Validation Loss: 0.03658960, Validation R2: -0.276481

Epoch 65/1000
Training Loss: 0.02800723, Training R2: -0.063827
Validation Loss: 0.06255479, Validation R2: -2.181848

Epoch 66/1000
Training Loss: 0.04422034, Training R2: -1.518111
Validation Loss: 0.02256402, Validation R2: 0.257808

Epoch 67/1000
Training Loss: 0.04162730, Training R2: -1.174098
Validation Loss: 0.05546388, Validation R2: -1.726161

Epoch 68/1000
Training Loss: 0.04801020, Training R2: -1.622954
Validation Loss: 0.02396266, Validation R2: 0.313193

Epoch 69/1000
Training Loss: 0.05824178, Training R2: -3.355572
Validation Loss: 0.07335965, Validation R2: -3.229653

Epoch 70/1000
Training Loss: 0.07888188, Training R2: -5.613365
Validation Loss: 0.05330328, Validation R2: -1.551978

Epoch 71/1000
Training Loss: 0.04713957, Training R2: -1.780513
Validation Loss: 0.03061734, Validation R2: 0.028540

Epoch 72/1000
Training Loss: 0.06296160, Training R2: -3.853964
Validation Loss: 0.04624452, Validation R2: -0.876184

Epoch 73/1000
Training Loss: 0.05120918, Training R2: -2.029114
Validation Loss: 0.06312559, Validation R2: -2.392089

Epoch 74/1000
Epoch 00074: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.05039255, Training R2: -2.133275
Validation Loss: 0.04319234, Validation R2: -0.678721

Epoch 75/1000
学习率已减少 1 次
Training Loss: 0.02997774, Training R2: -0.247491
Validation Loss: 0.02127472, Validation R2: 0.346553

Epoch 76/1000
Training Loss: 0.02718401, Training R2: -0.005823
Validation Loss: 0.02255724, Validation R2: 0.279253

Epoch 77/1000
Training Loss: 0.02273711, Training R2: 0.225489
Validation Loss: 0.03647226, Validation R2: -0.250993

Epoch 78/1000
Training Loss: 0.02368737, Training R2: 0.228474
Validation Loss: 0.01894889, Validation R2: 0.445192
Saved best model with validation R2 0.445192 to best_finetuned_model.pth

Epoch 79/1000
Training Loss: 0.01674867, Training R2: 0.601294
Validation Loss: 0.02071897, Validation R2: 0.375117

Epoch 80/1000
Training Loss: 0.01527087, Training R2: 0.643299
Validation Loss: 0.02023366, Validation R2: 0.409392

Epoch 81/1000
Training Loss: 0.01484645, Training R2: 0.657339
Validation Loss: 0.01754602, Validation R2: 0.511736
Saved best model with validation R2 0.511736 to best_finetuned_model.pth

Epoch 82/1000
Training Loss: 0.01256899, Training R2: 0.735595
Validation Loss: 0.01818166, Validation R2: 0.489980

Epoch 83/1000
Training Loss: 0.01279613, Training R2: 0.717945
Validation Loss: 0.01891328, Validation R2: 0.461325

Epoch 84/1000
Training Loss: 0.01264930, Training R2: 0.730920
Validation Loss: 0.01828837, Validation R2: 0.471220

Epoch 85/1000
Training Loss: 0.01179025, Training R2: 0.766217
Validation Loss: 0.01952105, Validation R2: 0.458075

Epoch 86/1000
Training Loss: 0.01095683, Training R2: 0.790216
Validation Loss: 0.02086574, Validation R2: 0.430804

Epoch 87/1000
Training Loss: 0.01187500, Training R2: 0.772687
Validation Loss: 0.01836074, Validation R2: 0.485573

Epoch 88/1000
Training Loss: 0.01009311, Training R2: 0.819731
Validation Loss: 0.01771035, Validation R2: 0.490220

Epoch 89/1000
Training Loss: 0.00980935, Training R2: 0.826140
Validation Loss: 0.02004988, Validation R2: 0.411009

Epoch 90/1000
Training Loss: 0.01135728, Training R2: 0.771433
Validation Loss: 0.01901406, Validation R2: 0.439331

Epoch 91/1000
Training Loss: 0.01235162, Training R2: 0.764577
Validation Loss: 0.01817700, Validation R2: 0.463041

Epoch 92/1000
Training Loss: 0.01131669, Training R2: 0.805528
Validation Loss: 0.01716923, Validation R2: 0.509242

Epoch 93/1000
Training Loss: 0.01349040, Training R2: 0.730198
Validation Loss: 0.02105266, Validation R2: 0.373403

Epoch 94/1000
Training Loss: 0.01784085, Training R2: 0.595735
Validation Loss: 0.01841581, Validation R2: 0.457472

Epoch 95/1000
Training Loss: 0.01141824, Training R2: 0.801477
Validation Loss: 0.01724030, Validation R2: 0.508587

Epoch 96/1000
Training Loss: 0.01049819, Training R2: 0.822108
Validation Loss: 0.01747118, Validation R2: 0.509952

Epoch 97/1000
Training Loss: 0.01006073, Training R2: 0.834426
Validation Loss: 0.02131404, Validation R2: 0.424415

Epoch 98/1000
Training Loss: 0.01287923, Training R2: 0.762109
Validation Loss: 0.03415206, Validation R2: -0.103387

Epoch 99/1000
Training Loss: 0.02352098, Training R2: 0.279862
Validation Loss: 0.03098823, Validation R2: -0.053700

Epoch 100/1000
Training Loss: 0.01922900, Training R2: 0.490766
Validation Loss: 0.02821699, Validation R2: 0.052018

Epoch 101/1000
Training Loss: 0.02072288, Training R2: 0.451991
Validation Loss: 0.01836708, Validation R2: 0.500519

Epoch 102/1000
Epoch 00102: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01813434, Training R2: 0.553783
Validation Loss: 0.02654817, Validation R2: 0.247826

Epoch 103/1000
学习率已减少 2 次
Training Loss: 0.01536500, Training R2: 0.669203
Validation Loss: 0.01830040, Validation R2: 0.489528

Epoch 104/1000
Training Loss: 0.01375783, Training R2: 0.732596
Validation Loss: 0.01973105, Validation R2: 0.423051

Epoch 105/1000
Training Loss: 0.01507473, Training R2: 0.679249
Validation Loss: 0.02285797, Validation R2: 0.387993

Epoch 106/1000
Training Loss: 0.01204861, Training R2: 0.790192
Validation Loss: 0.01820878, Validation R2: 0.487899

Epoch 107/1000
Training Loss: 0.01137879, Training R2: 0.813237
Validation Loss: 0.01904632, Validation R2: 0.447652

Epoch 108/1000
Training Loss: 0.01047986, Training R2: 0.827656
Validation Loss: 0.01904971, Validation R2: 0.498311

Epoch 109/1000
Training Loss: 0.00955081, Training R2: 0.852303
Validation Loss: 0.01701772, Validation R2: 0.535083
Saved best model with validation R2 0.535083 to best_finetuned_model.pth

Epoch 110/1000
Training Loss: 0.00716205, Training R2: 0.904707
Validation Loss: 0.01762424, Validation R2: 0.532389

Epoch 111/1000
Training Loss: 0.00707600, Training R2: 0.909709
Validation Loss: 0.01674612, Validation R2: 0.536547
Saved best model with validation R2 0.536547 to best_finetuned_model.pth

Epoch 112/1000
Training Loss: 0.00665055, Training R2: 0.916096
Validation Loss: 0.01680514, Validation R2: 0.544099
Saved best model with validation R2 0.544099 to best_finetuned_model.pth

Epoch 113/1000
Training Loss: 0.00675917, Training R2: 0.916219
Validation Loss: 0.01790002, Validation R2: 0.519985

Epoch 114/1000
Training Loss: 0.00768361, Training R2: 0.902721
Validation Loss: 0.01927118, Validation R2: 0.490790

Epoch 115/1000
Training Loss: 0.00965929, Training R2: 0.867385
Validation Loss: 0.01848472, Validation R2: 0.511955

Epoch 116/1000
Training Loss: 0.00866534, Training R2: 0.880939
Validation Loss: 0.01652855, Validation R2: 0.544578
Saved best model with validation R2 0.544578 to best_finetuned_model.pth

Epoch 117/1000
Training Loss: 0.00774628, Training R2: 0.902174
Validation Loss: 0.01759886, Validation R2: 0.493925

Epoch 118/1000
Training Loss: 0.00897432, Training R2: 0.878964
Validation Loss: 0.01786828, Validation R2: 0.479311

Epoch 119/1000
Training Loss: 0.00748073, Training R2: 0.907346
Validation Loss: 0.01726928, Validation R2: 0.512750

Epoch 120/1000
Training Loss: 0.00719777, Training R2: 0.909510
Validation Loss: 0.01706598, Validation R2: 0.535457

Epoch 121/1000
Training Loss: 0.00608547, Training R2: 0.931408
Validation Loss: 0.01763500, Validation R2: 0.511197

Epoch 122/1000
Training Loss: 0.00632390, Training R2: 0.928064
Validation Loss: 0.01690695, Validation R2: 0.538803

Epoch 123/1000
Training Loss: 0.00608014, Training R2: 0.930020
Validation Loss: 0.01644783, Validation R2: 0.543027

Epoch 124/1000
Training Loss: 0.00589760, Training R2: 0.935896
Validation Loss: 0.01679683, Validation R2: 0.523877

Epoch 125/1000
Training Loss: 0.00615187, Training R2: 0.931423
Validation Loss: 0.01630362, Validation R2: 0.541971

Epoch 126/1000
Training Loss: 0.00504515, Training R2: 0.946960
Validation Loss: 0.01661097, Validation R2: 0.544649
Saved best model with validation R2 0.544649 to best_finetuned_model.pth

Epoch 127/1000
Training Loss: 0.00498309, Training R2: 0.948372
Validation Loss: 0.01703174, Validation R2: 0.510870

Epoch 128/1000
Training Loss: 0.00625062, Training R2: 0.933783
Validation Loss: 0.01673786, Validation R2: 0.526569

Epoch 129/1000
Training Loss: 0.00536118, Training R2: 0.945430
Validation Loss: 0.01841130, Validation R2: 0.503815

Epoch 130/1000
Training Loss: 0.00703586, Training R2: 0.922277
Validation Loss: 0.01784556, Validation R2: 0.521647

Epoch 131/1000
Training Loss: 0.00603596, Training R2: 0.936399
Validation Loss: 0.01662719, Validation R2: 0.538453

Epoch 132/1000
Training Loss: 0.00433369, Training R2: 0.956655
Validation Loss: 0.01688593, Validation R2: 0.547810
Saved best model with validation R2 0.547810 to best_finetuned_model.pth

Epoch 133/1000
Training Loss: 0.00488613, Training R2: 0.952028
Validation Loss: 0.01705964, Validation R2: 0.520589

Epoch 134/1000
Training Loss: 0.00570520, Training R2: 0.944732
Validation Loss: 0.01656012, Validation R2: 0.547432

Epoch 135/1000
Training Loss: 0.00449265, Training R2: 0.957893
Validation Loss: 0.01659843, Validation R2: 0.550409
Saved best model with validation R2 0.550409 to best_finetuned_model.pth

Epoch 136/1000
Training Loss: 0.00373287, Training R2: 0.965898
Validation Loss: 0.01638965, Validation R2: 0.547872

Epoch 137/1000
Training Loss: 0.00451896, Training R2: 0.959839
Validation Loss: 0.01649349, Validation R2: 0.543729

Epoch 138/1000
Training Loss: 0.00441884, Training R2: 0.958562
Validation Loss: 0.01660703, Validation R2: 0.540559

Epoch 139/1000
Training Loss: 0.00406932, Training R2: 0.962463
Validation Loss: 0.01684294, Validation R2: 0.538307

Epoch 140/1000
Training Loss: 0.00398017, Training R2: 0.966179
Validation Loss: 0.01682491, Validation R2: 0.537224

Epoch 141/1000
Training Loss: 0.00435311, Training R2: 0.960164
Validation Loss: 0.02043604, Validation R2: 0.458017

Epoch 142/1000
Training Loss: 0.01040819, Training R2: 0.859374
Validation Loss: 0.01803201, Validation R2: 0.506692

Epoch 143/1000
Training Loss: 0.00729773, Training R2: 0.913899
Validation Loss: 0.01801769, Validation R2: 0.491306

Epoch 144/1000
Training Loss: 0.01067787, Training R2: 0.860965
Validation Loss: 0.01834317, Validation R2: 0.489765

Epoch 145/1000
Training Loss: 0.00647677, Training R2: 0.930860
Validation Loss: 0.01753092, Validation R2: 0.519595

Epoch 146/1000
Training Loss: 0.00490686, Training R2: 0.955457
Validation Loss: 0.01784519, Validation R2: 0.517639

Epoch 147/1000
Training Loss: 0.00473741, Training R2: 0.957101
Validation Loss: 0.01679004, Validation R2: 0.544789

Epoch 148/1000
Training Loss: 0.00391918, Training R2: 0.967790
Validation Loss: 0.01690954, Validation R2: 0.532197

Epoch 149/1000
Training Loss: 0.00497497, Training R2: 0.954093
Validation Loss: 0.01751071, Validation R2: 0.531133

Epoch 150/1000
Training Loss: 0.00466697, Training R2: 0.958654
Validation Loss: 0.01654918, Validation R2: 0.549929

Epoch 151/1000
Training Loss: 0.00460786, Training R2: 0.959351
Validation Loss: 0.01657930, Validation R2: 0.545612

Epoch 152/1000
Training Loss: 0.00465849, Training R2: 0.958329
Validation Loss: 0.01639621, Validation R2: 0.548163

Epoch 153/1000
Training Loss: 0.00410722, Training R2: 0.965083
Validation Loss: 0.01638716, Validation R2: 0.553981
Saved best model with validation R2 0.553981 to best_finetuned_model.pth

Epoch 154/1000
Training Loss: 0.00454848, Training R2: 0.961547
Validation Loss: 0.01716712, Validation R2: 0.525416

Epoch 155/1000
Training Loss: 0.00526260, Training R2: 0.954376
Validation Loss: 0.01727414, Validation R2: 0.535840

Epoch 156/1000
Training Loss: 0.00461171, Training R2: 0.959557
Validation Loss: 0.01661959, Validation R2: 0.548132

Epoch 157/1000
Training Loss: 0.00493942, Training R2: 0.955332
Validation Loss: 0.01689729, Validation R2: 0.530366

Epoch 158/1000
Training Loss: 0.00537120, Training R2: 0.950827
Validation Loss: 0.01655035, Validation R2: 0.555026
Saved best model with validation R2 0.555026 to best_finetuned_model.pth

Epoch 159/1000
Training Loss: 0.00510855, Training R2: 0.952742
Validation Loss: 0.01800176, Validation R2: 0.520414

Epoch 160/1000
Training Loss: 0.00612993, Training R2: 0.942280
Validation Loss: 0.02076879, Validation R2: 0.440165

Epoch 161/1000
Training Loss: 0.01029626, Training R2: 0.859897
Validation Loss: 0.01760393, Validation R2: 0.518893

Epoch 162/1000
Training Loss: 0.00624022, Training R2: 0.942917
Validation Loss: 0.01837097, Validation R2: 0.501755

Epoch 163/1000
Training Loss: 0.00537571, Training R2: 0.948346
Validation Loss: 0.01717510, Validation R2: 0.524073

Epoch 164/1000
Training Loss: 0.00437859, Training R2: 0.962119
Validation Loss: 0.01752795, Validation R2: 0.496861

Epoch 165/1000
Training Loss: 0.00543712, Training R2: 0.951269
Validation Loss: 0.01723365, Validation R2: 0.530773

Epoch 166/1000
Training Loss: 0.00390988, Training R2: 0.970193
Validation Loss: 0.01713014, Validation R2: 0.525452

Epoch 167/1000
Training Loss: 0.00319764, Training R2: 0.977036
Validation Loss: 0.01701599, Validation R2: 0.534228

Epoch 168/1000
Training Loss: 0.00510435, Training R2: 0.956178
Validation Loss: 0.01768571, Validation R2: 0.531282

Epoch 169/1000
Training Loss: 0.00435733, Training R2: 0.967249
Validation Loss: 0.01718296, Validation R2: 0.530138

Epoch 170/1000
Training Loss: 0.00474624, Training R2: 0.960273
Validation Loss: 0.01714779, Validation R2: 0.541275

Epoch 171/1000
Training Loss: 0.00478838, Training R2: 0.961302
Validation Loss: 0.01707598, Validation R2: 0.536673

Epoch 172/1000
Training Loss: 0.00455258, Training R2: 0.963014
Validation Loss: 0.01831886, Validation R2: 0.507907

Epoch 173/1000
Training Loss: 0.00450246, Training R2: 0.964028
Validation Loss: 0.01723134, Validation R2: 0.521946

Epoch 174/1000
Training Loss: 0.00387954, Training R2: 0.970653
Validation Loss: 0.01655347, Validation R2: 0.549094

Epoch 175/1000
Training Loss: 0.00271908, Training R2: 0.981268
Validation Loss: 0.01707585, Validation R2: 0.537466

Epoch 176/1000
Training Loss: 0.00327693, Training R2: 0.976963
Validation Loss: 0.01714330, Validation R2: 0.537033

Epoch 177/1000
Training Loss: 0.00405271, Training R2: 0.972720
Validation Loss: 0.01785464, Validation R2: 0.523503

Epoch 178/1000
Training Loss: 0.00391627, Training R2: 0.972402
Validation Loss: 0.01655014, Validation R2: 0.544951

Epoch 179/1000
Epoch 00179: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00460084, Training R2: 0.965201
Validation Loss: 0.01904884, Validation R2: 0.494827

Epoch 180/1000
学习率已减少 3 次
Training Loss: 0.00692359, Training R2: 0.938209
Validation Loss: 0.01649086, Validation R2: 0.547230

Epoch 181/1000
Training Loss: 0.00721501, Training R2: 0.928965
Validation Loss: 0.01824917, Validation R2: 0.469449

Epoch 182/1000
Training Loss: 0.01050743, Training R2: 0.870491
Validation Loss: 0.02020681, Validation R2: 0.462475

Epoch 183/1000
Training Loss: 0.00771924, Training R2: 0.924653
Validation Loss: 0.01653695, Validation R2: 0.538244

Epoch 184/1000
Training Loss: 0.00780011, Training R2: 0.917688
Validation Loss: 0.01757739, Validation R2: 0.493622

Epoch 185/1000
Training Loss: 0.00823092, Training R2: 0.910975
Validation Loss: 0.02136709, Validation R2: 0.432674

Epoch 186/1000
Training Loss: 0.00810909, Training R2: 0.915713
Validation Loss: 0.01723624, Validation R2: 0.504293

Epoch 187/1000
Training Loss: 0.00758657, Training R2: 0.922783
Validation Loss: 0.01778988, Validation R2: 0.484524

Epoch 188/1000
Training Loss: 0.00735028, Training R2: 0.925828
Validation Loss: 0.02092656, Validation R2: 0.437269

Epoch 189/1000
Training Loss: 0.00847303, Training R2: 0.908220
Validation Loss: 0.01742075, Validation R2: 0.520896

Epoch 190/1000
Training Loss: 0.00757570, Training R2: 0.922451
Validation Loss: 0.01702920, Validation R2: 0.533776

Epoch 191/1000
Training Loss: 0.00447830, Training R2: 0.967006
Validation Loss: 0.01720918, Validation R2: 0.520981

Epoch 192/1000
Training Loss: 0.00445978, Training R2: 0.967685
Validation Loss: 0.01702940, Validation R2: 0.530181

Epoch 193/1000
Training Loss: 0.00357001, Training R2: 0.976030
Validation Loss: 0.01663911, Validation R2: 0.552692

Epoch 194/1000
Training Loss: 0.00370693, Training R2: 0.974256
Validation Loss: 0.01674682, Validation R2: 0.547892

Epoch 195/1000
Training Loss: 0.00349822, Training R2: 0.976226
Validation Loss: 0.01724814, Validation R2: 0.531556

Epoch 196/1000
Training Loss: 0.00429901, Training R2: 0.970522
Validation Loss: 0.01697049, Validation R2: 0.538934

Epoch 197/1000
Training Loss: 0.00454267, Training R2: 0.967858
Validation Loss: 0.01793415, Validation R2: 0.517844

Epoch 198/1000
Training Loss: 0.00482677, Training R2: 0.965066
Validation Loss: 0.01707320, Validation R2: 0.537885

Epoch 199/1000
Training Loss: 0.00376028, Training R2: 0.974856
Validation Loss: 0.01706141, Validation R2: 0.532573

Epoch 200/1000
Epoch 00200: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00306293, Training R2: 0.981621
Validation Loss: 0.01676876, Validation R2: 0.542425

Epoch 201/1000
学习率已减少 4 次
Training Loss: 0.00239515, Training R2: 0.985693
Validation Loss: 0.01655558, Validation R2: 0.547220

Epoch 202/1000
Training Loss: 0.00202925, Training R2: 0.987955
Validation Loss: 0.01643167, Validation R2: 0.552462

Epoch 203/1000
Training Loss: 0.00196096, Training R2: 0.988330
Validation Loss: 0.01661142, Validation R2: 0.545546

Epoch 204/1000
Training Loss: 0.00206319, Training R2: 0.988028
Validation Loss: 0.01648047, Validation R2: 0.548780

Epoch 205/1000
Training Loss: 0.00181329, Training R2: 0.988998
Validation Loss: 0.01647379, Validation R2: 0.548147

Epoch 206/1000
Training Loss: 0.00182507, Training R2: 0.989089
Validation Loss: 0.01646185, Validation R2: 0.549940

Epoch 207/1000
Training Loss: 0.00187042, Training R2: 0.989008
Validation Loss: 0.01649433, Validation R2: 0.549811

Epoch 208/1000
Training Loss: 0.00208287, Training R2: 0.988388
Validation Loss: 0.01654968, Validation R2: 0.543261

Epoch 209/1000
Training Loss: 0.00254377, Training R2: 0.985956
Validation Loss: 0.01651018, Validation R2: 0.546646

Epoch 210/1000
Training Loss: 0.00203971, Training R2: 0.988397
Validation Loss: 0.01655031, Validation R2: 0.548552

Epoch 211/1000
Training Loss: 0.00166394, Training R2: 0.990204
Validation Loss: 0.01659630, Validation R2: 0.546312

Epoch 212/1000
Training Loss: 0.00155981, Training R2: 0.990155
Validation Loss: 0.01653413, Validation R2: 0.550711

Epoch 213/1000
Training Loss: 0.00146861, Training R2: 0.990605
Validation Loss: 0.01659687, Validation R2: 0.546532

Epoch 214/1000
Training Loss: 0.00144124, Training R2: 0.990731
Validation Loss: 0.01655562, Validation R2: 0.546225

Epoch 215/1000
Training Loss: 0.00142927, Training R2: 0.990842
Validation Loss: 0.01663979, Validation R2: 0.543811

Epoch 216/1000
Training Loss: 0.00136330, Training R2: 0.991123
Validation Loss: 0.01657148, Validation R2: 0.547761

Epoch 217/1000
Training Loss: 0.00140854, Training R2: 0.990572
Validation Loss: 0.01651799, Validation R2: 0.548184

Epoch 218/1000
Training Loss: 0.00160827, Training R2: 0.990435
Validation Loss: 0.01670336, Validation R2: 0.546187

Epoch 219/1000
Training Loss: 0.00234302, Training R2: 0.987414
Validation Loss: 0.01691343, Validation R2: 0.541560

Epoch 220/1000
Training Loss: 0.00279107, Training R2: 0.985093
Validation Loss: 0.01680760, Validation R2: 0.542231

Epoch 221/1000
Epoch 00221: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00198263, Training R2: 0.989593
Validation Loss: 0.01691542, Validation R2: 0.537873

Epoch 222/1000
学习率已减少 5 次
Training Loss: 0.00199984, Training R2: 0.989606
Validation Loss: 0.01666162, Validation R2: 0.544451

Epoch 223/1000
Training Loss: 0.00159638, Training R2: 0.990851
Validation Loss: 0.01660283, Validation R2: 0.544480

Epoch 224/1000
Training Loss: 0.00170331, Training R2: 0.990221
Validation Loss: 0.01657633, Validation R2: 0.546577

Epoch 225/1000
Training Loss: 0.00153193, Training R2: 0.991081
Validation Loss: 0.01670389, Validation R2: 0.545299

Epoch 226/1000
Training Loss: 0.00144914, Training R2: 0.991493
Validation Loss: 0.01659120, Validation R2: 0.549541

Epoch 227/1000
Training Loss: 0.00126545, Training R2: 0.991707
Validation Loss: 0.01660311, Validation R2: 0.546595

Epoch 228/1000
Training Loss: 0.00119321, Training R2: 0.991876
Validation Loss: 0.01651226, Validation R2: 0.549405

Epoch 229/1000
Training Loss: 0.00112878, Training R2: 0.992387
Validation Loss: 0.01652138, Validation R2: 0.551273

Epoch 230/1000
Training Loss: 0.00113672, Training R2: 0.992229
Validation Loss: 0.01659279, Validation R2: 0.547149

Epoch 231/1000
Training Loss: 0.00112526, Training R2: 0.992448
Validation Loss: 0.01655136, Validation R2: 0.548983

Epoch 232/1000
Training Loss: 0.00120041, Training R2: 0.992401
Validation Loss: 0.01658227, Validation R2: 0.547821

Epoch 233/1000
Training Loss: 0.00133110, Training R2: 0.991934
Validation Loss: 0.01665139, Validation R2: 0.546072

Epoch 234/1000
Training Loss: 0.00143898, Training R2: 0.991817
Validation Loss: 0.01664361, Validation R2: 0.545421

Epoch 235/1000
Training Loss: 0.00124123, Training R2: 0.992556
Validation Loss: 0.01656018, Validation R2: 0.550030

Epoch 236/1000
Training Loss: 0.00123306, Training R2: 0.991952
Validation Loss: 0.01661979, Validation R2: 0.546614

Epoch 237/1000
Training Loss: 0.00120655, Training R2: 0.992328
Validation Loss: 0.01656794, Validation R2: 0.548586

Epoch 238/1000
Training Loss: 0.00118606, Training R2: 0.992490
Validation Loss: 0.01657192, Validation R2: 0.548419

Epoch 239/1000
Training Loss: 0.00114371, Training R2: 0.992139
Validation Loss: 0.01659302, Validation R2: 0.549760

Epoch 240/1000
Training Loss: 0.00140296, Training R2: 0.991841
Validation Loss: 0.01664793, Validation R2: 0.546720

Epoch 241/1000
Training Loss: 0.00132885, Training R2: 0.991954
Validation Loss: 0.01665122, Validation R2: 0.545469

Epoch 242/1000
Epoch 00242: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00131343, Training R2: 0.992185
Validation Loss: 0.01669844, Validation R2: 0.544109

Epoch 243/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
