Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)

Frozen layers status:
emb_z.emb.weight: Trainable
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5317507

Epoch 1/1000
Training Loss: 0.84137113, Training R2: -1397.051758
Validation Loss: 0.53367281, Validation R2: -274.393860
Saved best model with validation R2 -274.393860 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.32147943, Training R2: -110.907951
Validation Loss: 0.22360599, Validation R2: -49.223370
Saved best model with validation R2 -49.223370 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.14117105, Training R2: -23.261675
Validation Loss: 0.03636988, Validation R2: -1.077504
Saved best model with validation R2 -1.077504 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.05789925, Training R2: -3.406209
Validation Loss: 0.09127455, Validation R2: -8.192686

Epoch 5/1000
Training Loss: 0.05986138, Training R2: -3.466566
Validation Loss: 0.06806404, Validation R2: -4.422410

Epoch 6/1000
Training Loss: 0.05634055, Training R2: -2.690372
Validation Loss: 0.04427210, Validation R2: -1.533090

Epoch 7/1000
Training Loss: 0.04103430, Training R2: -1.194690
Validation Loss: 0.03514422, Validation R2: -0.714627
Saved best model with validation R2 -0.714627 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.03555028, Training R2: -0.638057
Validation Loss: 0.04175093, Validation R2: -1.284646

Epoch 9/1000
Training Loss: 0.04031799, Training R2: -0.985193
Validation Loss: 0.04412092, Validation R2: -1.503491

Epoch 10/1000
Training Loss: 0.03971416, Training R2: -1.038113
Validation Loss: 0.04352481, Validation R2: -1.429891

Epoch 11/1000
Training Loss: 0.04076808, Training R2: -1.024147
Validation Loss: 0.04887932, Validation R2: -1.963449

Epoch 12/1000
Training Loss: 0.04287645, Training R2: -1.231528
Validation Loss: 0.02561099, Validation R2: -0.041590
Saved best model with validation R2 -0.041590 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.02547468, Training R2: 0.017880
Validation Loss: 0.02993730, Validation R2: -0.291211

Epoch 14/1000
Training Loss: 0.02868084, Training R2: -0.176876
Validation Loss: 0.02076621, Validation R2: 0.248249
Saved best model with validation R2 0.248249 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.02704443, Training R2: -0.052992
Validation Loss: 0.02853733, Validation R2: -0.164530

Epoch 16/1000
Training Loss: 0.02450384, Training R2: 0.139355
Validation Loss: 0.02893898, Validation R2: -0.217699

Epoch 17/1000
Training Loss: 0.02381321, Training R2: 0.133301
Validation Loss: 0.03315033, Validation R2: -0.409784

Epoch 18/1000
Training Loss: 0.02399054, Training R2: 0.172659
Validation Loss: 0.01856757, Validation R2: 0.418579
Saved best model with validation R2 0.418579 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.02404213, Training R2: 0.203113
Validation Loss: 0.02738863, Validation R2: -0.112459

Epoch 20/1000
Training Loss: 0.02413425, Training R2: 0.187789
Validation Loss: 0.03873851, Validation R2: -0.814463

Epoch 21/1000
Training Loss: 0.02650130, Training R2: 0.022112
Validation Loss: 0.01868917, Validation R2: 0.433389
Saved best model with validation R2 0.433389 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.03130056, Training R2: -0.468938
Validation Loss: 0.03373078, Validation R2: -0.402476

Epoch 23/1000
Training Loss: 0.05972770, Training R2: -3.022787
Validation Loss: 0.05514917, Validation R2: -2.403413

Epoch 24/1000
Training Loss: 0.04230991, Training R2: -1.251733
Validation Loss: 0.06192783, Validation R2: -3.175854

Epoch 25/1000
Training Loss: 0.05165709, Training R2: -1.865962
Validation Loss: 0.03672815, Validation R2: -0.648673

Epoch 26/1000
Training Loss: 0.03687623, Training R2: -0.634889
Validation Loss: 0.04627554, Validation R2: -1.459996

Epoch 27/1000
Training Loss: 0.04276532, Training R2: -1.026655
Validation Loss: 0.05345023, Validation R2: -2.205158

Epoch 28/1000
Training Loss: 0.04606243, Training R2: -1.353662
Validation Loss: 0.03485974, Validation R2: -0.504403

Epoch 29/1000
Training Loss: 0.03295406, Training R2: -0.377578
Validation Loss: 0.06211087, Validation R2: -3.192949

Epoch 30/1000
Training Loss: 0.04894394, Training R2: -1.551536
Validation Loss: 0.03106070, Validation R2: -0.246384

Epoch 31/1000
Training Loss: 0.03246547, Training R2: -0.289308
Validation Loss: 0.04818021, Validation R2: -1.710109

Epoch 32/1000
Training Loss: 0.04231363, Training R2: -1.050836
Validation Loss: 0.04032328, Validation R2: -0.962583

Epoch 33/1000
Training Loss: 0.03815141, Training R2: -0.679553
Validation Loss: 0.03683551, Validation R2: -0.699682

Epoch 34/1000
Training Loss: 0.03407923, Training R2: -0.420609
Validation Loss: 0.04568616, Validation R2: -1.442520

Epoch 35/1000
Training Loss: 0.03983753, Training R2: -0.801757
Validation Loss: 0.02293998, Validation R2: 0.252527

Epoch 36/1000
Training Loss: 0.02517845, Training R2: 0.168557
Validation Loss: 0.04324171, Validation R2: -1.247673

Epoch 37/1000
Training Loss: 0.03651989, Training R2: -0.633714
Validation Loss: 0.03565544, Validation R2: -0.632513

Epoch 38/1000
Training Loss: 0.03536616, Training R2: -0.499890
Validation Loss: 0.04995876, Validation R2: -1.844059

Epoch 39/1000
Training Loss: 0.04132664, Training R2: -0.916775
Validation Loss: 0.02712921, Validation R2: 0.012489

Epoch 40/1000
Training Loss: 0.02707511, Training R2: 0.053722
Validation Loss: 0.03874825, Validation R2: -0.804625

Epoch 41/1000
Training Loss: 0.03134031, Training R2: -0.266598
Validation Loss: 0.05466445, Validation R2: -2.315404

Epoch 42/1000
Epoch 00042: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.04514008, Training R2: -1.181089
Validation Loss: 0.02902037, Validation R2: -0.107680

Epoch 43/1000
学习率已减少 1 次
Training Loss: 0.02474299, Training R2: 0.176797
Validation Loss: 0.02845307, Validation R2: -0.187538

Epoch 44/1000
Training Loss: 0.02422693, Training R2: 0.206468
Validation Loss: 0.02206193, Validation R2: 0.224845

Epoch 45/1000
Training Loss: 0.02104461, Training R2: 0.383824
Validation Loss: 0.01864192, Validation R2: 0.427532

Epoch 46/1000
Training Loss: 0.01691215, Training R2: 0.586773
Validation Loss: 0.02362391, Validation R2: 0.225920

Epoch 47/1000
Training Loss: 0.01720001, Training R2: 0.567213
Validation Loss: 0.01686853, Validation R2: 0.488832
Saved best model with validation R2 0.488832 to best_finetuned_model.pth

Epoch 48/1000
Training Loss: 0.01539094, Training R2: 0.644803
Validation Loss: 0.01706074, Validation R2: 0.505112
Saved best model with validation R2 0.505112 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.01450705, Training R2: 0.675615
Validation Loss: 0.01625814, Validation R2: 0.523837
Saved best model with validation R2 0.523837 to best_finetuned_model.pth

Epoch 50/1000
Training Loss: 0.01369803, Training R2: 0.706062
Validation Loss: 0.01644268, Validation R2: 0.522351

Epoch 51/1000
Training Loss: 0.01339365, Training R2: 0.714974
Validation Loss: 0.01799428, Validation R2: 0.464808

Epoch 52/1000
Training Loss: 0.01380281, Training R2: 0.701873
Validation Loss: 0.01632966, Validation R2: 0.521246

Epoch 53/1000
Training Loss: 0.01230898, Training R2: 0.736207
Validation Loss: 0.01557781, Validation R2: 0.545201
Saved best model with validation R2 0.545201 to best_finetuned_model.pth

Epoch 54/1000
Training Loss: 0.01319898, Training R2: 0.705930
Validation Loss: 0.01733213, Validation R2: 0.475750

Epoch 55/1000
Training Loss: 0.01283583, Training R2: 0.736277
Validation Loss: 0.01849165, Validation R2: 0.416860

Epoch 56/1000
Training Loss: 0.01238962, Training R2: 0.749287
Validation Loss: 0.01686120, Validation R2: 0.488352

Epoch 57/1000
Training Loss: 0.01140486, Training R2: 0.778589
Validation Loss: 0.01609838, Validation R2: 0.506622

Epoch 58/1000
Training Loss: 0.01168143, Training R2: 0.771812
Validation Loss: 0.01609802, Validation R2: 0.534089

Epoch 59/1000
Training Loss: 0.01132983, Training R2: 0.783842
Validation Loss: 0.02413852, Validation R2: 0.174011

Epoch 60/1000
Training Loss: 0.01556863, Training R2: 0.658137
Validation Loss: 0.02132686, Validation R2: 0.317055

Epoch 61/1000
Training Loss: 0.01504761, Training R2: 0.685010
Validation Loss: 0.01549847, Validation R2: 0.570574
Saved best model with validation R2 0.570574 to best_finetuned_model.pth

Epoch 62/1000
Training Loss: 0.01261276, Training R2: 0.755886
Validation Loss: 0.01984585, Validation R2: 0.350495

Epoch 63/1000
Training Loss: 0.01380981, Training R2: 0.719665
Validation Loss: 0.01511033, Validation R2: 0.562063

Epoch 64/1000
Training Loss: 0.01538494, Training R2: 0.668915
Validation Loss: 0.02618966, Validation R2: 0.023329

Epoch 65/1000
Training Loss: 0.02609693, Training R2: 0.262294
Validation Loss: 0.02004200, Validation R2: 0.359718

Epoch 66/1000
Training Loss: 0.01648053, Training R2: 0.636014
Validation Loss: 0.01910660, Validation R2: 0.399716

Epoch 67/1000
Training Loss: 0.02652159, Training R2: 0.217410
Validation Loss: 0.02772732, Validation R2: -0.051409

Epoch 68/1000
Training Loss: 0.02710123, Training R2: 0.126383
Validation Loss: 0.01426580, Validation R2: 0.614334
Saved best model with validation R2 0.614334 to best_finetuned_model.pth

Epoch 69/1000
Training Loss: 0.01564152, Training R2: 0.606770
Validation Loss: 0.02478584, Validation R2: 0.167294

Epoch 70/1000
Training Loss: 0.02576777, Training R2: 0.272001
Validation Loss: 0.01771023, Validation R2: 0.470389

Epoch 71/1000
Training Loss: 0.01557302, Training R2: 0.641164
Validation Loss: 0.02497515, Validation R2: 0.142119

Epoch 72/1000
Training Loss: 0.02171322, Training R2: 0.448204
Validation Loss: 0.02566815, Validation R2: 0.111478

Epoch 73/1000
Training Loss: 0.01654555, Training R2: 0.625194
Validation Loss: 0.01772896, Validation R2: 0.464370

Epoch 74/1000
Training Loss: 0.01839392, Training R2: 0.558353
Validation Loss: 0.03290594, Validation R2: -0.282269

Epoch 75/1000
Training Loss: 0.01771148, Training R2: 0.575311
Validation Loss: 0.01889887, Validation R2: 0.430200

Epoch 76/1000
Training Loss: 0.01609921, Training R2: 0.641942
Validation Loss: 0.02559383, Validation R2: 0.131976

Epoch 77/1000
Training Loss: 0.02219734, Training R2: 0.433836
Validation Loss: 0.02400410, Validation R2: 0.206415

Epoch 78/1000
Training Loss: 0.01645443, Training R2: 0.625611
Validation Loss: 0.01698096, Validation R2: 0.534614

Epoch 79/1000
Training Loss: 0.01277790, Training R2: 0.741662
Validation Loss: 0.01489794, Validation R2: 0.586578

Epoch 80/1000
Training Loss: 0.01267844, Training R2: 0.747707
Validation Loss: 0.01608827, Validation R2: 0.528226

Epoch 81/1000
Training Loss: 0.01155669, Training R2: 0.781258
Validation Loss: 0.01889239, Validation R2: 0.398868

Epoch 82/1000
Training Loss: 0.01054576, Training R2: 0.821313
Validation Loss: 0.01680579, Validation R2: 0.513212

Epoch 83/1000
Training Loss: 0.00965813, Training R2: 0.844596
Validation Loss: 0.02219770, Validation R2: 0.260551

Epoch 84/1000
Training Loss: 0.01876838, Training R2: 0.566594
Validation Loss: 0.03252947, Validation R2: -0.297409

Epoch 85/1000
Training Loss: 0.02514361, Training R2: 0.236803
Validation Loss: 0.03434908, Validation R2: -0.430890

Epoch 86/1000
Training Loss: 0.02225080, Training R2: 0.412440
Validation Loss: 0.01703152, Validation R2: 0.527837

Epoch 87/1000
Training Loss: 0.01427806, Training R2: 0.715894
Validation Loss: 0.01792182, Validation R2: 0.478602

Epoch 88/1000
Training Loss: 0.02452980, Training R2: 0.320783
Validation Loss: 0.01545054, Validation R2: 0.568926

Epoch 89/1000
Epoch 00089: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01109413, Training R2: 0.810660
Validation Loss: 0.01725246, Validation R2: 0.509078

Epoch 90/1000
学习率已减少 2 次
Training Loss: 0.01056895, Training R2: 0.829288
Validation Loss: 0.01428732, Validation R2: 0.625330
Saved best model with validation R2 0.625330 to best_finetuned_model.pth

Epoch 91/1000
Training Loss: 0.00786005, Training R2: 0.887262
Validation Loss: 0.01450315, Validation R2: 0.614349

Epoch 92/1000
Training Loss: 0.00735055, Training R2: 0.897200
Validation Loss: 0.01458141, Validation R2: 0.609032

Epoch 93/1000
Training Loss: 0.00699236, Training R2: 0.901181
Validation Loss: 0.01552940, Validation R2: 0.570931

Epoch 94/1000
Training Loss: 0.00769670, Training R2: 0.889904
Validation Loss: 0.01630277, Validation R2: 0.545083

Epoch 95/1000
Training Loss: 0.00893334, Training R2: 0.862420
Validation Loss: 0.01565823, Validation R2: 0.578409

Epoch 96/1000
Training Loss: 0.00788561, Training R2: 0.888200
Validation Loss: 0.01460934, Validation R2: 0.622372

Epoch 97/1000
Training Loss: 0.00668358, Training R2: 0.907835
Validation Loss: 0.01465445, Validation R2: 0.608836

Epoch 98/1000
Training Loss: 0.00809548, Training R2: 0.884082
Validation Loss: 0.01479042, Validation R2: 0.603508

Epoch 99/1000
Training Loss: 0.00664760, Training R2: 0.909052
Validation Loss: 0.01450233, Validation R2: 0.610058

Epoch 100/1000
Training Loss: 0.00585879, Training R2: 0.919673
Validation Loss: 0.01534085, Validation R2: 0.573727

Epoch 101/1000
Training Loss: 0.00651271, Training R2: 0.913255
Validation Loss: 0.01450032, Validation R2: 0.608739

Epoch 102/1000
Training Loss: 0.00582264, Training R2: 0.924216
Validation Loss: 0.01452787, Validation R2: 0.614262

Epoch 103/1000
Training Loss: 0.00615468, Training R2: 0.918687
Validation Loss: 0.01576253, Validation R2: 0.557772

Epoch 104/1000
Training Loss: 0.00799889, Training R2: 0.892130
Validation Loss: 0.01441247, Validation R2: 0.618201

Epoch 105/1000
Training Loss: 0.00505520, Training R2: 0.932637
Validation Loss: 0.01425739, Validation R2: 0.620232

Epoch 106/1000
Training Loss: 0.00553546, Training R2: 0.927274
Validation Loss: 0.01460745, Validation R2: 0.609223

Epoch 107/1000
Training Loss: 0.00619622, Training R2: 0.917360
Validation Loss: 0.01662817, Validation R2: 0.540617

Epoch 108/1000
Training Loss: 0.00714556, Training R2: 0.909780
Validation Loss: 0.01396075, Validation R2: 0.647864
Saved best model with validation R2 0.647864 to best_finetuned_model.pth

Epoch 109/1000
Training Loss: 0.00612749, Training R2: 0.919501
Validation Loss: 0.01463714, Validation R2: 0.616902

Epoch 110/1000
Training Loss: 0.00598931, Training R2: 0.922388
Validation Loss: 0.01662741, Validation R2: 0.520527

Epoch 111/1000
Training Loss: 0.00859262, Training R2: 0.881375
Validation Loss: 0.01474722, Validation R2: 0.603310

Epoch 112/1000
Training Loss: 0.00597193, Training R2: 0.925238
Validation Loss: 0.01435350, Validation R2: 0.623678

Epoch 113/1000
Training Loss: 0.00634744, Training R2: 0.920527
Validation Loss: 0.01493110, Validation R2: 0.594785

Epoch 114/1000
Training Loss: 0.00562757, Training R2: 0.929818
Validation Loss: 0.01417798, Validation R2: 0.622042

Epoch 115/1000
Training Loss: 0.00486852, Training R2: 0.937088
Validation Loss: 0.01462121, Validation R2: 0.602522

Epoch 116/1000
Training Loss: 0.00520077, Training R2: 0.935971
Validation Loss: 0.01557117, Validation R2: 0.567301

Epoch 117/1000
Training Loss: 0.00542089, Training R2: 0.930361
Validation Loss: 0.01391802, Validation R2: 0.633803

Epoch 118/1000
Training Loss: 0.00511710, Training R2: 0.935364
Validation Loss: 0.01495530, Validation R2: 0.595724

Epoch 119/1000
Training Loss: 0.00606716, Training R2: 0.925108
Validation Loss: 0.01500937, Validation R2: 0.590675

Epoch 120/1000
Training Loss: 0.00548400, Training R2: 0.931049
Validation Loss: 0.01484953, Validation R2: 0.590790

Epoch 121/1000
Training Loss: 0.00571025, Training R2: 0.931347
Validation Loss: 0.01446510, Validation R2: 0.603072

Epoch 122/1000
Training Loss: 0.00575214, Training R2: 0.934118
Validation Loss: 0.01403538, Validation R2: 0.620097

Epoch 123/1000
Training Loss: 0.00638416, Training R2: 0.920056
Validation Loss: 0.01533122, Validation R2: 0.567069

Epoch 124/1000
Training Loss: 0.00745658, Training R2: 0.904436
Validation Loss: 0.01421123, Validation R2: 0.618262

Epoch 125/1000
Training Loss: 0.01005616, Training R2: 0.846304
Validation Loss: 0.02501066, Validation R2: 0.138603

Epoch 126/1000
Training Loss: 0.01739560, Training R2: 0.629745
Validation Loss: 0.01658138, Validation R2: 0.535357

Epoch 127/1000
Training Loss: 0.02612731, Training R2: 0.241760
Validation Loss: 0.01395186, Validation R2: 0.629988

Epoch 128/1000
Training Loss: 0.01901456, Training R2: 0.529657
Validation Loss: 0.03237239, Validation R2: -0.272914

Epoch 129/1000
Epoch 00129: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.03253642, Training R2: -0.027340
Validation Loss: 0.02836372, Validation R2: -0.058083

Epoch 130/1000
学习率已减少 3 次
Training Loss: 0.02432606, Training R2: 0.386181
Validation Loss: 0.02334192, Validation R2: 0.254030

Epoch 131/1000
Training Loss: 0.02263423, Training R2: 0.492252
Validation Loss: 0.01722643, Validation R2: 0.488731

Epoch 132/1000
Training Loss: 0.01921695, Training R2: 0.586494
Validation Loss: 0.01661574, Validation R2: 0.534327

Epoch 133/1000
Training Loss: 0.01494170, Training R2: 0.745887
Validation Loss: 0.01665131, Validation R2: 0.511171

Epoch 134/1000
Training Loss: 0.01279369, Training R2: 0.797577
Validation Loss: 0.01763799, Validation R2: 0.485477

Epoch 135/1000
Training Loss: 0.00864314, Training R2: 0.886886
Validation Loss: 0.01409520, Validation R2: 0.610982

Epoch 136/1000
Training Loss: 0.00740625, Training R2: 0.909384
Validation Loss: 0.01675076, Validation R2: 0.503788

Epoch 137/1000
Training Loss: 0.00992553, Training R2: 0.855857
Validation Loss: 0.01839264, Validation R2: 0.445756

Epoch 138/1000
Training Loss: 0.00937316, Training R2: 0.874711
Validation Loss: 0.01434283, Validation R2: 0.587302

Epoch 139/1000
Training Loss: 0.01046997, Training R2: 0.852351
Validation Loss: 0.01513895, Validation R2: 0.562190

Epoch 140/1000
Training Loss: 0.00914118, Training R2: 0.877463
Validation Loss: 0.01863769, Validation R2: 0.439578

Epoch 141/1000
Training Loss: 0.00840455, Training R2: 0.900361
Validation Loss: 0.01406584, Validation R2: 0.604481

Epoch 142/1000
Training Loss: 0.00600960, Training R2: 0.935381
Validation Loss: 0.01471901, Validation R2: 0.583476

Epoch 143/1000
Training Loss: 0.00550655, Training R2: 0.937507
Validation Loss: 0.01436514, Validation R2: 0.598142

Epoch 144/1000
Training Loss: 0.00451697, Training R2: 0.951578
Validation Loss: 0.01435935, Validation R2: 0.605349

Epoch 145/1000
Training Loss: 0.00461470, Training R2: 0.948907
Validation Loss: 0.01437131, Validation R2: 0.601281

Epoch 146/1000
Training Loss: 0.00375032, Training R2: 0.956730
Validation Loss: 0.01440326, Validation R2: 0.597903

Epoch 147/1000
Training Loss: 0.00401549, Training R2: 0.953447
Validation Loss: 0.01436873, Validation R2: 0.597766

Epoch 148/1000
Training Loss: 0.00432320, Training R2: 0.953041
Validation Loss: 0.01448727, Validation R2: 0.594601

Epoch 149/1000
Training Loss: 0.00389095, Training R2: 0.955246
Validation Loss: 0.01483264, Validation R2: 0.586631

Epoch 150/1000
Epoch 00150: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00351232, Training R2: 0.958491
Validation Loss: 0.01453190, Validation R2: 0.601086

Epoch 151/1000
学习率已减少 4 次
Training Loss: 0.00358452, Training R2: 0.959112
Validation Loss: 0.01481925, Validation R2: 0.586690

Epoch 152/1000
Training Loss: 0.00316951, Training R2: 0.961655
Validation Loss: 0.01493659, Validation R2: 0.582433

Epoch 153/1000
Training Loss: 0.00367627, Training R2: 0.959504
Validation Loss: 0.01478851, Validation R2: 0.588766

Epoch 154/1000
Training Loss: 0.00349431, Training R2: 0.961043
Validation Loss: 0.01440576, Validation R2: 0.601157

Epoch 155/1000
Training Loss: 0.00329804, Training R2: 0.961720
Validation Loss: 0.01434950, Validation R2: 0.601485

Epoch 156/1000
Training Loss: 0.00312590, Training R2: 0.962342
Validation Loss: 0.01429000, Validation R2: 0.603421

Epoch 157/1000
Training Loss: 0.00305891, Training R2: 0.963329
Validation Loss: 0.01433043, Validation R2: 0.602364

Epoch 158/1000
Training Loss: 0.00271005, Training R2: 0.964779
Validation Loss: 0.01431334, Validation R2: 0.603785

Epoch 159/1000
Training Loss: 0.00279373, Training R2: 0.964025
Validation Loss: 0.01435762, Validation R2: 0.599836

Epoch 160/1000
Training Loss: 0.00257947, Training R2: 0.965389
Validation Loss: 0.01445431, Validation R2: 0.597126

Epoch 161/1000
Training Loss: 0.00257971, Training R2: 0.966012
Validation Loss: 0.01446822, Validation R2: 0.594903

Epoch 162/1000
Training Loss: 0.00246292, Training R2: 0.966307
Validation Loss: 0.01443110, Validation R2: 0.597134

Epoch 163/1000
Training Loss: 0.00245821, Training R2: 0.966385
Validation Loss: 0.01443416, Validation R2: 0.597036

Epoch 164/1000
Training Loss: 0.00258004, Training R2: 0.965860
Validation Loss: 0.01444252, Validation R2: 0.596426

Epoch 165/1000
Training Loss: 0.00245940, Training R2: 0.965652
Validation Loss: 0.01436230, Validation R2: 0.601921

Epoch 166/1000
Training Loss: 0.00258247, Training R2: 0.966015
Validation Loss: 0.01442510, Validation R2: 0.598006

Epoch 167/1000
Training Loss: 0.00235348, Training R2: 0.967763
Validation Loss: 0.01464726, Validation R2: 0.589535

Epoch 168/1000
Training Loss: 0.00272489, Training R2: 0.966553
Validation Loss: 0.01445334, Validation R2: 0.598457

Epoch 169/1000
Training Loss: 0.00235409, Training R2: 0.967791
Validation Loss: 0.01429885, Validation R2: 0.606369

Epoch 170/1000
Training Loss: 0.00263229, Training R2: 0.966603
Validation Loss: 0.01432550, Validation R2: 0.605289

Epoch 171/1000
Epoch 00171: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00221142, Training R2: 0.968543
Validation Loss: 0.01447075, Validation R2: 0.598059

Epoch 172/1000
学习率已减少 5 次
Training Loss: 0.00221368, Training R2: 0.968548
Validation Loss: 0.01447995, Validation R2: 0.596198

Epoch 173/1000
Training Loss: 0.00219174, Training R2: 0.968395
Validation Loss: 0.01446716, Validation R2: 0.597317

Epoch 174/1000
Training Loss: 0.00211697, Training R2: 0.968600
Validation Loss: 0.01438674, Validation R2: 0.601293

Epoch 175/1000
Training Loss: 0.00201869, Training R2: 0.968821
Validation Loss: 0.01445234, Validation R2: 0.601313

Epoch 176/1000
Training Loss: 0.00217805, Training R2: 0.968377
Validation Loss: 0.01439533, Validation R2: 0.601152

Epoch 177/1000
Training Loss: 0.00199629, Training R2: 0.968930
Validation Loss: 0.01435105, Validation R2: 0.601257

Epoch 178/1000
Training Loss: 0.00198016, Training R2: 0.969031
Validation Loss: 0.01435239, Validation R2: 0.601100

Epoch 179/1000
Training Loss: 0.00206728, Training R2: 0.968577
Validation Loss: 0.01436506, Validation R2: 0.598779

Epoch 180/1000
Training Loss: 0.00245326, Training R2: 0.967767
Validation Loss: 0.01438805, Validation R2: 0.598053

Epoch 181/1000
Training Loss: 0.00223835, Training R2: 0.968328
Validation Loss: 0.01434135, Validation R2: 0.600133

Epoch 182/1000
Training Loss: 0.00224612, Training R2: 0.969110
Validation Loss: 0.01434780, Validation R2: 0.600553

Epoch 183/1000
Training Loss: 0.00239054, Training R2: 0.968088
Validation Loss: 0.01430771, Validation R2: 0.601326

Epoch 184/1000
Training Loss: 0.00225329, Training R2: 0.968629
Validation Loss: 0.01426598, Validation R2: 0.603124

Epoch 185/1000
Training Loss: 0.00245171, Training R2: 0.967463
Validation Loss: 0.01429520, Validation R2: 0.602799

Epoch 186/1000
Training Loss: 0.00226658, Training R2: 0.967903
Validation Loss: 0.01428049, Validation R2: 0.605016

Epoch 187/1000
Training Loss: 0.00219544, Training R2: 0.968352
Validation Loss: 0.01436712, Validation R2: 0.599997

Epoch 188/1000
Training Loss: 0.00229036, Training R2: 0.969312
Validation Loss: 0.01436941, Validation R2: 0.599937

Epoch 189/1000
Training Loss: 0.00231970, Training R2: 0.968893
Validation Loss: 0.01434993, Validation R2: 0.599086

Epoch 190/1000
Training Loss: 0.00231063, Training R2: 0.968446
Validation Loss: 0.01440312, Validation R2: 0.595142

Epoch 191/1000
Training Loss: 0.00207329, Training R2: 0.969210
Validation Loss: 0.01429279, Validation R2: 0.601974

Epoch 192/1000
Epoch 00192: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00245454, Training R2: 0.967848
Validation Loss: 0.01421680, Validation R2: 0.606988

Epoch 193/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
