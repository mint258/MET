Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 3258499

Epoch 1/1000
Training Loss: 0.84456901, Training R2: -1389.141479
Validation Loss: 0.45560518, Validation R2: -202.808273
Saved best model with validation R2 -202.808273 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.30732524, Training R2: -98.733582
Validation Loss: 0.35673335, Validation R2: -126.632370
Saved best model with validation R2 -126.632370 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.23213678, Training R2: -59.124123
Validation Loss: 0.31711775, Validation R2: -97.598640
Saved best model with validation R2 -97.598640 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.18216535, Training R2: -40.124283
Validation Loss: 0.15575929, Validation R2: -23.508186
Saved best model with validation R2 -23.508186 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.10585294, Training R2: -11.213603
Validation Loss: 0.10217814, Validation R2: -10.126354
Saved best model with validation R2 -10.126354 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.07489862, Training R2: -5.787177
Validation Loss: 0.02349235, Validation R2: -0.095031
Saved best model with validation R2 -0.095031 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.04724737, Training R2: -1.910550
Validation Loss: 0.04687381, Validation R2: -1.732542

Epoch 8/1000
Training Loss: 0.03845908, Training R2: -1.057582
Validation Loss: 0.03626696, Validation R2: -0.801897

Epoch 9/1000
Training Loss: 0.03580248, Training R2: -0.729430
Validation Loss: 0.02825989, Validation R2: -0.260172

Epoch 10/1000
Training Loss: 0.02903565, Training R2: -0.234361
Validation Loss: 0.04111742, Validation R2: -1.160474

Epoch 11/1000
Training Loss: 0.03691351, Training R2: -0.760800
Validation Loss: 0.02948021, Validation R2: -0.300838

Epoch 12/1000
Training Loss: 0.02982355, Training R2: -0.285392
Validation Loss: 0.02216335, Validation R2: 0.067374
Saved best model with validation R2 0.067374 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.02585901, Training R2: -0.082226
Validation Loss: 0.02272821, Validation R2: 0.050065

Epoch 14/1000
Training Loss: 0.02398733, Training R2: 0.044026
Validation Loss: 0.02414673, Validation R2: -0.046396

Epoch 15/1000
Training Loss: 0.02376908, Training R2: 0.054627
Validation Loss: 0.03608246, Validation R2: -0.850991

Epoch 16/1000
Training Loss: 0.03052538, Training R2: -0.337536
Validation Loss: 0.02386722, Validation R2: 0.001166

Epoch 17/1000
Training Loss: 0.02524290, Training R2: -0.018495
Validation Loss: 0.05137431, Validation R2: -2.126311

Epoch 18/1000
Training Loss: 0.04734510, Training R2: -1.673595
Validation Loss: 0.03082234, Validation R2: -0.351714

Epoch 19/1000
Training Loss: 0.03445992, Training R2: -0.580496
Validation Loss: 0.03355099, Validation R2: -0.519943

Epoch 20/1000
Training Loss: 0.03314055, Training R2: -0.445891
Validation Loss: 0.04236857, Validation R2: -1.196940

Epoch 21/1000
Training Loss: 0.04042500, Training R2: -1.070115
Validation Loss: 0.03489045, Validation R2: -0.603591

Epoch 22/1000
Training Loss: 0.03507406, Training R2: -0.591714
Validation Loss: 0.02275367, Validation R2: 0.078009
Saved best model with validation R2 0.078009 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.02305907, Training R2: 0.134914
Validation Loss: 0.02850445, Validation R2: -0.188820

Epoch 24/1000
Training Loss: 0.02725231, Training R2: -0.104989
Validation Loss: 0.02118728, Validation R2: 0.136912
Saved best model with validation R2 0.136912 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.02675792, Training R2: -0.113708
Validation Loss: 0.02831349, Validation R2: -0.315896

Epoch 26/1000
Training Loss: 0.03037115, Training R2: -0.281394
Validation Loss: 0.05666761, Validation R2: -2.878556

Epoch 27/1000
Training Loss: 0.04574314, Training R2: -1.510099
Validation Loss: 0.02032960, Validation R2: 0.166728
Saved best model with validation R2 0.166728 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.02898995, Training R2: -0.311687
Validation Loss: 0.02068220, Validation R2: 0.175320
Saved best model with validation R2 0.175320 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.02979289, Training R2: -0.324574
Validation Loss: 0.02949864, Validation R2: -0.231075

Epoch 30/1000
Training Loss: 0.04577559, Training R2: -1.599784
Validation Loss: 0.03791055, Validation R2: -0.801104

Epoch 31/1000
Training Loss: 0.03223806, Training R2: -0.355706
Validation Loss: 0.02517578, Validation R2: 0.017333

Epoch 32/1000
Training Loss: 0.03652811, Training R2: -0.775774
Validation Loss: 0.05266190, Validation R2: -2.197205

Epoch 33/1000
Training Loss: 0.03740456, Training R2: -0.859134
Validation Loss: 0.02088912, Validation R2: 0.149776

Epoch 34/1000
Training Loss: 0.02189451, Training R2: 0.200534
Validation Loss: 0.02420946, Validation R2: -0.027753

Epoch 35/1000
Training Loss: 0.02357059, Training R2: 0.148063
Validation Loss: 0.02199856, Validation R2: 0.122127

Epoch 36/1000
Training Loss: 0.02869775, Training R2: -0.180063
Validation Loss: 0.03482886, Validation R2: -0.766771

Epoch 37/1000
Training Loss: 0.03709385, Training R2: -0.618942
Validation Loss: 0.03954194, Validation R2: -1.159365

Epoch 38/1000
Training Loss: 0.03504990, Training R2: -0.578187
Validation Loss: 0.02677581, Validation R2: -0.204023

Epoch 39/1000
Training Loss: 0.03725712, Training R2: -0.691267
Validation Loss: 0.04323866, Validation R2: -1.494682

Epoch 40/1000
Training Loss: 0.03510431, Training R2: -0.525267
Validation Loss: 0.02469665, Validation R2: -0.071688

Epoch 41/1000
Training Loss: 0.02656997, Training R2: -0.018806
Validation Loss: 0.02020502, Validation R2: 0.204235
Saved best model with validation R2 0.204235 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.03379846, Training R2: -0.503765
Validation Loss: 0.04837795, Validation R2: -1.929675

Epoch 43/1000
Training Loss: 0.04286434, Training R2: -1.112773
Validation Loss: 0.02835592, Validation R2: -0.297558

Epoch 44/1000
Training Loss: 0.02789494, Training R2: -0.036329
Validation Loss: 0.03219835, Validation R2: -0.562725

Epoch 45/1000
Training Loss: 0.03350681, Training R2: -0.407721
Validation Loss: 0.03126904, Validation R2: -0.498515

Epoch 46/1000
Training Loss: 0.04087418, Training R2: -0.957625
Validation Loss: 0.03269526, Validation R2: -0.604049

Epoch 47/1000
Training Loss: 0.03061142, Training R2: -0.212202
Validation Loss: 0.02252649, Validation R2: 0.081224

Epoch 48/1000
Training Loss: 0.03191749, Training R2: -0.319439
Validation Loss: 0.03007483, Validation R2: -0.427700

Epoch 49/1000
Training Loss: 0.04080537, Training R2: -0.918582
Validation Loss: 0.04635923, Validation R2: -1.735807

Epoch 50/1000
Training Loss: 0.03603297, Training R2: -0.608547
Validation Loss: 0.03195077, Validation R2: -0.561748

Epoch 51/1000
Training Loss: 0.02769241, Training R2: -0.063130
Validation Loss: 0.03428010, Validation R2: -0.717261

Epoch 52/1000
Training Loss: 0.02777580, Training R2: -0.063710
Validation Loss: 0.01947506, Validation R2: 0.276674
Saved best model with validation R2 0.276674 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.02045082, Training R2: 0.373715
Validation Loss: 0.02456021, Validation R2: 0.116298

Epoch 54/1000
Training Loss: 0.01907069, Training R2: 0.439924
Validation Loss: 0.02019043, Validation R2: 0.251195

Epoch 55/1000
Training Loss: 0.02040513, Training R2: 0.379556
Validation Loss: 0.02711699, Validation R2: -0.026122

Epoch 56/1000
Training Loss: 0.02023260, Training R2: 0.402173
Validation Loss: 0.02257179, Validation R2: 0.095903

Epoch 57/1000
Training Loss: 0.01937249, Training R2: 0.423974
Validation Loss: 0.03090235, Validation R2: -0.439491

Epoch 58/1000
Training Loss: 0.02293477, Training R2: 0.257878
Validation Loss: 0.02254190, Validation R2: 0.215796

Epoch 59/1000
Training Loss: 0.01727601, Training R2: 0.528900
Validation Loss: 0.03395537, Validation R2: -0.631936

Epoch 60/1000
Training Loss: 0.02778427, Training R2: 0.009664
Validation Loss: 0.02278080, Validation R2: 0.104145

Epoch 61/1000
Training Loss: 0.02287516, Training R2: 0.285766
Validation Loss: 0.02120795, Validation R2: 0.311755
Saved best model with validation R2 0.311755 to best_finetuned_model.pth

Epoch 62/1000
Training Loss: 0.02305200, Training R2: 0.268347
Validation Loss: 0.03303005, Validation R2: -0.429033

Epoch 63/1000
Training Loss: 0.02323320, Training R2: 0.268882
Validation Loss: 0.02279071, Validation R2: 0.211471

Epoch 64/1000
Training Loss: 0.03756461, Training R2: -0.762283
Validation Loss: 0.06782218, Validation R2: -3.940912

Epoch 65/1000
Training Loss: 0.04282153, Training R2: -1.307350
Validation Loss: 0.05751104, Validation R2: -2.668960

Epoch 66/1000
Training Loss: 0.04383273, Training R2: -1.213388
Validation Loss: 0.03478675, Validation R2: -0.499681

Epoch 67/1000
Training Loss: 0.03127860, Training R2: -0.180727
Validation Loss: 0.05547132, Validation R2: -2.447394

Epoch 68/1000
Training Loss: 0.04200950, Training R2: -1.062126
Validation Loss: 0.02331798, Validation R2: 0.194280

Epoch 69/1000
Training Loss: 0.02220118, Training R2: 0.330867
Validation Loss: 0.02129402, Validation R2: 0.289666

Epoch 70/1000
Training Loss: 0.01735663, Training R2: 0.567158
Validation Loss: 0.02402285, Validation R2: 0.106179

Epoch 71/1000
Training Loss: 0.02199574, Training R2: 0.363906
Validation Loss: 0.02389657, Validation R2: 0.180631

Epoch 72/1000
Training Loss: 0.02429035, Training R2: 0.191301
Validation Loss: 0.06747326, Validation R2: -3.851664

Epoch 73/1000
Training Loss: 0.04722942, Training R2: -1.459491
Validation Loss: 0.03271740, Validation R2: -0.333647

Epoch 74/1000
Training Loss: 0.03024284, Training R2: -0.067553
Validation Loss: 0.04869689, Validation R2: -1.664363

Epoch 75/1000
Training Loss: 0.03864184, Training R2: -0.608056
Validation Loss: 0.04608998, Validation R2: -1.410979

Epoch 76/1000
Training Loss: 0.03557601, Training R2: -0.434246
Validation Loss: 0.04195263, Validation R2: -1.051054

Epoch 77/1000
Training Loss: 0.03572469, Training R2: -0.396475
Validation Loss: 0.04530082, Validation R2: -1.369644

Epoch 78/1000
Training Loss: 0.03559864, Training R2: -0.402936
Validation Loss: 0.03689366, Validation R2: -0.668733

Epoch 79/1000
Training Loss: 0.03201148, Training R2: -0.147129
Validation Loss: 0.04816047, Validation R2: -1.614172

Epoch 80/1000
Training Loss: 0.03720205, Training R2: -0.528274
Validation Loss: 0.03695521, Validation R2: -0.615673

Epoch 81/1000
Training Loss: 0.03095185, Training R2: -0.100812
Validation Loss: 0.05669912, Validation R2: -2.491747

Epoch 82/1000
Epoch 00082: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.04017756, Training R2: -0.941097
Validation Loss: 0.02440601, Validation R2: 0.166151

Epoch 83/1000
学习率已减少 1 次
Training Loss: 0.01761315, Training R2: 0.583891
Validation Loss: 0.01731857, Validation R2: 0.460216
Saved best model with validation R2 0.460216 to best_finetuned_model.pth

Epoch 84/1000
Training Loss: 0.01667600, Training R2: 0.615702
Validation Loss: 0.01837615, Validation R2: 0.393236

Epoch 85/1000
Training Loss: 0.01440893, Training R2: 0.692056
Validation Loss: 0.01772141, Validation R2: 0.435675

Epoch 86/1000
Training Loss: 0.01261479, Training R2: 0.762891
Validation Loss: 0.01791593, Validation R2: 0.426823

Epoch 87/1000
Training Loss: 0.01238572, Training R2: 0.767118
Validation Loss: 0.01909514, Validation R2: 0.367930

Epoch 88/1000
Training Loss: 0.01200307, Training R2: 0.780404
Validation Loss: 0.01982844, Validation R2: 0.328858

Epoch 89/1000
Training Loss: 0.01176123, Training R2: 0.787385
Validation Loss: 0.01927886, Validation R2: 0.356689

Epoch 90/1000
Training Loss: 0.01119189, Training R2: 0.802717
Validation Loss: 0.01726783, Validation R2: 0.434940

Epoch 91/1000
Training Loss: 0.01037285, Training R2: 0.822466
Validation Loss: 0.01739765, Validation R2: 0.449882

Epoch 92/1000
Training Loss: 0.01050873, Training R2: 0.829211
Validation Loss: 0.01865097, Validation R2: 0.398571

Epoch 93/1000
Training Loss: 0.01018294, Training R2: 0.832482
Validation Loss: 0.01699658, Validation R2: 0.448511

Epoch 94/1000
Training Loss: 0.01030756, Training R2: 0.832547
Validation Loss: 0.01685341, Validation R2: 0.437554

Epoch 95/1000
Training Loss: 0.01009090, Training R2: 0.841353
Validation Loss: 0.01776862, Validation R2: 0.403314

Epoch 96/1000
Training Loss: 0.01023946, Training R2: 0.839865
Validation Loss: 0.01616522, Validation R2: 0.499362
Saved best model with validation R2 0.499362 to best_finetuned_model.pth

Epoch 97/1000
Training Loss: 0.00917371, Training R2: 0.862058
Validation Loss: 0.01575587, Validation R2: 0.502858
Saved best model with validation R2 0.502858 to best_finetuned_model.pth

Epoch 98/1000
Training Loss: 0.01030666, Training R2: 0.840695
Validation Loss: 0.01706188, Validation R2: 0.433518

Epoch 99/1000
Training Loss: 0.01000917, Training R2: 0.845369
Validation Loss: 0.02177673, Validation R2: 0.253354

Epoch 100/1000
Training Loss: 0.01902303, Training R2: 0.554317
Validation Loss: 0.02399177, Validation R2: 0.119362

Epoch 101/1000
Training Loss: 0.01966989, Training R2: 0.565439
Validation Loss: 0.01881741, Validation R2: 0.366689

Epoch 102/1000
Training Loss: 0.01776623, Training R2: 0.618064
Validation Loss: 0.01994973, Validation R2: 0.325789

Epoch 103/1000
Training Loss: 0.01771475, Training R2: 0.635697
Validation Loss: 0.02216528, Validation R2: 0.230652

Epoch 104/1000
Training Loss: 0.01968933, Training R2: 0.567373
Validation Loss: 0.02025206, Validation R2: 0.300834

Epoch 105/1000
Training Loss: 0.01867455, Training R2: 0.593287
Validation Loss: 0.01709129, Validation R2: 0.422325

Epoch 106/1000
Training Loss: 0.01457687, Training R2: 0.730235
Validation Loss: 0.02083334, Validation R2: 0.266434

Epoch 107/1000
Training Loss: 0.01728085, Training R2: 0.654631
Validation Loss: 0.01791694, Validation R2: 0.393487

Epoch 108/1000
Training Loss: 0.01397571, Training R2: 0.745879
Validation Loss: 0.02257075, Validation R2: 0.197518

Epoch 109/1000
Training Loss: 0.01935050, Training R2: 0.570617
Validation Loss: 0.01933750, Validation R2: 0.362492

Epoch 110/1000
Training Loss: 0.01593972, Training R2: 0.697264
Validation Loss: 0.01610833, Validation R2: 0.517430
Saved best model with validation R2 0.517430 to best_finetuned_model.pth

Epoch 111/1000
Training Loss: 0.01120105, Training R2: 0.824276
Validation Loss: 0.01589404, Validation R2: 0.515506

Epoch 112/1000
Training Loss: 0.00873307, Training R2: 0.882219
Validation Loss: 0.01759156, Validation R2: 0.409092

Epoch 113/1000
Training Loss: 0.00853860, Training R2: 0.889212
Validation Loss: 0.01632189, Validation R2: 0.419334

Epoch 114/1000
Training Loss: 0.00870477, Training R2: 0.883352
Validation Loss: 0.01619771, Validation R2: 0.423986

Epoch 115/1000
Training Loss: 0.00996261, Training R2: 0.860974
Validation Loss: 0.01952907, Validation R2: 0.275201

Epoch 116/1000
Training Loss: 0.00987531, Training R2: 0.861657
Validation Loss: 0.02210009, Validation R2: 0.197447

Epoch 117/1000
Training Loss: 0.01814665, Training R2: 0.595667
Validation Loss: 0.02585236, Validation R2: -0.004950

Epoch 118/1000
Training Loss: 0.02028802, Training R2: 0.510812
Validation Loss: 0.01613668, Validation R2: 0.441111

Epoch 119/1000
Training Loss: 0.01026904, Training R2: 0.853248
Validation Loss: 0.01863912, Validation R2: 0.367812

Epoch 120/1000
Training Loss: 0.01072828, Training R2: 0.846813
Validation Loss: 0.01750685, Validation R2: 0.367065

Epoch 121/1000
Training Loss: 0.00739534, Training R2: 0.915452
Validation Loss: 0.01721861, Validation R2: 0.373758

Epoch 122/1000
Training Loss: 0.00901013, Training R2: 0.881096
Validation Loss: 0.01628936, Validation R2: 0.412287

Epoch 123/1000
Training Loss: 0.00795018, Training R2: 0.907092
Validation Loss: 0.01833253, Validation R2: 0.399331

Epoch 124/1000
Training Loss: 0.00989957, Training R2: 0.860052
Validation Loss: 0.01672900, Validation R2: 0.440555

Epoch 125/1000
Training Loss: 0.00887327, Training R2: 0.883050
Validation Loss: 0.01771066, Validation R2: 0.307891

Epoch 126/1000
Training Loss: 0.01105623, Training R2: 0.816999
Validation Loss: 0.02185769, Validation R2: 0.208571

Epoch 127/1000
Training Loss: 0.02515711, Training R2: 0.300393
Validation Loss: 0.03947047, Validation R2: -0.856072

Epoch 128/1000
Training Loss: 0.02550645, Training R2: 0.251834
Validation Loss: 0.02024523, Validation R2: 0.349538

Epoch 129/1000
Training Loss: 0.01326016, Training R2: 0.770804
Validation Loss: 0.02012701, Validation R2: 0.335075

Epoch 130/1000
Training Loss: 0.00907924, Training R2: 0.878639
Validation Loss: 0.01645689, Validation R2: 0.434520

Epoch 131/1000
Epoch 00131: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.00747243, Training R2: 0.914159
Validation Loss: 0.01971193, Validation R2: 0.311638

Epoch 132/1000
学习率已减少 2 次
Training Loss: 0.00916169, Training R2: 0.881001
Validation Loss: 0.01822599, Validation R2: 0.376600

Epoch 133/1000
Training Loss: 0.00878736, Training R2: 0.892992
Validation Loss: 0.02087134, Validation R2: 0.251420

Epoch 134/1000
Training Loss: 0.01095607, Training R2: 0.851281
Validation Loss: 0.01650950, Validation R2: 0.435803

Epoch 135/1000
Training Loss: 0.00714749, Training R2: 0.924242
Validation Loss: 0.01635760, Validation R2: 0.434296

Epoch 136/1000
Training Loss: 0.00612781, Training R2: 0.937709
Validation Loss: 0.01603330, Validation R2: 0.446005

Epoch 137/1000
Training Loss: 0.00533878, Training R2: 0.948797
Validation Loss: 0.01641800, Validation R2: 0.414437

Epoch 138/1000
Training Loss: 0.00507914, Training R2: 0.952479
Validation Loss: 0.01600001, Validation R2: 0.432947

Epoch 139/1000
Training Loss: 0.00499158, Training R2: 0.953325
Validation Loss: 0.01818342, Validation R2: 0.312650

Epoch 140/1000
Training Loss: 0.00642608, Training R2: 0.933287
Validation Loss: 0.01674955, Validation R2: 0.372848

Epoch 141/1000
Training Loss: 0.00617809, Training R2: 0.939767
Validation Loss: 0.01644273, Validation R2: 0.375288

Epoch 142/1000
Training Loss: 0.00734746, Training R2: 0.917560
Validation Loss: 0.01978836, Validation R2: 0.218649

Epoch 143/1000
Training Loss: 0.01035685, Training R2: 0.875188
Validation Loss: 0.02037583, Validation R2: 0.204606

Epoch 144/1000
Training Loss: 0.00827416, Training R2: 0.902989
Validation Loss: 0.02305232, Validation R2: 0.087923

Epoch 145/1000
Training Loss: 0.01215741, Training R2: 0.838407
Validation Loss: 0.01721432, Validation R2: 0.372372

Epoch 146/1000
Training Loss: 0.00687316, Training R2: 0.932381
Validation Loss: 0.01976854, Validation R2: 0.260853

Epoch 147/1000
Training Loss: 0.00953585, Training R2: 0.888962
Validation Loss: 0.01888236, Validation R2: 0.299169

Epoch 148/1000
Training Loss: 0.00882117, Training R2: 0.900480
Validation Loss: 0.02060177, Validation R2: 0.223698

Epoch 149/1000
Training Loss: 0.01012772, Training R2: 0.879321
Validation Loss: 0.01769160, Validation R2: 0.339033

Epoch 150/1000
Training Loss: 0.00743802, Training R2: 0.923289
Validation Loss: 0.01933655, Validation R2: 0.271138

Epoch 151/1000
Training Loss: 0.00967399, Training R2: 0.883709
Validation Loss: 0.01939387, Validation R2: 0.262410

Epoch 152/1000
Epoch 00152: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00951544, Training R2: 0.891452
Validation Loss: 0.01894898, Validation R2: 0.265302

Epoch 153/1000
学习率已减少 3 次
Training Loss: 0.00769509, Training R2: 0.920640
Validation Loss: 0.01617184, Validation R2: 0.407149

Epoch 154/1000
Training Loss: 0.00606594, Training R2: 0.945496
Validation Loss: 0.01624846, Validation R2: 0.406746

Epoch 155/1000
Training Loss: 0.00584087, Training R2: 0.946809
Validation Loss: 0.01652341, Validation R2: 0.385399

Epoch 156/1000
Training Loss: 0.00531082, Training R2: 0.954554
Validation Loss: 0.01744704, Validation R2: 0.331378

Epoch 157/1000
Training Loss: 0.00510150, Training R2: 0.957945
Validation Loss: 0.01637090, Validation R2: 0.372703

Epoch 158/1000
Training Loss: 0.00440767, Training R2: 0.965352
Validation Loss: 0.01614605, Validation R2: 0.385315

Epoch 159/1000
Training Loss: 0.00464209, Training R2: 0.962729
Validation Loss: 0.01620921, Validation R2: 0.380788

Epoch 160/1000
Training Loss: 0.00457287, Training R2: 0.964436
Validation Loss: 0.01624261, Validation R2: 0.381479

Epoch 161/1000
Training Loss: 0.00457224, Training R2: 0.964066
Validation Loss: 0.01617080, Validation R2: 0.400024

Epoch 162/1000
Training Loss: 0.00462686, Training R2: 0.964298
Validation Loss: 0.01606884, Validation R2: 0.434694

Epoch 163/1000
Training Loss: 0.00390538, Training R2: 0.971882
Validation Loss: 0.01603086, Validation R2: 0.441991

Epoch 164/1000
Training Loss: 0.00384471, Training R2: 0.971634
Validation Loss: 0.01607743, Validation R2: 0.436478

Epoch 165/1000
Training Loss: 0.00370593, Training R2: 0.973454
Validation Loss: 0.01604316, Validation R2: 0.442392

Epoch 166/1000
Training Loss: 0.00361012, Training R2: 0.973770
Validation Loss: 0.01584078, Validation R2: 0.461437

Epoch 167/1000
Training Loss: 0.00403726, Training R2: 0.969925
Validation Loss: 0.01596943, Validation R2: 0.453771

Epoch 168/1000
Training Loss: 0.00336374, Training R2: 0.976461
Validation Loss: 0.01600624, Validation R2: 0.452520

Epoch 169/1000
Training Loss: 0.00368835, Training R2: 0.973951
Validation Loss: 0.01593918, Validation R2: 0.449042

Epoch 170/1000
Training Loss: 0.00373933, Training R2: 0.973686
Validation Loss: 0.01643864, Validation R2: 0.410627

Epoch 171/1000
Training Loss: 0.00356465, Training R2: 0.975303
Validation Loss: 0.01671208, Validation R2: 0.396276

Epoch 172/1000
Training Loss: 0.00368789, Training R2: 0.974035
Validation Loss: 0.01700122, Validation R2: 0.395981

Epoch 173/1000
Epoch 00173: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00389675, Training R2: 0.972005
Validation Loss: 0.01652980, Validation R2: 0.427540

Epoch 174/1000
学习率已减少 4 次
Training Loss: 0.00336022, Training R2: 0.976807
Validation Loss: 0.01626344, Validation R2: 0.444894

Epoch 175/1000
Training Loss: 0.00299248, Training R2: 0.978772
Validation Loss: 0.01607423, Validation R2: 0.450532

Epoch 176/1000
Training Loss: 0.00287129, Training R2: 0.979424
Validation Loss: 0.01612291, Validation R2: 0.443738

Epoch 177/1000
Training Loss: 0.00288576, Training R2: 0.979393
Validation Loss: 0.01610820, Validation R2: 0.445007

Epoch 178/1000
Training Loss: 0.00286029, Training R2: 0.979668
Validation Loss: 0.01606109, Validation R2: 0.451406

Epoch 179/1000
Training Loss: 0.00284788, Training R2: 0.979963
Validation Loss: 0.01621662, Validation R2: 0.442939

Epoch 180/1000
Training Loss: 0.00299556, Training R2: 0.979041
Validation Loss: 0.01621867, Validation R2: 0.445096

Epoch 181/1000
Training Loss: 0.00268614, Training R2: 0.980654
Validation Loss: 0.01614993, Validation R2: 0.449943

Epoch 182/1000
Training Loss: 0.00257834, Training R2: 0.981275
Validation Loss: 0.01606368, Validation R2: 0.460019

Epoch 183/1000
Training Loss: 0.00248399, Training R2: 0.981896
Validation Loss: 0.01593060, Validation R2: 0.468684

Epoch 184/1000
Training Loss: 0.00267785, Training R2: 0.980765
Validation Loss: 0.01613686, Validation R2: 0.451844

Epoch 185/1000
Training Loss: 0.00253551, Training R2: 0.981915
Validation Loss: 0.01606855, Validation R2: 0.455671

Epoch 186/1000
Training Loss: 0.00235966, Training R2: 0.982744
Validation Loss: 0.01598606, Validation R2: 0.463098

Epoch 187/1000
Training Loss: 0.00256856, Training R2: 0.981607
Validation Loss: 0.01591377, Validation R2: 0.468725

Epoch 188/1000
Training Loss: 0.00265956, Training R2: 0.981313
Validation Loss: 0.01589018, Validation R2: 0.470632

Epoch 189/1000
Training Loss: 0.00285853, Training R2: 0.980860
Validation Loss: 0.01589789, Validation R2: 0.471763

Epoch 190/1000
Training Loss: 0.00290069, Training R2: 0.980495
Validation Loss: 0.01592604, Validation R2: 0.471725

Epoch 191/1000
Training Loss: 0.00269380, Training R2: 0.981541
Validation Loss: 0.01590358, Validation R2: 0.473615

Epoch 192/1000
Training Loss: 0.00273251, Training R2: 0.981117
Validation Loss: 0.01584520, Validation R2: 0.475231

Epoch 193/1000
Training Loss: 0.00284876, Training R2: 0.981129
Validation Loss: 0.01590453, Validation R2: 0.470421

Epoch 194/1000
Epoch 00194: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00253326, Training R2: 0.982566
Validation Loss: 0.01588644, Validation R2: 0.470157

Epoch 195/1000
学习率已减少 5 次
Training Loss: 0.00242270, Training R2: 0.983189
Validation Loss: 0.01592313, Validation R2: 0.466286

Epoch 196/1000
Training Loss: 0.00253318, Training R2: 0.982893
Validation Loss: 0.01628243, Validation R2: 0.446925

Epoch 197/1000
Training Loss: 0.00242849, Training R2: 0.983407
Validation Loss: 0.01600318, Validation R2: 0.462279

Epoch 198/1000
Training Loss: 0.00228860, Training R2: 0.984212
Validation Loss: 0.01591027, Validation R2: 0.468547

Epoch 199/1000
Training Loss: 0.00238810, Training R2: 0.983786
Validation Loss: 0.01609547, Validation R2: 0.456820

Epoch 200/1000
Training Loss: 0.00226111, Training R2: 0.984197
Validation Loss: 0.01615126, Validation R2: 0.456134

Epoch 201/1000
Training Loss: 0.00223666, Training R2: 0.983891
Validation Loss: 0.01609279, Validation R2: 0.461263

Epoch 202/1000
Training Loss: 0.00210379, Training R2: 0.984318
Validation Loss: 0.01597706, Validation R2: 0.467529

Epoch 203/1000
Training Loss: 0.00214791, Training R2: 0.984872
Validation Loss: 0.01599584, Validation R2: 0.465994

Epoch 204/1000
Training Loss: 0.00207431, Training R2: 0.985292
Validation Loss: 0.01619700, Validation R2: 0.452470

Epoch 205/1000
Training Loss: 0.00213551, Training R2: 0.984374
Validation Loss: 0.01613304, Validation R2: 0.456276

Epoch 206/1000
Training Loss: 0.00201844, Training R2: 0.984985
Validation Loss: 0.01605735, Validation R2: 0.460396

Epoch 207/1000
Training Loss: 0.00203185, Training R2: 0.984970
Validation Loss: 0.01615883, Validation R2: 0.455383

Epoch 208/1000
Training Loss: 0.00199165, Training R2: 0.985105
Validation Loss: 0.01613228, Validation R2: 0.457321

Epoch 209/1000
Training Loss: 0.00192138, Training R2: 0.985611
Validation Loss: 0.01602740, Validation R2: 0.462843

Epoch 210/1000
Training Loss: 0.00192983, Training R2: 0.985179
Validation Loss: 0.01614617, Validation R2: 0.456395

Epoch 211/1000
Training Loss: 0.00192877, Training R2: 0.985427
Validation Loss: 0.01615344, Validation R2: 0.455091

Epoch 212/1000
Training Loss: 0.00189471, Training R2: 0.985853
Validation Loss: 0.01608585, Validation R2: 0.457021

Epoch 213/1000
Training Loss: 0.00183485, Training R2: 0.985684
Validation Loss: 0.01602000, Validation R2: 0.460810

Epoch 214/1000
Training Loss: 0.00186752, Training R2: 0.985588
Validation Loss: 0.01612390, Validation R2: 0.452003

Epoch 215/1000
Epoch 00215: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00186921, Training R2: 0.985514
Validation Loss: 0.01606510, Validation R2: 0.457974

Epoch 216/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
