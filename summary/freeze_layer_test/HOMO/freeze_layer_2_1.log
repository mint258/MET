Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5293187

Epoch 1/1000
Training Loss: 0.85706456, Training R2: -876.135315
Validation Loss: 0.06656933, Validation R2: -3.732449
Saved best model with validation R2 -3.732449 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.15028484, Training R2: -32.350494
Validation Loss: 0.36680043, Validation R2: -96.607338

Epoch 3/1000
Training Loss: 0.21547012, Training R2: -58.799103
Validation Loss: 0.08231559, Validation R2: -4.897095

Epoch 4/1000
Training Loss: 0.10612744, Training R2: -11.603153
Validation Loss: 0.11388643, Validation R2: -9.320563

Epoch 5/1000
Training Loss: 0.09719476, Training R2: -10.117846
Validation Loss: 0.13784151, Validation R2: -13.683974

Epoch 6/1000
Training Loss: 0.09167318, Training R2: -9.407591
Validation Loss: 0.05372000, Validation R2: -1.814464
Saved best model with validation R2 -1.814464 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.06078787, Training R2: -3.605124
Validation Loss: 0.07972790, Validation R2: -4.331558

Epoch 8/1000
Training Loss: 0.07331357, Training R2: -5.321223
Validation Loss: 0.08903244, Validation R2: -5.698286

Epoch 9/1000
Training Loss: 0.06241253, Training R2: -3.948154
Validation Loss: 0.04318251, Validation R2: -0.936288
Saved best model with validation R2 -0.936288 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.04687330, Training R2: -1.904229
Validation Loss: 0.06418864, Validation R2: -2.617002

Epoch 11/1000
Training Loss: 0.05160192, Training R2: -2.529519
Validation Loss: 0.06582500, Validation R2: -3.001225

Epoch 12/1000
Training Loss: 0.05188538, Training R2: -2.572953
Validation Loss: 0.03777823, Validation R2: -0.582556
Saved best model with validation R2 -0.582556 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.05390781, Training R2: -2.834918
Validation Loss: 0.04919930, Validation R2: -1.332671

Epoch 14/1000
Training Loss: 0.04799097, Training R2: -2.021783
Validation Loss: 0.05579598, Validation R2: -2.004494

Epoch 15/1000
Training Loss: 0.04581155, Training R2: -1.876732
Validation Loss: 0.02685124, Validation R2: -0.037664
Saved best model with validation R2 -0.037664 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.04938447, Training R2: -2.491529
Validation Loss: 0.06927183, Validation R2: -3.131660

Epoch 17/1000
Training Loss: 0.06806470, Training R2: -4.426313
Validation Loss: 0.07262594, Validation R2: -3.668613

Epoch 18/1000
Training Loss: 0.05168590, Training R2: -2.582151
Validation Loss: 0.04106712, Validation R2: -0.763882

Epoch 19/1000
Training Loss: 0.03706476, Training R2: -0.840200
Validation Loss: 0.05289434, Validation R2: -1.632712

Epoch 20/1000
Training Loss: 0.03942932, Training R2: -1.163210
Validation Loss: 0.03137474, Validation R2: -0.177859

Epoch 21/1000
Training Loss: 0.03135079, Training R2: -0.424291
Validation Loss: 0.03714233, Validation R2: -0.508413

Epoch 22/1000
Training Loss: 0.02837163, Training R2: -0.217402
Validation Loss: 0.02805075, Validation R2: -0.015392
Saved best model with validation R2 -0.015392 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.02356754, Training R2: 0.092328
Validation Loss: 0.03525979, Validation R2: -0.393067

Epoch 24/1000
Training Loss: 0.02923859, Training R2: -0.248093
Validation Loss: 0.03718362, Validation R2: -0.518461

Epoch 25/1000
Training Loss: 0.03212493, Training R2: -0.409521
Validation Loss: 0.03385496, Validation R2: -0.318879

Epoch 26/1000
Training Loss: 0.02867986, Training R2: -0.187858
Validation Loss: 0.02844788, Validation R2: -0.029007

Epoch 27/1000
Training Loss: 0.02410554, Training R2: 0.098519
Validation Loss: 0.02743564, Validation R2: 0.032009
Saved best model with validation R2 0.032009 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.02324273, Training R2: 0.140256
Validation Loss: 0.03516844, Validation R2: -0.374879

Epoch 29/1000
Training Loss: 0.03097546, Training R2: -0.327748
Validation Loss: 0.03837619, Validation R2: -0.594156

Epoch 30/1000
Training Loss: 0.03255569, Training R2: -0.442147
Validation Loss: 0.02585842, Validation R2: 0.122061
Saved best model with validation R2 0.122061 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.02503060, Training R2: 0.051750
Validation Loss: 0.02631893, Validation R2: 0.113356

Epoch 32/1000
Training Loss: 0.02434103, Training R2: 0.126494
Validation Loss: 0.02499123, Validation R2: 0.172777
Saved best model with validation R2 0.172777 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.02014289, Training R2: 0.341268
Validation Loss: 0.02188278, Validation R2: 0.298755
Saved best model with validation R2 0.298755 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.01851392, Training R2: 0.416070
Validation Loss: 0.02929175, Validation R2: 0.028714

Epoch 35/1000
Training Loss: 0.02118419, Training R2: 0.334048
Validation Loss: 0.02134119, Validation R2: 0.320746
Saved best model with validation R2 0.320746 to best_finetuned_model.pth

Epoch 36/1000
Training Loss: 0.02019819, Training R2: 0.340920
Validation Loss: 0.03050365, Validation R2: -0.073943

Epoch 37/1000
Training Loss: 0.02192184, Training R2: 0.266921
Validation Loss: 0.02799611, Validation R2: 0.117335

Epoch 38/1000
Training Loss: 0.02192164, Training R2: 0.279372
Validation Loss: 0.02369132, Validation R2: 0.310134

Epoch 39/1000
Training Loss: 0.01850728, Training R2: 0.457183
Validation Loss: 0.01932965, Validation R2: 0.439013
Saved best model with validation R2 0.439013 to best_finetuned_model.pth

Epoch 40/1000
Training Loss: 0.01925680, Training R2: 0.434160
Validation Loss: 0.02438376, Validation R2: 0.247944

Epoch 41/1000
Training Loss: 0.02078875, Training R2: 0.364728
Validation Loss: 0.02462574, Validation R2: 0.282078

Epoch 42/1000
Training Loss: 0.02073618, Training R2: 0.366175
Validation Loss: 0.02480061, Validation R2: 0.227956

Epoch 43/1000
Training Loss: 0.02092151, Training R2: 0.364781
Validation Loss: 0.02051918, Validation R2: 0.408155

Epoch 44/1000
Training Loss: 0.01858057, Training R2: 0.448939
Validation Loss: 0.02934989, Validation R2: 0.076688

Epoch 45/1000
Training Loss: 0.01986540, Training R2: 0.415057
Validation Loss: 0.02904632, Validation R2: 0.034600

Epoch 46/1000
Training Loss: 0.02077220, Training R2: 0.372308
Validation Loss: 0.02667665, Validation R2: 0.196794

Epoch 47/1000
Training Loss: 0.01963095, Training R2: 0.414457
Validation Loss: 0.02059449, Validation R2: 0.424521

Epoch 48/1000
Training Loss: 0.01452758, Training R2: 0.641467
Validation Loss: 0.01919266, Validation R2: 0.479849
Saved best model with validation R2 0.479849 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.02152015, Training R2: 0.242718
Validation Loss: 0.01906729, Validation R2: 0.464034

Epoch 50/1000
Training Loss: 0.03637828, Training R2: -0.772661
Validation Loss: 0.04905868, Validation R2: -1.197992

Epoch 51/1000
Training Loss: 0.03380417, Training R2: -0.459983
Validation Loss: 0.02737203, Validation R2: 0.079921

Epoch 52/1000
Training Loss: 0.03755861, Training R2: -0.736151
Validation Loss: 0.03240221, Validation R2: -0.189869

Epoch 53/1000
Training Loss: 0.02884816, Training R2: -0.070407
Validation Loss: 0.02913845, Validation R2: 0.000206

Epoch 54/1000
Training Loss: 0.03105233, Training R2: -0.187429
Validation Loss: 0.03157396, Validation R2: -0.125409

Epoch 55/1000
Training Loss: 0.03248104, Training R2: -0.249028
Validation Loss: 0.03017814, Validation R2: -0.033453

Epoch 56/1000
Training Loss: 0.03244799, Training R2: -0.275345
Validation Loss: 0.02967743, Validation R2: 0.003907

Epoch 57/1000
Training Loss: 0.03166286, Training R2: -0.224447
Validation Loss: 0.03368805, Validation R2: -0.194626

Epoch 58/1000
Training Loss: 0.03305965, Training R2: -0.291102
Validation Loss: 0.02853236, Validation R2: 0.046818

Epoch 59/1000
Training Loss: 0.03412429, Training R2: -0.395545
Validation Loss: 0.02994958, Validation R2: -0.039322

Epoch 60/1000
Training Loss: 0.03127179, Training R2: -0.215576
Validation Loss: 0.03188330, Validation R2: -0.138354

Epoch 61/1000
Training Loss: 0.02875092, Training R2: -0.045905
Validation Loss: 0.02156721, Validation R2: 0.349825

Epoch 62/1000
Training Loss: 0.02470284, Training R2: 0.142458
Validation Loss: 0.03157195, Validation R2: -0.109208

Epoch 63/1000
Training Loss: 0.03056193, Training R2: -0.143992
Validation Loss: 0.02771614, Validation R2: 0.083924

Epoch 64/1000
Training Loss: 0.02821117, Training R2: 0.009547
Validation Loss: 0.03602768, Validation R2: -0.348143

Epoch 65/1000
Training Loss: 0.02665220, Training R2: 0.057872
Validation Loss: 0.02287061, Validation R2: 0.305722

Epoch 66/1000
Training Loss: 0.02760512, Training R2: 0.006755
Validation Loss: 0.03700265, Validation R2: -0.384735

Epoch 67/1000
Training Loss: 0.03106184, Training R2: -0.181391
Validation Loss: 0.02145736, Validation R2: 0.359258

Epoch 68/1000
Training Loss: 0.02053047, Training R2: 0.389783
Validation Loss: 0.02251052, Validation R2: 0.323524

Epoch 69/1000
Epoch 00069: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.02674806, Training R2: 0.048349
Validation Loss: 0.03047755, Validation R2: -0.051225

Epoch 70/1000
学习率已减少 1 次
Training Loss: 0.02328628, Training R2: 0.243813
Validation Loss: 0.01815698, Validation R2: 0.494711
Saved best model with validation R2 0.494711 to best_finetuned_model.pth

Epoch 71/1000
Training Loss: 0.01687673, Training R2: 0.567699
Validation Loss: 0.03036137, Validation R2: 0.071519

Epoch 72/1000
Training Loss: 0.01984763, Training R2: 0.437480
Validation Loss: 0.02018534, Validation R2: 0.460308

Epoch 73/1000
Training Loss: 0.01608900, Training R2: 0.599791
Validation Loss: 0.01783500, Validation R2: 0.497573
Saved best model with validation R2 0.497573 to best_finetuned_model.pth

Epoch 74/1000
Training Loss: 0.01582634, Training R2: 0.626137
Validation Loss: 0.01913112, Validation R2: 0.452399

Epoch 75/1000
Training Loss: 0.01423334, Training R2: 0.689109
Validation Loss: 0.01914086, Validation R2: 0.463216

Epoch 76/1000
Training Loss: 0.01374795, Training R2: 0.712726
Validation Loss: 0.01692358, Validation R2: 0.541050
Saved best model with validation R2 0.541050 to best_finetuned_model.pth

Epoch 77/1000
Training Loss: 0.01196799, Training R2: 0.771602
Validation Loss: 0.01920907, Validation R2: 0.465248

Epoch 78/1000
Training Loss: 0.01387402, Training R2: 0.710677
Validation Loss: 0.01851329, Validation R2: 0.488643

Epoch 79/1000
Training Loss: 0.01264497, Training R2: 0.754298
Validation Loss: 0.01656447, Validation R2: 0.552886
Saved best model with validation R2 0.552886 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.01051245, Training R2: 0.814328
Validation Loss: 0.01570114, Validation R2: 0.583895
Saved best model with validation R2 0.583895 to best_finetuned_model.pth

Epoch 81/1000
Training Loss: 0.00937729, Training R2: 0.853711
Validation Loss: 0.01766266, Validation R2: 0.520605

Epoch 82/1000
Training Loss: 0.01154291, Training R2: 0.794566
Validation Loss: 0.01649456, Validation R2: 0.586216
Saved best model with validation R2 0.586216 to best_finetuned_model.pth

Epoch 83/1000
Training Loss: 0.00960547, Training R2: 0.846515
Validation Loss: 0.01795535, Validation R2: 0.540442

Epoch 84/1000
Training Loss: 0.01010953, Training R2: 0.834761
Validation Loss: 0.01553059, Validation R2: 0.597566
Saved best model with validation R2 0.597566 to best_finetuned_model.pth

Epoch 85/1000
Training Loss: 0.01050670, Training R2: 0.827926
Validation Loss: 0.01518134, Validation R2: 0.605494
Saved best model with validation R2 0.605494 to best_finetuned_model.pth

Epoch 86/1000
Training Loss: 0.00761211, Training R2: 0.895276
Validation Loss: 0.01651453, Validation R2: 0.586927

Epoch 87/1000
Training Loss: 0.00743911, Training R2: 0.903375
Validation Loss: 0.01616138, Validation R2: 0.594311

Epoch 88/1000
Training Loss: 0.00849972, Training R2: 0.883448
Validation Loss: 0.01567459, Validation R2: 0.602032

Epoch 89/1000
Training Loss: 0.00670954, Training R2: 0.914914
Validation Loss: 0.01663019, Validation R2: 0.563544

Epoch 90/1000
Training Loss: 0.00900918, Training R2: 0.872185
Validation Loss: 0.02341522, Validation R2: 0.396192

Epoch 91/1000
Training Loss: 0.01677732, Training R2: 0.636084
Validation Loss: 0.02919094, Validation R2: 0.176765

Epoch 92/1000
Training Loss: 0.01936927, Training R2: 0.519862
Validation Loss: 0.02003948, Validation R2: 0.499238

Epoch 93/1000
Training Loss: 0.01310078, Training R2: 0.767479
Validation Loss: 0.02971734, Validation R2: 0.155110

Epoch 94/1000
Training Loss: 0.02014498, Training R2: 0.513359
Validation Loss: 0.02186067, Validation R2: 0.437008

Epoch 95/1000
Training Loss: 0.01504906, Training R2: 0.709872
Validation Loss: 0.02438035, Validation R2: 0.346808

Epoch 96/1000
Training Loss: 0.01723839, Training R2: 0.631856
Validation Loss: 0.02482543, Validation R2: 0.326043

Epoch 97/1000
Training Loss: 0.01709884, Training R2: 0.618656
Validation Loss: 0.02389093, Validation R2: 0.360548

Epoch 98/1000
Training Loss: 0.01649571, Training R2: 0.646039
Validation Loss: 0.02156998, Validation R2: 0.435987

Epoch 99/1000
Training Loss: 0.01457380, Training R2: 0.717535
Validation Loss: 0.02161820, Validation R2: 0.439496

Epoch 100/1000
Training Loss: 0.01504204, Training R2: 0.694950
Validation Loss: 0.02376927, Validation R2: 0.375588

Epoch 101/1000
Training Loss: 0.01639816, Training R2: 0.671629
Validation Loss: 0.02179750, Validation R2: 0.444005

Epoch 102/1000
Training Loss: 0.01472965, Training R2: 0.713639
Validation Loss: 0.02275495, Validation R2: 0.416855

Epoch 103/1000
Training Loss: 0.01501624, Training R2: 0.696121
Validation Loss: 0.02521723, Validation R2: 0.335244

Epoch 104/1000
Training Loss: 0.01683141, Training R2: 0.629287
Validation Loss: 0.01613126, Validation R2: 0.591725

Epoch 105/1000
Training Loss: 0.01061191, Training R2: 0.820536
Validation Loss: 0.01586747, Validation R2: 0.574879

Epoch 106/1000
Training Loss: 0.01074771, Training R2: 0.816651
Validation Loss: 0.01507820, Validation R2: 0.615285
Saved best model with validation R2 0.615285 to best_finetuned_model.pth

Epoch 107/1000
Training Loss: 0.01089749, Training R2: 0.813794
Validation Loss: 0.01508911, Validation R2: 0.617186
Saved best model with validation R2 0.617186 to best_finetuned_model.pth

Epoch 108/1000
Training Loss: 0.01144340, Training R2: 0.796991
Validation Loss: 0.01624474, Validation R2: 0.575957

Epoch 109/1000
Training Loss: 0.01658892, Training R2: 0.650227
Validation Loss: 0.02436769, Validation R2: 0.289384

Epoch 110/1000
Training Loss: 0.01494813, Training R2: 0.684483
Validation Loss: 0.01586151, Validation R2: 0.596552

Epoch 111/1000
Training Loss: 0.00854406, Training R2: 0.883407
Validation Loss: 0.01570279, Validation R2: 0.621342
Saved best model with validation R2 0.621342 to best_finetuned_model.pth

Epoch 112/1000
Training Loss: 0.00826207, Training R2: 0.892807
Validation Loss: 0.01646572, Validation R2: 0.598348

Epoch 113/1000
Training Loss: 0.00720293, Training R2: 0.913445
Validation Loss: 0.01569134, Validation R2: 0.597364

Epoch 114/1000
Training Loss: 0.00784458, Training R2: 0.902283
Validation Loss: 0.01435137, Validation R2: 0.639925
Saved best model with validation R2 0.639925 to best_finetuned_model.pth

Epoch 115/1000
Training Loss: 0.00783764, Training R2: 0.904040
Validation Loss: 0.01401525, Validation R2: 0.650807
Saved best model with validation R2 0.650807 to best_finetuned_model.pth

Epoch 116/1000
Training Loss: 0.00794416, Training R2: 0.903041
Validation Loss: 0.01459521, Validation R2: 0.645951

Epoch 117/1000
Training Loss: 0.00876668, Training R2: 0.882585
Validation Loss: 0.01492351, Validation R2: 0.638857

Epoch 118/1000
Training Loss: 0.00747964, Training R2: 0.915504
Validation Loss: 0.01688149, Validation R2: 0.597071

Epoch 119/1000
Training Loss: 0.00866893, Training R2: 0.887790
Validation Loss: 0.01729196, Validation R2: 0.577415

Epoch 120/1000
Training Loss: 0.00844186, Training R2: 0.899513
Validation Loss: 0.01452347, Validation R2: 0.661995
Saved best model with validation R2 0.661995 to best_finetuned_model.pth

Epoch 121/1000
Training Loss: 0.00777191, Training R2: 0.908999
Validation Loss: 0.01509478, Validation R2: 0.645582

Epoch 122/1000
Training Loss: 0.00837338, Training R2: 0.896886
Validation Loss: 0.01512550, Validation R2: 0.632924

Epoch 123/1000
Training Loss: 0.00632741, Training R2: 0.931536
Validation Loss: 0.01499365, Validation R2: 0.639795

Epoch 124/1000
Training Loss: 0.00773874, Training R2: 0.913126
Validation Loss: 0.01498481, Validation R2: 0.631317

Epoch 125/1000
Training Loss: 0.00803946, Training R2: 0.901742
Validation Loss: 0.01787508, Validation R2: 0.562932

Epoch 126/1000
Training Loss: 0.01319989, Training R2: 0.780275
Validation Loss: 0.03671905, Validation R2: -0.159936

Epoch 127/1000
Training Loss: 0.02191136, Training R2: 0.369448
Validation Loss: 0.02556582, Validation R2: 0.319676

Epoch 128/1000
Training Loss: 0.01674376, Training R2: 0.637089
Validation Loss: 0.01609731, Validation R2: 0.606516

Epoch 129/1000
Training Loss: 0.00938565, Training R2: 0.872024
Validation Loss: 0.01749014, Validation R2: 0.578166

Epoch 130/1000
Training Loss: 0.00778772, Training R2: 0.908027
Validation Loss: 0.01586376, Validation R2: 0.619144

Epoch 131/1000
Training Loss: 0.00678371, Training R2: 0.925667
Validation Loss: 0.01530905, Validation R2: 0.639564

Epoch 132/1000
Training Loss: 0.00880932, Training R2: 0.884819
Validation Loss: 0.01584906, Validation R2: 0.618230

Epoch 133/1000
Training Loss: 0.00655045, Training R2: 0.929769
Validation Loss: 0.01469305, Validation R2: 0.645604

Epoch 134/1000
Training Loss: 0.00633308, Training R2: 0.932638
Validation Loss: 0.01464044, Validation R2: 0.647911

Epoch 135/1000
Training Loss: 0.00937975, Training R2: 0.872796
Validation Loss: 0.02314636, Validation R2: 0.349960

Epoch 136/1000
Training Loss: 0.02158317, Training R2: 0.425265
Validation Loss: 0.01566473, Validation R2: 0.626396

Epoch 137/1000
Training Loss: 0.03288584, Training R2: -0.435815
Validation Loss: 0.03278375, Validation R2: 0.020331

Epoch 138/1000
Training Loss: 0.03316285, Training R2: -0.222107
Validation Loss: 0.03288106, Validation R2: -0.118922

Epoch 139/1000
Training Loss: 0.02744785, Training R2: 0.064909
Validation Loss: 0.02397952, Validation R2: 0.344953

Epoch 140/1000
Training Loss: 0.02911893, Training R2: -0.027943
Validation Loss: 0.03434153, Validation R2: -0.073178

Epoch 141/1000
Epoch 00141: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.03285676, Training R2: -0.216091
Validation Loss: 0.03518132, Validation R2: -0.213382

Epoch 142/1000
学习率已减少 2 次
Training Loss: 0.02312812, Training R2: 0.278314
Validation Loss: 0.03259805, Validation R2: 0.044174

Epoch 143/1000
Training Loss: 0.01863817, Training R2: 0.529858
Validation Loss: 0.01954971, Validation R2: 0.482094

Epoch 144/1000
Training Loss: 0.01269513, Training R2: 0.775092
Validation Loss: 0.01407880, Validation R2: 0.669404
Saved best model with validation R2 0.669404 to best_finetuned_model.pth

Epoch 145/1000
Training Loss: 0.01185377, Training R2: 0.802952
Validation Loss: 0.01965960, Validation R2: 0.538220

Epoch 146/1000
Training Loss: 0.01071873, Training R2: 0.845892
Validation Loss: 0.01383159, Validation R2: 0.676686
Saved best model with validation R2 0.676686 to best_finetuned_model.pth

Epoch 147/1000
Training Loss: 0.00887577, Training R2: 0.886564
Validation Loss: 0.01584630, Validation R2: 0.612237

Epoch 148/1000
Training Loss: 0.00785409, Training R2: 0.907349
Validation Loss: 0.01643170, Validation R2: 0.592261

Epoch 149/1000
Training Loss: 0.00919861, Training R2: 0.885488
Validation Loss: 0.01432802, Validation R2: 0.655161

Epoch 150/1000
Training Loss: 0.00648270, Training R2: 0.934551
Validation Loss: 0.01427848, Validation R2: 0.657592

Epoch 151/1000
Training Loss: 0.00600905, Training R2: 0.943826
Validation Loss: 0.01400295, Validation R2: 0.664476

Epoch 152/1000
Training Loss: 0.00470281, Training R2: 0.962432
Validation Loss: 0.01620170, Validation R2: 0.601166

Epoch 153/1000
Training Loss: 0.00925137, Training R2: 0.888752
Validation Loss: 0.01439335, Validation R2: 0.646450

Epoch 154/1000
Training Loss: 0.00663029, Training R2: 0.937134
Validation Loss: 0.01418453, Validation R2: 0.651640

Epoch 155/1000
Training Loss: 0.00614595, Training R2: 0.942964
Validation Loss: 0.01626757, Validation R2: 0.593182

Epoch 156/1000
Training Loss: 0.00970047, Training R2: 0.884163
Validation Loss: 0.01336847, Validation R2: 0.673693

Epoch 157/1000
Training Loss: 0.00576904, Training R2: 0.945041
Validation Loss: 0.01333871, Validation R2: 0.675573

Epoch 158/1000
Training Loss: 0.00464691, Training R2: 0.963649
Validation Loss: 0.01339764, Validation R2: 0.672546

Epoch 159/1000
Training Loss: 0.00407248, Training R2: 0.969207
Validation Loss: 0.01418433, Validation R2: 0.648883

Epoch 160/1000
Training Loss: 0.00498688, Training R2: 0.959723
Validation Loss: 0.01359745, Validation R2: 0.668841

Epoch 161/1000
Training Loss: 0.00455239, Training R2: 0.965626
Validation Loss: 0.01356900, Validation R2: 0.667483

Epoch 162/1000
Training Loss: 0.00336777, Training R2: 0.976936
Validation Loss: 0.01371157, Validation R2: 0.666616

Epoch 163/1000
Training Loss: 0.00407867, Training R2: 0.971606
Validation Loss: 0.01429413, Validation R2: 0.657431

Epoch 164/1000
Training Loss: 0.00360003, Training R2: 0.976337
Validation Loss: 0.01368465, Validation R2: 0.669495

Epoch 165/1000
Training Loss: 0.00340398, Training R2: 0.977815
Validation Loss: 0.01383918, Validation R2: 0.662384

Epoch 166/1000
Training Loss: 0.00431554, Training R2: 0.970858
Validation Loss: 0.01382093, Validation R2: 0.666307

Epoch 167/1000
Epoch 00167: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00282713, Training R2: 0.983074
Validation Loss: 0.01371923, Validation R2: 0.671454

Epoch 168/1000
学习率已减少 3 次
Training Loss: 0.00267369, Training R2: 0.984510
Validation Loss: 0.01374804, Validation R2: 0.671173

Epoch 169/1000
Training Loss: 0.00279132, Training R2: 0.984341
Validation Loss: 0.01387581, Validation R2: 0.666336

Epoch 170/1000
Training Loss: 0.00264935, Training R2: 0.985280
Validation Loss: 0.01373551, Validation R2: 0.668565

Epoch 171/1000
Training Loss: 0.00258376, Training R2: 0.985124
Validation Loss: 0.01392878, Validation R2: 0.664844

Epoch 172/1000
Training Loss: 0.00324554, Training R2: 0.981876
Validation Loss: 0.01365438, Validation R2: 0.675257

Epoch 173/1000
Training Loss: 0.00306624, Training R2: 0.982764
Validation Loss: 0.01358004, Validation R2: 0.676017

Epoch 174/1000
Training Loss: 0.00265518, Training R2: 0.985922
Validation Loss: 0.01381123, Validation R2: 0.667752

Epoch 175/1000
Training Loss: 0.00246358, Training R2: 0.986406
Validation Loss: 0.01372178, Validation R2: 0.668992

Epoch 176/1000
Training Loss: 0.00219813, Training R2: 0.988164
Validation Loss: 0.01386617, Validation R2: 0.666871

Epoch 177/1000
Training Loss: 0.00276496, Training R2: 0.985201
Validation Loss: 0.01370114, Validation R2: 0.673405

Epoch 178/1000
Training Loss: 0.00278776, Training R2: 0.985223
Validation Loss: 0.01368806, Validation R2: 0.673752

Epoch 179/1000
Training Loss: 0.00197154, Training R2: 0.989800
Validation Loss: 0.01360259, Validation R2: 0.673583

Epoch 180/1000
Training Loss: 0.00185643, Training R2: 0.990332
Validation Loss: 0.01382134, Validation R2: 0.667829

Epoch 181/1000
Training Loss: 0.00223279, Training R2: 0.988864
Validation Loss: 0.01361554, Validation R2: 0.675380

Epoch 182/1000
Training Loss: 0.00174718, Training R2: 0.991086
Validation Loss: 0.01357348, Validation R2: 0.677908
Saved best model with validation R2 0.677908 to best_finetuned_model.pth

Epoch 183/1000
Training Loss: 0.00175077, Training R2: 0.991101
Validation Loss: 0.01448595, Validation R2: 0.654659

Epoch 184/1000
Training Loss: 0.00485112, Training R2: 0.967392
Validation Loss: 0.01384425, Validation R2: 0.670090

Epoch 185/1000
Training Loss: 0.00324994, Training R2: 0.983685
Validation Loss: 0.01491104, Validation R2: 0.644763

Epoch 186/1000
Training Loss: 0.00517668, Training R2: 0.968286
Validation Loss: 0.01415065, Validation R2: 0.664763

Epoch 187/1000
Training Loss: 0.00396918, Training R2: 0.977588
Validation Loss: 0.01424054, Validation R2: 0.663197

Epoch 188/1000
Training Loss: 0.00417658, Training R2: 0.976436
Validation Loss: 0.01419600, Validation R2: 0.665324

Epoch 189/1000
Training Loss: 0.00418039, Training R2: 0.975360
Validation Loss: 0.01447061, Validation R2: 0.658716

Epoch 190/1000
Training Loss: 0.00426813, Training R2: 0.974689
Validation Loss: 0.01470353, Validation R2: 0.653707

Epoch 191/1000
Training Loss: 0.00455512, Training R2: 0.972209
Validation Loss: 0.01456605, Validation R2: 0.655427

Epoch 192/1000
Training Loss: 0.00415878, Training R2: 0.975640
Validation Loss: 0.01405458, Validation R2: 0.663364

Epoch 193/1000
Training Loss: 0.00325619, Training R2: 0.983084
Validation Loss: 0.01442536, Validation R2: 0.652540

Epoch 194/1000
Training Loss: 0.00435192, Training R2: 0.972794
Validation Loss: 0.01426913, Validation R2: 0.654540

Epoch 195/1000
Training Loss: 0.00413751, Training R2: 0.976092
Validation Loss: 0.01401668, Validation R2: 0.661856

Epoch 196/1000
Training Loss: 0.00347997, Training R2: 0.981184
Validation Loss: 0.01530304, Validation R2: 0.635521

Epoch 197/1000
Training Loss: 0.00526982, Training R2: 0.965170
Validation Loss: 0.01389864, Validation R2: 0.668943

Epoch 198/1000
Training Loss: 0.00312498, Training R2: 0.984452
Validation Loss: 0.01396440, Validation R2: 0.667190

Epoch 199/1000
Training Loss: 0.00248582, Training R2: 0.989112
Validation Loss: 0.01390175, Validation R2: 0.669441

Epoch 200/1000
Training Loss: 0.00227064, Training R2: 0.989858
Validation Loss: 0.01385069, Validation R2: 0.668677

Epoch 201/1000
Training Loss: 0.00219003, Training R2: 0.990534
Validation Loss: 0.01386585, Validation R2: 0.663933

Epoch 202/1000
Training Loss: 0.00440787, Training R2: 0.973040
Validation Loss: 0.01377404, Validation R2: 0.668490

Epoch 203/1000
Epoch 00203: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00371149, Training R2: 0.980714
Validation Loss: 0.01421580, Validation R2: 0.656652

Epoch 204/1000
学习率已减少 4 次
Training Loss: 0.00435563, Training R2: 0.972874
Validation Loss: 0.01427404, Validation R2: 0.658382

Epoch 205/1000
Training Loss: 0.00337215, Training R2: 0.982709
Validation Loss: 0.01362841, Validation R2: 0.675534

Epoch 206/1000
Training Loss: 0.00232979, Training R2: 0.989803
Validation Loss: 0.01366145, Validation R2: 0.675440

Epoch 207/1000
Training Loss: 0.00221809, Training R2: 0.990694
Validation Loss: 0.01367681, Validation R2: 0.674051

Epoch 208/1000
Training Loss: 0.00202158, Training R2: 0.991595
Validation Loss: 0.01371724, Validation R2: 0.672645

Epoch 209/1000
Training Loss: 0.00229011, Training R2: 0.990098
Validation Loss: 0.01373667, Validation R2: 0.673178

Epoch 210/1000
Training Loss: 0.00164801, Training R2: 0.993353
Validation Loss: 0.01376869, Validation R2: 0.672020

Epoch 211/1000
Training Loss: 0.00150820, Training R2: 0.993714
Validation Loss: 0.01373362, Validation R2: 0.673077

Epoch 212/1000
Training Loss: 0.00181673, Training R2: 0.992592
Validation Loss: 0.01374497, Validation R2: 0.672873

Epoch 213/1000
Training Loss: 0.00231546, Training R2: 0.990342
Validation Loss: 0.01380237, Validation R2: 0.672086

Epoch 214/1000
Training Loss: 0.00248588, Training R2: 0.989941
Validation Loss: 0.01376989, Validation R2: 0.674641

Epoch 215/1000
Training Loss: 0.00161934, Training R2: 0.993680
Validation Loss: 0.01378299, Validation R2: 0.674292

Epoch 216/1000
Training Loss: 0.00147591, Training R2: 0.994007
Validation Loss: 0.01379778, Validation R2: 0.673003

Epoch 217/1000
Training Loss: 0.00131751, Training R2: 0.994559
Validation Loss: 0.01376756, Validation R2: 0.673805

Epoch 218/1000
Training Loss: 0.00133397, Training R2: 0.994666
Validation Loss: 0.01371216, Validation R2: 0.675928

Epoch 219/1000
Training Loss: 0.00119623, Training R2: 0.995173
Validation Loss: 0.01369526, Validation R2: 0.675649

Epoch 220/1000
Training Loss: 0.00134716, Training R2: 0.994644
Validation Loss: 0.01377530, Validation R2: 0.673898

Epoch 221/1000
Training Loss: 0.00121545, Training R2: 0.995090
Validation Loss: 0.01371168, Validation R2: 0.674487

Epoch 222/1000
Training Loss: 0.00123546, Training R2: 0.994979
Validation Loss: 0.01368145, Validation R2: 0.676731

Epoch 223/1000
Training Loss: 0.00121255, Training R2: 0.994901
Validation Loss: 0.01362460, Validation R2: 0.676876

Epoch 224/1000
Epoch 00224: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00101714, Training R2: 0.995437
Validation Loss: 0.01374057, Validation R2: 0.673481

Epoch 225/1000
学习率已减少 5 次
Training Loss: 0.00110159, Training R2: 0.995402
Validation Loss: 0.01371445, Validation R2: 0.673960

Epoch 226/1000
Training Loss: 0.00097715, Training R2: 0.995546
Validation Loss: 0.01369090, Validation R2: 0.674946

Epoch 227/1000
Training Loss: 0.00096043, Training R2: 0.995638
Validation Loss: 0.01368360, Validation R2: 0.675140

Epoch 228/1000
Training Loss: 0.00100687, Training R2: 0.995540
Validation Loss: 0.01369895, Validation R2: 0.675308

Epoch 229/1000
Training Loss: 0.00110349, Training R2: 0.995397
Validation Loss: 0.01368886, Validation R2: 0.675351

Epoch 230/1000
Training Loss: 0.00100769, Training R2: 0.995665
Validation Loss: 0.01368215, Validation R2: 0.675287

Epoch 231/1000
Training Loss: 0.00093170, Training R2: 0.995837
Validation Loss: 0.01373303, Validation R2: 0.674955

Epoch 232/1000
Training Loss: 0.00081270, Training R2: 0.996048
Validation Loss: 0.01370023, Validation R2: 0.674741

Epoch 233/1000
Training Loss: 0.00086071, Training R2: 0.995899
Validation Loss: 0.01371909, Validation R2: 0.674621

Epoch 234/1000
Training Loss: 0.00089874, Training R2: 0.995896
Validation Loss: 0.01370686, Validation R2: 0.674985

Epoch 235/1000
Training Loss: 0.00112136, Training R2: 0.995422
Validation Loss: 0.01368035, Validation R2: 0.675094

Epoch 236/1000
Training Loss: 0.00152791, Training R2: 0.994661
Validation Loss: 0.01370005, Validation R2: 0.675711

Epoch 237/1000
Training Loss: 0.00100700, Training R2: 0.995723
Validation Loss: 0.01370012, Validation R2: 0.676198

Epoch 238/1000
Training Loss: 0.00090029, Training R2: 0.996057
Validation Loss: 0.01368063, Validation R2: 0.676303

Epoch 239/1000
Training Loss: 0.00130159, Training R2: 0.995338
Validation Loss: 0.01362368, Validation R2: 0.676636

Epoch 240/1000
Training Loss: 0.00115134, Training R2: 0.995394
Validation Loss: 0.01365312, Validation R2: 0.676039

Epoch 241/1000
Training Loss: 0.00141319, Training R2: 0.994754
Validation Loss: 0.01366165, Validation R2: 0.676816

Epoch 242/1000
Training Loss: 0.00113869, Training R2: 0.995474
Validation Loss: 0.01366547, Validation R2: 0.677274

Epoch 243/1000
Training Loss: 0.00089356, Training R2: 0.996092
Validation Loss: 0.01366132, Validation R2: 0.676556

Epoch 244/1000
Training Loss: 0.00091068, Training R2: 0.995957
Validation Loss: 0.01368469, Validation R2: 0.674903

Epoch 245/1000
Epoch 00245: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00094860, Training R2: 0.995967
Validation Loss: 0.01369104, Validation R2: 0.674053

Epoch 246/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
