Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)

Frozen layers status:
emb_z.emb.weight: Trainable
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5317507

Epoch 1/1000
Training Loss: 0.84940684, Training R2: -860.641052
Validation Loss: 0.06317773, Validation R2: -3.181878
Saved best model with validation R2 -3.181878 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.13881134, Training R2: -28.748037
Validation Loss: 0.34855518, Validation R2: -87.140526

Epoch 3/1000
Training Loss: 0.22218228, Training R2: -55.876595
Validation Loss: 0.14338809, Validation R2: -14.561872

Epoch 4/1000
Training Loss: 0.09901460, Training R2: -10.537771
Validation Loss: 0.10054924, Validation R2: -6.958610

Epoch 5/1000
Training Loss: 0.07312980, Training R2: -5.951119
Validation Loss: 0.04372645, Validation R2: -0.943255
Saved best model with validation R2 -0.943255 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.05862892, Training R2: -3.183607
Validation Loss: 0.03685308, Validation R2: -0.457014
Saved best model with validation R2 -0.457014 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.02966878, Training R2: -0.356344
Validation Loss: 0.02977830, Validation R2: -0.102108
Saved best model with validation R2 -0.102108 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.02807774, Training R2: -0.241969
Validation Loss: 0.05989785, Validation R2: -2.165404

Epoch 9/1000
Training Loss: 0.04649521, Training R2: -1.705059
Validation Loss: 0.03460942, Validation R2: -0.327281

Epoch 10/1000
Training Loss: 0.03533021, Training R2: -0.744617
Validation Loss: 0.05032510, Validation R2: -1.335137

Epoch 11/1000
Training Loss: 0.04140194, Training R2: -1.218582
Validation Loss: 0.03511000, Validation R2: -0.337085

Epoch 12/1000
Training Loss: 0.03234618, Training R2: -0.501677
Validation Loss: 0.05052019, Validation R2: -1.329173

Epoch 13/1000
Training Loss: 0.04166756, Training R2: -1.242064
Validation Loss: 0.03310007, Validation R2: -0.214666

Epoch 14/1000
Training Loss: 0.03189072, Training R2: -0.400820
Validation Loss: 0.04591871, Validation R2: -0.953186

Epoch 15/1000
Training Loss: 0.03749190, Training R2: -0.813851
Validation Loss: 0.03814741, Validation R2: -0.437717

Epoch 16/1000
Training Loss: 0.03330740, Training R2: -0.513724
Validation Loss: 0.05305098, Validation R2: -1.445805

Epoch 17/1000
Training Loss: 0.04152489, Training R2: -1.149208
Validation Loss: 0.03113897, Validation R2: -0.056046
Saved best model with validation R2 -0.056046 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.02966636, Training R2: -0.230497
Validation Loss: 0.04346516, Validation R2: -0.713784

Epoch 19/1000
Training Loss: 0.03460996, Training R2: -0.578049
Validation Loss: 0.04243346, Validation R2: -0.638519

Epoch 20/1000
Training Loss: 0.03609560, Training R2: -0.619857
Validation Loss: 0.04030516, Validation R2: -0.494279

Epoch 21/1000
Training Loss: 0.03279044, Training R2: -0.381273
Validation Loss: 0.03695959, Validation R2: -0.289816

Epoch 22/1000
Training Loss: 0.03097744, Training R2: -0.300758
Validation Loss: 0.05014122, Validation R2: -1.142644

Epoch 23/1000
Training Loss: 0.04267744, Training R2: -1.209879
Validation Loss: 0.03352695, Validation R2: -0.103194

Epoch 24/1000
Training Loss: 0.02958329, Training R2: -0.180032
Validation Loss: 0.04152381, Validation R2: -0.562127

Epoch 25/1000
Training Loss: 0.03465489, Training R2: -0.541697
Validation Loss: 0.03963655, Validation R2: -0.445022

Epoch 26/1000
Training Loss: 0.03286623, Training R2: -0.374642
Validation Loss: 0.04110723, Validation R2: -0.528331

Epoch 27/1000
Training Loss: 0.03708485, Training R2: -0.684394
Validation Loss: 0.04388174, Validation R2: -0.699602

Epoch 28/1000
Training Loss: 0.03566401, Training R2: -0.581504
Validation Loss: 0.02774807, Validation R2: 0.159968
Saved best model with validation R2 0.159968 to best_finetuned_model.pth

Epoch 29/1000
Training Loss: 0.02419777, Training R2: 0.158419
Validation Loss: 0.04937789, Validation R2: -1.059750

Epoch 30/1000
Training Loss: 0.04055916, Training R2: -1.021776
Validation Loss: 0.02862093, Validation R2: 0.120129

Epoch 31/1000
Training Loss: 0.02599179, Training R2: 0.073193
Validation Loss: 0.02895384, Validation R2: 0.116352

Epoch 32/1000
Training Loss: 0.02211705, Training R2: 0.283502
Validation Loss: 0.02241822, Validation R2: 0.393785
Saved best model with validation R2 0.393785 to best_finetuned_model.pth

Epoch 33/1000
Training Loss: 0.01621436, Training R2: 0.587976
Validation Loss: 0.02283399, Validation R2: 0.378591

Epoch 34/1000
Training Loss: 0.01661141, Training R2: 0.564823
Validation Loss: 0.01875680, Validation R2: 0.467856
Saved best model with validation R2 0.467856 to best_finetuned_model.pth

Epoch 35/1000
Training Loss: 0.01392317, Training R2: 0.665246
Validation Loss: 0.02462167, Validation R2: 0.280498

Epoch 36/1000
Training Loss: 0.01838514, Training R2: 0.482755
Validation Loss: 0.01774090, Validation R2: 0.531314
Saved best model with validation R2 0.531314 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.01359118, Training R2: 0.680150
Validation Loss: 0.01870385, Validation R2: 0.486577

Epoch 38/1000
Training Loss: 0.01514829, Training R2: 0.622381
Validation Loss: 0.02129675, Validation R2: 0.376887

Epoch 39/1000
Training Loss: 0.01727217, Training R2: 0.546121
Validation Loss: 0.03435087, Validation R2: -0.081990

Epoch 40/1000
Training Loss: 0.01904555, Training R2: 0.450374
Validation Loss: 0.02352101, Validation R2: 0.286151

Epoch 41/1000
Training Loss: 0.01947904, Training R2: 0.460072
Validation Loss: 0.01636184, Validation R2: 0.565179
Saved best model with validation R2 0.565179 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.01121348, Training R2: 0.771605
Validation Loss: 0.03001850, Validation R2: 0.131475

Epoch 43/1000
Training Loss: 0.01903560, Training R2: 0.499415
Validation Loss: 0.02022219, Validation R2: 0.477630

Epoch 44/1000
Training Loss: 0.01933516, Training R2: 0.495115
Validation Loss: 0.01614884, Validation R2: 0.583973
Saved best model with validation R2 0.583973 to best_finetuned_model.pth

Epoch 45/1000
Training Loss: 0.01962267, Training R2: 0.457222
Validation Loss: 0.01553703, Validation R2: 0.607646
Saved best model with validation R2 0.607646 to best_finetuned_model.pth

Epoch 46/1000
Training Loss: 0.01674618, Training R2: 0.568569
Validation Loss: 0.01649180, Validation R2: 0.611175
Saved best model with validation R2 0.611175 to best_finetuned_model.pth

Epoch 47/1000
Training Loss: 0.01577357, Training R2: 0.626306
Validation Loss: 0.01909285, Validation R2: 0.547044

Epoch 48/1000
Training Loss: 0.01857613, Training R2: 0.536701
Validation Loss: 0.01586555, Validation R2: 0.596160

Epoch 49/1000
Training Loss: 0.01790257, Training R2: 0.526134
Validation Loss: 0.01632848, Validation R2: 0.577416

Epoch 50/1000
Training Loss: 0.01791492, Training R2: 0.564884
Validation Loss: 0.02108069, Validation R2: 0.406061

Epoch 51/1000
Training Loss: 0.01695151, Training R2: 0.593072
Validation Loss: 0.02734810, Validation R2: 0.151822

Epoch 52/1000
Training Loss: 0.01811212, Training R2: 0.525771
Validation Loss: 0.03181477, Validation R2: 0.058339

Epoch 53/1000
Training Loss: 0.01924322, Training R2: 0.488923
Validation Loss: 0.01801770, Validation R2: 0.562647

Epoch 54/1000
Training Loss: 0.01878444, Training R2: 0.522408
Validation Loss: 0.01527680, Validation R2: 0.633081
Saved best model with validation R2 0.633081 to best_finetuned_model.pth

Epoch 55/1000
Training Loss: 0.01047182, Training R2: 0.817160
Validation Loss: 0.02608540, Validation R2: 0.312342

Epoch 56/1000
Training Loss: 0.01424820, Training R2: 0.693414
Validation Loss: 0.03613314, Validation R2: -0.145833

Epoch 57/1000
Training Loss: 0.02076924, Training R2: 0.388947
Validation Loss: 0.01629449, Validation R2: 0.629434

Epoch 58/1000
Training Loss: 0.03488776, Training R2: -0.599143
Validation Loss: 0.06116775, Validation R2: -1.918313

Epoch 59/1000
Training Loss: 0.04137423, Training R2: -1.261599
Validation Loss: 0.05601227, Validation R2: -1.462899

Epoch 60/1000
Training Loss: 0.04395484, Training R2: -1.528146
Validation Loss: 0.07257749, Validation R2: -3.125263

Epoch 61/1000
Training Loss: 0.05031650, Training R2: -2.308865
Validation Loss: 0.01633250, Validation R2: 0.567309

Epoch 62/1000
Training Loss: 0.02352813, Training R2: 0.074740
Validation Loss: 0.04987090, Validation R2: -1.023034

Epoch 63/1000
Training Loss: 0.03475372, Training R2: -0.427112
Validation Loss: 0.03685950, Validation R2: -0.203158

Epoch 64/1000
Training Loss: 0.03113352, Training R2: -0.135548
Validation Loss: 0.04055838, Validation R2: -0.415062

Epoch 65/1000
Training Loss: 0.03009091, Training R2: -0.116749
Validation Loss: 0.04249800, Validation R2: -0.554560

Epoch 66/1000
Training Loss: 0.02817287, Training R2: -0.071913
Validation Loss: 0.03234452, Validation R2: -0.002821

Epoch 67/1000
Training Loss: 0.03184523, Training R2: -0.247100
Validation Loss: 0.04062013, Validation R2: -0.433970

Epoch 68/1000
Training Loss: 0.02662047, Training R2: 0.032885
Validation Loss: 0.02221588, Validation R2: 0.422591

Epoch 69/1000
Training Loss: 0.02828176, Training R2: -0.059075
Validation Loss: 0.05710372, Validation R2: -1.566450

Epoch 70/1000
Training Loss: 0.04077749, Training R2: -1.179440
Validation Loss: 0.03765818, Validation R2: -0.247612

Epoch 71/1000
Training Loss: 0.03122654, Training R2: -0.289863
Validation Loss: 0.01640352, Validation R2: 0.554393

Epoch 72/1000
Training Loss: 0.01669057, Training R2: 0.544620
Validation Loss: 0.03286202, Validation R2: -0.007035

Epoch 73/1000
Training Loss: 0.03067534, Training R2: -0.191503
Validation Loss: 0.03103881, Validation R2: 0.077341

Epoch 74/1000
Training Loss: 0.02660487, Training R2: 0.097771
Validation Loss: 0.03067944, Validation R2: 0.099553

Epoch 75/1000
Epoch 00075: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.02566438, Training R2: 0.135527
Validation Loss: 0.04250545, Validation R2: -0.523437

Epoch 76/1000
学习率已减少 1 次
Training Loss: 0.03153642, Training R2: -0.247292
Validation Loss: 0.04565453, Validation R2: -0.870305

Epoch 77/1000
Training Loss: 0.03024102, Training R2: -0.150085
Validation Loss: 0.02678669, Validation R2: 0.252925

Epoch 78/1000
Training Loss: 0.02246522, Training R2: 0.318762
Validation Loss: 0.02535263, Validation R2: 0.307090

Epoch 79/1000
Training Loss: 0.02204773, Training R2: 0.336260
Validation Loss: 0.02790104, Validation R2: 0.115597

Epoch 80/1000
Training Loss: 0.01988922, Training R2: 0.422567
Validation Loss: 0.01530749, Validation R2: 0.602207

Epoch 81/1000
Training Loss: 0.01345107, Training R2: 0.692412
Validation Loss: 0.01964795, Validation R2: 0.514236

Epoch 82/1000
Training Loss: 0.01471091, Training R2: 0.657098
Validation Loss: 0.01772589, Validation R2: 0.567626

Epoch 83/1000
Training Loss: 0.01176107, Training R2: 0.772966
Validation Loss: 0.01549368, Validation R2: 0.614674

Epoch 84/1000
Training Loss: 0.01000247, Training R2: 0.830987
Validation Loss: 0.01442508, Validation R2: 0.638237
Saved best model with validation R2 0.638237 to best_finetuned_model.pth

Epoch 85/1000
Training Loss: 0.00912209, Training R2: 0.855919
Validation Loss: 0.01393497, Validation R2: 0.654674
Saved best model with validation R2 0.654674 to best_finetuned_model.pth

Epoch 86/1000
Training Loss: 0.00853036, Training R2: 0.869274
Validation Loss: 0.01456566, Validation R2: 0.659660
Saved best model with validation R2 0.659660 to best_finetuned_model.pth

Epoch 87/1000
Training Loss: 0.00845399, Training R2: 0.881685
Validation Loss: 0.01380071, Validation R2: 0.676452
Saved best model with validation R2 0.676452 to best_finetuned_model.pth

Epoch 88/1000
Training Loss: 0.00824085, Training R2: 0.886560
Validation Loss: 0.01433063, Validation R2: 0.650949

Epoch 89/1000
Training Loss: 0.00813233, Training R2: 0.891243
Validation Loss: 0.01457062, Validation R2: 0.668855

Epoch 90/1000
Training Loss: 0.00808866, Training R2: 0.893421
Validation Loss: 0.01363881, Validation R2: 0.679266
Saved best model with validation R2 0.679266 to best_finetuned_model.pth

Epoch 91/1000
Training Loss: 0.00715626, Training R2: 0.913052
Validation Loss: 0.01443166, Validation R2: 0.660667

Epoch 92/1000
Training Loss: 0.00658158, Training R2: 0.919717
Validation Loss: 0.01455816, Validation R2: 0.647803

Epoch 93/1000
Training Loss: 0.00754996, Training R2: 0.907831
Validation Loss: 0.01409308, Validation R2: 0.674729

Epoch 94/1000
Training Loss: 0.01067738, Training R2: 0.824768
Validation Loss: 0.02094158, Validation R2: 0.509350

Epoch 95/1000
Training Loss: 0.01797299, Training R2: 0.629184
Validation Loss: 0.01957907, Validation R2: 0.543631

Epoch 96/1000
Training Loss: 0.01276579, Training R2: 0.779209
Validation Loss: 0.01586494, Validation R2: 0.641261

Epoch 97/1000
Training Loss: 0.01515048, Training R2: 0.711511
Validation Loss: 0.02420810, Validation R2: 0.390467

Epoch 98/1000
Training Loss: 0.01488242, Training R2: 0.704018
Validation Loss: 0.01541228, Validation R2: 0.640831

Epoch 99/1000
Training Loss: 0.01128193, Training R2: 0.810022
Validation Loss: 0.01557747, Validation R2: 0.640803

Epoch 100/1000
Training Loss: 0.01514065, Training R2: 0.705441
Validation Loss: 0.02681796, Validation R2: 0.298747

Epoch 101/1000
Training Loss: 0.01669187, Training R2: 0.621847
Validation Loss: 0.02284796, Validation R2: 0.437710

Epoch 102/1000
Training Loss: 0.01823732, Training R2: 0.600683
Validation Loss: 0.01754156, Validation R2: 0.601835

Epoch 103/1000
Training Loss: 0.01214130, Training R2: 0.796323
Validation Loss: 0.01907039, Validation R2: 0.562413

Epoch 104/1000
Training Loss: 0.01340992, Training R2: 0.764943
Validation Loss: 0.02536607, Validation R2: 0.349304

Epoch 105/1000
Training Loss: 0.01765908, Training R2: 0.610192
Validation Loss: 0.01594428, Validation R2: 0.638195

Epoch 106/1000
Training Loss: 0.00970517, Training R2: 0.858644
Validation Loss: 0.01756461, Validation R2: 0.594063

Epoch 107/1000
Training Loss: 0.01110491, Training R2: 0.824027
Validation Loss: 0.02322427, Validation R2: 0.426741

Epoch 108/1000
Training Loss: 0.01673444, Training R2: 0.649894
Validation Loss: 0.01738749, Validation R2: 0.599888

Epoch 109/1000
Training Loss: 0.01349053, Training R2: 0.761437
Validation Loss: 0.01554698, Validation R2: 0.649004

Epoch 110/1000
Training Loss: 0.00896198, Training R2: 0.875438
Validation Loss: 0.01376607, Validation R2: 0.684848
Saved best model with validation R2 0.684848 to best_finetuned_model.pth

Epoch 111/1000
Training Loss: 0.00751554, Training R2: 0.908334
Validation Loss: 0.01455395, Validation R2: 0.649675

Epoch 112/1000
Training Loss: 0.00720718, Training R2: 0.914014
Validation Loss: 0.01502708, Validation R2: 0.651776

Epoch 113/1000
Training Loss: 0.00649848, Training R2: 0.926294
Validation Loss: 0.01537703, Validation R2: 0.621414

Epoch 114/1000
Training Loss: 0.00679956, Training R2: 0.920879
Validation Loss: 0.01522515, Validation R2: 0.652509

Epoch 115/1000
Training Loss: 0.00640204, Training R2: 0.928483
Validation Loss: 0.01556545, Validation R2: 0.625349

Epoch 116/1000
Training Loss: 0.00815119, Training R2: 0.896584
Validation Loss: 0.01368279, Validation R2: 0.677678

Epoch 117/1000
Training Loss: 0.00533684, Training R2: 0.945668
Validation Loss: 0.01423155, Validation R2: 0.650583

Epoch 118/1000
Training Loss: 0.00612451, Training R2: 0.933149
Validation Loss: 0.01400960, Validation R2: 0.670114

Epoch 119/1000
Training Loss: 0.00707301, Training R2: 0.919461
Validation Loss: 0.01377850, Validation R2: 0.677281

Epoch 120/1000
Training Loss: 0.00878257, Training R2: 0.884474
Validation Loss: 0.02544052, Validation R2: 0.277541

Epoch 121/1000
Training Loss: 0.01962440, Training R2: 0.582316
Validation Loss: 0.01575764, Validation R2: 0.603662

Epoch 122/1000
Training Loss: 0.01169306, Training R2: 0.825653
Validation Loss: 0.02105779, Validation R2: 0.427614

Epoch 123/1000
Training Loss: 0.01655865, Training R2: 0.668335
Validation Loss: 0.01459661, Validation R2: 0.636760

Epoch 124/1000
Training Loss: 0.00980801, Training R2: 0.860002
Validation Loss: 0.01954383, Validation R2: 0.489563

Epoch 125/1000
Training Loss: 0.01365398, Training R2: 0.753146
Validation Loss: 0.02776196, Validation R2: 0.185941

Epoch 126/1000
Training Loss: 0.01909539, Training R2: 0.544244
Validation Loss: 0.01396684, Validation R2: 0.676579

Epoch 127/1000
Training Loss: 0.01037520, Training R2: 0.826638
Validation Loss: 0.01570247, Validation R2: 0.637681

Epoch 128/1000
Training Loss: 0.01722529, Training R2: 0.632887
Validation Loss: 0.01925371, Validation R2: 0.534290

Epoch 129/1000
Training Loss: 0.01256569, Training R2: 0.795667
Validation Loss: 0.01643105, Validation R2: 0.604617

Epoch 130/1000
Training Loss: 0.01397260, Training R2: 0.744749
Validation Loss: 0.02445769, Validation R2: 0.377111

Epoch 131/1000
Epoch 00131: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01389302, Training R2: 0.747565
Validation Loss: 0.01629055, Validation R2: 0.604942

Epoch 132/1000
学习率已减少 2 次
Training Loss: 0.00920306, Training R2: 0.875519
Validation Loss: 0.01437633, Validation R2: 0.653856

Epoch 133/1000
Training Loss: 0.00675027, Training R2: 0.927833
Validation Loss: 0.01313373, Validation R2: 0.685177
Saved best model with validation R2 0.685177 to best_finetuned_model.pth

Epoch 134/1000
Training Loss: 0.00542215, Training R2: 0.947795
Validation Loss: 0.01321059, Validation R2: 0.690255
Saved best model with validation R2 0.690255 to best_finetuned_model.pth

Epoch 135/1000
Training Loss: 0.00538199, Training R2: 0.949717
Validation Loss: 0.01331047, Validation R2: 0.688823

Epoch 136/1000
Training Loss: 0.00467623, Training R2: 0.958833
Validation Loss: 0.01338244, Validation R2: 0.684461

Epoch 137/1000
Training Loss: 0.00430025, Training R2: 0.964148
Validation Loss: 0.01347090, Validation R2: 0.677315

Epoch 138/1000
Training Loss: 0.00387881, Training R2: 0.967989
Validation Loss: 0.01343331, Validation R2: 0.678465

Epoch 139/1000
Training Loss: 0.00388516, Training R2: 0.969174
Validation Loss: 0.01313520, Validation R2: 0.688744

Epoch 140/1000
Training Loss: 0.00377590, Training R2: 0.970237
Validation Loss: 0.01302448, Validation R2: 0.690177

Epoch 141/1000
Training Loss: 0.00352532, Training R2: 0.973372
Validation Loss: 0.01322300, Validation R2: 0.691993
Saved best model with validation R2 0.691993 to best_finetuned_model.pth

Epoch 142/1000
Training Loss: 0.00356426, Training R2: 0.973418
Validation Loss: 0.01334356, Validation R2: 0.693609
Saved best model with validation R2 0.693609 to best_finetuned_model.pth

Epoch 143/1000
Training Loss: 0.00421602, Training R2: 0.969416
Validation Loss: 0.01328372, Validation R2: 0.693091

Epoch 144/1000
Training Loss: 0.00375880, Training R2: 0.972970
Validation Loss: 0.01451515, Validation R2: 0.651592

Epoch 145/1000
Training Loss: 0.00466850, Training R2: 0.962094
Validation Loss: 0.01329271, Validation R2: 0.692243

Epoch 146/1000
Training Loss: 0.00411888, Training R2: 0.968260
Validation Loss: 0.01310583, Validation R2: 0.695923
Saved best model with validation R2 0.695923 to best_finetuned_model.pth

Epoch 147/1000
Training Loss: 0.00396964, Training R2: 0.971114
Validation Loss: 0.01328265, Validation R2: 0.693341

Epoch 148/1000
Training Loss: 0.00309770, Training R2: 0.978630
Validation Loss: 0.01370369, Validation R2: 0.675461

Epoch 149/1000
Training Loss: 0.00411410, Training R2: 0.971657
Validation Loss: 0.01355546, Validation R2: 0.680360

Epoch 150/1000
Training Loss: 0.00398971, Training R2: 0.971827
Validation Loss: 0.01438270, Validation R2: 0.654443

Epoch 151/1000
Training Loss: 0.00404447, Training R2: 0.970373
Validation Loss: 0.01321757, Validation R2: 0.690896

Epoch 152/1000
Training Loss: 0.00377833, Training R2: 0.973898
Validation Loss: 0.01366334, Validation R2: 0.683327

Epoch 153/1000
Training Loss: 0.00386558, Training R2: 0.972938
Validation Loss: 0.01314699, Validation R2: 0.693826

Epoch 154/1000
Training Loss: 0.00352319, Training R2: 0.976108
Validation Loss: 0.01326777, Validation R2: 0.690197

Epoch 155/1000
Training Loss: 0.00437075, Training R2: 0.967973
Validation Loss: 0.01330997, Validation R2: 0.694185

Epoch 156/1000
Training Loss: 0.00412628, Training R2: 0.970984
Validation Loss: 0.01333809, Validation R2: 0.693335

Epoch 157/1000
Training Loss: 0.00406343, Training R2: 0.972224
Validation Loss: 0.01356336, Validation R2: 0.692160

Epoch 158/1000
Training Loss: 0.00394305, Training R2: 0.972619
Validation Loss: 0.01333147, Validation R2: 0.690755

Epoch 159/1000
Training Loss: 0.00450960, Training R2: 0.966179
Validation Loss: 0.01421719, Validation R2: 0.675848

Epoch 160/1000
Training Loss: 0.00467493, Training R2: 0.964266
Validation Loss: 0.01341989, Validation R2: 0.684370

Epoch 161/1000
Training Loss: 0.00373928, Training R2: 0.973204
Validation Loss: 0.01326091, Validation R2: 0.691325

Epoch 162/1000
Training Loss: 0.00413788, Training R2: 0.970200
Validation Loss: 0.01325933, Validation R2: 0.694296

Epoch 163/1000
Training Loss: 0.00272493, Training R2: 0.983074
Validation Loss: 0.01383984, Validation R2: 0.671748

Epoch 164/1000
Training Loss: 0.00415042, Training R2: 0.971012
Validation Loss: 0.01328327, Validation R2: 0.694138

Epoch 165/1000
Training Loss: 0.00420819, Training R2: 0.968017
Validation Loss: 0.01593663, Validation R2: 0.608849

Epoch 166/1000
Training Loss: 0.00994327, Training R2: 0.874667
Validation Loss: 0.01373947, Validation R2: 0.680927

Epoch 167/1000
Epoch 00167: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00736066, Training R2: 0.921205
Validation Loss: 0.02076222, Validation R2: 0.512752

Epoch 168/1000
学习率已减少 3 次
Training Loss: 0.01067914, Training R2: 0.853631
Validation Loss: 0.01573981, Validation R2: 0.620837

Epoch 169/1000
Training Loss: 0.00661111, Training R2: 0.938888
Validation Loss: 0.01372670, Validation R2: 0.679607

Epoch 170/1000
Training Loss: 0.00427646, Training R2: 0.967894
Validation Loss: 0.01406857, Validation R2: 0.683391

Epoch 171/1000
Training Loss: 0.00454479, Training R2: 0.966476
Validation Loss: 0.01349489, Validation R2: 0.688902

Epoch 172/1000
Training Loss: 0.00308577, Training R2: 0.979958
Validation Loss: 0.01368023, Validation R2: 0.682583

Epoch 173/1000
Training Loss: 0.00357836, Training R2: 0.977171
Validation Loss: 0.01341077, Validation R2: 0.682681

Epoch 174/1000
Training Loss: 0.00243487, Training R2: 0.985434
Validation Loss: 0.01333658, Validation R2: 0.686776

Epoch 175/1000
Training Loss: 0.00255181, Training R2: 0.984549
Validation Loss: 0.01336796, Validation R2: 0.688341

Epoch 176/1000
Training Loss: 0.00235341, Training R2: 0.986587
Validation Loss: 0.01349300, Validation R2: 0.680860

Epoch 177/1000
Training Loss: 0.00234304, Training R2: 0.986535
Validation Loss: 0.01342986, Validation R2: 0.688220

Epoch 178/1000
Training Loss: 0.00299188, Training R2: 0.983031
Validation Loss: 0.01367093, Validation R2: 0.681363

Epoch 179/1000
Training Loss: 0.00343573, Training R2: 0.979325
Validation Loss: 0.01373509, Validation R2: 0.678786

Epoch 180/1000
Training Loss: 0.00401110, Training R2: 0.973880
Validation Loss: 0.01419086, Validation R2: 0.670318

Epoch 181/1000
Training Loss: 0.00483875, Training R2: 0.968108
Validation Loss: 0.01347029, Validation R2: 0.684308

Epoch 182/1000
Training Loss: 0.00328108, Training R2: 0.981008
Validation Loss: 0.01448026, Validation R2: 0.667229

Epoch 183/1000
Training Loss: 0.00519156, Training R2: 0.962385
Validation Loss: 0.01329122, Validation R2: 0.682666

Epoch 184/1000
Training Loss: 0.00312574, Training R2: 0.981956
Validation Loss: 0.01424242, Validation R2: 0.652990

Epoch 185/1000
Training Loss: 0.00433175, Training R2: 0.972561
Validation Loss: 0.01337147, Validation R2: 0.681699

Epoch 186/1000
Training Loss: 0.00318367, Training R2: 0.980238
Validation Loss: 0.01374503, Validation R2: 0.669984

Epoch 187/1000
Training Loss: 0.00506283, Training R2: 0.965284
Validation Loss: 0.01374303, Validation R2: 0.672438

Epoch 188/1000
Epoch 00188: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00290132, Training R2: 0.982787
Validation Loss: 0.01340101, Validation R2: 0.683781

Epoch 189/1000
学习率已减少 4 次
Training Loss: 0.00219995, Training R2: 0.988160
Validation Loss: 0.01332428, Validation R2: 0.685361

Epoch 190/1000
Training Loss: 0.00193076, Training R2: 0.989228
Validation Loss: 0.01334135, Validation R2: 0.684621

Epoch 191/1000
Training Loss: 0.00181814, Training R2: 0.989750
Validation Loss: 0.01337520, Validation R2: 0.683755

Epoch 192/1000
Training Loss: 0.00169420, Training R2: 0.990375
Validation Loss: 0.01341257, Validation R2: 0.685875

Epoch 193/1000
Training Loss: 0.00153965, Training R2: 0.991086
Validation Loss: 0.01336592, Validation R2: 0.688229

Epoch 194/1000
Training Loss: 0.00155960, Training R2: 0.991042
Validation Loss: 0.01335717, Validation R2: 0.689073

Epoch 195/1000
Training Loss: 0.00146649, Training R2: 0.991342
Validation Loss: 0.01338145, Validation R2: 0.687359

Epoch 196/1000
Training Loss: 0.00150663, Training R2: 0.991288
Validation Loss: 0.01327226, Validation R2: 0.692309

Epoch 197/1000
Training Loss: 0.00133488, Training R2: 0.991920
Validation Loss: 0.01324766, Validation R2: 0.692429

Epoch 198/1000
Training Loss: 0.00123746, Training R2: 0.992140
Validation Loss: 0.01323172, Validation R2: 0.691734

Epoch 199/1000
Training Loss: 0.00121526, Training R2: 0.992025
Validation Loss: 0.01332179, Validation R2: 0.687360

Epoch 200/1000
Training Loss: 0.00131350, Training R2: 0.991821
Validation Loss: 0.01327732, Validation R2: 0.690496

Epoch 201/1000
Training Loss: 0.00116649, Training R2: 0.992228
Validation Loss: 0.01329317, Validation R2: 0.693227

Epoch 202/1000
Training Loss: 0.00167175, Training R2: 0.990320
Validation Loss: 0.01325857, Validation R2: 0.691435

Epoch 203/1000
Training Loss: 0.00139353, Training R2: 0.991722
Validation Loss: 0.01333347, Validation R2: 0.689371

Epoch 204/1000
Training Loss: 0.00138034, Training R2: 0.991778
Validation Loss: 0.01322534, Validation R2: 0.692706

Epoch 205/1000
Training Loss: 0.00148736, Training R2: 0.991414
Validation Loss: 0.01330978, Validation R2: 0.687875

Epoch 206/1000
Training Loss: 0.00145758, Training R2: 0.991649
Validation Loss: 0.01361451, Validation R2: 0.675598

Epoch 207/1000
Training Loss: 0.00286405, Training R2: 0.985397
Validation Loss: 0.01333169, Validation R2: 0.686844

Epoch 208/1000
Training Loss: 0.00208682, Training R2: 0.988822
Validation Loss: 0.01359032, Validation R2: 0.686865

Epoch 209/1000
Epoch 00209: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00330449, Training R2: 0.982443
Validation Loss: 0.01329822, Validation R2: 0.689316

Epoch 210/1000
学习率已减少 5 次
Training Loss: 0.00174834, Training R2: 0.991167
Validation Loss: 0.01339617, Validation R2: 0.682785

Epoch 211/1000
Training Loss: 0.00151212, Training R2: 0.991354
Validation Loss: 0.01328094, Validation R2: 0.688958

Epoch 212/1000
Training Loss: 0.00122859, Training R2: 0.992203
Validation Loss: 0.01323797, Validation R2: 0.692932

Epoch 213/1000
Training Loss: 0.00133500, Training R2: 0.992130
Validation Loss: 0.01329214, Validation R2: 0.692115

Epoch 214/1000
Training Loss: 0.00121916, Training R2: 0.992638
Validation Loss: 0.01330238, Validation R2: 0.692944

Epoch 215/1000
Training Loss: 0.00145517, Training R2: 0.992366
Validation Loss: 0.01329049, Validation R2: 0.691472

Epoch 216/1000
Training Loss: 0.00129505, Training R2: 0.992670
Validation Loss: 0.01337510, Validation R2: 0.686887

Epoch 217/1000
Training Loss: 0.00124783, Training R2: 0.992492
Validation Loss: 0.01345011, Validation R2: 0.683314

Epoch 218/1000
Training Loss: 0.00131540, Training R2: 0.992375
Validation Loss: 0.01345899, Validation R2: 0.683841

Epoch 219/1000
Training Loss: 0.00146173, Training R2: 0.992157
Validation Loss: 0.01333620, Validation R2: 0.688411

Epoch 220/1000
Training Loss: 0.00105355, Training R2: 0.993262
Validation Loss: 0.01329001, Validation R2: 0.690895

Epoch 221/1000
Training Loss: 0.00116139, Training R2: 0.992795
Validation Loss: 0.01327634, Validation R2: 0.692039

Epoch 222/1000
Training Loss: 0.00121149, Training R2: 0.993028
Validation Loss: 0.01327799, Validation R2: 0.691226

Epoch 223/1000
Training Loss: 0.00097392, Training R2: 0.993469
Validation Loss: 0.01331199, Validation R2: 0.690402

Epoch 224/1000
Training Loss: 0.00110954, Training R2: 0.993039
Validation Loss: 0.01327460, Validation R2: 0.692259

Epoch 225/1000
Training Loss: 0.00137818, Training R2: 0.992321
Validation Loss: 0.01333347, Validation R2: 0.692828

Epoch 226/1000
Training Loss: 0.00125852, Training R2: 0.992678
Validation Loss: 0.01332020, Validation R2: 0.691261

Epoch 227/1000
Training Loss: 0.00101866, Training R2: 0.993417
Validation Loss: 0.01333008, Validation R2: 0.690812

Epoch 228/1000
Training Loss: 0.00097110, Training R2: 0.993596
Validation Loss: 0.01334675, Validation R2: 0.688415

Epoch 229/1000
Training Loss: 0.00101891, Training R2: 0.993552
Validation Loss: 0.01338018, Validation R2: 0.687082

Epoch 230/1000
Epoch 00230: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00120230, Training R2: 0.993050
Validation Loss: 0.01342446, Validation R2: 0.685080

Epoch 231/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
