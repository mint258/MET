Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 2241155

Epoch 1/1000
Training Loss: 0.85880391, Training R2: -1391.988770
Validation Loss: 0.30878440, Validation R2: -94.491837
Saved best model with validation R2 -94.491837 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.15993179, Training R2: -34.002380
Validation Loss: 0.11336066, Validation R2: -13.421477
Saved best model with validation R2 -13.421477 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.09764378, Training R2: -9.907169
Validation Loss: 0.03011137, Validation R2: -0.404328
Saved best model with validation R2 -0.404328 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.04945538, Training R2: -2.354836
Validation Loss: 0.09492006, Validation R2: -8.734565

Epoch 5/1000
Training Loss: 0.06173376, Training R2: -3.821030
Validation Loss: 0.05982966, Validation R2: -3.109579

Epoch 6/1000
Training Loss: 0.05090165, Training R2: -2.198720
Validation Loss: 0.05995958, Validation R2: -3.160029

Epoch 7/1000
Training Loss: 0.05349026, Training R2: -2.558953
Validation Loss: 0.03260327, Validation R2: -0.666278

Epoch 8/1000
Training Loss: 0.05692149, Training R2: -2.806528
Validation Loss: 0.05277929, Validation R2: -2.476444

Epoch 9/1000
Training Loss: 0.04762495, Training R2: -1.785206
Validation Loss: 0.03952937, Validation R2: -1.115372

Epoch 10/1000
Training Loss: 0.03820003, Training R2: -1.029312
Validation Loss: 0.02340076, Validation R2: 0.010100
Saved best model with validation R2 0.010100 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.02847106, Training R2: -0.188462
Validation Loss: 0.04315667, Validation R2: -1.446030

Epoch 12/1000
Training Loss: 0.04315315, Training R2: -1.349237
Validation Loss: 0.04747092, Validation R2: -1.893892

Epoch 13/1000
Training Loss: 0.04290968, Training R2: -1.372150
Validation Loss: 0.03918460, Validation R2: -1.100448

Epoch 14/1000
Training Loss: 0.03772016, Training R2: -0.798963
Validation Loss: 0.05084112, Validation R2: -2.228983

Epoch 15/1000
Training Loss: 0.04394197, Training R2: -1.339946
Validation Loss: 0.03087968, Validation R2: -0.475863

Epoch 16/1000
Training Loss: 0.03384070, Training R2: -0.506099
Validation Loss: 0.04806805, Validation R2: -2.011530

Epoch 17/1000
Training Loss: 0.04326831, Training R2: -1.288935
Validation Loss: 0.02354329, Validation R2: 0.005663

Epoch 18/1000
Training Loss: 0.02650471, Training R2: -0.033873
Validation Loss: 0.02034142, Validation R2: 0.225924
Saved best model with validation R2 0.225924 to best_finetuned_model.pth

Epoch 19/1000
Training Loss: 0.02134043, Training R2: 0.241669
Validation Loss: 0.02293934, Validation R2: 0.132645

Epoch 20/1000
Training Loss: 0.02351423, Training R2: 0.133361
Validation Loss: 0.02034190, Validation R2: 0.237981
Saved best model with validation R2 0.237981 to best_finetuned_model.pth

Epoch 21/1000
Training Loss: 0.02234262, Training R2: 0.177442
Validation Loss: 0.01974002, Validation R2: 0.268469
Saved best model with validation R2 0.268469 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.02141751, Training R2: 0.258036
Validation Loss: 0.01964522, Validation R2: 0.275599
Saved best model with validation R2 0.275599 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.02063429, Training R2: 0.304547
Validation Loss: 0.02634658, Validation R2: -0.003068

Epoch 24/1000
Training Loss: 0.02656240, Training R2: -0.022292
Validation Loss: 0.02138869, Validation R2: 0.212459

Epoch 25/1000
Training Loss: 0.02314322, Training R2: 0.202790
Validation Loss: 0.02209427, Validation R2: 0.199394

Epoch 26/1000
Training Loss: 0.02060207, Training R2: 0.308979
Validation Loss: 0.02176099, Validation R2: 0.143978

Epoch 27/1000
Training Loss: 0.02355202, Training R2: 0.182549
Validation Loss: 0.04597131, Validation R2: -1.451534

Epoch 28/1000
Training Loss: 0.03055813, Training R2: -0.315137
Validation Loss: 0.02116097, Validation R2: 0.257358

Epoch 29/1000
Training Loss: 0.03179608, Training R2: -0.469835
Validation Loss: 0.03892754, Validation R2: -0.838512

Epoch 30/1000
Training Loss: 0.06002556, Training R2: -3.007634
Validation Loss: 0.05238298, Validation R2: -2.249385

Epoch 31/1000
Training Loss: 0.03488764, Training R2: -0.634733
Validation Loss: 0.01944862, Validation R2: 0.276541
Saved best model with validation R2 0.276541 to best_finetuned_model.pth

Epoch 32/1000
Training Loss: 0.02456579, Training R2: 0.126186
Validation Loss: 0.03720891, Validation R2: -0.967639

Epoch 33/1000
Training Loss: 0.02763954, Training R2: -0.041439
Validation Loss: 0.02234646, Validation R2: 0.215869

Epoch 34/1000
Training Loss: 0.02436407, Training R2: 0.181446
Validation Loss: 0.01884212, Validation R2: 0.333756
Saved best model with validation R2 0.333756 to best_finetuned_model.pth

Epoch 35/1000
Training Loss: 0.02441686, Training R2: 0.148668
Validation Loss: 0.02666142, Validation R2: -0.177963

Epoch 36/1000
Training Loss: 0.02591907, Training R2: 0.096744
Validation Loss: 0.03588349, Validation R2: -0.586295

Epoch 37/1000
Training Loss: 0.02873873, Training R2: -0.112264
Validation Loss: 0.02013095, Validation R2: 0.219645

Epoch 38/1000
Training Loss: 0.01900426, Training R2: 0.422106
Validation Loss: 0.02396676, Validation R2: 0.155621

Epoch 39/1000
Training Loss: 0.02235493, Training R2: 0.312327
Validation Loss: 0.03301472, Validation R2: -0.606938

Epoch 40/1000
Training Loss: 0.02692866, Training R2: 0.054304
Validation Loss: 0.01868866, Validation R2: 0.349169
Saved best model with validation R2 0.349169 to best_finetuned_model.pth

Epoch 41/1000
Training Loss: 0.03457330, Training R2: -0.627740
Validation Loss: 0.07137468, Validation R2: -4.498605

Epoch 42/1000
Training Loss: 0.04626714, Training R2: -1.547522
Validation Loss: 0.02600084, Validation R2: -0.088840

Epoch 43/1000
Training Loss: 0.04145459, Training R2: -1.003752
Validation Loss: 0.05603418, Validation R2: -2.605923

Epoch 44/1000
Training Loss: 0.04365729, Training R2: -1.143707
Validation Loss: 0.03654793, Validation R2: -0.844605

Epoch 45/1000
Training Loss: 0.03549464, Training R2: -0.500721
Validation Loss: 0.03222719, Validation R2: -0.531245

Epoch 46/1000
Training Loss: 0.04666284, Training R2: -1.399519
Validation Loss: 0.04415199, Validation R2: -1.454923

Epoch 47/1000
Training Loss: 0.03412358, Training R2: -0.417434
Validation Loss: 0.03138534, Validation R2: -0.481904

Epoch 48/1000
Training Loss: 0.04338753, Training R2: -1.067737
Validation Loss: 0.03243678, Validation R2: -0.601832

Epoch 49/1000
Training Loss: 0.03990254, Training R2: -0.788410
Validation Loss: 0.02856660, Validation R2: -0.376200

Epoch 50/1000
Training Loss: 0.03925509, Training R2: -0.762701
Validation Loss: 0.02984210, Validation R2: -0.456774

Epoch 51/1000
Training Loss: 0.04119749, Training R2: -0.918210
Validation Loss: 0.02879224, Validation R2: -0.374452

Epoch 52/1000
Training Loss: 0.03969554, Training R2: -0.784815
Validation Loss: 0.04049752, Validation R2: -1.150177

Epoch 53/1000
Training Loss: 0.03330524, Training R2: -0.330676
Validation Loss: 0.02397088, Validation R2: 0.069804

Epoch 54/1000
Training Loss: 0.03297088, Training R2: -0.333134
Validation Loss: 0.04129176, Validation R2: -1.195465

Epoch 55/1000
Training Loss: 0.03698271, Training R2: -0.563024
Validation Loss: 0.01976768, Validation R2: 0.269250

Epoch 56/1000
Training Loss: 0.02146173, Training R2: 0.349100
Validation Loss: 0.02376700, Validation R2: 0.192307

Epoch 57/1000
Training Loss: 0.02378817, Training R2: 0.253699
Validation Loss: 0.01744655, Validation R2: 0.444989
Saved best model with validation R2 0.444989 to best_finetuned_model.pth

Epoch 58/1000
Training Loss: 0.01664663, Training R2: 0.569666
Validation Loss: 0.03412510, Validation R2: -0.410771

Epoch 59/1000
Training Loss: 0.02898339, Training R2: -0.090790
Validation Loss: 0.03131592, Validation R2: -0.235938

Epoch 60/1000
Training Loss: 0.02585305, Training R2: 0.110959
Validation Loss: 0.02670225, Validation R2: 0.049287

Epoch 61/1000
Training Loss: 0.01997935, Training R2: 0.423942
Validation Loss: 0.02525503, Validation R2: -0.046877

Epoch 62/1000
Training Loss: 0.02378439, Training R2: 0.231860
Validation Loss: 0.01864429, Validation R2: 0.338227

Epoch 63/1000
Training Loss: 0.01995939, Training R2: 0.423068
Validation Loss: 0.01856423, Validation R2: 0.427988

Epoch 64/1000
Training Loss: 0.01505824, Training R2: 0.642907
Validation Loss: 0.02392315, Validation R2: 0.052159

Epoch 65/1000
Training Loss: 0.01856930, Training R2: 0.490422
Validation Loss: 0.02399576, Validation R2: 0.206135

Epoch 66/1000
Training Loss: 0.01640025, Training R2: 0.603225
Validation Loss: 0.02023330, Validation R2: 0.275943

Epoch 67/1000
Training Loss: 0.01768664, Training R2: 0.539793
Validation Loss: 0.02137151, Validation R2: 0.332243

Epoch 68/1000
Training Loss: 0.01926797, Training R2: 0.506398
Validation Loss: 0.01646584, Validation R2: 0.499799
Saved best model with validation R2 0.499799 to best_finetuned_model.pth

Epoch 69/1000
Training Loss: 0.01342264, Training R2: 0.703414
Validation Loss: 0.02019948, Validation R2: 0.257060

Epoch 70/1000
Training Loss: 0.01584678, Training R2: 0.622497
Validation Loss: 0.01630157, Validation R2: 0.461172

Epoch 71/1000
Training Loss: 0.01365220, Training R2: 0.698455
Validation Loss: 0.02552394, Validation R2: 0.108627

Epoch 72/1000
Training Loss: 0.01626550, Training R2: 0.613766
Validation Loss: 0.01637398, Validation R2: 0.462172

Epoch 73/1000
Training Loss: 0.01261153, Training R2: 0.734337
Validation Loss: 0.01560939, Validation R2: 0.510938
Saved best model with validation R2 0.510938 to best_finetuned_model.pth

Epoch 74/1000
Training Loss: 0.01504569, Training R2: 0.650275
Validation Loss: 0.01874749, Validation R2: 0.341807

Epoch 75/1000
Training Loss: 0.01822811, Training R2: 0.530808
Validation Loss: 0.01646873, Validation R2: 0.448616

Epoch 76/1000
Training Loss: 0.01888003, Training R2: 0.503182
Validation Loss: 0.02135796, Validation R2: 0.197446

Epoch 77/1000
Training Loss: 0.01904908, Training R2: 0.498251
Validation Loss: 0.04602896, Validation R2: -1.336572

Epoch 78/1000
Training Loss: 0.04282801, Training R2: -0.923874
Validation Loss: 0.02600945, Validation R2: 0.105817

Epoch 79/1000
Training Loss: 0.02757933, Training R2: 0.119130
Validation Loss: 0.02945209, Validation R2: -0.101709

Epoch 80/1000
Training Loss: 0.02097757, Training R2: 0.407596
Validation Loss: 0.01982375, Validation R2: 0.409324

Epoch 81/1000
Training Loss: 0.02768765, Training R2: -0.030562
Validation Loss: 0.07006698, Validation R2: -4.119645

Epoch 82/1000
Training Loss: 0.05036693, Training R2: -2.092138
Validation Loss: 0.02687293, Validation R2: 0.083559

Epoch 83/1000
Training Loss: 0.02581905, Training R2: 0.139744
Validation Loss: 0.03437986, Validation R2: -0.369968

Epoch 84/1000
Training Loss: 0.03366909, Training R2: -0.275460
Validation Loss: 0.04622826, Validation R2: -1.324495

Epoch 85/1000
Training Loss: 0.03637980, Training R2: -0.522811
Validation Loss: 0.02990024, Validation R2: -0.089547

Epoch 86/1000
Training Loss: 0.02805121, Training R2: 0.046043
Validation Loss: 0.05781978, Validation R2: -2.575724

Epoch 87/1000
Training Loss: 0.04330415, Training R2: -1.188396
Validation Loss: 0.02042273, Validation R2: 0.398765

Epoch 88/1000
Training Loss: 0.01997045, Training R2: 0.446050
Validation Loss: 0.03252474, Validation R2: -0.337783

Epoch 89/1000
Training Loss: 0.02024289, Training R2: 0.414267
Validation Loss: 0.01830531, Validation R2: 0.354036

Epoch 90/1000
Training Loss: 0.01329923, Training R2: 0.697033
Validation Loss: 0.02334338, Validation R2: 0.073376

Epoch 91/1000
Training Loss: 0.02209850, Training R2: 0.375425
Validation Loss: 0.01709241, Validation R2: 0.476106

Epoch 92/1000
Training Loss: 0.01734355, Training R2: 0.572931
Validation Loss: 0.01491496, Validation R2: 0.536397
Saved best model with validation R2 0.536397 to best_finetuned_model.pth

Epoch 93/1000
Training Loss: 0.01594029, Training R2: 0.632010
Validation Loss: 0.02276883, Validation R2: 0.158110

Epoch 94/1000
Training Loss: 0.02162280, Training R2: 0.406449
Validation Loss: 0.02600996, Validation R2: -0.057709

Epoch 95/1000
Training Loss: 0.04803338, Training R2: -1.538657
Validation Loss: 0.07986752, Validation R2: -5.571806

Epoch 96/1000
Training Loss: 0.06884070, Training R2: -3.908651
Validation Loss: 0.11979280, Validation R2: -13.255390

Epoch 97/1000
Training Loss: 0.07475634, Training R2: -5.864458
Validation Loss: 0.07992745, Validation R2: -5.589562

Epoch 98/1000
Training Loss: 0.06417601, Training R2: -3.746050
Validation Loss: 0.08256913, Validation R2: -5.966013

Epoch 99/1000
Training Loss: 0.05392229, Training R2: -2.471149
Validation Loss: 0.02916067, Validation R2: -0.028661

Epoch 100/1000
Training Loss: 0.02727655, Training R2: 0.045847
Validation Loss: 0.01747898, Validation R2: 0.403826

Epoch 101/1000
Training Loss: 0.03894102, Training R2: -0.790893
Validation Loss: 0.02898252, Validation R2: -0.209623

Epoch 102/1000
Training Loss: 0.02195330, Training R2: 0.398138
Validation Loss: 0.01542694, Validation R2: 0.486937

Epoch 103/1000
Training Loss: 0.02948439, Training R2: -0.054284
Validation Loss: 0.03784940, Validation R2: -0.786261

Epoch 104/1000
Training Loss: 0.02838499, Training R2: 0.074130
Validation Loss: 0.02419617, Validation R2: 0.085789

Epoch 105/1000
Training Loss: 0.02441961, Training R2: 0.267428
Validation Loss: 0.03013692, Validation R2: -0.312470

Epoch 106/1000
Training Loss: 0.03511877, Training R2: -0.320590
Validation Loss: 0.02395325, Validation R2: 0.000739

Epoch 107/1000
Training Loss: 0.02313683, Training R2: 0.344014
Validation Loss: 0.01779891, Validation R2: 0.338015

Epoch 108/1000
Training Loss: 0.03059563, Training R2: -0.115552
Validation Loss: 0.02388927, Validation R2: 0.048716

Epoch 109/1000
Training Loss: 0.03109887, Training R2: -0.075766
Validation Loss: 0.01670284, Validation R2: 0.427428

Epoch 110/1000
Training Loss: 0.02313578, Training R2: 0.310613
Validation Loss: 0.02989428, Validation R2: -0.257199

Epoch 111/1000
Training Loss: 0.03276105, Training R2: -0.120157
Validation Loss: 0.01749231, Validation R2: 0.431858

Epoch 112/1000
Training Loss: 0.02018278, Training R2: 0.451328
Validation Loss: 0.02543806, Validation R2: 0.016981

Epoch 113/1000
Epoch 00113: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.03649208, Training R2: -0.452744
Validation Loss: 0.03614340, Validation R2: -0.701187

Epoch 114/1000
学习率已减少 1 次
Training Loss: 0.02723117, Training R2: 0.088232
Validation Loss: 0.02097148, Validation R2: 0.375397

Epoch 115/1000
Training Loss: 0.01766586, Training R2: 0.562861
Validation Loss: 0.01762476, Validation R2: 0.504930

Epoch 116/1000
Training Loss: 0.01300784, Training R2: 0.731634
Validation Loss: 0.01889882, Validation R2: 0.468946

Epoch 117/1000
Training Loss: 0.01388710, Training R2: 0.722691
Validation Loss: 0.01444150, Validation R2: 0.604622
Saved best model with validation R2 0.604622 to best_finetuned_model.pth

Epoch 118/1000
Training Loss: 0.01177015, Training R2: 0.784261
Validation Loss: 0.01483026, Validation R2: 0.578230

Epoch 119/1000
Training Loss: 0.01121268, Training R2: 0.801101
Validation Loss: 0.01618186, Validation R2: 0.534712

Epoch 120/1000
Training Loss: 0.01014315, Training R2: 0.825317
Validation Loss: 0.01641682, Validation R2: 0.526030

Epoch 121/1000
Training Loss: 0.00985620, Training R2: 0.826438
Validation Loss: 0.01508104, Validation R2: 0.551693

Epoch 122/1000
Training Loss: 0.00949419, Training R2: 0.838906
Validation Loss: 0.01467409, Validation R2: 0.566045

Epoch 123/1000
Training Loss: 0.00927535, Training R2: 0.842866
Validation Loss: 0.01448937, Validation R2: 0.567237

Epoch 124/1000
Training Loss: 0.00938986, Training R2: 0.843473
Validation Loss: 0.01467345, Validation R2: 0.573683

Epoch 125/1000
Training Loss: 0.00924479, Training R2: 0.840444
Validation Loss: 0.01496076, Validation R2: 0.562310

Epoch 126/1000
Training Loss: 0.00847369, Training R2: 0.859040
Validation Loss: 0.01459586, Validation R2: 0.560698

Epoch 127/1000
Training Loss: 0.00889562, Training R2: 0.851268
Validation Loss: 0.01571900, Validation R2: 0.541323

Epoch 128/1000
Training Loss: 0.00894328, Training R2: 0.852978
Validation Loss: 0.01503986, Validation R2: 0.567632

Epoch 129/1000
Training Loss: 0.00899067, Training R2: 0.845581
Validation Loss: 0.01808953, Validation R2: 0.403122

Epoch 130/1000
Training Loss: 0.01500997, Training R2: 0.697769
Validation Loss: 0.02060756, Validation R2: 0.290799

Epoch 131/1000
Training Loss: 0.01790623, Training R2: 0.619740
Validation Loss: 0.01631669, Validation R2: 0.495190

Epoch 132/1000
Training Loss: 0.01281362, Training R2: 0.759568
Validation Loss: 0.02218604, Validation R2: 0.201592

Epoch 133/1000
Training Loss: 0.01900362, Training R2: 0.578276
Validation Loss: 0.01551724, Validation R2: 0.530701

Epoch 134/1000
Training Loss: 0.01213781, Training R2: 0.774844
Validation Loss: 0.01469158, Validation R2: 0.577888

Epoch 135/1000
Training Loss: 0.00931063, Training R2: 0.852634
Validation Loss: 0.01523906, Validation R2: 0.546083

Epoch 136/1000
Training Loss: 0.00889895, Training R2: 0.861285
Validation Loss: 0.01475352, Validation R2: 0.575187

Epoch 137/1000
Training Loss: 0.00815271, Training R2: 0.879515
Validation Loss: 0.01927611, Validation R2: 0.436192

Epoch 138/1000
Epoch 00138: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.00995430, Training R2: 0.846577
Validation Loss: 0.01431404, Validation R2: 0.586136

Epoch 139/1000
学习率已减少 2 次
Training Loss: 0.00765095, Training R2: 0.888099
Validation Loss: 0.01412196, Validation R2: 0.588676

Epoch 140/1000
Training Loss: 0.00757647, Training R2: 0.890510
Validation Loss: 0.01417244, Validation R2: 0.577673

Epoch 141/1000
Training Loss: 0.00756729, Training R2: 0.886504
Validation Loss: 0.01460399, Validation R2: 0.561422

Epoch 142/1000
Training Loss: 0.00808736, Training R2: 0.877273
Validation Loss: 0.01455882, Validation R2: 0.563203

Epoch 143/1000
Training Loss: 0.00835067, Training R2: 0.871310
Validation Loss: 0.01446855, Validation R2: 0.576298

Epoch 144/1000
Training Loss: 0.00753348, Training R2: 0.889524
Validation Loss: 0.01447576, Validation R2: 0.576175

Epoch 145/1000
Training Loss: 0.00719567, Training R2: 0.893658
Validation Loss: 0.01532673, Validation R2: 0.553186

Epoch 146/1000
Training Loss: 0.00755203, Training R2: 0.889223
Validation Loss: 0.01460084, Validation R2: 0.570706

Epoch 147/1000
Training Loss: 0.00659104, Training R2: 0.906435
Validation Loss: 0.01442575, Validation R2: 0.566608

Epoch 148/1000
Training Loss: 0.00666368, Training R2: 0.904814
Validation Loss: 0.01447553, Validation R2: 0.573473

Epoch 149/1000
Training Loss: 0.00652323, Training R2: 0.906035
Validation Loss: 0.01446097, Validation R2: 0.578027

Epoch 150/1000
Training Loss: 0.00664200, Training R2: 0.907068
Validation Loss: 0.01441608, Validation R2: 0.583829

Epoch 151/1000
Training Loss: 0.00656238, Training R2: 0.905157
Validation Loss: 0.01487999, Validation R2: 0.570275

Epoch 152/1000
Training Loss: 0.00647134, Training R2: 0.909464
Validation Loss: 0.01552660, Validation R2: 0.553798

Epoch 153/1000
Training Loss: 0.00733751, Training R2: 0.896478
Validation Loss: 0.01469248, Validation R2: 0.574047

Epoch 154/1000
Training Loss: 0.00650480, Training R2: 0.906992
Validation Loss: 0.01444613, Validation R2: 0.574587

Epoch 155/1000
Training Loss: 0.00632418, Training R2: 0.911533
Validation Loss: 0.01511690, Validation R2: 0.540529

Epoch 156/1000
Training Loss: 0.00816000, Training R2: 0.885908
Validation Loss: 0.01570888, Validation R2: 0.511455

Epoch 157/1000
Training Loss: 0.00943994, Training R2: 0.867596
Validation Loss: 0.01428719, Validation R2: 0.589852

Epoch 158/1000
Training Loss: 0.00700611, Training R2: 0.904532
Validation Loss: 0.01463775, Validation R2: 0.582760

Epoch 159/1000
Epoch 00159: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00806284, Training R2: 0.886914
Validation Loss: 0.01606651, Validation R2: 0.537779

Epoch 160/1000
学习率已减少 3 次
Training Loss: 0.00762122, Training R2: 0.892919
Validation Loss: 0.01410454, Validation R2: 0.592923

Epoch 161/1000
Training Loss: 0.00652888, Training R2: 0.912163
Validation Loss: 0.01428526, Validation R2: 0.574158

Epoch 162/1000
Training Loss: 0.00671352, Training R2: 0.905347
Validation Loss: 0.01525073, Validation R2: 0.567470

Epoch 163/1000
Training Loss: 0.00661118, Training R2: 0.909355
Validation Loss: 0.01484025, Validation R2: 0.577057

Epoch 164/1000
Training Loss: 0.00617547, Training R2: 0.918598
Validation Loss: 0.01430732, Validation R2: 0.586145

Epoch 165/1000
Training Loss: 0.00592459, Training R2: 0.920174
Validation Loss: 0.01434223, Validation R2: 0.577986

Epoch 166/1000
Training Loss: 0.00578368, Training R2: 0.920888
Validation Loss: 0.01455278, Validation R2: 0.576198

Epoch 167/1000
Training Loss: 0.00549013, Training R2: 0.925427
Validation Loss: 0.01466130, Validation R2: 0.572547

Epoch 168/1000
Training Loss: 0.00537557, Training R2: 0.926632
Validation Loss: 0.01471870, Validation R2: 0.567065

Epoch 169/1000
Training Loss: 0.00526951, Training R2: 0.928362
Validation Loss: 0.01438855, Validation R2: 0.569762

Epoch 170/1000
Training Loss: 0.00565095, Training R2: 0.925102
Validation Loss: 0.01430038, Validation R2: 0.573529

Epoch 171/1000
Training Loss: 0.00544648, Training R2: 0.925539
Validation Loss: 0.01428048, Validation R2: 0.577525

Epoch 172/1000
Training Loss: 0.00533743, Training R2: 0.927191
Validation Loss: 0.01480060, Validation R2: 0.565785

Epoch 173/1000
Training Loss: 0.00544424, Training R2: 0.925233
Validation Loss: 0.01466005, Validation R2: 0.571451

Epoch 174/1000
Training Loss: 0.00523411, Training R2: 0.928164
Validation Loss: 0.01438750, Validation R2: 0.577618

Epoch 175/1000
Training Loss: 0.00500950, Training R2: 0.930790
Validation Loss: 0.01446767, Validation R2: 0.573086

Epoch 176/1000
Training Loss: 0.00490779, Training R2: 0.931431
Validation Loss: 0.01463048, Validation R2: 0.570901

Epoch 177/1000
Training Loss: 0.00502943, Training R2: 0.931531
Validation Loss: 0.01453893, Validation R2: 0.571438

Epoch 178/1000
Training Loss: 0.00500881, Training R2: 0.930925
Validation Loss: 0.01450326, Validation R2: 0.569655

Epoch 179/1000
Training Loss: 0.00520122, Training R2: 0.929885
Validation Loss: 0.01434218, Validation R2: 0.576665

Epoch 180/1000
Epoch 00180: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00491705, Training R2: 0.932128
Validation Loss: 0.01441061, Validation R2: 0.578389

Epoch 181/1000
学习率已减少 4 次
Training Loss: 0.00469301, Training R2: 0.933924
Validation Loss: 0.01450893, Validation R2: 0.574929

Epoch 182/1000
Training Loss: 0.00465885, Training R2: 0.934520
Validation Loss: 0.01458308, Validation R2: 0.571473

Epoch 183/1000
Training Loss: 0.00466169, Training R2: 0.934917
Validation Loss: 0.01453410, Validation R2: 0.573810

Epoch 184/1000
Training Loss: 0.00466555, Training R2: 0.934822
Validation Loss: 0.01446593, Validation R2: 0.575113

Epoch 185/1000
Training Loss: 0.00462376, Training R2: 0.935168
Validation Loss: 0.01446901, Validation R2: 0.574654

Epoch 186/1000
Training Loss: 0.00468112, Training R2: 0.934669
Validation Loss: 0.01438466, Validation R2: 0.575063

Epoch 187/1000
Training Loss: 0.00471592, Training R2: 0.935085
Validation Loss: 0.01453468, Validation R2: 0.573311

Epoch 188/1000
Training Loss: 0.00469470, Training R2: 0.935392
Validation Loss: 0.01479458, Validation R2: 0.567150

Epoch 189/1000
Training Loss: 0.00477888, Training R2: 0.935276
Validation Loss: 0.01463212, Validation R2: 0.573287

Epoch 190/1000
Training Loss: 0.00463498, Training R2: 0.936877
Validation Loss: 0.01438976, Validation R2: 0.578240

Epoch 191/1000
Training Loss: 0.00454764, Training R2: 0.936811
Validation Loss: 0.01447082, Validation R2: 0.576735

Epoch 192/1000
Training Loss: 0.00445732, Training R2: 0.937328
Validation Loss: 0.01438481, Validation R2: 0.579319

Epoch 193/1000
Training Loss: 0.00439723, Training R2: 0.937881
Validation Loss: 0.01460367, Validation R2: 0.573560

Epoch 194/1000
Training Loss: 0.00440793, Training R2: 0.938060
Validation Loss: 0.01464457, Validation R2: 0.572441

Epoch 195/1000
Training Loss: 0.00452228, Training R2: 0.937270
Validation Loss: 0.01455492, Validation R2: 0.575329

Epoch 196/1000
Training Loss: 0.00451108, Training R2: 0.938359
Validation Loss: 0.01436536, Validation R2: 0.577473

Epoch 197/1000
Training Loss: 0.00465980, Training R2: 0.937356
Validation Loss: 0.01448143, Validation R2: 0.577807

Epoch 198/1000
Training Loss: 0.00445286, Training R2: 0.937274
Validation Loss: 0.01476078, Validation R2: 0.567901

Epoch 199/1000
Training Loss: 0.00473110, Training R2: 0.936585
Validation Loss: 0.01466189, Validation R2: 0.572819

Epoch 200/1000
Training Loss: 0.00455246, Training R2: 0.938348
Validation Loss: 0.01431928, Validation R2: 0.579257

Epoch 201/1000
Epoch 00201: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00486591, Training R2: 0.934922
Validation Loss: 0.01436177, Validation R2: 0.579566

Epoch 202/1000
学习率已减少 5 次
Training Loss: 0.00499898, Training R2: 0.933627
Validation Loss: 0.01470025, Validation R2: 0.574448

Epoch 203/1000
Training Loss: 0.00455525, Training R2: 0.937813
Validation Loss: 0.01438634, Validation R2: 0.580873

Epoch 204/1000
Training Loss: 0.00441417, Training R2: 0.938353
Validation Loss: 0.01461748, Validation R2: 0.576825

Epoch 205/1000
Training Loss: 0.00440323, Training R2: 0.939280
Validation Loss: 0.01446780, Validation R2: 0.579227

Epoch 206/1000
Training Loss: 0.00427783, Training R2: 0.940117
Validation Loss: 0.01446193, Validation R2: 0.579068

Epoch 207/1000
Training Loss: 0.00426775, Training R2: 0.939253
Validation Loss: 0.01447336, Validation R2: 0.579360

Epoch 208/1000
Training Loss: 0.00427537, Training R2: 0.939214
Validation Loss: 0.01459521, Validation R2: 0.575725

Epoch 209/1000
Training Loss: 0.00423826, Training R2: 0.940011
Validation Loss: 0.01450805, Validation R2: 0.577532

Epoch 210/1000
Training Loss: 0.00418583, Training R2: 0.940298
Validation Loss: 0.01445114, Validation R2: 0.578521

Epoch 211/1000
Training Loss: 0.00431803, Training R2: 0.939683
Validation Loss: 0.01473568, Validation R2: 0.571464

Epoch 212/1000
Training Loss: 0.00438535, Training R2: 0.939673
Validation Loss: 0.01447637, Validation R2: 0.579382

Epoch 213/1000
Training Loss: 0.00429093, Training R2: 0.940218
Validation Loss: 0.01435089, Validation R2: 0.581383

Epoch 214/1000
Training Loss: 0.00452784, Training R2: 0.938084
Validation Loss: 0.01462339, Validation R2: 0.575143

Epoch 215/1000
Training Loss: 0.00446448, Training R2: 0.939435
Validation Loss: 0.01430961, Validation R2: 0.582447

Epoch 216/1000
Training Loss: 0.00422918, Training R2: 0.940624
Validation Loss: 0.01446471, Validation R2: 0.578576

Epoch 217/1000
Training Loss: 0.00422406, Training R2: 0.939632
Validation Loss: 0.01464174, Validation R2: 0.573217

Epoch 218/1000
Training Loss: 0.00433395, Training R2: 0.940658
Validation Loss: 0.01439576, Validation R2: 0.579674

Epoch 219/1000
Training Loss: 0.00421409, Training R2: 0.940261
Validation Loss: 0.01447660, Validation R2: 0.579504

Epoch 220/1000
Training Loss: 0.00409714, Training R2: 0.941175
Validation Loss: 0.01447781, Validation R2: 0.580708

Epoch 221/1000
Training Loss: 0.00401489, Training R2: 0.941607
Validation Loss: 0.01452752, Validation R2: 0.579350

Epoch 222/1000
Epoch 00222: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00401081, Training R2: 0.941852
Validation Loss: 0.01445383, Validation R2: 0.579723

Epoch 223/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
