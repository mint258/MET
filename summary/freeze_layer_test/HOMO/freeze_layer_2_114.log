Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5293187

Epoch 1/1000
Training Loss: 0.84233000, Training R2: -1397.202148
Validation Loss: 0.54634511, Validation R2: -287.642548
Saved best model with validation R2 -287.642548 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.32224761, Training R2: -113.953842
Validation Loss: 0.18758087, Validation R2: -34.974739
Saved best model with validation R2 -34.974739 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.12415368, Training R2: -16.552570
Validation Loss: 0.10895519, Validation R2: -11.758347
Saved best model with validation R2 -11.758347 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.08586820, Training R2: -7.844957
Validation Loss: 0.07250825, Validation R2: -5.145249
Saved best model with validation R2 -5.145249 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.06267006, Training R2: -3.435514
Validation Loss: 0.05987501, Validation R2: -3.363952
Saved best model with validation R2 -3.363952 to best_finetuned_model.pth

Epoch 6/1000
Training Loss: 0.05518455, Training R2: -2.701573
Validation Loss: 0.04235668, Validation R2: -1.382641
Saved best model with validation R2 -1.382641 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.04395290, Training R2: -1.536220
Validation Loss: 0.05125236, Validation R2: -2.243949

Epoch 8/1000
Training Loss: 0.04617696, Training R2: -1.634598
Validation Loss: 0.05886980, Validation R2: -3.055906

Epoch 9/1000
Training Loss: 0.05293924, Training R2: -2.296654
Validation Loss: 0.02531759, Validation R2: -0.106568
Saved best model with validation R2 -0.106568 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.03136778, Training R2: -0.460111
Validation Loss: 0.02611869, Validation R2: -0.139962

Epoch 11/1000
Training Loss: 0.02854875, Training R2: -0.206451
Validation Loss: 0.02740081, Validation R2: -0.199888

Epoch 12/1000
Training Loss: 0.02704824, Training R2: -0.123434
Validation Loss: 0.02222779, Validation R2: 0.084144
Saved best model with validation R2 0.084144 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.02350118, Training R2: 0.068716
Validation Loss: 0.02200582, Validation R2: 0.109010
Saved best model with validation R2 0.109010 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.02745242, Training R2: -0.143510
Validation Loss: 0.03155484, Validation R2: -0.419053

Epoch 15/1000
Training Loss: 0.02728678, Training R2: -0.102139
Validation Loss: 0.02141150, Validation R2: 0.174645
Saved best model with validation R2 0.174645 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.02647477, Training R2: -0.073125
Validation Loss: 0.02048101, Validation R2: 0.251090
Saved best model with validation R2 0.251090 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.02238467, Training R2: 0.183775
Validation Loss: 0.02401204, Validation R2: 0.091562

Epoch 18/1000
Training Loss: 0.02839583, Training R2: -0.179080
Validation Loss: 0.03356139, Validation R2: -0.449085

Epoch 19/1000
Training Loss: 0.05312468, Training R2: -2.281867
Validation Loss: 0.04684204, Validation R2: -1.578602

Epoch 20/1000
Training Loss: 0.03853551, Training R2: -0.783424
Validation Loss: 0.04035591, Validation R2: -0.946224

Epoch 21/1000
Training Loss: 0.04466025, Training R2: -1.280330
Validation Loss: 0.04336303, Validation R2: -1.203720

Epoch 22/1000
Training Loss: 0.03791244, Training R2: -0.752475
Validation Loss: 0.04018733, Validation R2: -0.944777

Epoch 23/1000
Training Loss: 0.04378026, Training R2: -1.197183
Validation Loss: 0.03319270, Validation R2: -0.388918

Epoch 24/1000
Training Loss: 0.03573698, Training R2: -0.564017
Validation Loss: 0.04379259, Validation R2: -1.228657

Epoch 25/1000
Training Loss: 0.04816999, Training R2: -1.594650
Validation Loss: 0.04076101, Validation R2: -0.957723

Epoch 26/1000
Training Loss: 0.03597359, Training R2: -0.600058
Validation Loss: 0.03572460, Validation R2: -0.598406

Epoch 27/1000
Training Loss: 0.03870136, Training R2: -0.819708
Validation Loss: 0.04184450, Validation R2: -1.158774

Epoch 28/1000
Training Loss: 0.04196272, Training R2: -1.083771
Validation Loss: 0.03858409, Validation R2: -0.857606

Epoch 29/1000
Training Loss: 0.03887580, Training R2: -0.815514
Validation Loss: 0.03516141, Validation R2: -0.546151

Epoch 30/1000
Training Loss: 0.03236630, Training R2: -0.375088
Validation Loss: 0.03112125, Validation R2: -0.232753

Epoch 31/1000
Training Loss: 0.03479598, Training R2: -0.551998
Validation Loss: 0.04885172, Validation R2: -1.715492

Epoch 32/1000
Training Loss: 0.03702734, Training R2: -0.738363
Validation Loss: 0.03862323, Validation R2: -0.825776

Epoch 33/1000
Training Loss: 0.03236066, Training R2: -0.377518
Validation Loss: 0.01799502, Validation R2: 0.481669
Saved best model with validation R2 0.481669 to best_finetuned_model.pth

Epoch 34/1000
Training Loss: 0.02341068, Training R2: 0.200470
Validation Loss: 0.01785242, Validation R2: 0.417744

Epoch 35/1000
Training Loss: 0.01905869, Training R2: 0.427704
Validation Loss: 0.02117169, Validation R2: 0.216718

Epoch 36/1000
Training Loss: 0.02204712, Training R2: 0.292798
Validation Loss: 0.02085936, Validation R2: 0.376025

Epoch 37/1000
Training Loss: 0.01918168, Training R2: 0.407710
Validation Loss: 0.01900255, Validation R2: 0.328760

Epoch 38/1000
Training Loss: 0.01809926, Training R2: 0.462407
Validation Loss: 0.01969117, Validation R2: 0.441269

Epoch 39/1000
Training Loss: 0.02200896, Training R2: 0.337836
Validation Loss: 0.01788447, Validation R2: 0.413687

Epoch 40/1000
Training Loss: 0.02044663, Training R2: 0.395063
Validation Loss: 0.01584697, Validation R2: 0.537371
Saved best model with validation R2 0.537371 to best_finetuned_model.pth

Epoch 41/1000
Training Loss: 0.01965455, Training R2: 0.446822
Validation Loss: 0.01556596, Validation R2: 0.555034
Saved best model with validation R2 0.555034 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.02330802, Training R2: 0.266424
Validation Loss: 0.03439057, Validation R2: -0.524446

Epoch 43/1000
Training Loss: 0.02425267, Training R2: 0.196630
Validation Loss: 0.01810827, Validation R2: 0.495289

Epoch 44/1000
Training Loss: 0.02075026, Training R2: 0.410026
Validation Loss: 0.01627550, Validation R2: 0.496683

Epoch 45/1000
Training Loss: 0.01687673, Training R2: 0.558588
Validation Loss: 0.02226443, Validation R2: 0.212985

Epoch 46/1000
Training Loss: 0.02083659, Training R2: 0.388099
Validation Loss: 0.01670980, Validation R2: 0.469768

Epoch 47/1000
Training Loss: 0.02082508, Training R2: 0.394056
Validation Loss: 0.03333841, Validation R2: -0.303725

Epoch 48/1000
Training Loss: 0.03349916, Training R2: -0.455180
Validation Loss: 0.07763673, Validation R2: -5.139395

Epoch 49/1000
Training Loss: 0.06301977, Training R2: -3.448939
Validation Loss: 0.13345607, Validation R2: -16.580231

Epoch 50/1000
Training Loss: 0.08803937, Training R2: -7.194875
Validation Loss: 0.04178751, Validation R2: -0.968479

Epoch 51/1000
Training Loss: 0.06742805, Training R2: -3.813662
Validation Loss: 0.08213531, Validation R2: -5.954072

Epoch 52/1000
Training Loss: 0.08773624, Training R2: -6.555066
Validation Loss: 0.06546784, Validation R2: -3.613522

Epoch 53/1000
Training Loss: 0.05620215, Training R2: -2.641248
Validation Loss: 0.02906913, Validation R2: -0.067297

Epoch 54/1000
Training Loss: 0.08039435, Training R2: -6.389696
Validation Loss: 0.02971452, Validation R2: -0.133434

Epoch 55/1000
Training Loss: 0.04031080, Training R2: -0.965687
Validation Loss: 0.07460545, Validation R2: -4.829977

Epoch 56/1000
Training Loss: 0.05969324, Training R2: -3.078661
Validation Loss: 0.05318301, Validation R2: -2.089483

Epoch 57/1000
Training Loss: 0.06130677, Training R2: -2.939777
Validation Loss: 0.05214581, Validation R2: -1.980463

Epoch 58/1000
Training Loss: 0.05281302, Training R2: -2.076746
Validation Loss: 0.08184399, Validation R2: -5.969873

Epoch 59/1000
Training Loss: 0.06036236, Training R2: -2.959078
Validation Loss: 0.04797987, Validation R2: -1.570110

Epoch 60/1000
Training Loss: 0.05634775, Training R2: -2.423344
Validation Loss: 0.05362956, Validation R2: -2.188262

Epoch 61/1000
Training Loss: 0.04960960, Training R2: -1.845441
Validation Loss: 0.08411831, Validation R2: -6.365838

Epoch 62/1000
Epoch 00062: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.06024301, Training R2: -2.948276
Validation Loss: 0.04666267, Validation R2: -1.468098

Epoch 63/1000
学习率已减少 1 次
Training Loss: 0.03592464, Training R2: -0.662325
Validation Loss: 0.03425131, Validation R2: -0.577531

Epoch 64/1000
Training Loss: 0.03008959, Training R2: -0.191354
Validation Loss: 0.01675357, Validation R2: 0.484257

Epoch 65/1000
Training Loss: 0.02427672, Training R2: 0.161063
Validation Loss: 0.01983266, Validation R2: 0.383671

Epoch 66/1000
Training Loss: 0.01783008, Training R2: 0.502531
Validation Loss: 0.01497084, Validation R2: 0.590428
Saved best model with validation R2 0.590428 to best_finetuned_model.pth

Epoch 67/1000
Training Loss: 0.01559992, Training R2: 0.608966
Validation Loss: 0.01713957, Validation R2: 0.464892

Epoch 68/1000
Training Loss: 0.01645349, Training R2: 0.579477
Validation Loss: 0.01458351, Validation R2: 0.598888
Saved best model with validation R2 0.598888 to best_finetuned_model.pth

Epoch 69/1000
Training Loss: 0.01324289, Training R2: 0.692527
Validation Loss: 0.01635690, Validation R2: 0.540879

Epoch 70/1000
Training Loss: 0.01383388, Training R2: 0.683609
Validation Loss: 0.01694625, Validation R2: 0.515190

Epoch 71/1000
Training Loss: 0.01582683, Training R2: 0.622911
Validation Loss: 0.01578126, Validation R2: 0.566581

Epoch 72/1000
Training Loss: 0.01385523, Training R2: 0.685421
Validation Loss: 0.01678092, Validation R2: 0.512166

Epoch 73/1000
Training Loss: 0.01382968, Training R2: 0.677474
Validation Loss: 0.01949047, Validation R2: 0.384799

Epoch 74/1000
Training Loss: 0.01872133, Training R2: 0.516234
Validation Loss: 0.01565558, Validation R2: 0.567442

Epoch 75/1000
Training Loss: 0.01574796, Training R2: 0.624838
Validation Loss: 0.01358853, Validation R2: 0.654756
Saved best model with validation R2 0.654756 to best_finetuned_model.pth

Epoch 76/1000
Training Loss: 0.01147116, Training R2: 0.751540
Validation Loss: 0.01571641, Validation R2: 0.576080

Epoch 77/1000
Training Loss: 0.01332049, Training R2: 0.702930
Validation Loss: 0.01540209, Validation R2: 0.568056

Epoch 78/1000
Training Loss: 0.01196448, Training R2: 0.739885
Validation Loss: 0.01488251, Validation R2: 0.581645

Epoch 79/1000
Training Loss: 0.01201628, Training R2: 0.755843
Validation Loss: 0.01341203, Validation R2: 0.659318
Saved best model with validation R2 0.659318 to best_finetuned_model.pth

Epoch 80/1000
Training Loss: 0.01022922, Training R2: 0.797202
Validation Loss: 0.01622494, Validation R2: 0.578451

Epoch 81/1000
Training Loss: 0.01061112, Training R2: 0.788549
Validation Loss: 0.01586570, Validation R2: 0.572488

Epoch 82/1000
Training Loss: 0.01008148, Training R2: 0.808124
Validation Loss: 0.01408135, Validation R2: 0.648900

Epoch 83/1000
Training Loss: 0.00907226, Training R2: 0.828253
Validation Loss: 0.01821770, Validation R2: 0.505651

Epoch 84/1000
Training Loss: 0.01229566, Training R2: 0.745926
Validation Loss: 0.02523415, Validation R2: 0.208485

Epoch 85/1000
Training Loss: 0.01918677, Training R2: 0.507149
Validation Loss: 0.02257656, Validation R2: 0.329520

Epoch 86/1000
Training Loss: 0.01766009, Training R2: 0.596728
Validation Loss: 0.01722340, Validation R2: 0.536684

Epoch 87/1000
Training Loss: 0.01417997, Training R2: 0.707090
Validation Loss: 0.02536420, Validation R2: 0.149896

Epoch 88/1000
Training Loss: 0.01957245, Training R2: 0.538975
Validation Loss: 0.02046367, Validation R2: 0.398424

Epoch 89/1000
Training Loss: 0.01666185, Training R2: 0.637365
Validation Loss: 0.02463597, Validation R2: 0.214352

Epoch 90/1000
Training Loss: 0.01879426, Training R2: 0.556660
Validation Loss: 0.01750036, Validation R2: 0.526528

Epoch 91/1000
Training Loss: 0.01370818, Training R2: 0.722385
Validation Loss: 0.01416088, Validation R2: 0.652325

Epoch 92/1000
Training Loss: 0.00908601, Training R2: 0.828355
Validation Loss: 0.01369286, Validation R2: 0.661023
Saved best model with validation R2 0.661023 to best_finetuned_model.pth

Epoch 93/1000
Training Loss: 0.00923591, Training R2: 0.835238
Validation Loss: 0.01377763, Validation R2: 0.663069
Saved best model with validation R2 0.663069 to best_finetuned_model.pth

Epoch 94/1000
Training Loss: 0.00833905, Training R2: 0.854317
Validation Loss: 0.01394591, Validation R2: 0.647597

Epoch 95/1000
Training Loss: 0.00787092, Training R2: 0.864563
Validation Loss: 0.02034360, Validation R2: 0.396723

Epoch 96/1000
Training Loss: 0.01219870, Training R2: 0.763107
Validation Loss: 0.01400016, Validation R2: 0.657397

Epoch 97/1000
Training Loss: 0.01020851, Training R2: 0.808252
Validation Loss: 0.01454981, Validation R2: 0.618931

Epoch 98/1000
Training Loss: 0.00973125, Training R2: 0.829210
Validation Loss: 0.01521623, Validation R2: 0.610010

Epoch 99/1000
Training Loss: 0.00862603, Training R2: 0.852469
Validation Loss: 0.01405720, Validation R2: 0.639722

Epoch 100/1000
Training Loss: 0.00910458, Training R2: 0.850597
Validation Loss: 0.01441833, Validation R2: 0.630304

Epoch 101/1000
Training Loss: 0.00705782, Training R2: 0.880025
Validation Loss: 0.01370076, Validation R2: 0.654985

Epoch 102/1000
Training Loss: 0.01013889, Training R2: 0.820788
Validation Loss: 0.01505972, Validation R2: 0.610649

Epoch 103/1000
Training Loss: 0.00960885, Training R2: 0.835039
Validation Loss: 0.01379861, Validation R2: 0.637431

Epoch 104/1000
Training Loss: 0.01026822, Training R2: 0.812342
Validation Loss: 0.02310319, Validation R2: 0.257739

Epoch 105/1000
Training Loss: 0.01842571, Training R2: 0.586058
Validation Loss: 0.02309313, Validation R2: 0.257356

Epoch 106/1000
Training Loss: 0.01741534, Training R2: 0.630030
Validation Loss: 0.02916603, Validation R2: -0.071668

Epoch 107/1000
Training Loss: 0.02106469, Training R2: 0.468011
Validation Loss: 0.02430733, Validation R2: 0.209313

Epoch 108/1000
Training Loss: 0.01833732, Training R2: 0.605508
Validation Loss: 0.02846780, Validation R2: -0.019915

Epoch 109/1000
Training Loss: 0.02069021, Training R2: 0.495799
Validation Loss: 0.02117502, Validation R2: 0.342911

Epoch 110/1000
Training Loss: 0.01721822, Training R2: 0.625670
Validation Loss: 0.01729787, Validation R2: 0.513763

Epoch 111/1000
Training Loss: 0.01335431, Training R2: 0.736601
Validation Loss: 0.03045839, Validation R2: -0.134132

Epoch 112/1000
Training Loss: 0.02121284, Training R2: 0.491454
Validation Loss: 0.02486835, Validation R2: 0.183221

Epoch 113/1000
Training Loss: 0.01866342, Training R2: 0.589337
Validation Loss: 0.02712293, Validation R2: 0.060092

Epoch 114/1000
Epoch 00114: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01892605, Training R2: 0.584307
Validation Loss: 0.02246891, Validation R2: 0.296403

Epoch 115/1000
学习率已减少 2 次
Training Loss: 0.01402658, Training R2: 0.729570
Validation Loss: 0.01638512, Validation R2: 0.546942

Epoch 116/1000
Training Loss: 0.01193104, Training R2: 0.784046
Validation Loss: 0.01381019, Validation R2: 0.643784

Epoch 117/1000
Training Loss: 0.00965184, Training R2: 0.828656
Validation Loss: 0.01428913, Validation R2: 0.636229

Epoch 118/1000
Training Loss: 0.00853187, Training R2: 0.856269
Validation Loss: 0.01490580, Validation R2: 0.611334

Epoch 119/1000
Training Loss: 0.00842958, Training R2: 0.866540
Validation Loss: 0.01330167, Validation R2: 0.667627
Saved best model with validation R2 0.667627 to best_finetuned_model.pth

Epoch 120/1000
Training Loss: 0.00707635, Training R2: 0.888926
Validation Loss: 0.01488889, Validation R2: 0.606842

Epoch 121/1000
Training Loss: 0.00788086, Training R2: 0.870465
Validation Loss: 0.01376102, Validation R2: 0.650090

Epoch 122/1000
Training Loss: 0.00685191, Training R2: 0.890903
Validation Loss: 0.01309539, Validation R2: 0.670183
Saved best model with validation R2 0.670183 to best_finetuned_model.pth

Epoch 123/1000
Training Loss: 0.00654296, Training R2: 0.898019
Validation Loss: 0.01312063, Validation R2: 0.669237

Epoch 124/1000
Training Loss: 0.00620689, Training R2: 0.906524
Validation Loss: 0.01317360, Validation R2: 0.668865

Epoch 125/1000
Training Loss: 0.00637198, Training R2: 0.904514
Validation Loss: 0.01350551, Validation R2: 0.660161

Epoch 126/1000
Training Loss: 0.00578997, Training R2: 0.912384
Validation Loss: 0.01380720, Validation R2: 0.656547

Epoch 127/1000
Training Loss: 0.00581932, Training R2: 0.909362
Validation Loss: 0.01310955, Validation R2: 0.681356
Saved best model with validation R2 0.681356 to best_finetuned_model.pth

Epoch 128/1000
Training Loss: 0.00592863, Training R2: 0.908208
Validation Loss: 0.01311410, Validation R2: 0.675379

Epoch 129/1000
Training Loss: 0.00627824, Training R2: 0.903982
Validation Loss: 0.01327468, Validation R2: 0.671578

Epoch 130/1000
Training Loss: 0.00529549, Training R2: 0.917657
Validation Loss: 0.01453005, Validation R2: 0.619851

Epoch 131/1000
Training Loss: 0.00584299, Training R2: 0.913313
Validation Loss: 0.01371213, Validation R2: 0.653974

Epoch 132/1000
Training Loss: 0.00595296, Training R2: 0.907284
Validation Loss: 0.01293747, Validation R2: 0.684343
Saved best model with validation R2 0.684343 to best_finetuned_model.pth

Epoch 133/1000
Training Loss: 0.00531454, Training R2: 0.918140
Validation Loss: 0.01341154, Validation R2: 0.670220

Epoch 134/1000
Training Loss: 0.00480330, Training R2: 0.925735
Validation Loss: 0.01313471, Validation R2: 0.677016

Epoch 135/1000
Training Loss: 0.00563124, Training R2: 0.918748
Validation Loss: 0.01407258, Validation R2: 0.636234

Epoch 136/1000
Training Loss: 0.00500030, Training R2: 0.924911
Validation Loss: 0.01279690, Validation R2: 0.683157

Epoch 137/1000
Training Loss: 0.00574629, Training R2: 0.912885
Validation Loss: 0.01316001, Validation R2: 0.678252

Epoch 138/1000
Training Loss: 0.00490415, Training R2: 0.923451
Validation Loss: 0.01291388, Validation R2: 0.680341

Epoch 139/1000
Training Loss: 0.00512973, Training R2: 0.920008
Validation Loss: 0.01351049, Validation R2: 0.665869

Epoch 140/1000
Training Loss: 0.00538279, Training R2: 0.921177
Validation Loss: 0.01359328, Validation R2: 0.658851

Epoch 141/1000
Training Loss: 0.00430230, Training R2: 0.931817
Validation Loss: 0.01297721, Validation R2: 0.679961

Epoch 142/1000
Training Loss: 0.00569869, Training R2: 0.918342
Validation Loss: 0.01389524, Validation R2: 0.661780

Epoch 143/1000
Training Loss: 0.00482537, Training R2: 0.927639
Validation Loss: 0.01428902, Validation R2: 0.640136

Epoch 144/1000
Training Loss: 0.00488822, Training R2: 0.928191
Validation Loss: 0.01342002, Validation R2: 0.661655

Epoch 145/1000
Training Loss: 0.00680757, Training R2: 0.907356
Validation Loss: 0.01326096, Validation R2: 0.668514

Epoch 146/1000
Training Loss: 0.01135317, Training R2: 0.824181
Validation Loss: 0.01314351, Validation R2: 0.672570

Epoch 147/1000
Training Loss: 0.00995694, Training R2: 0.851248
Validation Loss: 0.01419823, Validation R2: 0.633523

Epoch 148/1000
Training Loss: 0.01003262, Training R2: 0.856509
Validation Loss: 0.01281676, Validation R2: 0.681498

Epoch 149/1000
Training Loss: 0.01046148, Training R2: 0.841510
Validation Loss: 0.01296274, Validation R2: 0.672288

Epoch 150/1000
Training Loss: 0.00955093, Training R2: 0.864619
Validation Loss: 0.01350304, Validation R2: 0.652140

Epoch 151/1000
Training Loss: 0.00967173, Training R2: 0.862887
Validation Loss: 0.01292682, Validation R2: 0.671509

Epoch 152/1000
Training Loss: 0.01026316, Training R2: 0.847741
Validation Loss: 0.01375457, Validation R2: 0.638972

Epoch 153/1000
Epoch 00153: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00914529, Training R2: 0.869376
Validation Loss: 0.01358481, Validation R2: 0.641818

Epoch 154/1000
学习率已减少 3 次
Training Loss: 0.00689211, Training R2: 0.906485
Validation Loss: 0.01311591, Validation R2: 0.665057

Epoch 155/1000
Training Loss: 0.00588512, Training R2: 0.916987
Validation Loss: 0.01362695, Validation R2: 0.659276

Epoch 156/1000
Training Loss: 0.00568149, Training R2: 0.920027
Validation Loss: 0.01374336, Validation R2: 0.659983

Epoch 157/1000
Training Loss: 0.00504119, Training R2: 0.924984
Validation Loss: 0.01374322, Validation R2: 0.665202

Epoch 158/1000
Training Loss: 0.00490207, Training R2: 0.930260
Validation Loss: 0.01337918, Validation R2: 0.679797

Epoch 159/1000
Training Loss: 0.00464003, Training R2: 0.934151
Validation Loss: 0.01307165, Validation R2: 0.686936
Saved best model with validation R2 0.686936 to best_finetuned_model.pth

Epoch 160/1000
Training Loss: 0.00451697, Training R2: 0.935646
Validation Loss: 0.01271040, Validation R2: 0.694089
Saved best model with validation R2 0.694089 to best_finetuned_model.pth

Epoch 161/1000
Training Loss: 0.00486349, Training R2: 0.932499
Validation Loss: 0.01279221, Validation R2: 0.689834

Epoch 162/1000
Training Loss: 0.00474149, Training R2: 0.931816
Validation Loss: 0.01285167, Validation R2: 0.689537

Epoch 163/1000
Training Loss: 0.00378879, Training R2: 0.941017
Validation Loss: 0.01318117, Validation R2: 0.677713

Epoch 164/1000
Training Loss: 0.00387549, Training R2: 0.940731
Validation Loss: 0.01433534, Validation R2: 0.632370

Epoch 165/1000
Training Loss: 0.00490280, Training R2: 0.931512
Validation Loss: 0.01584272, Validation R2: 0.568604

Epoch 166/1000
Training Loss: 0.00667515, Training R2: 0.911401
Validation Loss: 0.01369559, Validation R2: 0.651468

Epoch 167/1000
Training Loss: 0.00406710, Training R2: 0.939285
Validation Loss: 0.01335445, Validation R2: 0.665357

Epoch 168/1000
Training Loss: 0.00358518, Training R2: 0.943439
Validation Loss: 0.01374267, Validation R2: 0.653591

Epoch 169/1000
Training Loss: 0.00367262, Training R2: 0.943673
Validation Loss: 0.01324813, Validation R2: 0.670234

Epoch 170/1000
Training Loss: 0.00335013, Training R2: 0.944485
Validation Loss: 0.01317460, Validation R2: 0.673454

Epoch 171/1000
Training Loss: 0.00367627, Training R2: 0.944822
Validation Loss: 0.01322314, Validation R2: 0.670432

Epoch 172/1000
Training Loss: 0.00452479, Training R2: 0.935938
Validation Loss: 0.01307225, Validation R2: 0.673981

Epoch 173/1000
Training Loss: 0.00567936, Training R2: 0.927401
Validation Loss: 0.01302199, Validation R2: 0.670455

Epoch 174/1000
Training Loss: 0.00483028, Training R2: 0.935466
Validation Loss: 0.01301103, Validation R2: 0.676406

Epoch 175/1000
Training Loss: 0.00433193, Training R2: 0.935954
Validation Loss: 0.01326831, Validation R2: 0.667113

Epoch 176/1000
Training Loss: 0.00466653, Training R2: 0.937536
Validation Loss: 0.01338997, Validation R2: 0.655601

Epoch 177/1000
Training Loss: 0.00570151, Training R2: 0.927484
Validation Loss: 0.01331361, Validation R2: 0.658751

Epoch 178/1000
Training Loss: 0.00435961, Training R2: 0.941841
Validation Loss: 0.01323761, Validation R2: 0.664452

Epoch 179/1000
Training Loss: 0.00533704, Training R2: 0.928801
Validation Loss: 0.01323194, Validation R2: 0.667762

Epoch 180/1000
Training Loss: 0.00540194, Training R2: 0.929412
Validation Loss: 0.01312131, Validation R2: 0.674205

Epoch 181/1000
Epoch 00181: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00464454, Training R2: 0.934055
Validation Loss: 0.01316824, Validation R2: 0.672614

Epoch 182/1000
学习率已减少 4 次
Training Loss: 0.00400467, Training R2: 0.942304
Validation Loss: 0.01330092, Validation R2: 0.668846

Epoch 183/1000
Training Loss: 0.00347494, Training R2: 0.946105
Validation Loss: 0.01372391, Validation R2: 0.655853

Epoch 184/1000
Training Loss: 0.00316683, Training R2: 0.949378
Validation Loss: 0.01390405, Validation R2: 0.649708

Epoch 185/1000
Training Loss: 0.00317794, Training R2: 0.948523
Validation Loss: 0.01433382, Validation R2: 0.631615

Epoch 186/1000
Training Loss: 0.00399399, Training R2: 0.944376
Validation Loss: 0.01314635, Validation R2: 0.672974

Epoch 187/1000
Training Loss: 0.00372599, Training R2: 0.945186
Validation Loss: 0.01309232, Validation R2: 0.673904

Epoch 188/1000
Training Loss: 0.00299295, Training R2: 0.950330
Validation Loss: 0.01330352, Validation R2: 0.667789

Epoch 189/1000
Training Loss: 0.00273173, Training R2: 0.950887
Validation Loss: 0.01310126, Validation R2: 0.673402

Epoch 190/1000
Training Loss: 0.00279130, Training R2: 0.950321
Validation Loss: 0.01297100, Validation R2: 0.676772

Epoch 191/1000
Training Loss: 0.00320792, Training R2: 0.947566
Validation Loss: 0.01295119, Validation R2: 0.677573

Epoch 192/1000
Training Loss: 0.00369994, Training R2: 0.945682
Validation Loss: 0.01328210, Validation R2: 0.668734

Epoch 193/1000
Training Loss: 0.00317704, Training R2: 0.947962
Validation Loss: 0.01408035, Validation R2: 0.640516

Epoch 194/1000
Training Loss: 0.00344117, Training R2: 0.948478
Validation Loss: 0.01370022, Validation R2: 0.655443

Epoch 195/1000
Training Loss: 0.00295825, Training R2: 0.950327
Validation Loss: 0.01344026, Validation R2: 0.664079

Epoch 196/1000
Training Loss: 0.00269040, Training R2: 0.950740
Validation Loss: 0.01304307, Validation R2: 0.676229

Epoch 197/1000
Training Loss: 0.00260922, Training R2: 0.951460
Validation Loss: 0.01321811, Validation R2: 0.669359

Epoch 198/1000
Training Loss: 0.00248072, Training R2: 0.952171
Validation Loss: 0.01315873, Validation R2: 0.673218

Epoch 199/1000
Training Loss: 0.00251922, Training R2: 0.951639
Validation Loss: 0.01361466, Validation R2: 0.658741

Epoch 200/1000
Training Loss: 0.00269301, Training R2: 0.951635
Validation Loss: 0.01329372, Validation R2: 0.669635

Epoch 201/1000
Training Loss: 0.00246078, Training R2: 0.951967
Validation Loss: 0.01321582, Validation R2: 0.670380

Epoch 202/1000
Epoch 00202: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00238355, Training R2: 0.953026
Validation Loss: 0.01316195, Validation R2: 0.670961

Epoch 203/1000
学习率已减少 5 次
Training Loss: 0.00240940, Training R2: 0.953217
Validation Loss: 0.01324388, Validation R2: 0.669660

Epoch 204/1000
Training Loss: 0.00226742, Training R2: 0.953086
Validation Loss: 0.01323662, Validation R2: 0.670339

Epoch 205/1000
Training Loss: 0.00223836, Training R2: 0.953046
Validation Loss: 0.01339083, Validation R2: 0.665052

Epoch 206/1000
Training Loss: 0.00224362, Training R2: 0.953137
Validation Loss: 0.01349616, Validation R2: 0.660937

Epoch 207/1000
Training Loss: 0.00231873, Training R2: 0.953001
Validation Loss: 0.01355279, Validation R2: 0.659326

Epoch 208/1000
Training Loss: 0.00236825, Training R2: 0.953189
Validation Loss: 0.01341704, Validation R2: 0.663737

Epoch 209/1000
Training Loss: 0.00223052, Training R2: 0.953631
Validation Loss: 0.01342578, Validation R2: 0.664908

Epoch 210/1000
Training Loss: 0.00219909, Training R2: 0.953617
Validation Loss: 0.01339376, Validation R2: 0.666632

Epoch 211/1000
Training Loss: 0.00216104, Training R2: 0.953284
Validation Loss: 0.01347834, Validation R2: 0.663572

Epoch 212/1000
Training Loss: 0.00222760, Training R2: 0.953953
Validation Loss: 0.01349067, Validation R2: 0.662408

Epoch 213/1000
Training Loss: 0.00223481, Training R2: 0.953059
Validation Loss: 0.01340564, Validation R2: 0.664383

Epoch 214/1000
Training Loss: 0.00217617, Training R2: 0.953533
Validation Loss: 0.01320860, Validation R2: 0.670389

Epoch 215/1000
Training Loss: 0.00211460, Training R2: 0.953507
Validation Loss: 0.01322779, Validation R2: 0.668000

Epoch 216/1000
Training Loss: 0.00206241, Training R2: 0.954226
Validation Loss: 0.01330211, Validation R2: 0.665330

Epoch 217/1000
Training Loss: 0.00202410, Training R2: 0.954515
Validation Loss: 0.01331759, Validation R2: 0.664660

Epoch 218/1000
Training Loss: 0.00202313, Training R2: 0.954120
Validation Loss: 0.01342517, Validation R2: 0.661455

Epoch 219/1000
Training Loss: 0.00200856, Training R2: 0.954688
Validation Loss: 0.01314669, Validation R2: 0.670768

Epoch 220/1000
Training Loss: 0.00223236, Training R2: 0.953559
Validation Loss: 0.01319247, Validation R2: 0.669694

Epoch 221/1000
Training Loss: 0.00208077, Training R2: 0.953922
Validation Loss: 0.01318183, Validation R2: 0.669780

Epoch 222/1000
Training Loss: 0.00229267, Training R2: 0.953931
Validation Loss: 0.01317459, Validation R2: 0.669769

Epoch 223/1000
Epoch 00223: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00230963, Training R2: 0.953890
Validation Loss: 0.01312962, Validation R2: 0.668930

Epoch 224/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
