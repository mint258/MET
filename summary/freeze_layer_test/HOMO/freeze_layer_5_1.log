Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)
冻结层 4: interaction_blocks.1 (SimpleInteractionBlock)
冻结层 5: interaction_blocks.2 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Frozen
interaction_blocks.1.conv1.lin_rel.bias: Frozen
interaction_blocks.1.conv1.lin_root.weight: Frozen
interaction_blocks.1.conv2.lin_rel.weight: Frozen
interaction_blocks.1.conv2.lin_rel.bias: Frozen
interaction_blocks.1.conv2.lin_root.weight: Frozen
interaction_blocks.1.lin1.weight: Frozen
interaction_blocks.1.lin1.bias: Frozen
interaction_blocks.1.lin2.weight: Frozen
interaction_blocks.1.lin2.bias: Frozen
interaction_blocks.1.lin_cat.weight: Frozen
interaction_blocks.1.lin_cat.bias: Frozen
interaction_blocks.1.norm.weight: Frozen
interaction_blocks.1.norm.bias: Frozen
interaction_blocks.1.norm.mean_scale: Frozen
interaction_blocks.1.lin_feature1.lin1.weight: Frozen
interaction_blocks.1.lin_feature1.lin2.weight: Frozen
interaction_blocks.1.lin_feature2.lin1.weight: Frozen
interaction_blocks.1.lin_feature2.lin2.weight: Frozen
interaction_blocks.1.lin.weight: Frozen
interaction_blocks.1.lin.bias: Frozen
interaction_blocks.1.lins.0.weight: Frozen
interaction_blocks.1.lins.0.bias: Frozen
interaction_blocks.1.lins.1.weight: Frozen
interaction_blocks.1.lins.1.bias: Frozen
interaction_blocks.1.lins.2.weight: Frozen
interaction_blocks.1.lins.2.bias: Frozen
interaction_blocks.1.lins.3.weight: Frozen
interaction_blocks.1.lins.3.bias: Frozen
interaction_blocks.1.final.weight: Frozen
interaction_blocks.1.final.bias: Frozen
interaction_blocks.2.conv1.lin_rel.weight: Frozen
interaction_blocks.2.conv1.lin_rel.bias: Frozen
interaction_blocks.2.conv1.lin_root.weight: Frozen
interaction_blocks.2.conv2.lin_rel.weight: Frozen
interaction_blocks.2.conv2.lin_rel.bias: Frozen
interaction_blocks.2.conv2.lin_root.weight: Frozen
interaction_blocks.2.lin1.weight: Frozen
interaction_blocks.2.lin1.bias: Frozen
interaction_blocks.2.lin2.weight: Frozen
interaction_blocks.2.lin2.bias: Frozen
interaction_blocks.2.lin_cat.weight: Frozen
interaction_blocks.2.lin_cat.bias: Frozen
interaction_blocks.2.norm.weight: Frozen
interaction_blocks.2.norm.bias: Frozen
interaction_blocks.2.norm.mean_scale: Frozen
interaction_blocks.2.lin_feature1.lin1.weight: Frozen
interaction_blocks.2.lin_feature1.lin2.weight: Frozen
interaction_blocks.2.lin_feature2.lin1.weight: Frozen
interaction_blocks.2.lin_feature2.lin2.weight: Frozen
interaction_blocks.2.lin.weight: Frozen
interaction_blocks.2.lin.bias: Frozen
interaction_blocks.2.lins.0.weight: Frozen
interaction_blocks.2.lins.0.bias: Frozen
interaction_blocks.2.lins.1.weight: Frozen
interaction_blocks.2.lins.1.bias: Frozen
interaction_blocks.2.lins.2.weight: Frozen
interaction_blocks.2.lins.2.bias: Frozen
interaction_blocks.2.lins.3.weight: Frozen
interaction_blocks.2.lins.3.bias: Frozen
interaction_blocks.2.final.weight: Frozen
interaction_blocks.2.final.bias: Frozen
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 2241155

Epoch 1/1000
Training Loss: 0.95595217, Training R2: -1030.275635
Validation Loss: 0.31835836, Validation R2: -76.692764
Saved best model with validation R2 -76.692764 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.30028240, Training R2: -100.771370
Validation Loss: 0.28959373, Validation R2: -62.909451
Saved best model with validation R2 -62.909451 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.19045432, Training R2: -42.054398
Validation Loss: 0.15130205, Validation R2: -17.707365
Saved best model with validation R2 -17.707365 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.11250983, Training R2: -15.426937
Validation Loss: 0.03944898, Validation R2: -0.833326
Saved best model with validation R2 -0.833326 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.08404361, Training R2: -8.506728
Validation Loss: 0.08186157, Validation R2: -4.686077

Epoch 6/1000
Training Loss: 0.08803038, Training R2: -8.017436
Validation Loss: 0.06954653, Validation R2: -3.618791

Epoch 7/1000
Training Loss: 0.05250483, Training R2: -2.742266
Validation Loss: 0.03075914, Validation R2: -0.245532
Saved best model with validation R2 -0.245532 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.03789455, Training R2: -1.206108
Validation Loss: 0.03139507, Validation R2: -0.244855
Saved best model with validation R2 -0.244855 to best_finetuned_model.pth

Epoch 9/1000
Training Loss: 0.02753703, Training R2: -0.276356
Validation Loss: 0.03185092, Validation R2: -0.236364
Saved best model with validation R2 -0.236364 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.02648705, Training R2: -0.179575
Validation Loss: 0.02883943, Validation R2: -0.090636
Saved best model with validation R2 -0.090636 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.02560291, Training R2: -0.106467
Validation Loss: 0.02687380, Validation R2: -0.009308
Saved best model with validation R2 -0.009308 to best_finetuned_model.pth

Epoch 12/1000
Training Loss: 0.02694293, Training R2: -0.161471
Validation Loss: 0.02682327, Validation R2: -0.008583
Saved best model with validation R2 -0.008583 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.02796535, Training R2: -0.246467
Validation Loss: 0.03330052, Validation R2: -0.303818

Epoch 14/1000
Training Loss: 0.03830065, Training R2: -0.960586
Validation Loss: 0.03694868, Validation R2: -0.481796

Epoch 15/1000
Training Loss: 0.02929273, Training R2: -0.278705
Validation Loss: 0.03197904, Validation R2: -0.186742

Epoch 16/1000
Training Loss: 0.03336367, Training R2: -0.590508
Validation Loss: 0.03394803, Validation R2: -0.274288

Epoch 17/1000
Training Loss: 0.03003020, Training R2: -0.341851
Validation Loss: 0.03099331, Validation R2: -0.124251

Epoch 18/1000
Training Loss: 0.02907966, Training R2: -0.236633
Validation Loss: 0.02917405, Validation R2: -0.038912

Epoch 19/1000
Training Loss: 0.03057501, Training R2: -0.353999
Validation Loss: 0.03117185, Validation R2: -0.158573

Epoch 20/1000
Training Loss: 0.03369583, Training R2: -0.549435
Validation Loss: 0.03305110, Validation R2: -0.260734

Epoch 21/1000
Training Loss: 0.02879762, Training R2: -0.212292
Validation Loss: 0.02537553, Validation R2: 0.124773
Saved best model with validation R2 0.124773 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.02848749, Training R2: -0.272879
Validation Loss: 0.03486935, Validation R2: -0.313339

Epoch 23/1000
Training Loss: 0.03856332, Training R2: -0.999995
Validation Loss: 0.04056608, Validation R2: -0.646616

Epoch 24/1000
Training Loss: 0.03055031, Training R2: -0.361315
Validation Loss: 0.02491810, Validation R2: 0.150657
Saved best model with validation R2 0.150657 to best_finetuned_model.pth

Epoch 25/1000
Training Loss: 0.02245940, Training R2: 0.184968
Validation Loss: 0.02883027, Validation R2: -0.010062

Epoch 26/1000
Training Loss: 0.02316038, Training R2: 0.135094
Validation Loss: 0.02653558, Validation R2: 0.094653

Epoch 27/1000
Training Loss: 0.02271646, Training R2: 0.150374
Validation Loss: 0.02343489, Validation R2: 0.223123
Saved best model with validation R2 0.223123 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.01999568, Training R2: 0.297723
Validation Loss: 0.02383467, Validation R2: 0.219653

Epoch 29/1000
Training Loss: 0.02001109, Training R2: 0.306832
Validation Loss: 0.02685652, Validation R2: 0.128048

Epoch 30/1000
Training Loss: 0.02071505, Training R2: 0.277928
Validation Loss: 0.02560216, Validation R2: 0.170126

Epoch 31/1000
Training Loss: 0.02751046, Training R2: -0.184553
Validation Loss: 0.03381058, Validation R2: -0.224838

Epoch 32/1000
Training Loss: 0.04014852, Training R2: -1.090818
Validation Loss: 0.03904017, Validation R2: -0.504962

Epoch 33/1000
Training Loss: 0.03016437, Training R2: -0.232741
Validation Loss: 0.03884904, Validation R2: -0.490302

Epoch 34/1000
Training Loss: 0.03665008, Training R2: -0.702748
Validation Loss: 0.04041206, Validation R2: -0.588685

Epoch 35/1000
Training Loss: 0.03219031, Training R2: -0.363854
Validation Loss: 0.02868890, Validation R2: 0.065791

Epoch 36/1000
Training Loss: 0.03597674, Training R2: -0.753573
Validation Loss: 0.05330160, Validation R2: -1.502561

Epoch 37/1000
Training Loss: 0.03738541, Training R2: -0.894178
Validation Loss: 0.04313348, Validation R2: -0.762829

Epoch 38/1000
Training Loss: 0.03396777, Training R2: -0.614556
Validation Loss: 0.04715569, Validation R2: -1.031988

Epoch 39/1000
Training Loss: 0.03901616, Training R2: -0.874141
Validation Loss: 0.03420468, Validation R2: -0.211435

Epoch 40/1000
Training Loss: 0.03044636, Training R2: -0.241885
Validation Loss: 0.03765668, Validation R2: -0.413917

Epoch 41/1000
Training Loss: 0.03459472, Training R2: -0.556050
Validation Loss: 0.04270650, Validation R2: -0.716813

Epoch 42/1000
Training Loss: 0.03599701, Training R2: -0.632500
Validation Loss: 0.03247621, Validation R2: -0.108918

Epoch 43/1000
Training Loss: 0.03097386, Training R2: -0.260970
Validation Loss: 0.03504967, Validation R2: -0.235698

Epoch 44/1000
Training Loss: 0.03048878, Training R2: -0.251849
Validation Loss: 0.04606399, Validation R2: -0.917502

Epoch 45/1000
Training Loss: 0.03908311, Training R2: -0.881776
Validation Loss: 0.03181324, Validation R2: -0.048259

Epoch 46/1000
Training Loss: 0.02998675, Training R2: -0.200317
Validation Loss: 0.03539684, Validation R2: -0.238817

Epoch 47/1000
Training Loss: 0.03184035, Training R2: -0.310539
Validation Loss: 0.04580626, Validation R2: -0.875293

Epoch 48/1000
Training Loss: 0.03683780, Training R2: -0.723412
Validation Loss: 0.02099732, Validation R2: 0.433699
Saved best model with validation R2 0.433699 to best_finetuned_model.pth

Epoch 49/1000
Training Loss: 0.02105539, Training R2: 0.301244
Validation Loss: 0.02112078, Validation R2: 0.429022

Epoch 50/1000
Training Loss: 0.01936207, Training R2: 0.423612
Validation Loss: 0.02671711, Validation R2: 0.214823

Epoch 51/1000
Training Loss: 0.02030505, Training R2: 0.382716
Validation Loss: 0.02093433, Validation R2: 0.449728
Saved best model with validation R2 0.449728 to best_finetuned_model.pth

Epoch 52/1000
Training Loss: 0.01954790, Training R2: 0.439601
Validation Loss: 0.01983663, Validation R2: 0.474113
Saved best model with validation R2 0.474113 to best_finetuned_model.pth

Epoch 53/1000
Training Loss: 0.01761221, Training R2: 0.507322
Validation Loss: 0.02343615, Validation R2: 0.336660

Epoch 54/1000
Training Loss: 0.01674582, Training R2: 0.559671
Validation Loss: 0.02876925, Validation R2: 0.138752

Epoch 55/1000
Training Loss: 0.02152788, Training R2: 0.315444
Validation Loss: 0.02061424, Validation R2: 0.484371
Saved best model with validation R2 0.484371 to best_finetuned_model.pth

Epoch 56/1000
Training Loss: 0.02116754, Training R2: 0.292484
Validation Loss: 0.01913597, Validation R2: 0.482735

Epoch 57/1000
Training Loss: 0.01875927, Training R2: 0.471670
Validation Loss: 0.02503300, Validation R2: 0.216718

Epoch 58/1000
Training Loss: 0.02086128, Training R2: 0.365231
Validation Loss: 0.01759220, Validation R2: 0.541692
Saved best model with validation R2 0.541692 to best_finetuned_model.pth

Epoch 59/1000
Training Loss: 0.02101116, Training R2: 0.302398
Validation Loss: 0.01818926, Validation R2: 0.536832

Epoch 60/1000
Training Loss: 0.01789755, Training R2: 0.509719
Validation Loss: 0.02300511, Validation R2: 0.391436

Epoch 61/1000
Training Loss: 0.01781798, Training R2: 0.514711
Validation Loss: 0.03287665, Validation R2: -0.157296

Epoch 62/1000
Training Loss: 0.02238812, Training R2: 0.273094
Validation Loss: 0.02387684, Validation R2: 0.275476

Epoch 63/1000
Training Loss: 0.02268304, Training R2: 0.273025
Validation Loss: 0.01900609, Validation R2: 0.478661

Epoch 64/1000
Training Loss: 0.03249956, Training R2: -0.377952
Validation Loss: 0.05643686, Validation R2: -1.659356

Epoch 65/1000
Training Loss: 0.03261190, Training R2: -0.463967
Validation Loss: 0.01843361, Validation R2: 0.508826

Epoch 66/1000
Training Loss: 0.01824786, Training R2: 0.488958
Validation Loss: 0.02833817, Validation R2: 0.195885

Epoch 67/1000
Training Loss: 0.02305549, Training R2: 0.254430
Validation Loss: 0.02810970, Validation R2: 0.201323

Epoch 68/1000
Training Loss: 0.02129053, Training R2: 0.344624
Validation Loss: 0.01707738, Validation R2: 0.590462
Saved best model with validation R2 0.590462 to best_finetuned_model.pth

Epoch 69/1000
Training Loss: 0.02272772, Training R2: 0.170058
Validation Loss: 0.02629327, Validation R2: 0.273450

Epoch 70/1000
Training Loss: 0.04176920, Training R2: -1.054404
Validation Loss: 0.03211310, Validation R2: 0.002655

Epoch 71/1000
Training Loss: 0.02284612, Training R2: 0.257126
Validation Loss: 0.01946279, Validation R2: 0.506617

Epoch 72/1000
Training Loss: 0.02474787, Training R2: 0.074102
Validation Loss: 0.04968119, Validation R2: -1.045267

Epoch 73/1000
Training Loss: 0.03159429, Training R2: -0.339511
Validation Loss: 0.02671625, Validation R2: 0.255359

Epoch 74/1000
Training Loss: 0.02954603, Training R2: -0.083039
Validation Loss: 0.05152088, Validation R2: -1.185434

Epoch 75/1000
Training Loss: 0.03279272, Training R2: -0.501394
Validation Loss: 0.02914829, Validation R2: 0.163447

Epoch 76/1000
Training Loss: 0.01994826, Training R2: 0.405610
Validation Loss: 0.02011980, Validation R2: 0.503693

Epoch 77/1000
Training Loss: 0.02520929, Training R2: 0.092742
Validation Loss: 0.04666477, Validation R2: -0.851111

Epoch 78/1000
Training Loss: 0.02981838, Training R2: -0.207739
Validation Loss: 0.02300958, Validation R2: 0.396938

Epoch 79/1000
Training Loss: 0.02121132, Training R2: 0.347014
Validation Loss: 0.02116726, Validation R2: 0.454594

Epoch 80/1000
Training Loss: 0.02941032, Training R2: -0.151587
Validation Loss: 0.04540351, Validation R2: -0.760379

Epoch 81/1000
Training Loss: 0.02776278, Training R2: -0.074921
Validation Loss: 0.01993150, Validation R2: 0.496409

Epoch 82/1000
Training Loss: 0.02261287, Training R2: 0.255997
Validation Loss: 0.03502456, Validation R2: -0.147796

Epoch 83/1000
Training Loss: 0.03205686, Training R2: -0.204815
Validation Loss: 0.03104417, Validation R2: 0.055428

Epoch 84/1000
Training Loss: 0.02599168, Training R2: 0.138202
Validation Loss: 0.03451049, Validation R2: -0.110232

Epoch 85/1000
Training Loss: 0.02739650, Training R2: 0.052693
Validation Loss: 0.03497581, Validation R2: -0.138242

Epoch 86/1000
Training Loss: 0.02637934, Training R2: 0.074681
Validation Loss: 0.02630898, Validation R2: 0.270065

Epoch 87/1000
Training Loss: 0.02940631, Training R2: -0.109244
Validation Loss: 0.04204388, Validation R2: -0.543128

Epoch 88/1000
Training Loss: 0.03101414, Training R2: -0.308650
Validation Loss: 0.03723859, Validation R2: -0.237073

Epoch 89/1000
Epoch 00089: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.03385544, Training R2: -0.453305
Validation Loss: 0.02577406, Validation R2: 0.298110

Epoch 90/1000
学习率已减少 1 次
Training Loss: 0.02162685, Training R2: 0.365914
Validation Loss: 0.02840998, Validation R2: 0.104249

Epoch 91/1000
Training Loss: 0.02046661, Training R2: 0.408692
Validation Loss: 0.01817946, Validation R2: 0.518905

Epoch 92/1000
Training Loss: 0.01602342, Training R2: 0.576337
Validation Loss: 0.02211657, Validation R2: 0.438208

Epoch 93/1000
Training Loss: 0.01613842, Training R2: 0.591116
Validation Loss: 0.01753552, Validation R2: 0.576188

Epoch 94/1000
Training Loss: 0.01251374, Training R2: 0.744382
Validation Loss: 0.01647065, Validation R2: 0.603455
Saved best model with validation R2 0.603455 to best_finetuned_model.pth

Epoch 95/1000
Training Loss: 0.01270905, Training R2: 0.746755
Validation Loss: 0.01731935, Validation R2: 0.568103

Epoch 96/1000
Training Loss: 0.01189318, Training R2: 0.761923
Validation Loss: 0.02064463, Validation R2: 0.450566

Epoch 97/1000
Training Loss: 0.01349302, Training R2: 0.710120
Validation Loss: 0.02209204, Validation R2: 0.386084

Epoch 98/1000
Training Loss: 0.01558139, Training R2: 0.633394
Validation Loss: 0.02332258, Validation R2: 0.334527

Epoch 99/1000
Training Loss: 0.01696614, Training R2: 0.585344
Validation Loss: 0.01653197, Validation R2: 0.583310

Epoch 100/1000
Training Loss: 0.01267572, Training R2: 0.729430
Validation Loss: 0.01738059, Validation R2: 0.581361

Epoch 101/1000
Training Loss: 0.01245070, Training R2: 0.745521
Validation Loss: 0.01595363, Validation R2: 0.607802
Saved best model with validation R2 0.607802 to best_finetuned_model.pth

Epoch 102/1000
Training Loss: 0.01100900, Training R2: 0.788557
Validation Loss: 0.01729753, Validation R2: 0.559955

Epoch 103/1000
Training Loss: 0.01148153, Training R2: 0.775549
Validation Loss: 0.01688572, Validation R2: 0.577447

Epoch 104/1000
Training Loss: 0.00971118, Training R2: 0.831522
Validation Loss: 0.01981542, Validation R2: 0.466012

Epoch 105/1000
Training Loss: 0.01146302, Training R2: 0.784085
Validation Loss: 0.02630603, Validation R2: 0.200363

Epoch 106/1000
Training Loss: 0.01851068, Training R2: 0.539607
Validation Loss: 0.01850562, Validation R2: 0.510388

Epoch 107/1000
Training Loss: 0.01325062, Training R2: 0.715682
Validation Loss: 0.01625571, Validation R2: 0.594911

Epoch 108/1000
Training Loss: 0.01033553, Training R2: 0.809601
Validation Loss: 0.01647598, Validation R2: 0.580306

Epoch 109/1000
Training Loss: 0.00929172, Training R2: 0.840468
Validation Loss: 0.01663841, Validation R2: 0.571473

Epoch 110/1000
Training Loss: 0.00932586, Training R2: 0.843818
Validation Loss: 0.01773569, Validation R2: 0.537440

Epoch 111/1000
Training Loss: 0.00992867, Training R2: 0.823660
Validation Loss: 0.01690495, Validation R2: 0.567916

Epoch 112/1000
Training Loss: 0.01002367, Training R2: 0.816898
Validation Loss: 0.01606919, Validation R2: 0.603838

Epoch 113/1000
Training Loss: 0.01064098, Training R2: 0.804526
Validation Loss: 0.01619621, Validation R2: 0.600114

Epoch 114/1000
Training Loss: 0.01095089, Training R2: 0.802947
Validation Loss: 0.01682192, Validation R2: 0.567624

Epoch 115/1000
Training Loss: 0.01112798, Training R2: 0.800890
Validation Loss: 0.01686087, Validation R2: 0.570672

Epoch 116/1000
Training Loss: 0.01444678, Training R2: 0.704930
Validation Loss: 0.02293255, Validation R2: 0.349914

Epoch 117/1000
Training Loss: 0.01744129, Training R2: 0.613165
Validation Loss: 0.01989513, Validation R2: 0.465532

Epoch 118/1000
Training Loss: 0.01202113, Training R2: 0.782041
Validation Loss: 0.01942975, Validation R2: 0.474616

Epoch 119/1000
Training Loss: 0.01522070, Training R2: 0.686446
Validation Loss: 0.01795442, Validation R2: 0.529427

Epoch 120/1000
Training Loss: 0.01411976, Training R2: 0.714139
Validation Loss: 0.02015947, Validation R2: 0.447591

Epoch 121/1000
Training Loss: 0.01654773, Training R2: 0.645548
Validation Loss: 0.02074276, Validation R2: 0.421758

Epoch 122/1000
Epoch 00122: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01321162, Training R2: 0.739537
Validation Loss: 0.01943906, Validation R2: 0.474874

Epoch 123/1000
学习率已减少 2 次
Training Loss: 0.01085729, Training R2: 0.805807
Validation Loss: 0.01642843, Validation R2: 0.595073

Epoch 124/1000
Training Loss: 0.00998310, Training R2: 0.827570
Validation Loss: 0.01600058, Validation R2: 0.628289
Saved best model with validation R2 0.628289 to best_finetuned_model.pth

Epoch 125/1000
Training Loss: 0.00947835, Training R2: 0.846191
Validation Loss: 0.01606792, Validation R2: 0.629354
Saved best model with validation R2 0.629354 to best_finetuned_model.pth

Epoch 126/1000
Training Loss: 0.00904586, Training R2: 0.860995
Validation Loss: 0.01609350, Validation R2: 0.612424

Epoch 127/1000
Training Loss: 0.00803059, Training R2: 0.883273
Validation Loss: 0.01777036, Validation R2: 0.546361

Epoch 128/1000
Training Loss: 0.00888203, Training R2: 0.856222
Validation Loss: 0.01708967, Validation R2: 0.568599

Epoch 129/1000
Training Loss: 0.00808692, Training R2: 0.869584
Validation Loss: 0.01589057, Validation R2: 0.611770

Epoch 130/1000
Training Loss: 0.00780285, Training R2: 0.881730
Validation Loss: 0.01577909, Validation R2: 0.623208

Epoch 131/1000
Training Loss: 0.00791848, Training R2: 0.879255
Validation Loss: 0.01608316, Validation R2: 0.604831

Epoch 132/1000
Training Loss: 0.00696648, Training R2: 0.896917
Validation Loss: 0.01563869, Validation R2: 0.629557
Saved best model with validation R2 0.629557 to best_finetuned_model.pth

Epoch 133/1000
Training Loss: 0.00732093, Training R2: 0.890948
Validation Loss: 0.01587329, Validation R2: 0.620778

Epoch 134/1000
Training Loss: 0.00723102, Training R2: 0.893533
Validation Loss: 0.01602539, Validation R2: 0.616340

Epoch 135/1000
Training Loss: 0.00682185, Training R2: 0.900173
Validation Loss: 0.01607516, Validation R2: 0.604296

Epoch 136/1000
Training Loss: 0.00673825, Training R2: 0.900037
Validation Loss: 0.01582634, Validation R2: 0.608155

Epoch 137/1000
Training Loss: 0.00650680, Training R2: 0.905424
Validation Loss: 0.01556781, Validation R2: 0.623108

Epoch 138/1000
Training Loss: 0.00640245, Training R2: 0.907476
Validation Loss: 0.01615306, Validation R2: 0.606465

Epoch 139/1000
Training Loss: 0.00637376, Training R2: 0.909975
Validation Loss: 0.01578815, Validation R2: 0.622474

Epoch 140/1000
Training Loss: 0.00616776, Training R2: 0.913147
Validation Loss: 0.01556361, Validation R2: 0.626275

Epoch 141/1000
Training Loss: 0.00602994, Training R2: 0.914700
Validation Loss: 0.01591162, Validation R2: 0.623621

Epoch 142/1000
Training Loss: 0.00692278, Training R2: 0.900691
Validation Loss: 0.01665145, Validation R2: 0.604853

Epoch 143/1000
Training Loss: 0.00826190, Training R2: 0.875740
Validation Loss: 0.01567082, Validation R2: 0.631626
Saved best model with validation R2 0.631626 to best_finetuned_model.pth

Epoch 144/1000
Training Loss: 0.00722561, Training R2: 0.897562
Validation Loss: 0.01567090, Validation R2: 0.636071
Saved best model with validation R2 0.636071 to best_finetuned_model.pth

Epoch 145/1000
Training Loss: 0.00669112, Training R2: 0.904163
Validation Loss: 0.01582297, Validation R2: 0.625435

Epoch 146/1000
Training Loss: 0.00637221, Training R2: 0.910038
Validation Loss: 0.01626792, Validation R2: 0.599604

Epoch 147/1000
Training Loss: 0.00571086, Training R2: 0.921260
Validation Loss: 0.01559955, Validation R2: 0.632111

Epoch 148/1000
Training Loss: 0.00633850, Training R2: 0.914274
Validation Loss: 0.01719870, Validation R2: 0.567557

Epoch 149/1000
Training Loss: 0.00697690, Training R2: 0.904811
Validation Loss: 0.01748087, Validation R2: 0.556190

Epoch 150/1000
Training Loss: 0.00698275, Training R2: 0.904747
Validation Loss: 0.01716677, Validation R2: 0.569896

Epoch 151/1000
Training Loss: 0.00782214, Training R2: 0.895426
Validation Loss: 0.01799524, Validation R2: 0.539685

Epoch 152/1000
Training Loss: 0.00859450, Training R2: 0.876819
Validation Loss: 0.01642944, Validation R2: 0.592238

Epoch 153/1000
Training Loss: 0.00769473, Training R2: 0.893981
Validation Loss: 0.01562831, Validation R2: 0.620246

Epoch 154/1000
Training Loss: 0.00656798, Training R2: 0.914459
Validation Loss: 0.01543403, Validation R2: 0.630085

Epoch 155/1000
Training Loss: 0.00575128, Training R2: 0.924174
Validation Loss: 0.01604027, Validation R2: 0.623404

Epoch 156/1000
Training Loss: 0.00805464, Training R2: 0.885467
Validation Loss: 0.01786646, Validation R2: 0.578735

Epoch 157/1000
Training Loss: 0.01071690, Training R2: 0.839288
Validation Loss: 0.01564520, Validation R2: 0.629588

Epoch 158/1000
Training Loss: 0.00715048, Training R2: 0.903481
Validation Loss: 0.01572550, Validation R2: 0.626526

Epoch 159/1000
Training Loss: 0.00610411, Training R2: 0.920646
Validation Loss: 0.01571234, Validation R2: 0.635069

Epoch 160/1000
Training Loss: 0.00708609, Training R2: 0.906929
Validation Loss: 0.01688500, Validation R2: 0.601930

Epoch 161/1000
Training Loss: 0.00902976, Training R2: 0.875385
Validation Loss: 0.01604309, Validation R2: 0.615055

Epoch 162/1000
Training Loss: 0.00727575, Training R2: 0.904377
Validation Loss: 0.01647647, Validation R2: 0.610391

Epoch 163/1000
Training Loss: 0.00809421, Training R2: 0.889261
Validation Loss: 0.01717000, Validation R2: 0.596346

Epoch 164/1000
Training Loss: 0.00994995, Training R2: 0.855660
Validation Loss: 0.01619497, Validation R2: 0.618650

Epoch 165/1000
Epoch 00165: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00775977, Training R2: 0.899214
Validation Loss: 0.01616746, Validation R2: 0.620183

Epoch 166/1000
学习率已减少 3 次
Training Loss: 0.00664049, Training R2: 0.917989
Validation Loss: 0.01720177, Validation R2: 0.567684

Epoch 167/1000
Training Loss: 0.00632752, Training R2: 0.920198
Validation Loss: 0.01603749, Validation R2: 0.607718

Epoch 168/1000
Training Loss: 0.00545895, Training R2: 0.929899
Validation Loss: 0.01576451, Validation R2: 0.623989

Epoch 169/1000
Training Loss: 0.00577835, Training R2: 0.927236
Validation Loss: 0.01572433, Validation R2: 0.619430

Epoch 170/1000
Training Loss: 0.00513697, Training R2: 0.935816
Validation Loss: 0.01615297, Validation R2: 0.606631

Epoch 171/1000
Training Loss: 0.00541606, Training R2: 0.933764
Validation Loss: 0.01692363, Validation R2: 0.577973

Epoch 172/1000
Training Loss: 0.00591629, Training R2: 0.926935
Validation Loss: 0.01577516, Validation R2: 0.617453

Epoch 173/1000
Training Loss: 0.00516405, Training R2: 0.936391
Validation Loss: 0.01541398, Validation R2: 0.632086

Epoch 174/1000
Training Loss: 0.00500294, Training R2: 0.938702
Validation Loss: 0.01549678, Validation R2: 0.629229

Epoch 175/1000
Training Loss: 0.00486470, Training R2: 0.940899
Validation Loss: 0.01540190, Validation R2: 0.630612

Epoch 176/1000
Training Loss: 0.00450380, Training R2: 0.944010
Validation Loss: 0.01543160, Validation R2: 0.630759

Epoch 177/1000
Training Loss: 0.00465298, Training R2: 0.942466
Validation Loss: 0.01556335, Validation R2: 0.628920

Epoch 178/1000
Training Loss: 0.00459996, Training R2: 0.943587
Validation Loss: 0.01565470, Validation R2: 0.624797

Epoch 179/1000
Training Loss: 0.00460546, Training R2: 0.943545
Validation Loss: 0.01558617, Validation R2: 0.623981

Epoch 180/1000
Training Loss: 0.00438822, Training R2: 0.946504
Validation Loss: 0.01570689, Validation R2: 0.619247

Epoch 181/1000
Training Loss: 0.00421018, Training R2: 0.948464
Validation Loss: 0.01581641, Validation R2: 0.618030

Epoch 182/1000
Training Loss: 0.00422852, Training R2: 0.946986
Validation Loss: 0.01563896, Validation R2: 0.627568

Epoch 183/1000
Training Loss: 0.00447130, Training R2: 0.945131
Validation Loss: 0.01566635, Validation R2: 0.631583

Epoch 184/1000
Training Loss: 0.00517786, Training R2: 0.940886
Validation Loss: 0.01550790, Validation R2: 0.630341

Epoch 185/1000
Training Loss: 0.00511853, Training R2: 0.940074
Validation Loss: 0.01542677, Validation R2: 0.630154

Epoch 186/1000
Epoch 00186: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00436762, Training R2: 0.947194
Validation Loss: 0.01555225, Validation R2: 0.629413

Epoch 187/1000
学习率已减少 4 次
Training Loss: 0.00447766, Training R2: 0.945694
Validation Loss: 0.01620907, Validation R2: 0.601134

Epoch 188/1000
Training Loss: 0.00425576, Training R2: 0.946229
Validation Loss: 0.01583153, Validation R2: 0.613747

Epoch 189/1000
Training Loss: 0.00395428, Training R2: 0.949510
Validation Loss: 0.01558383, Validation R2: 0.625646

Epoch 190/1000
Training Loss: 0.00401132, Training R2: 0.949423
Validation Loss: 0.01578711, Validation R2: 0.615153

Epoch 191/1000
Training Loss: 0.00392731, Training R2: 0.950174
Validation Loss: 0.01599172, Validation R2: 0.607816

Epoch 192/1000
Training Loss: 0.00410501, Training R2: 0.947193
Validation Loss: 0.01569494, Validation R2: 0.619511

Epoch 193/1000
Training Loss: 0.00396894, Training R2: 0.949167
Validation Loss: 0.01555290, Validation R2: 0.626520

Epoch 194/1000
Training Loss: 0.00385404, Training R2: 0.950367
Validation Loss: 0.01560930, Validation R2: 0.622461

Epoch 195/1000
Training Loss: 0.00378515, Training R2: 0.951855
Validation Loss: 0.01567807, Validation R2: 0.619350

Epoch 196/1000
Training Loss: 0.00367452, Training R2: 0.951958
Validation Loss: 0.01557775, Validation R2: 0.622441

Epoch 197/1000
Training Loss: 0.00366931, Training R2: 0.951800
Validation Loss: 0.01544244, Validation R2: 0.627439

Epoch 198/1000
Training Loss: 0.00374018, Training R2: 0.951776
Validation Loss: 0.01547493, Validation R2: 0.626863

Epoch 199/1000
Training Loss: 0.00358699, Training R2: 0.952829
Validation Loss: 0.01559443, Validation R2: 0.622601

Epoch 200/1000
Training Loss: 0.00355748, Training R2: 0.952944
Validation Loss: 0.01563757, Validation R2: 0.620814

Epoch 201/1000
Training Loss: 0.00352322, Training R2: 0.953178
Validation Loss: 0.01557899, Validation R2: 0.623823

Epoch 202/1000
Training Loss: 0.00359480, Training R2: 0.952527
Validation Loss: 0.01556747, Validation R2: 0.626056

Epoch 203/1000
Training Loss: 0.00375703, Training R2: 0.953036
Validation Loss: 0.01560731, Validation R2: 0.625382

Epoch 204/1000
Training Loss: 0.00368516, Training R2: 0.953149
Validation Loss: 0.01567755, Validation R2: 0.621766

Epoch 205/1000
Training Loss: 0.00344707, Training R2: 0.954431
Validation Loss: 0.01579865, Validation R2: 0.617459

Epoch 206/1000
Training Loss: 0.00354928, Training R2: 0.954409
Validation Loss: 0.01565214, Validation R2: 0.622399

Epoch 207/1000
Epoch 00207: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00351625, Training R2: 0.954652
Validation Loss: 0.01562884, Validation R2: 0.621583

Epoch 208/1000
学习率已减少 5 次
Training Loss: 0.00342861, Training R2: 0.954888
Validation Loss: 0.01566595, Validation R2: 0.619657

Epoch 209/1000
Training Loss: 0.00336772, Training R2: 0.955134
Validation Loss: 0.01575869, Validation R2: 0.615959

Epoch 210/1000
Training Loss: 0.00350350, Training R2: 0.953482
Validation Loss: 0.01559774, Validation R2: 0.623082

Epoch 211/1000
Training Loss: 0.00345642, Training R2: 0.954109
Validation Loss: 0.01549053, Validation R2: 0.628221

Epoch 212/1000
Training Loss: 0.00352357, Training R2: 0.955157
Validation Loss: 0.01576235, Validation R2: 0.617689

Epoch 213/1000
Training Loss: 0.00349672, Training R2: 0.954051
Validation Loss: 0.01581624, Validation R2: 0.615367

Epoch 214/1000
Training Loss: 0.00346968, Training R2: 0.953906
Validation Loss: 0.01562056, Validation R2: 0.622587

Epoch 215/1000
Training Loss: 0.00345299, Training R2: 0.954025
Validation Loss: 0.01557027, Validation R2: 0.624375

Epoch 216/1000
Training Loss: 0.00337612, Training R2: 0.955572
Validation Loss: 0.01572537, Validation R2: 0.618688

Epoch 217/1000
Training Loss: 0.00338921, Training R2: 0.955188
Validation Loss: 0.01573886, Validation R2: 0.618028

Epoch 218/1000
Training Loss: 0.00326866, Training R2: 0.955772
Validation Loss: 0.01578205, Validation R2: 0.616352

Epoch 219/1000
Training Loss: 0.00336832, Training R2: 0.955293
Validation Loss: 0.01578977, Validation R2: 0.616165

Epoch 220/1000
Training Loss: 0.00336358, Training R2: 0.954927
Validation Loss: 0.01558615, Validation R2: 0.624530

Epoch 221/1000
Training Loss: 0.00334716, Training R2: 0.955701
Validation Loss: 0.01555438, Validation R2: 0.625562

Epoch 222/1000
Training Loss: 0.00328575, Training R2: 0.956156
Validation Loss: 0.01557227, Validation R2: 0.625040

Epoch 223/1000
Training Loss: 0.00336567, Training R2: 0.956270
Validation Loss: 0.01566598, Validation R2: 0.619847

Epoch 224/1000
Training Loss: 0.00335929, Training R2: 0.955795
Validation Loss: 0.01583588, Validation R2: 0.614084

Epoch 225/1000
Training Loss: 0.00340447, Training R2: 0.955777
Validation Loss: 0.01571453, Validation R2: 0.618101

Epoch 226/1000
Training Loss: 0.00337898, Training R2: 0.955247
Validation Loss: 0.01552022, Validation R2: 0.625389

Epoch 227/1000
Training Loss: 0.00330045, Training R2: 0.955950
Validation Loss: 0.01565400, Validation R2: 0.619748

Epoch 228/1000
Epoch 00228: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00323477, Training R2: 0.955804
Validation Loss: 0.01567308, Validation R2: 0.619489

Epoch 229/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
