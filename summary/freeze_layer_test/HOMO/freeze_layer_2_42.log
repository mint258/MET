Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Trainable
interaction_blocks.0.conv1.lin_rel.bias: Trainable
interaction_blocks.0.conv1.lin_root.weight: Trainable
interaction_blocks.0.conv2.lin_rel.weight: Trainable
interaction_blocks.0.conv2.lin_rel.bias: Trainable
interaction_blocks.0.conv2.lin_root.weight: Trainable
interaction_blocks.0.lin1.weight: Trainable
interaction_blocks.0.lin1.bias: Trainable
interaction_blocks.0.lin2.weight: Trainable
interaction_blocks.0.lin2.bias: Trainable
interaction_blocks.0.lin_cat.weight: Trainable
interaction_blocks.0.lin_cat.bias: Trainable
interaction_blocks.0.norm.weight: Trainable
interaction_blocks.0.norm.bias: Trainable
interaction_blocks.0.norm.mean_scale: Trainable
interaction_blocks.0.lin_feature1.lin1.weight: Trainable
interaction_blocks.0.lin_feature1.lin2.weight: Trainable
interaction_blocks.0.lin_feature2.lin1.weight: Trainable
interaction_blocks.0.lin_feature2.lin2.weight: Trainable
interaction_blocks.0.lin.weight: Trainable
interaction_blocks.0.lin.bias: Trainable
interaction_blocks.0.lins.0.weight: Trainable
interaction_blocks.0.lins.0.bias: Trainable
interaction_blocks.0.lins.1.weight: Trainable
interaction_blocks.0.lins.1.bias: Trainable
interaction_blocks.0.lins.2.weight: Trainable
interaction_blocks.0.lins.2.bias: Trainable
interaction_blocks.0.lins.3.weight: Trainable
interaction_blocks.0.lins.3.bias: Trainable
interaction_blocks.0.final.weight: Trainable
interaction_blocks.0.final.bias: Trainable
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 5293187

Epoch 1/1000
Training Loss: 0.86352236, Training R2: -723.281799
Validation Loss: 0.47859725, Validation R2: -234.931824
Saved best model with validation R2 -234.931824 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.43998185, Training R2: -182.830307
Validation Loss: 0.21547678, Validation R2: -48.457561
Saved best model with validation R2 -48.457561 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.17002322, Training R2: -31.341702
Validation Loss: 0.16004555, Validation R2: -27.105352
Saved best model with validation R2 -27.105352 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.12908158, Training R2: -16.176933
Validation Loss: 0.08357692, Validation R2: -7.143738
Saved best model with validation R2 -7.143738 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.08798594, Training R2: -7.205730
Validation Loss: 0.12044901, Validation R2: -14.891030

Epoch 6/1000
Training Loss: 0.08576227, Training R2: -6.950230
Validation Loss: 0.05548384, Validation R2: -2.976443
Saved best model with validation R2 -2.976443 to best_finetuned_model.pth

Epoch 7/1000
Training Loss: 0.07780042, Training R2: -5.406849
Validation Loss: 0.05833337, Validation R2: -3.261877

Epoch 8/1000
Training Loss: 0.05735927, Training R2: -2.788385
Validation Loss: 0.09122900, Validation R2: -8.392816

Epoch 9/1000
Training Loss: 0.07045081, Training R2: -4.458678
Validation Loss: 0.05456797, Validation R2: -2.775715
Saved best model with validation R2 -2.775715 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.06120799, Training R2: -3.186042
Validation Loss: 0.04865294, Validation R2: -2.110833
Saved best model with validation R2 -2.110833 to best_finetuned_model.pth

Epoch 11/1000
Training Loss: 0.04645044, Training R2: -1.585374
Validation Loss: 0.05388445, Validation R2: -2.784202

Epoch 12/1000
Training Loss: 0.04327217, Training R2: -1.338236
Validation Loss: 0.05185412, Validation R2: -2.508781

Epoch 13/1000
Training Loss: 0.04462468, Training R2: -1.520980
Validation Loss: 0.03948063, Validation R2: -1.146076
Saved best model with validation R2 -1.146076 to best_finetuned_model.pth

Epoch 14/1000
Training Loss: 0.04188495, Training R2: -1.103109
Validation Loss: 0.03944956, Validation R2: -1.129042
Saved best model with validation R2 -1.129042 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.03431690, Training R2: -0.528011
Validation Loss: 0.03506371, Validation R2: -0.744457
Saved best model with validation R2 -0.744457 to best_finetuned_model.pth

Epoch 16/1000
Training Loss: 0.03295361, Training R2: -0.343449
Validation Loss: 0.03233918, Validation R2: -0.553539
Saved best model with validation R2 -0.553539 to best_finetuned_model.pth

Epoch 17/1000
Training Loss: 0.03077369, Training R2: -0.225287
Validation Loss: 0.03051932, Validation R2: -0.418858
Saved best model with validation R2 -0.418858 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.02854063, Training R2: -0.085229
Validation Loss: 0.03210934, Validation R2: -0.521537

Epoch 19/1000
Training Loss: 0.02903864, Training R2: -0.094936
Validation Loss: 0.02973437, Validation R2: -0.345445
Saved best model with validation R2 -0.345445 to best_finetuned_model.pth

Epoch 20/1000
Training Loss: 0.02724894, Training R2: 0.005510
Validation Loss: 0.03668335, Validation R2: -0.885114

Epoch 21/1000
Training Loss: 0.03301889, Training R2: -0.336679
Validation Loss: 0.03310616, Validation R2: -0.591609

Epoch 22/1000
Training Loss: 0.03237911, Training R2: -0.312960
Validation Loss: 0.04016080, Validation R2: -1.205450

Epoch 23/1000
Training Loss: 0.03642340, Training R2: -0.585883
Validation Loss: 0.03469108, Validation R2: -0.675403

Epoch 24/1000
Training Loss: 0.03214348, Training R2: -0.296161
Validation Loss: 0.03329770, Validation R2: -0.554006

Epoch 25/1000
Training Loss: 0.02878730, Training R2: -0.036883
Validation Loss: 0.03598328, Validation R2: -0.777192

Epoch 26/1000
Training Loss: 0.03406010, Training R2: -0.396121
Validation Loss: 0.03898953, Validation R2: -1.031605

Epoch 27/1000
Training Loss: 0.03437481, Training R2: -0.393993
Validation Loss: 0.02498427, Validation R2: 0.038572
Saved best model with validation R2 0.038572 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.02426740, Training R2: 0.202594
Validation Loss: 0.04481349, Validation R2: -1.567423

Epoch 29/1000
Training Loss: 0.03877824, Training R2: -0.741096
Validation Loss: 0.03019554, Validation R2: -0.310017

Epoch 30/1000
Training Loss: 0.02944785, Training R2: -0.113211
Validation Loss: 0.02507373, Validation R2: 0.051449
Saved best model with validation R2 0.051449 to best_finetuned_model.pth

Epoch 31/1000
Training Loss: 0.02229434, Training R2: 0.324514
Validation Loss: 0.03667345, Validation R2: -0.802121

Epoch 32/1000
Training Loss: 0.02995212, Training R2: -0.159680
Validation Loss: 0.04883277, Validation R2: -1.946355

Epoch 33/1000
Training Loss: 0.04206841, Training R2: -0.934192
Validation Loss: 0.02899546, Validation R2: -0.185643

Epoch 34/1000
Training Loss: 0.02799182, Training R2: 0.007549
Validation Loss: 0.03138274, Validation R2: -0.381042

Epoch 35/1000
Training Loss: 0.02699409, Training R2: 0.089178
Validation Loss: 0.03954089, Validation R2: -1.059276

Epoch 36/1000
Training Loss: 0.03502567, Training R2: -0.424451
Validation Loss: 0.02898709, Validation R2: -0.219295

Epoch 37/1000
Training Loss: 0.02876452, Training R2: -0.018089
Validation Loss: 0.03099701, Validation R2: -0.353510

Epoch 38/1000
Training Loss: 0.02864760, Training R2: 0.002438
Validation Loss: 0.03179865, Validation R2: -0.401839

Epoch 39/1000
Training Loss: 0.02911843, Training R2: -0.074712
Validation Loss: 0.03921210, Validation R2: -1.003525

Epoch 40/1000
Training Loss: 0.03772898, Training R2: -0.645676
Validation Loss: 0.03966876, Validation R2: -1.031263

Epoch 41/1000
Training Loss: 0.03390063, Training R2: -0.381816
Validation Loss: 0.02308226, Validation R2: 0.200790
Saved best model with validation R2 0.200790 to best_finetuned_model.pth

Epoch 42/1000
Training Loss: 0.02211428, Training R2: 0.360782
Validation Loss: 0.01846526, Validation R2: 0.416690
Saved best model with validation R2 0.416690 to best_finetuned_model.pth

Epoch 43/1000
Training Loss: 0.01717093, Training R2: 0.578054
Validation Loss: 0.01885366, Validation R2: 0.329051

Epoch 44/1000
Training Loss: 0.01914359, Training R2: 0.491203
Validation Loss: 0.03072055, Validation R2: -0.444653

Epoch 45/1000
Training Loss: 0.02378190, Training R2: 0.240507
Validation Loss: 0.01709316, Validation R2: 0.443438
Saved best model with validation R2 0.443438 to best_finetuned_model.pth

Epoch 46/1000
Training Loss: 0.01977857, Training R2: 0.447297
Validation Loss: 0.03216229, Validation R2: -0.412657

Epoch 47/1000
Training Loss: 0.03235574, Training R2: -0.255849
Validation Loss: 0.04996286, Validation R2: -2.052685

Epoch 48/1000
Training Loss: 0.04082230, Training R2: -0.952237
Validation Loss: 0.01922065, Validation R2: 0.328019

Epoch 49/1000
Training Loss: 0.02681847, Training R2: 0.023426
Validation Loss: 0.04688976, Validation R2: -1.781643

Epoch 50/1000
Training Loss: 0.03622006, Training R2: -0.445421
Validation Loss: 0.02588216, Validation R2: -0.026486

Epoch 51/1000
Training Loss: 0.02314633, Training R2: 0.300681
Validation Loss: 0.02236384, Validation R2: 0.155632

Epoch 52/1000
Training Loss: 0.03422400, Training R2: -0.396930
Validation Loss: 0.03630686, Validation R2: -0.842137

Epoch 53/1000
Training Loss: 0.03436473, Training R2: -0.297722
Validation Loss: 0.01953789, Validation R2: 0.322479

Epoch 54/1000
Training Loss: 0.02775445, Training R2: 0.050169
Validation Loss: 0.04797930, Validation R2: -1.792400

Epoch 55/1000
Training Loss: 0.03581598, Training R2: -0.405006
Validation Loss: 0.02107407, Validation R2: 0.229766

Epoch 56/1000
Training Loss: 0.02695573, Training R2: 0.122165
Validation Loss: 0.03021576, Validation R2: -0.373604

Epoch 57/1000
Training Loss: 0.03834317, Training R2: -0.629275
Validation Loss: 0.04917862, Validation R2: -1.962759

Epoch 58/1000
Training Loss: 0.04226282, Training R2: -1.090298
Validation Loss: 0.01714974, Validation R2: 0.441882

Epoch 59/1000
Training Loss: 0.02622323, Training R2: 0.031568
Validation Loss: 0.03933445, Validation R2: -0.932024

Epoch 60/1000
Training Loss: 0.03208900, Training R2: -0.153434
Validation Loss: 0.03149241, Validation R2: -0.308574

Epoch 61/1000
Training Loss: 0.02668534, Training R2: 0.122885
Validation Loss: 0.01999776, Validation R2: 0.382241

Epoch 62/1000
Training Loss: 0.02797265, Training R2: -0.014135
Validation Loss: 0.05097102, Validation R2: -2.078896

Epoch 63/1000
Training Loss: 0.03462272, Training R2: -0.494390
Validation Loss: 0.06285927, Validation R2: -3.505309

Epoch 64/1000
Training Loss: 0.05259291, Training R2: -2.118615
Validation Loss: 0.08207660, Validation R2: -6.400535

Epoch 65/1000
Training Loss: 0.06357274, Training R2: -3.265919
Validation Loss: 0.06797264, Validation R2: -4.358088

Epoch 66/1000
Epoch 00066: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.05151697, Training R2: -2.059713
Validation Loss: 0.04366786, Validation R2: -1.480979

Epoch 67/1000
学习率已减少 1 次
Training Loss: 0.03904076, Training R2: -0.763481
Validation Loss: 0.03905939, Validation R2: -1.118777

Epoch 68/1000
Training Loss: 0.02958341, Training R2: -0.113830
Validation Loss: 0.03227315, Validation R2: -0.543159

Epoch 69/1000
Training Loss: 0.02279806, Training R2: 0.288422
Validation Loss: 0.01809751, Validation R2: 0.384021

Epoch 70/1000
Training Loss: 0.01848663, Training R2: 0.509563
Validation Loss: 0.02254417, Validation R2: 0.098866

Epoch 71/1000
Training Loss: 0.01868203, Training R2: 0.528983
Validation Loss: 0.01764272, Validation R2: 0.370263

Epoch 72/1000
Training Loss: 0.01650223, Training R2: 0.595006
Validation Loss: 0.01507817, Validation R2: 0.547575
Saved best model with validation R2 0.547575 to best_finetuned_model.pth

Epoch 73/1000
Training Loss: 0.01438522, Training R2: 0.681361
Validation Loss: 0.01503849, Validation R2: 0.588015
Saved best model with validation R2 0.588015 to best_finetuned_model.pth

Epoch 74/1000
Training Loss: 0.01346816, Training R2: 0.722392
Validation Loss: 0.01683969, Validation R2: 0.535202

Epoch 75/1000
Training Loss: 0.01458062, Training R2: 0.687509
Validation Loss: 0.01822823, Validation R2: 0.488562

Epoch 76/1000
Training Loss: 0.01376230, Training R2: 0.725994
Validation Loss: 0.02322758, Validation R2: 0.248114

Epoch 77/1000
Training Loss: 0.01784713, Training R2: 0.595995
Validation Loss: 0.01559290, Validation R2: 0.593689
Saved best model with validation R2 0.593689 to best_finetuned_model.pth

Epoch 78/1000
Training Loss: 0.01273437, Training R2: 0.777055
Validation Loss: 0.01424833, Validation R2: 0.589173

Epoch 79/1000
Training Loss: 0.01089757, Training R2: 0.827093
Validation Loss: 0.01518085, Validation R2: 0.542890

Epoch 80/1000
Training Loss: 0.01086221, Training R2: 0.820018
Validation Loss: 0.01410387, Validation R2: 0.610564
Saved best model with validation R2 0.610564 to best_finetuned_model.pth

Epoch 81/1000
Training Loss: 0.00997504, Training R2: 0.839704
Validation Loss: 0.01340022, Validation R2: 0.665165
Saved best model with validation R2 0.665165 to best_finetuned_model.pth

Epoch 82/1000
Training Loss: 0.01078124, Training R2: 0.828323
Validation Loss: 0.01331999, Validation R2: 0.656536

Epoch 83/1000
Training Loss: 0.00974320, Training R2: 0.847350
Validation Loss: 0.01314698, Validation R2: 0.638912

Epoch 84/1000
Training Loss: 0.01134732, Training R2: 0.809473
Validation Loss: 0.01861333, Validation R2: 0.388962

Epoch 85/1000
Training Loss: 0.01280343, Training R2: 0.773329
Validation Loss: 0.01868354, Validation R2: 0.394594

Epoch 86/1000
Training Loss: 0.01123697, Training R2: 0.818220
Validation Loss: 0.01464266, Validation R2: 0.566907

Epoch 87/1000
Training Loss: 0.01320965, Training R2: 0.770333
Validation Loss: 0.01792011, Validation R2: 0.416186

Epoch 88/1000
Training Loss: 0.01829475, Training R2: 0.603685
Validation Loss: 0.01918610, Validation R2: 0.362831

Epoch 89/1000
Training Loss: 0.01334809, Training R2: 0.769478
Validation Loss: 0.01348828, Validation R2: 0.643741

Epoch 90/1000
Training Loss: 0.01274555, Training R2: 0.776997
Validation Loss: 0.01882811, Validation R2: 0.412454

Epoch 91/1000
Training Loss: 0.01884386, Training R2: 0.610840
Validation Loss: 0.01928607, Validation R2: 0.378829

Epoch 92/1000
Training Loss: 0.01553096, Training R2: 0.712176
Validation Loss: 0.01604918, Validation R2: 0.508698

Epoch 93/1000
Training Loss: 0.01480009, Training R2: 0.720649
Validation Loss: 0.01918269, Validation R2: 0.386202

Epoch 94/1000
Training Loss: 0.01694619, Training R2: 0.676908
Validation Loss: 0.01964385, Validation R2: 0.382587

Epoch 95/1000
Training Loss: 0.01539412, Training R2: 0.720605
Validation Loss: 0.01525184, Validation R2: 0.544904

Epoch 96/1000
Training Loss: 0.01193511, Training R2: 0.802745
Validation Loss: 0.01287149, Validation R2: 0.654833

Epoch 97/1000
Training Loss: 0.01158764, Training R2: 0.810379
Validation Loss: 0.01257687, Validation R2: 0.685845
Saved best model with validation R2 0.685845 to best_finetuned_model.pth

Epoch 98/1000
Training Loss: 0.01272992, Training R2: 0.770607
Validation Loss: 0.02496525, Validation R2: 0.114797

Epoch 99/1000
Training Loss: 0.01868377, Training R2: 0.606625
Validation Loss: 0.02534349, Validation R2: 0.087779

Epoch 100/1000
Training Loss: 0.01933330, Training R2: 0.550257
Validation Loss: 0.01977873, Validation R2: 0.394522

Epoch 101/1000
Training Loss: 0.01581552, Training R2: 0.684866
Validation Loss: 0.01458064, Validation R2: 0.604648

Epoch 102/1000
Training Loss: 0.01154030, Training R2: 0.813119
Validation Loss: 0.01612841, Validation R2: 0.523126

Epoch 103/1000
Training Loss: 0.01204817, Training R2: 0.805042
Validation Loss: 0.02262764, Validation R2: 0.239923

Epoch 104/1000
Training Loss: 0.01894940, Training R2: 0.592617
Validation Loss: 0.01799794, Validation R2: 0.472309

Epoch 105/1000
Training Loss: 0.01411998, Training R2: 0.746504
Validation Loss: 0.01830725, Validation R2: 0.467282

Epoch 106/1000
Training Loss: 0.01385216, Training R2: 0.760918
Validation Loss: 0.02992486, Validation R2: -0.155470

Epoch 107/1000
Training Loss: 0.02126828, Training R2: 0.482334
Validation Loss: 0.01294371, Validation R2: 0.645071

Epoch 108/1000
Training Loss: 0.01409696, Training R2: 0.723615
Validation Loss: 0.02292873, Validation R2: 0.256393

Epoch 109/1000
Training Loss: 0.01656941, Training R2: 0.675207
Validation Loss: 0.01376875, Validation R2: 0.647637

Epoch 110/1000
Training Loss: 0.01224452, Training R2: 0.796932
Validation Loss: 0.01316035, Validation R2: 0.676093

Epoch 111/1000
Training Loss: 0.01352032, Training R2: 0.761991
Validation Loss: 0.02146662, Validation R2: 0.315985

Epoch 112/1000
Training Loss: 0.01664054, Training R2: 0.677449
Validation Loss: 0.01359243, Validation R2: 0.653196

Epoch 113/1000
Training Loss: 0.01614682, Training R2: 0.676041
Validation Loss: 0.02220397, Validation R2: 0.283540

Epoch 114/1000
Training Loss: 0.01472507, Training R2: 0.715618
Validation Loss: 0.01376952, Validation R2: 0.654202

Epoch 115/1000
Training Loss: 0.01270559, Training R2: 0.776515
Validation Loss: 0.01656307, Validation R2: 0.561491

Epoch 116/1000
Training Loss: 0.01655314, Training R2: 0.685280
Validation Loss: 0.02254116, Validation R2: 0.286922

Epoch 117/1000
Training Loss: 0.01638897, Training R2: 0.661830
Validation Loss: 0.01498233, Validation R2: 0.619047

Epoch 118/1000
Epoch 00118: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.00997967, Training R2: 0.850912
Validation Loss: 0.01359824, Validation R2: 0.662327

Epoch 119/1000
学习率已减少 2 次
Training Loss: 0.00934384, Training R2: 0.866650
Validation Loss: 0.01212146, Validation R2: 0.714588
Saved best model with validation R2 0.714588 to best_finetuned_model.pth

Epoch 120/1000
Training Loss: 0.00756441, Training R2: 0.911100
Validation Loss: 0.01127768, Validation R2: 0.737462
Saved best model with validation R2 0.737462 to best_finetuned_model.pth

Epoch 121/1000
Training Loss: 0.00700601, Training R2: 0.919331
Validation Loss: 0.01135192, Validation R2: 0.727848

Epoch 122/1000
Training Loss: 0.00616070, Training R2: 0.932976
Validation Loss: 0.01186689, Validation R2: 0.709104

Epoch 123/1000
Training Loss: 0.00648097, Training R2: 0.927972
Validation Loss: 0.01244501, Validation R2: 0.702087

Epoch 124/1000
Training Loss: 0.00783978, Training R2: 0.907064
Validation Loss: 0.01193578, Validation R2: 0.719192

Epoch 125/1000
Training Loss: 0.00640574, Training R2: 0.933867
Validation Loss: 0.01252864, Validation R2: 0.699145

Epoch 126/1000
Training Loss: 0.00792074, Training R2: 0.908967
Validation Loss: 0.01315856, Validation R2: 0.675513

Epoch 127/1000
Training Loss: 0.00947217, Training R2: 0.884923
Validation Loss: 0.01140024, Validation R2: 0.729252

Epoch 128/1000
Training Loss: 0.00632950, Training R2: 0.934369
Validation Loss: 0.01178756, Validation R2: 0.720606

Epoch 129/1000
Training Loss: 0.00637254, Training R2: 0.934352
Validation Loss: 0.01184804, Validation R2: 0.716934

Epoch 130/1000
Training Loss: 0.00577326, Training R2: 0.942962
Validation Loss: 0.01142019, Validation R2: 0.721396

Epoch 131/1000
Training Loss: 0.00472623, Training R2: 0.953311
Validation Loss: 0.01145862, Validation R2: 0.716929

Epoch 132/1000
Training Loss: 0.00452250, Training R2: 0.956543
Validation Loss: 0.01129970, Validation R2: 0.731429

Epoch 133/1000
Training Loss: 0.00480716, Training R2: 0.953475
Validation Loss: 0.01134577, Validation R2: 0.718425

Epoch 134/1000
Training Loss: 0.00455088, Training R2: 0.957239
Validation Loss: 0.01176116, Validation R2: 0.705435

Epoch 135/1000
Training Loss: 0.00441477, Training R2: 0.958603
Validation Loss: 0.01111235, Validation R2: 0.734284

Epoch 136/1000
Training Loss: 0.00502419, Training R2: 0.952772
Validation Loss: 0.01120630, Validation R2: 0.721333

Epoch 137/1000
Training Loss: 0.00478699, Training R2: 0.956399
Validation Loss: 0.01446711, Validation R2: 0.594403

Epoch 138/1000
Training Loss: 0.00769851, Training R2: 0.914053
Validation Loss: 0.01935553, Validation R2: 0.416588

Epoch 139/1000
Training Loss: 0.01171810, Training R2: 0.832425
Validation Loss: 0.01180987, Validation R2: 0.703432

Epoch 140/1000
Training Loss: 0.00563233, Training R2: 0.947679
Validation Loss: 0.01284286, Validation R2: 0.657739

Epoch 141/1000
Epoch 00141: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00564552, Training R2: 0.947079
Validation Loss: 0.01135482, Validation R2: 0.712528

Epoch 142/1000
学习率已减少 3 次
Training Loss: 0.00403468, Training R2: 0.964334
Validation Loss: 0.01139802, Validation R2: 0.710280

Epoch 143/1000
Training Loss: 0.00381135, Training R2: 0.966849
Validation Loss: 0.01124325, Validation R2: 0.718696

Epoch 144/1000
Training Loss: 0.00390601, Training R2: 0.965165
Validation Loss: 0.01116364, Validation R2: 0.717284

Epoch 145/1000
Training Loss: 0.00362173, Training R2: 0.968005
Validation Loss: 0.01127834, Validation R2: 0.722326

Epoch 146/1000
Training Loss: 0.00453586, Training R2: 0.961100
Validation Loss: 0.01167880, Validation R2: 0.717337

Epoch 147/1000
Training Loss: 0.00528357, Training R2: 0.955620
Validation Loss: 0.01168555, Validation R2: 0.714482

Epoch 148/1000
Training Loss: 0.00512471, Training R2: 0.955857
Validation Loss: 0.01119381, Validation R2: 0.718786

Epoch 149/1000
Training Loss: 0.00388768, Training R2: 0.967339
Validation Loss: 0.01106713, Validation R2: 0.724690

Epoch 150/1000
Training Loss: 0.00399002, Training R2: 0.965973
Validation Loss: 0.01132442, Validation R2: 0.717990

Epoch 151/1000
Training Loss: 0.00439209, Training R2: 0.962638
Validation Loss: 0.01183725, Validation R2: 0.693429

Epoch 152/1000
Training Loss: 0.00512374, Training R2: 0.957288
Validation Loss: 0.01221650, Validation R2: 0.673208

Epoch 153/1000
Training Loss: 0.00486976, Training R2: 0.958139
Validation Loss: 0.01149651, Validation R2: 0.702955

Epoch 154/1000
Training Loss: 0.00346968, Training R2: 0.971166
Validation Loss: 0.01117715, Validation R2: 0.721133

Epoch 155/1000
Training Loss: 0.00345727, Training R2: 0.971424
Validation Loss: 0.01106846, Validation R2: 0.722610

Epoch 156/1000
Training Loss: 0.00329714, Training R2: 0.972653
Validation Loss: 0.01116345, Validation R2: 0.721498

Epoch 157/1000
Training Loss: 0.00377577, Training R2: 0.968140
Validation Loss: 0.01125157, Validation R2: 0.719475

Epoch 158/1000
Training Loss: 0.00409776, Training R2: 0.966358
Validation Loss: 0.01183977, Validation R2: 0.688242

Epoch 159/1000
Training Loss: 0.00525745, Training R2: 0.956621
Validation Loss: 0.01244892, Validation R2: 0.662490

Epoch 160/1000
Training Loss: 0.00438071, Training R2: 0.962803
Validation Loss: 0.01179317, Validation R2: 0.695667

Epoch 161/1000
Training Loss: 0.00382002, Training R2: 0.968483
Validation Loss: 0.01123685, Validation R2: 0.719636

Epoch 162/1000
Epoch 00162: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00297482, Training R2: 0.974110
Validation Loss: 0.01135794, Validation R2: 0.712206

Epoch 163/1000
学习率已减少 4 次
Training Loss: 0.00297030, Training R2: 0.974825
Validation Loss: 0.01132822, Validation R2: 0.712719

Epoch 164/1000
Training Loss: 0.00291270, Training R2: 0.975159
Validation Loss: 0.01121825, Validation R2: 0.720020

Epoch 165/1000
Training Loss: 0.00270261, Training R2: 0.975740
Validation Loss: 0.01132752, Validation R2: 0.711172

Epoch 166/1000
Training Loss: 0.00266654, Training R2: 0.975264
Validation Loss: 0.01139208, Validation R2: 0.708899

Epoch 167/1000
Training Loss: 0.00294076, Training R2: 0.973787
Validation Loss: 0.01142011, Validation R2: 0.707961

Epoch 168/1000
Training Loss: 0.00320819, Training R2: 0.973308
Validation Loss: 0.01131480, Validation R2: 0.712689

Epoch 169/1000
Training Loss: 0.00291283, Training R2: 0.974785
Validation Loss: 0.01127953, Validation R2: 0.714812

Epoch 170/1000
Training Loss: 0.00270753, Training R2: 0.976107
Validation Loss: 0.01126168, Validation R2: 0.715872

Epoch 171/1000
Training Loss: 0.00285391, Training R2: 0.975204
Validation Loss: 0.01120432, Validation R2: 0.719479

Epoch 172/1000
Training Loss: 0.00294043, Training R2: 0.974670
Validation Loss: 0.01117548, Validation R2: 0.719580

Epoch 173/1000
Training Loss: 0.00254296, Training R2: 0.976800
Validation Loss: 0.01112748, Validation R2: 0.722358

Epoch 174/1000
Training Loss: 0.00240616, Training R2: 0.977597
Validation Loss: 0.01118848, Validation R2: 0.718456

Epoch 175/1000
Training Loss: 0.00246714, Training R2: 0.977385
Validation Loss: 0.01114188, Validation R2: 0.720424

Epoch 176/1000
Training Loss: 0.00250256, Training R2: 0.977837
Validation Loss: 0.01107788, Validation R2: 0.725093

Epoch 177/1000
Training Loss: 0.00252661, Training R2: 0.977141
Validation Loss: 0.01108434, Validation R2: 0.722584

Epoch 178/1000
Training Loss: 0.00263730, Training R2: 0.976612
Validation Loss: 0.01116204, Validation R2: 0.716451

Epoch 179/1000
Training Loss: 0.00246936, Training R2: 0.977615
Validation Loss: 0.01112787, Validation R2: 0.720752

Epoch 180/1000
Training Loss: 0.00248865, Training R2: 0.977311
Validation Loss: 0.01109803, Validation R2: 0.722634

Epoch 181/1000
Training Loss: 0.00240939, Training R2: 0.977455
Validation Loss: 0.01118780, Validation R2: 0.718085

Epoch 182/1000
Training Loss: 0.00235743, Training R2: 0.977836
Validation Loss: 0.01114710, Validation R2: 0.717978

Epoch 183/1000
Epoch 00183: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00219354, Training R2: 0.979189
Validation Loss: 0.01117757, Validation R2: 0.721021

Epoch 184/1000
学习率已减少 5 次
Training Loss: 0.00225511, Training R2: 0.979156
Validation Loss: 0.01122371, Validation R2: 0.718284

Epoch 185/1000
Training Loss: 0.00209268, Training R2: 0.979636
Validation Loss: 0.01125639, Validation R2: 0.713680

Epoch 186/1000
Training Loss: 0.00217986, Training R2: 0.979542
Validation Loss: 0.01115831, Validation R2: 0.718952

Epoch 187/1000
Training Loss: 0.00200738, Training R2: 0.979951
Validation Loss: 0.01117474, Validation R2: 0.719265

Epoch 188/1000
Training Loss: 0.00194389, Training R2: 0.980309
Validation Loss: 0.01114125, Validation R2: 0.718955

Epoch 189/1000
Training Loss: 0.00192674, Training R2: 0.979969
Validation Loss: 0.01111030, Validation R2: 0.720801

Epoch 190/1000
Training Loss: 0.00189479, Training R2: 0.980367
Validation Loss: 0.01110470, Validation R2: 0.718887

Epoch 191/1000
Training Loss: 0.00187923, Training R2: 0.980216
Validation Loss: 0.01110389, Validation R2: 0.719545

Epoch 192/1000
Training Loss: 0.00191994, Training R2: 0.980090
Validation Loss: 0.01114042, Validation R2: 0.719072

Epoch 193/1000
Training Loss: 0.00187487, Training R2: 0.980590
Validation Loss: 0.01115771, Validation R2: 0.717420

Epoch 194/1000
Training Loss: 0.00192858, Training R2: 0.980827
Validation Loss: 0.01123096, Validation R2: 0.713550

Epoch 195/1000
Training Loss: 0.00215342, Training R2: 0.980270
Validation Loss: 0.01119145, Validation R2: 0.716102

Epoch 196/1000
Training Loss: 0.00200286, Training R2: 0.980564
Validation Loss: 0.01117379, Validation R2: 0.715840

Epoch 197/1000
Training Loss: 0.00190030, Training R2: 0.980378
Validation Loss: 0.01109922, Validation R2: 0.719457

Epoch 198/1000
Training Loss: 0.00182842, Training R2: 0.981077
Validation Loss: 0.01114870, Validation R2: 0.718248

Epoch 199/1000
Training Loss: 0.00177667, Training R2: 0.981115
Validation Loss: 0.01121335, Validation R2: 0.716016

Epoch 200/1000
Training Loss: 0.00176726, Training R2: 0.981180
Validation Loss: 0.01108478, Validation R2: 0.720688

Epoch 201/1000
Training Loss: 0.00175137, Training R2: 0.980929
Validation Loss: 0.01111243, Validation R2: 0.718819

Epoch 202/1000
Training Loss: 0.00174990, Training R2: 0.981255
Validation Loss: 0.01110420, Validation R2: 0.720166

Epoch 203/1000
Training Loss: 0.00182123, Training R2: 0.981143
Validation Loss: 0.01110284, Validation R2: 0.721040

Epoch 204/1000
Epoch 00204: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00199779, Training R2: 0.980910
Validation Loss: 0.01113664, Validation R2: 0.721858

Epoch 205/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
