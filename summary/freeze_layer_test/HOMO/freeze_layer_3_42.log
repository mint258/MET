Using device: cuda
Selected target_properties: ['HOMO_energy']
Available target properties: ['rot_A', 'rot_B', 'rot_C', 'dipole', 'polarizability', 'HOMO_energy', 'LUMO_energy', 'gap', 'R2', 'zpve', 'U0', 'U298', 'H298', 'G298', 'Cv']
Total samples: 1000, Training: 800, Validation: 200
Pretrained ComENetAutoEncoder layers:
0: feature1 (torsion_emb)
1: feature2 (angle_emb)
2: emb_z (EmbeddingBlock)
3: interaction_blocks.0 (SimpleInteractionBlock)
4: interaction_blocks.1 (SimpleInteractionBlock)
5: interaction_blocks.2 (SimpleInteractionBlock)
6: interaction_blocks.3 (SimpleInteractionBlock)
7: lins.0 (Linear)
8: lins.1 (Linear)
9: lins.2 (Linear)
10: encoder (Sequential)
11: transformer_decoders_z.0 (TransformerEncoder)
12: output_layers_z.0 (Linear)
冻结层 0: feature1 (torsion_emb)
冻结层 1: feature2 (angle_emb)
冻结层 2: emb_z (EmbeddingBlock)
冻结层 3: interaction_blocks.0 (SimpleInteractionBlock)

Frozen layers status:
emb_z.emb.weight: Frozen
interaction_blocks.0.conv1.lin_rel.weight: Frozen
interaction_blocks.0.conv1.lin_rel.bias: Frozen
interaction_blocks.0.conv1.lin_root.weight: Frozen
interaction_blocks.0.conv2.lin_rel.weight: Frozen
interaction_blocks.0.conv2.lin_rel.bias: Frozen
interaction_blocks.0.conv2.lin_root.weight: Frozen
interaction_blocks.0.lin1.weight: Frozen
interaction_blocks.0.lin1.bias: Frozen
interaction_blocks.0.lin2.weight: Frozen
interaction_blocks.0.lin2.bias: Frozen
interaction_blocks.0.lin_cat.weight: Frozen
interaction_blocks.0.lin_cat.bias: Frozen
interaction_blocks.0.norm.weight: Frozen
interaction_blocks.0.norm.bias: Frozen
interaction_blocks.0.norm.mean_scale: Frozen
interaction_blocks.0.lin_feature1.lin1.weight: Frozen
interaction_blocks.0.lin_feature1.lin2.weight: Frozen
interaction_blocks.0.lin_feature2.lin1.weight: Frozen
interaction_blocks.0.lin_feature2.lin2.weight: Frozen
interaction_blocks.0.lin.weight: Frozen
interaction_blocks.0.lin.bias: Frozen
interaction_blocks.0.lins.0.weight: Frozen
interaction_blocks.0.lins.0.bias: Frozen
interaction_blocks.0.lins.1.weight: Frozen
interaction_blocks.0.lins.1.bias: Frozen
interaction_blocks.0.lins.2.weight: Frozen
interaction_blocks.0.lins.2.bias: Frozen
interaction_blocks.0.lins.3.weight: Frozen
interaction_blocks.0.lins.3.bias: Frozen
interaction_blocks.0.final.weight: Frozen
interaction_blocks.0.final.bias: Frozen
interaction_blocks.1.conv1.lin_rel.weight: Trainable
interaction_blocks.1.conv1.lin_rel.bias: Trainable
interaction_blocks.1.conv1.lin_root.weight: Trainable
interaction_blocks.1.conv2.lin_rel.weight: Trainable
interaction_blocks.1.conv2.lin_rel.bias: Trainable
interaction_blocks.1.conv2.lin_root.weight: Trainable
interaction_blocks.1.lin1.weight: Trainable
interaction_blocks.1.lin1.bias: Trainable
interaction_blocks.1.lin2.weight: Trainable
interaction_blocks.1.lin2.bias: Trainable
interaction_blocks.1.lin_cat.weight: Trainable
interaction_blocks.1.lin_cat.bias: Trainable
interaction_blocks.1.norm.weight: Trainable
interaction_blocks.1.norm.bias: Trainable
interaction_blocks.1.norm.mean_scale: Trainable
interaction_blocks.1.lin_feature1.lin1.weight: Trainable
interaction_blocks.1.lin_feature1.lin2.weight: Trainable
interaction_blocks.1.lin_feature2.lin1.weight: Trainable
interaction_blocks.1.lin_feature2.lin2.weight: Trainable
interaction_blocks.1.lin.weight: Trainable
interaction_blocks.1.lin.bias: Trainable
interaction_blocks.1.lins.0.weight: Trainable
interaction_blocks.1.lins.0.bias: Trainable
interaction_blocks.1.lins.1.weight: Trainable
interaction_blocks.1.lins.1.bias: Trainable
interaction_blocks.1.lins.2.weight: Trainable
interaction_blocks.1.lins.2.bias: Trainable
interaction_blocks.1.lins.3.weight: Trainable
interaction_blocks.1.lins.3.bias: Trainable
interaction_blocks.1.final.weight: Trainable
interaction_blocks.1.final.bias: Trainable
interaction_blocks.2.conv1.lin_rel.weight: Trainable
interaction_blocks.2.conv1.lin_rel.bias: Trainable
interaction_blocks.2.conv1.lin_root.weight: Trainable
interaction_blocks.2.conv2.lin_rel.weight: Trainable
interaction_blocks.2.conv2.lin_rel.bias: Trainable
interaction_blocks.2.conv2.lin_root.weight: Trainable
interaction_blocks.2.lin1.weight: Trainable
interaction_blocks.2.lin1.bias: Trainable
interaction_blocks.2.lin2.weight: Trainable
interaction_blocks.2.lin2.bias: Trainable
interaction_blocks.2.lin_cat.weight: Trainable
interaction_blocks.2.lin_cat.bias: Trainable
interaction_blocks.2.norm.weight: Trainable
interaction_blocks.2.norm.bias: Trainable
interaction_blocks.2.norm.mean_scale: Trainable
interaction_blocks.2.lin_feature1.lin1.weight: Trainable
interaction_blocks.2.lin_feature1.lin2.weight: Trainable
interaction_blocks.2.lin_feature2.lin1.weight: Trainable
interaction_blocks.2.lin_feature2.lin2.weight: Trainable
interaction_blocks.2.lin.weight: Trainable
interaction_blocks.2.lin.bias: Trainable
interaction_blocks.2.lins.0.weight: Trainable
interaction_blocks.2.lins.0.bias: Trainable
interaction_blocks.2.lins.1.weight: Trainable
interaction_blocks.2.lins.1.bias: Trainable
interaction_blocks.2.lins.2.weight: Trainable
interaction_blocks.2.lins.2.bias: Trainable
interaction_blocks.2.lins.3.weight: Trainable
interaction_blocks.2.lins.3.bias: Trainable
interaction_blocks.2.final.weight: Trainable
interaction_blocks.2.final.bias: Trainable
interaction_blocks.3.conv1.lin_rel.weight: Trainable
interaction_blocks.3.conv1.lin_rel.bias: Trainable
interaction_blocks.3.conv1.lin_root.weight: Trainable
interaction_blocks.3.conv2.lin_rel.weight: Trainable
interaction_blocks.3.conv2.lin_rel.bias: Trainable
interaction_blocks.3.conv2.lin_root.weight: Trainable
interaction_blocks.3.lin1.weight: Trainable
interaction_blocks.3.lin1.bias: Trainable
interaction_blocks.3.lin2.weight: Trainable
interaction_blocks.3.lin2.bias: Trainable
interaction_blocks.3.lin_cat.weight: Trainable
interaction_blocks.3.lin_cat.bias: Trainable
interaction_blocks.3.norm.weight: Trainable
interaction_blocks.3.norm.bias: Trainable
interaction_blocks.3.norm.mean_scale: Trainable
interaction_blocks.3.lin_feature1.lin1.weight: Trainable
interaction_blocks.3.lin_feature1.lin2.weight: Trainable
interaction_blocks.3.lin_feature2.lin1.weight: Trainable
interaction_blocks.3.lin_feature2.lin2.weight: Trainable
interaction_blocks.3.lin.weight: Trainable
interaction_blocks.3.lin.bias: Trainable
interaction_blocks.3.lins.0.weight: Trainable
interaction_blocks.3.lins.0.bias: Trainable
interaction_blocks.3.lins.1.weight: Trainable
interaction_blocks.3.lins.1.bias: Trainable
interaction_blocks.3.lins.2.weight: Trainable
interaction_blocks.3.lins.2.bias: Trainable
interaction_blocks.3.lins.3.weight: Trainable
interaction_blocks.3.lins.3.bias: Trainable
interaction_blocks.3.final.weight: Trainable
interaction_blocks.3.final.bias: Trainable
lins.0.weight: Trainable
lins.0.bias: Trainable
lins.1.weight: Trainable
lins.1.bias: Trainable
lins.2.weight: Trainable
lins.2.bias: Trainable
encoder.0.weight: Trainable
encoder.0.bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.in_proj_bias: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.weight: Trainable
transformer_decoders_z.0.layers.0.self_attn.out_proj.bias: Trainable
transformer_decoders_z.0.layers.0.linear1.weight: Trainable
transformer_decoders_z.0.layers.0.linear1.bias: Trainable
transformer_decoders_z.0.layers.0.linear2.weight: Trainable
transformer_decoders_z.0.layers.0.linear2.bias: Trainable
transformer_decoders_z.0.layers.0.norm1.weight: Trainable
transformer_decoders_z.0.layers.0.norm1.bias: Trainable
transformer_decoders_z.0.layers.0.norm2.weight: Trainable
transformer_decoders_z.0.layers.0.norm2.bias: Trainable
output_layers_z.0.weight: Trainable
output_layers_z.0.bias: Trainable
模型的总可训练参数量: 4275843

Epoch 1/1000
Training Loss: 0.86281468, Training R2: -723.405212
Validation Loss: 0.47977614, Validation R2: -236.229065
Saved best model with validation R2 -236.229065 to best_finetuned_model.pth

Epoch 2/1000
Training Loss: 0.44410474, Training R2: -186.241516
Validation Loss: 0.22552440, Validation R2: -53.041103
Saved best model with validation R2 -53.041103 to best_finetuned_model.pth

Epoch 3/1000
Training Loss: 0.17561156, Training R2: -31.924206
Validation Loss: 0.17430751, Validation R2: -32.150410
Saved best model with validation R2 -32.150410 to best_finetuned_model.pth

Epoch 4/1000
Training Loss: 0.12478089, Training R2: -15.975616
Validation Loss: 0.06906486, Validation R2: -4.828112
Saved best model with validation R2 -4.828112 to best_finetuned_model.pth

Epoch 5/1000
Training Loss: 0.07234184, Training R2: -4.971481
Validation Loss: 0.13373090, Validation R2: -18.260468

Epoch 6/1000
Training Loss: 0.09375743, Training R2: -8.373487
Validation Loss: 0.07594784, Validation R2: -5.854275

Epoch 7/1000
Training Loss: 0.06990667, Training R2: -4.282090
Validation Loss: 0.05950107, Validation R2: -3.533003
Saved best model with validation R2 -3.533003 to best_finetuned_model.pth

Epoch 8/1000
Training Loss: 0.05351119, Training R2: -2.406701
Validation Loss: 0.08327901, Validation R2: -7.126493

Epoch 9/1000
Training Loss: 0.06610181, Training R2: -4.130675
Validation Loss: 0.05633332, Validation R2: -3.084743
Saved best model with validation R2 -3.084743 to best_finetuned_model.pth

Epoch 10/1000
Training Loss: 0.06071783, Training R2: -3.278092
Validation Loss: 0.06543060, Validation R2: -4.329749

Epoch 11/1000
Training Loss: 0.06934782, Training R2: -4.197700
Validation Loss: 0.06135418, Validation R2: -3.844120

Epoch 12/1000
Training Loss: 0.04911214, Training R2: -1.965938
Validation Loss: 0.02313088, Validation R2: 0.020200
Saved best model with validation R2 0.020200 to best_finetuned_model.pth

Epoch 13/1000
Training Loss: 0.04447367, Training R2: -1.510852
Validation Loss: 0.02966563, Validation R2: -0.451403

Epoch 14/1000
Training Loss: 0.02741730, Training R2: -0.067129
Validation Loss: 0.02205992, Validation R2: 0.066823
Saved best model with validation R2 0.066823 to best_finetuned_model.pth

Epoch 15/1000
Training Loss: 0.02520765, Training R2: 0.045805
Validation Loss: 0.02426753, Validation R2: 0.009197

Epoch 16/1000
Training Loss: 0.02539638, Training R2: 0.072000
Validation Loss: 0.02790646, Validation R2: -0.221029

Epoch 17/1000
Training Loss: 0.02638865, Training R2: 0.019365
Validation Loss: 0.02073925, Validation R2: 0.186801
Saved best model with validation R2 0.186801 to best_finetuned_model.pth

Epoch 18/1000
Training Loss: 0.02103758, Training R2: 0.277516
Validation Loss: 0.02084924, Validation R2: 0.177408

Epoch 19/1000
Training Loss: 0.02260256, Training R2: 0.232734
Validation Loss: 0.03005812, Validation R2: -0.358559

Epoch 20/1000
Training Loss: 0.02600804, Training R2: 0.042681
Validation Loss: 0.02585994, Validation R2: -0.042859

Epoch 21/1000
Training Loss: 0.02164598, Training R2: 0.286080
Validation Loss: 0.01974053, Validation R2: 0.255022
Saved best model with validation R2 0.255022 to best_finetuned_model.pth

Epoch 22/1000
Training Loss: 0.01911155, Training R2: 0.439006
Validation Loss: 0.01913237, Validation R2: 0.291862
Saved best model with validation R2 0.291862 to best_finetuned_model.pth

Epoch 23/1000
Training Loss: 0.01804744, Training R2: 0.479261
Validation Loss: 0.02124525, Validation R2: 0.208328

Epoch 24/1000
Training Loss: 0.01910576, Training R2: 0.457900
Validation Loss: 0.02761928, Validation R2: -0.138741

Epoch 25/1000
Training Loss: 0.02169595, Training R2: 0.318856
Validation Loss: 0.03145980, Validation R2: -0.387051

Epoch 26/1000
Training Loss: 0.03130949, Training R2: -0.247266
Validation Loss: 0.07494745, Validation R2: -5.357709

Epoch 27/1000
Training Loss: 0.05412426, Training R2: -2.476670
Validation Loss: 0.01754433, Validation R2: 0.390734
Saved best model with validation R2 0.390734 to best_finetuned_model.pth

Epoch 28/1000
Training Loss: 0.03171747, Training R2: -0.369895
Validation Loss: 0.06021243, Validation R2: -3.251611

Epoch 29/1000
Training Loss: 0.04042223, Training R2: -0.945359
Validation Loss: 0.01920328, Validation R2: 0.349351

Epoch 30/1000
Training Loss: 0.02993699, Training R2: -0.183460
Validation Loss: 0.03426089, Validation R2: -0.650155

Epoch 31/1000
Training Loss: 0.04580371, Training R2: -1.279470
Validation Loss: 0.03491391, Validation R2: -0.690959

Epoch 32/1000
Training Loss: 0.02761411, Training R2: 0.046000
Validation Loss: 0.01874269, Validation R2: 0.362088

Epoch 33/1000
Training Loss: 0.02562258, Training R2: 0.105480
Validation Loss: 0.01955421, Validation R2: 0.331080

Epoch 34/1000
Training Loss: 0.03651951, Training R2: -0.611685
Validation Loss: 0.05321230, Validation R2: -2.421237

Epoch 35/1000
Training Loss: 0.03984959, Training R2: -0.866611
Validation Loss: 0.05328542, Validation R2: -2.394430

Epoch 36/1000
Training Loss: 0.04787820, Training R2: -1.515096
Validation Loss: 0.01722622, Validation R2: 0.447598
Saved best model with validation R2 0.447598 to best_finetuned_model.pth

Epoch 37/1000
Training Loss: 0.02598351, Training R2: 0.037321
Validation Loss: 0.03101242, Validation R2: -0.291200

Epoch 38/1000
Training Loss: 0.04159945, Training R2: -0.867448
Validation Loss: 0.03768044, Validation R2: -0.873343

Epoch 39/1000
Training Loss: 0.03133357, Training R2: -0.154356
Validation Loss: 0.02633290, Validation R2: -0.141051

Epoch 40/1000
Training Loss: 0.03991843, Training R2: -0.856872
Validation Loss: 0.04768888, Validation R2: -1.894485

Epoch 41/1000
Training Loss: 0.03124034, Training R2: -0.274244
Validation Loss: 0.02528837, Validation R2: 0.069657

Epoch 42/1000
Training Loss: 0.02004085, Training R2: 0.451031
Validation Loss: 0.02345486, Validation R2: 0.117883

Epoch 43/1000
Training Loss: 0.01965034, Training R2: 0.474300
Validation Loss: 0.02101243, Validation R2: 0.277408

Epoch 44/1000
Training Loss: 0.01722562, Training R2: 0.567542
Validation Loss: 0.02431509, Validation R2: 0.114283

Epoch 45/1000
Training Loss: 0.01812350, Training R2: 0.534953
Validation Loss: 0.02119468, Validation R2: 0.330298

Epoch 46/1000
Training Loss: 0.01568239, Training R2: 0.631729
Validation Loss: 0.02345948, Validation R2: 0.174341

Epoch 47/1000
Training Loss: 0.01795270, Training R2: 0.525447
Validation Loss: 0.01573477, Validation R2: 0.509251
Saved best model with validation R2 0.509251 to best_finetuned_model.pth

Epoch 48/1000
Training Loss: 0.01890078, Training R2: 0.520409
Validation Loss: 0.05151904, Validation R2: -2.094700

Epoch 49/1000
Training Loss: 0.04779318, Training R2: -1.491211
Validation Loss: 0.01578561, Validation R2: 0.562035
Saved best model with validation R2 0.562035 to best_finetuned_model.pth

Epoch 50/1000
Training Loss: 0.06114063, Training R2: -3.496803
Validation Loss: 0.10137048, Validation R2: -9.908509

Epoch 51/1000
Training Loss: 0.11072678, Training R2: -10.514875
Validation Loss: 0.09521975, Validation R2: -8.720439

Epoch 52/1000
Training Loss: 0.08381030, Training R2: -5.951046
Validation Loss: 0.11997695, Validation R2: -14.272413

Epoch 53/1000
Training Loss: 0.07760701, Training R2: -6.250157
Validation Loss: 0.12347570, Validation R2: -15.113216

Epoch 54/1000
Training Loss: 0.07735241, Training R2: -5.780143
Validation Loss: 0.04145243, Validation R2: -1.185535

Epoch 55/1000
Training Loss: 0.04784559, Training R2: -1.461729
Validation Loss: 0.06728455, Validation R2: -4.145223

Epoch 56/1000
Training Loss: 0.05413219, Training R2: -2.312009
Validation Loss: 0.08567476, Validation R2: -7.055720

Epoch 57/1000
Training Loss: 0.06542360, Training R2: -3.567422
Validation Loss: 0.07250652, Validation R2: -4.936796

Epoch 58/1000
Training Loss: 0.04904646, Training R2: -1.838126
Validation Loss: 0.06009208, Validation R2: -3.212588

Epoch 59/1000
Training Loss: 0.05485187, Training R2: -2.192676
Validation Loss: 0.07869440, Validation R2: -5.860324

Epoch 60/1000
Training Loss: 0.06123032, Training R2: -2.983348
Validation Loss: 0.06057322, Validation R2: -3.188491

Epoch 61/1000
Training Loss: 0.04618309, Training R2: -1.374920
Validation Loss: 0.05866197, Validation R2: -2.982639

Epoch 62/1000
Training Loss: 0.05154026, Training R2: -1.936618
Validation Loss: 0.08144128, Validation R2: -6.297003

Epoch 63/1000
Training Loss: 0.06051734, Training R2: -2.849519
Validation Loss: 0.05359120, Validation R2: -2.434701

Epoch 64/1000
Training Loss: 0.04588256, Training R2: -1.352270
Validation Loss: 0.05099045, Validation R2: -2.151863

Epoch 65/1000
Training Loss: 0.04684698, Training R2: -1.434401
Validation Loss: 0.06258519, Validation R2: -3.609462

Epoch 66/1000
Training Loss: 0.04971326, Training R2: -1.864109
Validation Loss: 0.03402961, Validation R2: -0.495092

Epoch 67/1000
Training Loss: 0.05494010, Training R2: -2.272014
Validation Loss: 0.05041663, Validation R2: -1.995497

Epoch 68/1000
Training Loss: 0.05661511, Training R2: -2.280229
Validation Loss: 0.04931319, Validation R2: -1.945449

Epoch 69/1000
Training Loss: 0.04113923, Training R2: -1.002869
Validation Loss: 0.01715481, Validation R2: 0.516193

Epoch 70/1000
Epoch 00070: reducing learning rate of group 0 to 5.0000e-05.
Training Loss: 0.04174060, Training R2: -1.092176
Validation Loss: 0.04785918, Validation R2: -1.729570

Epoch 71/1000
学习率已减少 1 次
Training Loss: 0.03381670, Training R2: -0.325182
Validation Loss: 0.04099080, Validation R2: -1.117755

Epoch 72/1000
Training Loss: 0.03021231, Training R2: -0.122312
Validation Loss: 0.02698455, Validation R2: -0.024421

Epoch 73/1000
Training Loss: 0.02139609, Training R2: 0.383623
Validation Loss: 0.01743273, Validation R2: 0.475643

Epoch 74/1000
Training Loss: 0.01667043, Training R2: 0.625314
Validation Loss: 0.01593485, Validation R2: 0.502712

Epoch 75/1000
Training Loss: 0.01452965, Training R2: 0.694830
Validation Loss: 0.01619842, Validation R2: 0.505910

Epoch 76/1000
Training Loss: 0.01350987, Training R2: 0.707719
Validation Loss: 0.01463920, Validation R2: 0.580039
Saved best model with validation R2 0.580039 to best_finetuned_model.pth

Epoch 77/1000
Training Loss: 0.01185076, Training R2: 0.762593
Validation Loss: 0.01400797, Validation R2: 0.605295
Saved best model with validation R2 0.605295 to best_finetuned_model.pth

Epoch 78/1000
Training Loss: 0.01178546, Training R2: 0.765291
Validation Loss: 0.01575635, Validation R2: 0.540696

Epoch 79/1000
Training Loss: 0.01239560, Training R2: 0.747232
Validation Loss: 0.02340775, Validation R2: 0.197619

Epoch 80/1000
Training Loss: 0.01820777, Training R2: 0.563099
Validation Loss: 0.01544585, Validation R2: 0.574397

Epoch 81/1000
Training Loss: 0.01442986, Training R2: 0.696072
Validation Loss: 0.01797430, Validation R2: 0.493183

Epoch 82/1000
Training Loss: 0.01472881, Training R2: 0.696085
Validation Loss: 0.01719144, Validation R2: 0.523677

Epoch 83/1000
Training Loss: 0.01392799, Training R2: 0.715229
Validation Loss: 0.01476029, Validation R2: 0.608425
Saved best model with validation R2 0.608425 to best_finetuned_model.pth

Epoch 84/1000
Training Loss: 0.01195242, Training R2: 0.771523
Validation Loss: 0.01351089, Validation R2: 0.634319
Saved best model with validation R2 0.634319 to best_finetuned_model.pth

Epoch 85/1000
Training Loss: 0.01087310, Training R2: 0.803951
Validation Loss: 0.01533142, Validation R2: 0.555920

Epoch 86/1000
Training Loss: 0.01217017, Training R2: 0.772692
Validation Loss: 0.01551093, Validation R2: 0.549529

Epoch 87/1000
Training Loss: 0.01195246, Training R2: 0.782155
Validation Loss: 0.01871778, Validation R2: 0.397143

Epoch 88/1000
Training Loss: 0.01595127, Training R2: 0.670847
Validation Loss: 0.01671273, Validation R2: 0.490379

Epoch 89/1000
Training Loss: 0.01396464, Training R2: 0.734024
Validation Loss: 0.01868226, Validation R2: 0.421266

Epoch 90/1000
Training Loss: 0.01520779, Training R2: 0.699591
Validation Loss: 0.01629258, Validation R2: 0.524005

Epoch 91/1000
Training Loss: 0.01235923, Training R2: 0.778963
Validation Loss: 0.01832324, Validation R2: 0.439775

Epoch 92/1000
Training Loss: 0.01279952, Training R2: 0.768097
Validation Loss: 0.01866440, Validation R2: 0.417862

Epoch 93/1000
Training Loss: 0.01331841, Training R2: 0.744407
Validation Loss: 0.02348194, Validation R2: 0.191503

Epoch 94/1000
Training Loss: 0.01784321, Training R2: 0.625133
Validation Loss: 0.01597003, Validation R2: 0.535552

Epoch 95/1000
Training Loss: 0.01282045, Training R2: 0.768883
Validation Loss: 0.01913492, Validation R2: 0.417467

Epoch 96/1000
Training Loss: 0.01464958, Training R2: 0.709011
Validation Loss: 0.01683067, Validation R2: 0.522424

Epoch 97/1000
Training Loss: 0.01267687, Training R2: 0.780278
Validation Loss: 0.01372905, Validation R2: 0.632655

Epoch 98/1000
Training Loss: 0.00968948, Training R2: 0.846288
Validation Loss: 0.01525720, Validation R2: 0.574591

Epoch 99/1000
Training Loss: 0.00972824, Training R2: 0.843178
Validation Loss: 0.01386849, Validation R2: 0.636448
Saved best model with validation R2 0.636448 to best_finetuned_model.pth

Epoch 100/1000
Training Loss: 0.00846757, Training R2: 0.872340
Validation Loss: 0.01220371, Validation R2: 0.698016
Saved best model with validation R2 0.698016 to best_finetuned_model.pth

Epoch 101/1000
Training Loss: 0.00807535, Training R2: 0.885425
Validation Loss: 0.01270776, Validation R2: 0.669520

Epoch 102/1000
Training Loss: 0.00763565, Training R2: 0.891122
Validation Loss: 0.01189596, Validation R2: 0.698202
Saved best model with validation R2 0.698202 to best_finetuned_model.pth

Epoch 103/1000
Training Loss: 0.00826266, Training R2: 0.880852
Validation Loss: 0.01176055, Validation R2: 0.703320
Saved best model with validation R2 0.703320 to best_finetuned_model.pth

Epoch 104/1000
Training Loss: 0.00744674, Training R2: 0.901089
Validation Loss: 0.01182507, Validation R2: 0.705373
Saved best model with validation R2 0.705373 to best_finetuned_model.pth

Epoch 105/1000
Training Loss: 0.00717800, Training R2: 0.905795
Validation Loss: 0.01158595, Validation R2: 0.715238
Saved best model with validation R2 0.715238 to best_finetuned_model.pth

Epoch 106/1000
Training Loss: 0.00627369, Training R2: 0.920214
Validation Loss: 0.01197580, Validation R2: 0.701548

Epoch 107/1000
Training Loss: 0.00869975, Training R2: 0.884237
Validation Loss: 0.01687338, Validation R2: 0.528324

Epoch 108/1000
Training Loss: 0.01005220, Training R2: 0.856715
Validation Loss: 0.01181241, Validation R2: 0.711794

Epoch 109/1000
Training Loss: 0.00730921, Training R2: 0.910774
Validation Loss: 0.01163352, Validation R2: 0.718875
Saved best model with validation R2 0.718875 to best_finetuned_model.pth

Epoch 110/1000
Training Loss: 0.00622558, Training R2: 0.925232
Validation Loss: 0.01322675, Validation R2: 0.688404

Epoch 111/1000
Training Loss: 0.00805055, Training R2: 0.899980
Validation Loss: 0.01375576, Validation R2: 0.663605

Epoch 112/1000
Training Loss: 0.00841835, Training R2: 0.897110
Validation Loss: 0.01267830, Validation R2: 0.689833

Epoch 113/1000
Training Loss: 0.00868002, Training R2: 0.888654
Validation Loss: 0.01209838, Validation R2: 0.702734

Epoch 114/1000
Training Loss: 0.00809900, Training R2: 0.895231
Validation Loss: 0.01175049, Validation R2: 0.701344

Epoch 115/1000
Training Loss: 0.00553908, Training R2: 0.935179
Validation Loss: 0.01222961, Validation R2: 0.689193

Epoch 116/1000
Training Loss: 0.00851720, Training R2: 0.898319
Validation Loss: 0.01172586, Validation R2: 0.713807

Epoch 117/1000
Training Loss: 0.00893588, Training R2: 0.877560
Validation Loss: 0.01257595, Validation R2: 0.685757

Epoch 118/1000
Training Loss: 0.00676986, Training R2: 0.923787
Validation Loss: 0.01117602, Validation R2: 0.730872
Saved best model with validation R2 0.730872 to best_finetuned_model.pth

Epoch 119/1000
Training Loss: 0.00851151, Training R2: 0.888019
Validation Loss: 0.01177501, Validation R2: 0.721801

Epoch 120/1000
Training Loss: 0.01150019, Training R2: 0.816438
Validation Loss: 0.02158172, Validation R2: 0.368107

Epoch 121/1000
Training Loss: 0.01736344, Training R2: 0.665017
Validation Loss: 0.01346358, Validation R2: 0.671899

Epoch 122/1000
Training Loss: 0.01456793, Training R2: 0.738478
Validation Loss: 0.02661536, Validation R2: 0.079438

Epoch 123/1000
Training Loss: 0.01588840, Training R2: 0.681172
Validation Loss: 0.01193498, Validation R2: 0.701959

Epoch 124/1000
Training Loss: 0.00630888, Training R2: 0.928255
Validation Loss: 0.01363293, Validation R2: 0.658309

Epoch 125/1000
Training Loss: 0.00721324, Training R2: 0.916589
Validation Loss: 0.01192061, Validation R2: 0.702162

Epoch 126/1000
Training Loss: 0.00815450, Training R2: 0.902152
Validation Loss: 0.01163729, Validation R2: 0.717160

Epoch 127/1000
Training Loss: 0.00858316, Training R2: 0.890175
Validation Loss: 0.01748832, Validation R2: 0.513666

Epoch 128/1000
Training Loss: 0.01400741, Training R2: 0.752831
Validation Loss: 0.02853878, Validation R2: -0.033807

Epoch 129/1000
Training Loss: 0.02113502, Training R2: 0.476483
Validation Loss: 0.01723201, Validation R2: 0.534079

Epoch 130/1000
Training Loss: 0.02269925, Training R2: 0.458546
Validation Loss: 0.02422802, Validation R2: 0.225435

Epoch 131/1000
Training Loss: 0.02143361, Training R2: 0.505203
Validation Loss: 0.01142541, Validation R2: 0.724213

Epoch 132/1000
Training Loss: 0.02049049, Training R2: 0.492391
Validation Loss: 0.02418978, Validation R2: 0.219015

Epoch 133/1000
Training Loss: 0.01693787, Training R2: 0.653916
Validation Loss: 0.02544198, Validation R2: 0.147121

Epoch 134/1000
Training Loss: 0.01889955, Training R2: 0.590683
Validation Loss: 0.01778474, Validation R2: 0.493932

Epoch 135/1000
Training Loss: 0.01564502, Training R2: 0.714656
Validation Loss: 0.01594519, Validation R2: 0.564105

Epoch 136/1000
Training Loss: 0.01346177, Training R2: 0.778882
Validation Loss: 0.02214399, Validation R2: 0.302829

Epoch 137/1000
Training Loss: 0.01755187, Training R2: 0.654241
Validation Loss: 0.01736520, Validation R2: 0.513045

Epoch 138/1000
Training Loss: 0.01342701, Training R2: 0.773771
Validation Loss: 0.01806905, Validation R2: 0.458427

Epoch 139/1000
Epoch 00139: reducing learning rate of group 0 to 2.5000e-05.
Training Loss: 0.01410116, Training R2: 0.751184
Validation Loss: 0.01754020, Validation R2: 0.462938

Epoch 140/1000
学习率已减少 2 次
Training Loss: 0.01154313, Training R2: 0.815952
Validation Loss: 0.01291994, Validation R2: 0.689121

Epoch 141/1000
Training Loss: 0.00831375, Training R2: 0.894773
Validation Loss: 0.01343811, Validation R2: 0.672477

Epoch 142/1000
Training Loss: 0.00852923, Training R2: 0.893566
Validation Loss: 0.01163077, Validation R2: 0.731156
Saved best model with validation R2 0.731156 to best_finetuned_model.pth

Epoch 143/1000
Training Loss: 0.00628543, Training R2: 0.933645
Validation Loss: 0.01207025, Validation R2: 0.715147

Epoch 144/1000
Training Loss: 0.00659097, Training R2: 0.928839
Validation Loss: 0.01158200, Validation R2: 0.732161
Saved best model with validation R2 0.732161 to best_finetuned_model.pth

Epoch 145/1000
Training Loss: 0.00540007, Training R2: 0.947267
Validation Loss: 0.01191802, Validation R2: 0.720111

Epoch 146/1000
Training Loss: 0.00603730, Training R2: 0.939042
Validation Loss: 0.01133695, Validation R2: 0.732542
Saved best model with validation R2 0.732542 to best_finetuned_model.pth

Epoch 147/1000
Training Loss: 0.00490965, Training R2: 0.953764
Validation Loss: 0.01121310, Validation R2: 0.734977
Saved best model with validation R2 0.734977 to best_finetuned_model.pth

Epoch 148/1000
Training Loss: 0.00486511, Training R2: 0.952905
Validation Loss: 0.01099457, Validation R2: 0.744165
Saved best model with validation R2 0.744165 to best_finetuned_model.pth

Epoch 149/1000
Training Loss: 0.00465191, Training R2: 0.956498
Validation Loss: 0.01153731, Validation R2: 0.730101

Epoch 150/1000
Training Loss: 0.00444819, Training R2: 0.958935
Validation Loss: 0.01171191, Validation R2: 0.720634

Epoch 151/1000
Training Loss: 0.00450423, Training R2: 0.959636
Validation Loss: 0.01165954, Validation R2: 0.724128

Epoch 152/1000
Training Loss: 0.00428713, Training R2: 0.962090
Validation Loss: 0.01124717, Validation R2: 0.732393

Epoch 153/1000
Training Loss: 0.00401253, Training R2: 0.965268
Validation Loss: 0.01174736, Validation R2: 0.718477

Epoch 154/1000
Training Loss: 0.00625523, Training R2: 0.940604
Validation Loss: 0.01416842, Validation R2: 0.633923

Epoch 155/1000
Training Loss: 0.00933152, Training R2: 0.901603
Validation Loss: 0.01296769, Validation R2: 0.672255

Epoch 156/1000
Training Loss: 0.00708520, Training R2: 0.931861
Validation Loss: 0.01167721, Validation R2: 0.717140

Epoch 157/1000
Training Loss: 0.00830192, Training R2: 0.911201
Validation Loss: 0.01473743, Validation R2: 0.616283

Epoch 158/1000
Training Loss: 0.00770464, Training R2: 0.921187
Validation Loss: 0.01274405, Validation R2: 0.681685

Epoch 159/1000
Training Loss: 0.00753950, Training R2: 0.927324
Validation Loss: 0.01261694, Validation R2: 0.685188

Epoch 160/1000
Training Loss: 0.00922759, Training R2: 0.899685
Validation Loss: 0.01289308, Validation R2: 0.675621

Epoch 161/1000
Training Loss: 0.00711689, Training R2: 0.931191
Validation Loss: 0.01195482, Validation R2: 0.709687

Epoch 162/1000
Training Loss: 0.00944075, Training R2: 0.891388
Validation Loss: 0.01241384, Validation R2: 0.698906

Epoch 163/1000
Training Loss: 0.00644612, Training R2: 0.940296
Validation Loss: 0.01097629, Validation R2: 0.742154

Epoch 164/1000
Training Loss: 0.00728353, Training R2: 0.924396
Validation Loss: 0.01370863, Validation R2: 0.653271

Epoch 165/1000
Training Loss: 0.00896837, Training R2: 0.905515
Validation Loss: 0.01236136, Validation R2: 0.698873

Epoch 166/1000
Training Loss: 0.00739088, Training R2: 0.927670
Validation Loss: 0.01266631, Validation R2: 0.690393

Epoch 167/1000
Training Loss: 0.00861817, Training R2: 0.908763
Validation Loss: 0.01272084, Validation R2: 0.686379

Epoch 168/1000
Training Loss: 0.00721179, Training R2: 0.929613
Validation Loss: 0.01162410, Validation R2: 0.717408

Epoch 169/1000
Epoch 00169: reducing learning rate of group 0 to 1.2500e-05.
Training Loss: 0.00604211, Training R2: 0.944586
Validation Loss: 0.01171570, Validation R2: 0.710730

Epoch 170/1000
学习率已减少 3 次
Training Loss: 0.00580751, Training R2: 0.947377
Validation Loss: 0.01196650, Validation R2: 0.705200

Epoch 171/1000
Training Loss: 0.00541996, Training R2: 0.953358
Validation Loss: 0.01067304, Validation R2: 0.745914
Saved best model with validation R2 0.745914 to best_finetuned_model.pth

Epoch 172/1000
Training Loss: 0.00474373, Training R2: 0.959476
Validation Loss: 0.01112671, Validation R2: 0.735265

Epoch 173/1000
Training Loss: 0.00423935, Training R2: 0.963814
Validation Loss: 0.01098897, Validation R2: 0.738681

Epoch 174/1000
Training Loss: 0.00402810, Training R2: 0.967019
Validation Loss: 0.01110827, Validation R2: 0.735365

Epoch 175/1000
Training Loss: 0.00464992, Training R2: 0.960708
Validation Loss: 0.01080579, Validation R2: 0.742614

Epoch 176/1000
Training Loss: 0.00383977, Training R2: 0.969823
Validation Loss: 0.01078954, Validation R2: 0.744016

Epoch 177/1000
Training Loss: 0.00367509, Training R2: 0.970662
Validation Loss: 0.01105982, Validation R2: 0.736167

Epoch 178/1000
Training Loss: 0.00417889, Training R2: 0.967252
Validation Loss: 0.01115159, Validation R2: 0.734808

Epoch 179/1000
Training Loss: 0.00395600, Training R2: 0.968291
Validation Loss: 0.01101122, Validation R2: 0.738548

Epoch 180/1000
Training Loss: 0.00361761, Training R2: 0.971562
Validation Loss: 0.01097668, Validation R2: 0.740502

Epoch 181/1000
Training Loss: 0.00326802, Training R2: 0.974062
Validation Loss: 0.01082257, Validation R2: 0.746876
Saved best model with validation R2 0.746876 to best_finetuned_model.pth

Epoch 182/1000
Training Loss: 0.00304490, Training R2: 0.976386
Validation Loss: 0.01075090, Validation R2: 0.749543
Saved best model with validation R2 0.749543 to best_finetuned_model.pth

Epoch 183/1000
Training Loss: 0.00283036, Training R2: 0.976832
Validation Loss: 0.01076643, Validation R2: 0.750226
Saved best model with validation R2 0.750226 to best_finetuned_model.pth

Epoch 184/1000
Training Loss: 0.00270007, Training R2: 0.977946
Validation Loss: 0.01103013, Validation R2: 0.742000

Epoch 185/1000
Training Loss: 0.00324242, Training R2: 0.974269
Validation Loss: 0.01074763, Validation R2: 0.749389

Epoch 186/1000
Training Loss: 0.00318874, Training R2: 0.974909
Validation Loss: 0.01099609, Validation R2: 0.744160

Epoch 187/1000
Training Loss: 0.00289523, Training R2: 0.977273
Validation Loss: 0.01094096, Validation R2: 0.745538

Epoch 188/1000
Training Loss: 0.00243019, Training R2: 0.979372
Validation Loss: 0.01094344, Validation R2: 0.743662

Epoch 189/1000
Training Loss: 0.00244768, Training R2: 0.979683
Validation Loss: 0.01088772, Validation R2: 0.745728

Epoch 190/1000
Training Loss: 0.00224870, Training R2: 0.980245
Validation Loss: 0.01104923, Validation R2: 0.742383

Epoch 191/1000
Training Loss: 0.00309501, Training R2: 0.975706
Validation Loss: 0.01088376, Validation R2: 0.745741

Epoch 192/1000
Training Loss: 0.00463633, Training R2: 0.962870
Validation Loss: 0.01191209, Validation R2: 0.718041

Epoch 193/1000
Training Loss: 0.00438662, Training R2: 0.965650
Validation Loss: 0.01088731, Validation R2: 0.744329

Epoch 194/1000
Training Loss: 0.00341375, Training R2: 0.973234
Validation Loss: 0.01096471, Validation R2: 0.743741

Epoch 195/1000
Training Loss: 0.00480619, Training R2: 0.963854
Validation Loss: 0.01125002, Validation R2: 0.734128

Epoch 196/1000
Training Loss: 0.00393979, Training R2: 0.971891
Validation Loss: 0.01079450, Validation R2: 0.747766

Epoch 197/1000
Training Loss: 0.00292839, Training R2: 0.977155
Validation Loss: 0.01096071, Validation R2: 0.742127

Epoch 198/1000
Training Loss: 0.00274465, Training R2: 0.979381
Validation Loss: 0.01107377, Validation R2: 0.739546

Epoch 199/1000
Training Loss: 0.00266073, Training R2: 0.978751
Validation Loss: 0.01115252, Validation R2: 0.736555

Epoch 200/1000
Training Loss: 0.00328681, Training R2: 0.974745
Validation Loss: 0.01104378, Validation R2: 0.741206

Epoch 201/1000
Training Loss: 0.00298752, Training R2: 0.977420
Validation Loss: 0.01092331, Validation R2: 0.745650

Epoch 202/1000
Training Loss: 0.00248815, Training R2: 0.980258
Validation Loss: 0.01101329, Validation R2: 0.741892

Epoch 203/1000
Training Loss: 0.00281544, Training R2: 0.978364
Validation Loss: 0.01108065, Validation R2: 0.739171

Epoch 204/1000
Epoch 00204: reducing learning rate of group 0 to 6.2500e-06.
Training Loss: 0.00331032, Training R2: 0.977222
Validation Loss: 0.01138359, Validation R2: 0.732843

Epoch 205/1000
学习率已减少 4 次
Training Loss: 0.00358216, Training R2: 0.975085
Validation Loss: 0.01075094, Validation R2: 0.751157
Saved best model with validation R2 0.751157 to best_finetuned_model.pth

Epoch 206/1000
Training Loss: 0.00251905, Training R2: 0.980980
Validation Loss: 0.01097429, Validation R2: 0.745223

Epoch 207/1000
Training Loss: 0.00258670, Training R2: 0.980762
Validation Loss: 0.01092132, Validation R2: 0.746932

Epoch 208/1000
Training Loss: 0.00230206, Training R2: 0.981651
Validation Loss: 0.01086982, Validation R2: 0.747230

Epoch 209/1000
Training Loss: 0.00205866, Training R2: 0.982572
Validation Loss: 0.01085527, Validation R2: 0.747337

Epoch 210/1000
Training Loss: 0.00188630, Training R2: 0.983172
Validation Loss: 0.01084686, Validation R2: 0.747802

Epoch 211/1000
Training Loss: 0.00182463, Training R2: 0.983521
Validation Loss: 0.01072214, Validation R2: 0.750472

Epoch 212/1000
Training Loss: 0.00180706, Training R2: 0.983413
Validation Loss: 0.01071189, Validation R2: 0.750790

Epoch 213/1000
Training Loss: 0.00176601, Training R2: 0.983543
Validation Loss: 0.01073423, Validation R2: 0.749433

Epoch 214/1000
Training Loss: 0.00200140, Training R2: 0.983186
Validation Loss: 0.01078028, Validation R2: 0.748322

Epoch 215/1000
Training Loss: 0.00229598, Training R2: 0.981728
Validation Loss: 0.01098210, Validation R2: 0.741012

Epoch 216/1000
Training Loss: 0.00259592, Training R2: 0.981351
Validation Loss: 0.01081902, Validation R2: 0.746374

Epoch 217/1000
Training Loss: 0.00199334, Training R2: 0.983045
Validation Loss: 0.01078090, Validation R2: 0.747170

Epoch 218/1000
Training Loss: 0.00189423, Training R2: 0.983398
Validation Loss: 0.01083694, Validation R2: 0.745953

Epoch 219/1000
Training Loss: 0.00185124, Training R2: 0.984007
Validation Loss: 0.01074072, Validation R2: 0.749500

Epoch 220/1000
Training Loss: 0.00175101, Training R2: 0.984467
Validation Loss: 0.01071194, Validation R2: 0.750353

Epoch 221/1000
Training Loss: 0.00168470, Training R2: 0.984521
Validation Loss: 0.01076742, Validation R2: 0.747886

Epoch 222/1000
Training Loss: 0.00164308, Training R2: 0.984451
Validation Loss: 0.01084034, Validation R2: 0.745311

Epoch 223/1000
Training Loss: 0.00170346, Training R2: 0.984819
Validation Loss: 0.01075687, Validation R2: 0.747637

Epoch 224/1000
Training Loss: 0.00154053, Training R2: 0.985068
Validation Loss: 0.01073125, Validation R2: 0.748205

Epoch 225/1000
Training Loss: 0.00157726, Training R2: 0.984963
Validation Loss: 0.01074884, Validation R2: 0.748379

Epoch 226/1000
Epoch 00226: reducing learning rate of group 0 to 3.1250e-06.
Training Loss: 0.00141697, Training R2: 0.985444
Validation Loss: 0.01085222, Validation R2: 0.746056

Epoch 227/1000
学习率已减少 5 次
Training Loss: 0.00180127, Training R2: 0.984269
Validation Loss: 0.01083870, Validation R2: 0.746228

Epoch 228/1000
Training Loss: 0.00181744, Training R2: 0.984218
Validation Loss: 0.01075515, Validation R2: 0.748327

Epoch 229/1000
Training Loss: 0.00150873, Training R2: 0.985348
Validation Loss: 0.01077303, Validation R2: 0.748019

Epoch 230/1000
Training Loss: 0.00143707, Training R2: 0.985577
Validation Loss: 0.01075071, Validation R2: 0.748118

Epoch 231/1000
Training Loss: 0.00146178, Training R2: 0.985668
Validation Loss: 0.01079132, Validation R2: 0.746779

Epoch 232/1000
Training Loss: 0.00179328, Training R2: 0.985011
Validation Loss: 0.01074973, Validation R2: 0.747740

Epoch 233/1000
Training Loss: 0.00151814, Training R2: 0.985413
Validation Loss: 0.01075637, Validation R2: 0.747919

Epoch 234/1000
Training Loss: 0.00154169, Training R2: 0.985450
Validation Loss: 0.01076778, Validation R2: 0.747501

Epoch 235/1000
Training Loss: 0.00172920, Training R2: 0.984800
Validation Loss: 0.01076144, Validation R2: 0.748346

Epoch 236/1000
Training Loss: 0.00166774, Training R2: 0.985207
Validation Loss: 0.01074400, Validation R2: 0.748417

Epoch 237/1000
Training Loss: 0.00164936, Training R2: 0.985405
Validation Loss: 0.01075722, Validation R2: 0.748033

Epoch 238/1000
Training Loss: 0.00150821, Training R2: 0.985340
Validation Loss: 0.01080040, Validation R2: 0.747151

Epoch 239/1000
Training Loss: 0.00142956, Training R2: 0.985508
Validation Loss: 0.01078379, Validation R2: 0.747320

Epoch 240/1000
Training Loss: 0.00136868, Training R2: 0.985875
Validation Loss: 0.01074073, Validation R2: 0.748138

Epoch 241/1000
Training Loss: 0.00130362, Training R2: 0.985937
Validation Loss: 0.01068720, Validation R2: 0.749320

Epoch 242/1000
Training Loss: 0.00130968, Training R2: 0.986052
Validation Loss: 0.01068828, Validation R2: 0.749526

Epoch 243/1000
Training Loss: 0.00132332, Training R2: 0.986094
Validation Loss: 0.01072048, Validation R2: 0.748480

Epoch 244/1000
Training Loss: 0.00126118, Training R2: 0.986107
Validation Loss: 0.01075570, Validation R2: 0.748321

Epoch 245/1000
Training Loss: 0.00123211, Training R2: 0.986211
Validation Loss: 0.01070744, Validation R2: 0.749246

Epoch 246/1000
Training Loss: 0.00120190, Training R2: 0.986299
Validation Loss: 0.01073519, Validation R2: 0.748344

Epoch 247/1000
Epoch 00247: reducing learning rate of group 0 to 1.5625e-06.
Training Loss: 0.00146781, Training R2: 0.986117
Validation Loss: 0.01076690, Validation R2: 0.747724

Epoch 248/1000
学习率已减少 6 次
学习率已减少 6 次，达到最大允许次数 5，提前终止训练

Training completed.
Saved loss curve to /share/home/zixiao/block_predict/fine-tune/loss_curve_HOMO_energy.png
Saved R2 curve to /share/home/zixiao/block_predict/fine-tune/r2_curve_HOMO_energy.png
